var OE=Object.defineProperty;var IE=(n,e,t)=>e in n?OE(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var w=(n,e,t)=>IE(n,typeof e!="symbol"?e+"":e,t);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function t(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function r(i){if(i.ep)return;i.ep=!0;const a=t(i);fetch(i.href,a)}})();function NE(n){return n&&n.__esModule&&Object.prototype.hasOwnProperty.call(n,"default")?n.default:n}var sp={exports:{}},Po={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var sv;function kE(){if(sv)return Po;sv=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.fragment");function t(r,i,a){var l=null;if(a!==void 0&&(l=""+a),i.key!==void 0&&(l=""+i.key),"key"in i){a={};for(var c in i)c!=="key"&&(a[c]=i[c])}else a=i;return i=a.ref,{$$typeof:n,type:r,key:l,ref:i!==void 0?i:null,props:a}}return Po.Fragment=e,Po.jsx=t,Po.jsxs=t,Po}var av;function DE(){return av||(av=1,sp.exports=kE()),sp.exports}var ae=DE(),ap={exports:{}},Ce={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ov;function PE(){if(ov)return Ce;ov=1;var n=Symbol.for("react.transitional.element"),e=Symbol.for("react.portal"),t=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),i=Symbol.for("react.profiler"),a=Symbol.for("react.consumer"),l=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),f=Symbol.for("react.suspense"),d=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),_=Symbol.iterator;function y(D){return D===null||typeof D!="object"?null:(D=_&&D[_]||D["@@iterator"],typeof D=="function"?D:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},T=Object.assign,A={};function C(D,ie,ge){this.props=D,this.context=ie,this.refs=A,this.updater=ge||b}C.prototype.isReactComponent={},C.prototype.setState=function(D,ie){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,ie,"setState")},C.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function N(){}N.prototype=C.prototype;function O(D,ie,ge){this.props=D,this.context=ie,this.refs=A,this.updater=ge||b}var R=O.prototype=new N;R.constructor=O,T(R,C.prototype),R.isPureReactComponent=!0;var E=Array.isArray,k={H:null,A:null,T:null,S:null,V:null},V=Object.prototype.hasOwnProperty;function ne(D,ie,ge,he,ve,Pe){return ge=Pe.ref,{$$typeof:n,type:D,key:ie,ref:ge!==void 0?ge:null,props:Pe}}function G(D,ie){return ne(D.type,ie,void 0,void 0,void 0,D.props)}function se(D){return typeof D=="object"&&D!==null&&D.$$typeof===n}function re(D){var ie={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(ge){return ie[ge]})}var q=/\/+/g;function ce(D,ie){return typeof D=="object"&&D!==null&&D.key!=null?re(""+D.key):ie.toString(36)}function me(){}function de(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(me,me):(D.status="pending",D.then(function(ie){D.status==="pending"&&(D.status="fulfilled",D.value=ie)},function(ie){D.status==="pending"&&(D.status="rejected",D.reason=ie)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function _e(D,ie,ge,he,ve){var Pe=typeof D;(Pe==="undefined"||Pe==="boolean")&&(D=null);var Ae=!1;if(D===null)Ae=!0;else switch(Pe){case"bigint":case"string":case"number":Ae=!0;break;case"object":switch(D.$$typeof){case n:case e:Ae=!0;break;case p:return Ae=D._init,_e(Ae(D._payload),ie,ge,he,ve)}}if(Ae)return ve=ve(D),Ae=he===""?"."+ce(D,0):he,E(ve)?(ge="",Ae!=null&&(ge=Ae.replace(q,"$&/")+"/"),_e(ve,ie,ge,"",function(pe){return pe})):ve!=null&&(se(ve)&&(ve=G(ve,ge+(ve.key==null||D&&D.key===ve.key?"":(""+ve.key).replace(q,"$&/")+"/")+Ae)),ie.push(ve)),1;Ae=0;var Ht=he===""?".":he+":";if(E(D))for(var Je=0;Je<D.length;Je++)he=D[Je],Pe=Ht+ce(he,Je),Ae+=_e(he,ie,ge,Pe,ve);else if(Je=y(D),typeof Je=="function")for(D=Je.call(D),Je=0;!(he=D.next()).done;)he=he.value,Pe=Ht+ce(he,Je++),Ae+=_e(he,ie,ge,Pe,ve);else if(Pe==="object"){if(typeof D.then=="function")return _e(de(D),ie,ge,he,ve);throw ie=String(D),Error("Objects are not valid as a React child (found: "+(ie==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":ie)+"). If you meant to render a collection of children, use an array instead.")}return Ae}function $(D,ie,ge){if(D==null)return D;var he=[],ve=0;return _e(D,he,"","",function(Pe){return ie.call(ge,Pe,ve++)}),he}function ee(D){if(D._status===-1){var ie=D._result;ie=ie(),ie.then(function(ge){(D._status===0||D._status===-1)&&(D._status=1,D._result=ge)},function(ge){(D._status===0||D._status===-1)&&(D._status=2,D._result=ge)}),D._status===-1&&(D._status=0,D._result=ie)}if(D._status===1)return D._result.default;throw D._result}var fe=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var ie=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(ie))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function Re(){}return Ce.Children={map:$,forEach:function(D,ie,ge){$(D,function(){ie.apply(this,arguments)},ge)},count:function(D){var ie=0;return $(D,function(){ie++}),ie},toArray:function(D){return $(D,function(ie){return ie})||[]},only:function(D){if(!se(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Ce.Component=C,Ce.Fragment=t,Ce.Profiler=i,Ce.PureComponent=O,Ce.StrictMode=r,Ce.Suspense=f,Ce.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=k,Ce.__COMPILER_RUNTIME={__proto__:null,c:function(D){return k.H.useMemoCache(D)}},Ce.cache=function(D){return function(){return D.apply(null,arguments)}},Ce.cloneElement=function(D,ie,ge){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var he=T({},D.props),ve=D.key,Pe=void 0;if(ie!=null)for(Ae in ie.ref!==void 0&&(Pe=void 0),ie.key!==void 0&&(ve=""+ie.key),ie)!V.call(ie,Ae)||Ae==="key"||Ae==="__self"||Ae==="__source"||Ae==="ref"&&ie.ref===void 0||(he[Ae]=ie[Ae]);var Ae=arguments.length-2;if(Ae===1)he.children=ge;else if(1<Ae){for(var Ht=Array(Ae),Je=0;Je<Ae;Je++)Ht[Je]=arguments[Je+2];he.children=Ht}return ne(D.type,ve,void 0,void 0,Pe,he)},Ce.createContext=function(D){return D={$$typeof:l,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:a,_context:D},D},Ce.createElement=function(D,ie,ge){var he,ve={},Pe=null;if(ie!=null)for(he in ie.key!==void 0&&(Pe=""+ie.key),ie)V.call(ie,he)&&he!=="key"&&he!=="__self"&&he!=="__source"&&(ve[he]=ie[he]);var Ae=arguments.length-2;if(Ae===1)ve.children=ge;else if(1<Ae){for(var Ht=Array(Ae),Je=0;Je<Ae;Je++)Ht[Je]=arguments[Je+2];ve.children=Ht}if(D&&D.defaultProps)for(he in Ae=D.defaultProps,Ae)ve[he]===void 0&&(ve[he]=Ae[he]);return ne(D,Pe,void 0,void 0,null,ve)},Ce.createRef=function(){return{current:null}},Ce.forwardRef=function(D){return{$$typeof:c,render:D}},Ce.isValidElement=se,Ce.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:ee}},Ce.memo=function(D,ie){return{$$typeof:d,type:D,compare:ie===void 0?null:ie}},Ce.startTransition=function(D){var ie=k.T,ge={};k.T=ge;try{var he=D(),ve=k.S;ve!==null&&ve(ge,he),typeof he=="object"&&he!==null&&typeof he.then=="function"&&he.then(Re,fe)}catch(Pe){fe(Pe)}finally{k.T=ie}},Ce.unstable_useCacheRefresh=function(){return k.H.useCacheRefresh()},Ce.use=function(D){return k.H.use(D)},Ce.useActionState=function(D,ie,ge){return k.H.useActionState(D,ie,ge)},Ce.useCallback=function(D,ie){return k.H.useCallback(D,ie)},Ce.useContext=function(D){return k.H.useContext(D)},Ce.useDebugValue=function(){},Ce.useDeferredValue=function(D,ie){return k.H.useDeferredValue(D,ie)},Ce.useEffect=function(D,ie,ge){var he=k.H;if(typeof ge=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return he.useEffect(D,ie)},Ce.useId=function(){return k.H.useId()},Ce.useImperativeHandle=function(D,ie,ge){return k.H.useImperativeHandle(D,ie,ge)},Ce.useInsertionEffect=function(D,ie){return k.H.useInsertionEffect(D,ie)},Ce.useLayoutEffect=function(D,ie){return k.H.useLayoutEffect(D,ie)},Ce.useMemo=function(D,ie){return k.H.useMemo(D,ie)},Ce.useOptimistic=function(D,ie){return k.H.useOptimistic(D,ie)},Ce.useReducer=function(D,ie,ge){return k.H.useReducer(D,ie,ge)},Ce.useRef=function(D){return k.H.useRef(D)},Ce.useState=function(D){return k.H.useState(D)},Ce.useSyncExternalStore=function(D,ie,ge){return k.H.useSyncExternalStore(D,ie,ge)},Ce.useTransition=function(){return k.H.useTransition()},Ce.version="19.1.0",Ce}var lv;function b_(){return lv||(lv=1,ap.exports=PE()),ap.exports}var K=b_();const ui=NE(K);var op={exports:{}},Uo={},lp={exports:{}},cp={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var cv;function UE(){return cv||(cv=1,function(n){function e($,ee){var fe=$.length;$.push(ee);e:for(;0<fe;){var Re=fe-1>>>1,D=$[Re];if(0<i(D,ee))$[Re]=ee,$[fe]=D,fe=Re;else break e}}function t($){return $.length===0?null:$[0]}function r($){if($.length===0)return null;var ee=$[0],fe=$.pop();if(fe!==ee){$[0]=fe;e:for(var Re=0,D=$.length,ie=D>>>1;Re<ie;){var ge=2*(Re+1)-1,he=$[ge],ve=ge+1,Pe=$[ve];if(0>i(he,fe))ve<D&&0>i(Pe,he)?($[Re]=Pe,$[ve]=fe,Re=ve):($[Re]=he,$[ge]=fe,Re=ge);else if(ve<D&&0>i(Pe,fe))$[Re]=Pe,$[ve]=fe,Re=ve;else break e}}return ee}function i($,ee){var fe=$.sortIndex-ee.sortIndex;return fe!==0?fe:$.id-ee.id}if(n.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var a=performance;n.unstable_now=function(){return a.now()}}else{var l=Date,c=l.now();n.unstable_now=function(){return l.now()-c}}var f=[],d=[],p=1,_=null,y=3,b=!1,T=!1,A=!1,C=!1,N=typeof setTimeout=="function"?setTimeout:null,O=typeof clearTimeout=="function"?clearTimeout:null,R=typeof setImmediate<"u"?setImmediate:null;function E($){for(var ee=t(d);ee!==null;){if(ee.callback===null)r(d);else if(ee.startTime<=$)r(d),ee.sortIndex=ee.expirationTime,e(f,ee);else break;ee=t(d)}}function k($){if(A=!1,E($),!T)if(t(f)!==null)T=!0,V||(V=!0,ce());else{var ee=t(d);ee!==null&&_e(k,ee.startTime-$)}}var V=!1,ne=-1,G=5,se=-1;function re(){return C?!0:!(n.unstable_now()-se<G)}function q(){if(C=!1,V){var $=n.unstable_now();se=$;var ee=!0;try{e:{T=!1,A&&(A=!1,O(ne),ne=-1),b=!0;var fe=y;try{t:{for(E($),_=t(f);_!==null&&!(_.expirationTime>$&&re());){var Re=_.callback;if(typeof Re=="function"){_.callback=null,y=_.priorityLevel;var D=Re(_.expirationTime<=$);if($=n.unstable_now(),typeof D=="function"){_.callback=D,E($),ee=!0;break t}_===t(f)&&r(f),E($)}else r(f);_=t(f)}if(_!==null)ee=!0;else{var ie=t(d);ie!==null&&_e(k,ie.startTime-$),ee=!1}}break e}finally{_=null,y=fe,b=!1}ee=void 0}}finally{ee?ce():V=!1}}}var ce;if(typeof R=="function")ce=function(){R(q)};else if(typeof MessageChannel<"u"){var me=new MessageChannel,de=me.port2;me.port1.onmessage=q,ce=function(){de.postMessage(null)}}else ce=function(){N(q,0)};function _e($,ee){ne=N(function(){$(n.unstable_now())},ee)}n.unstable_IdlePriority=5,n.unstable_ImmediatePriority=1,n.unstable_LowPriority=4,n.unstable_NormalPriority=3,n.unstable_Profiling=null,n.unstable_UserBlockingPriority=2,n.unstable_cancelCallback=function($){$.callback=null},n.unstable_forceFrameRate=function($){0>$||125<$?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):G=0<$?Math.floor(1e3/$):5},n.unstable_getCurrentPriorityLevel=function(){return y},n.unstable_next=function($){switch(y){case 1:case 2:case 3:var ee=3;break;default:ee=y}var fe=y;y=ee;try{return $()}finally{y=fe}},n.unstable_requestPaint=function(){C=!0},n.unstable_runWithPriority=function($,ee){switch($){case 1:case 2:case 3:case 4:case 5:break;default:$=3}var fe=y;y=$;try{return ee()}finally{y=fe}},n.unstable_scheduleCallback=function($,ee,fe){var Re=n.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?Re+fe:Re):fe=Re,$){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=fe+D,$={id:p++,callback:ee,priorityLevel:$,startTime:fe,expirationTime:D,sortIndex:-1},fe>Re?($.sortIndex=fe,e(d,$),t(f)===null&&$===t(d)&&(A?(O(ne),ne=-1):A=!0,_e(k,fe-Re))):($.sortIndex=D,e(f,$),T||b||(T=!0,V||(V=!0,ce()))),$},n.unstable_shouldYield=re,n.unstable_wrapCallback=function($){var ee=y;return function(){var fe=y;y=ee;try{return $.apply(this,arguments)}finally{y=fe}}}}(cp)),cp}var uv;function BE(){return uv||(uv=1,lp.exports=UE()),lp.exports}var up={exports:{}},Bt={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fv;function FE(){if(fv)return Bt;fv=1;var n=b_();function e(f){var d="https://react.dev/errors/"+f;if(1<arguments.length){d+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)d+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+f+"; visit "+d+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function t(){}var r={d:{f:t,r:function(){throw Error(e(522))},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},i=Symbol.for("react.portal");function a(f,d,p){var _=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:i,key:_==null?null:""+_,children:f,containerInfo:d,implementation:p}}var l=n.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function c(f,d){if(f==="font")return"";if(typeof d=="string")return d==="use-credentials"?d:""}return Bt.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Bt.createPortal=function(f,d){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!d||d.nodeType!==1&&d.nodeType!==9&&d.nodeType!==11)throw Error(e(299));return a(f,d,null,p)},Bt.flushSync=function(f){var d=l.T,p=r.p;try{if(l.T=null,r.p=2,f)return f()}finally{l.T=d,r.p=p,r.d.f()}},Bt.preconnect=function(f,d){typeof f=="string"&&(d?(d=d.crossOrigin,d=typeof d=="string"?d==="use-credentials"?d:"":void 0):d=null,r.d.C(f,d))},Bt.prefetchDNS=function(f){typeof f=="string"&&r.d.D(f)},Bt.preinit=function(f,d){if(typeof f=="string"&&d&&typeof d.as=="string"){var p=d.as,_=c(p,d.crossOrigin),y=typeof d.integrity=="string"?d.integrity:void 0,b=typeof d.fetchPriority=="string"?d.fetchPriority:void 0;p==="style"?r.d.S(f,typeof d.precedence=="string"?d.precedence:void 0,{crossOrigin:_,integrity:y,fetchPriority:b}):p==="script"&&r.d.X(f,{crossOrigin:_,integrity:y,fetchPriority:b,nonce:typeof d.nonce=="string"?d.nonce:void 0})}},Bt.preinitModule=function(f,d){if(typeof f=="string")if(typeof d=="object"&&d!==null){if(d.as==null||d.as==="script"){var p=c(d.as,d.crossOrigin);r.d.M(f,{crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0})}}else d==null&&r.d.M(f)},Bt.preload=function(f,d){if(typeof f=="string"&&typeof d=="object"&&d!==null&&typeof d.as=="string"){var p=d.as,_=c(p,d.crossOrigin);r.d.L(f,p,{crossOrigin:_,integrity:typeof d.integrity=="string"?d.integrity:void 0,nonce:typeof d.nonce=="string"?d.nonce:void 0,type:typeof d.type=="string"?d.type:void 0,fetchPriority:typeof d.fetchPriority=="string"?d.fetchPriority:void 0,referrerPolicy:typeof d.referrerPolicy=="string"?d.referrerPolicy:void 0,imageSrcSet:typeof d.imageSrcSet=="string"?d.imageSrcSet:void 0,imageSizes:typeof d.imageSizes=="string"?d.imageSizes:void 0,media:typeof d.media=="string"?d.media:void 0})}},Bt.preloadModule=function(f,d){if(typeof f=="string")if(d){var p=c(d.as,d.crossOrigin);r.d.m(f,{as:typeof d.as=="string"&&d.as!=="script"?d.as:void 0,crossOrigin:p,integrity:typeof d.integrity=="string"?d.integrity:void 0})}else r.d.m(f)},Bt.requestFormReset=function(f){r.d.r(f)},Bt.unstable_batchedUpdates=function(f,d){return f(d)},Bt.useFormState=function(f,d,p){return l.H.useFormState(f,d,p)},Bt.useFormStatus=function(){return l.H.useHostTransitionStatus()},Bt.version="19.1.0",Bt}var hv;function N2(){if(hv)return up.exports;hv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),up.exports=FE(),up.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var dv;function LE(){if(dv)return Uo;dv=1;var n=BE(),e=b_(),t=N2();function r(s){var o="https://react.dev/errors/"+s;if(1<arguments.length){o+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)o+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+s+"; visit "+o+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function i(s){return!(!s||s.nodeType!==1&&s.nodeType!==9&&s.nodeType!==11)}function a(s){var o=s,u=s;if(s.alternate)for(;o.return;)o=o.return;else{s=o;do o=s,(o.flags&4098)!==0&&(u=o.return),s=o.return;while(s)}return o.tag===3?u:null}function l(s){if(s.tag===13){var o=s.memoizedState;if(o===null&&(s=s.alternate,s!==null&&(o=s.memoizedState)),o!==null)return o.dehydrated}return null}function c(s){if(a(s)!==s)throw Error(r(188))}function f(s){var o=s.alternate;if(!o){if(o=a(s),o===null)throw Error(r(188));return o!==s?null:s}for(var u=s,h=o;;){var g=u.return;if(g===null)break;var m=g.alternate;if(m===null){if(h=g.return,h!==null){u=h;continue}break}if(g.child===m.child){for(m=g.child;m;){if(m===u)return c(g),s;if(m===h)return c(g),o;m=m.sibling}throw Error(r(188))}if(u.return!==h.return)u=g,h=m;else{for(var v=!1,x=g.child;x;){if(x===u){v=!0,u=g,h=m;break}if(x===h){v=!0,h=g,u=m;break}x=x.sibling}if(!v){for(x=m.child;x;){if(x===u){v=!0,u=m,h=g;break}if(x===h){v=!0,h=m,u=g;break}x=x.sibling}if(!v)throw Error(r(189))}}if(u.alternate!==h)throw Error(r(190))}if(u.tag!==3)throw Error(r(188));return u.stateNode.current===u?s:o}function d(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s;for(s=s.child;s!==null;){if(o=d(s),o!==null)return o;s=s.sibling}return null}var p=Object.assign,_=Symbol.for("react.element"),y=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),T=Symbol.for("react.fragment"),A=Symbol.for("react.strict_mode"),C=Symbol.for("react.profiler"),N=Symbol.for("react.provider"),O=Symbol.for("react.consumer"),R=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),k=Symbol.for("react.suspense"),V=Symbol.for("react.suspense_list"),ne=Symbol.for("react.memo"),G=Symbol.for("react.lazy"),se=Symbol.for("react.activity"),re=Symbol.for("react.memo_cache_sentinel"),q=Symbol.iterator;function ce(s){return s===null||typeof s!="object"?null:(s=q&&s[q]||s["@@iterator"],typeof s=="function"?s:null)}var me=Symbol.for("react.client.reference");function de(s){if(s==null)return null;if(typeof s=="function")return s.$$typeof===me?null:s.displayName||s.name||null;if(typeof s=="string")return s;switch(s){case T:return"Fragment";case C:return"Profiler";case A:return"StrictMode";case k:return"Suspense";case V:return"SuspenseList";case se:return"Activity"}if(typeof s=="object")switch(s.$$typeof){case b:return"Portal";case R:return(s.displayName||"Context")+".Provider";case O:return(s._context.displayName||"Context")+".Consumer";case E:var o=s.render;return s=s.displayName,s||(s=o.displayName||o.name||"",s=s!==""?"ForwardRef("+s+")":"ForwardRef"),s;case ne:return o=s.displayName||null,o!==null?o:de(s.type)||"Memo";case G:o=s._payload,s=s._init;try{return de(s(o))}catch{}}return null}var _e=Array.isArray,$=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee=t.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,fe={pending:!1,data:null,method:null,action:null},Re=[],D=-1;function ie(s){return{current:s}}function ge(s){0>D||(s.current=Re[D],Re[D]=null,D--)}function he(s,o){D++,Re[D]=s.current,s.current=o}var ve=ie(null),Pe=ie(null),Ae=ie(null),Ht=ie(null);function Je(s,o){switch(he(Ae,o),he(Pe,s),he(ve,null),o.nodeType){case 9:case 11:s=(s=o.documentElement)&&(s=s.namespaceURI)?kb(s):0;break;default:if(s=o.tagName,o=o.namespaceURI)o=kb(o),s=Db(o,s);else switch(s){case"svg":s=1;break;case"math":s=2;break;default:s=0}}ge(ve),he(ve,s)}function pe(){ge(ve),ge(Pe),ge(Ae)}function Me(s){s.memoizedState!==null&&he(Ht,s);var o=ve.current,u=Db(o,s.type);o!==u&&(he(Pe,s),he(ve,u))}function Ne(s){Pe.current===s&&(ge(ve),ge(Pe)),Ht.current===s&&(ge(Ht),Oo._currentValue=fe)}var oe=Object.prototype.hasOwnProperty,wt=n.unstable_scheduleCallback,He=n.unstable_cancelCallback,jt=n.unstable_shouldYield,$t=n.unstable_requestPaint,xt=n.unstable_now,Bl=n.unstable_getCurrentPriorityLevel,dm=n.unstable_ImmediatePriority,pm=n.unstable_UserBlockingPriority,Fl=n.unstable_NormalPriority,fS=n.unstable_LowPriority,gm=n.unstable_IdlePriority,hS=n.log,dS=n.unstable_setDisableYieldValue,Ba=null,tn=null;function Nr(s){if(typeof hS=="function"&&dS(s),tn&&typeof tn.setStrictMode=="function")try{tn.setStrictMode(Ba,s)}catch{}}var nn=Math.clz32?Math.clz32:_S,pS=Math.log,gS=Math.LN2;function _S(s){return s>>>=0,s===0?32:31-(pS(s)/gS|0)|0}var Ll=256,zl=4194304;function mi(s){var o=s&42;if(o!==0)return o;switch(s&-s){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return s&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return s&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return s}}function Vl(s,o,u){var h=s.pendingLanes;if(h===0)return 0;var g=0,m=s.suspendedLanes,v=s.pingedLanes;s=s.warmLanes;var x=h&134217727;return x!==0?(h=x&~m,h!==0?g=mi(h):(v&=x,v!==0?g=mi(v):u||(u=x&~s,u!==0&&(g=mi(u))))):(x=h&~m,x!==0?g=mi(x):v!==0?g=mi(v):u||(u=h&~s,u!==0&&(g=mi(u)))),g===0?0:o!==0&&o!==g&&(o&m)===0&&(m=g&-g,u=o&-o,m>=u||m===32&&(u&4194048)!==0)?o:g}function Fa(s,o){return(s.pendingLanes&~(s.suspendedLanes&~s.pingedLanes)&o)===0}function mS(s,o){switch(s){case 1:case 2:case 4:case 8:case 64:return o+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return o+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function _m(){var s=Ll;return Ll<<=1,(Ll&4194048)===0&&(Ll=256),s}function mm(){var s=zl;return zl<<=1,(zl&62914560)===0&&(zl=4194304),s}function qf(s){for(var o=[],u=0;31>u;u++)o.push(s);return o}function La(s,o){s.pendingLanes|=o,o!==268435456&&(s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0)}function yS(s,o,u,h,g,m){var v=s.pendingLanes;s.pendingLanes=u,s.suspendedLanes=0,s.pingedLanes=0,s.warmLanes=0,s.expiredLanes&=u,s.entangledLanes&=u,s.errorRecoveryDisabledLanes&=u,s.shellSuspendCounter=0;var x=s.entanglements,I=s.expirationTimes,W=s.hiddenUpdates;for(u=v&~u;0<u;){var Z=31-nn(u),te=1<<Z;x[Z]=0,I[Z]=-1;var X=W[Z];if(X!==null)for(W[Z]=null,Z=0;Z<X.length;Z++){var Y=X[Z];Y!==null&&(Y.lane&=-536870913)}u&=~te}h!==0&&ym(s,h,0),m!==0&&g===0&&s.tag!==0&&(s.suspendedLanes|=m&~(v&~o))}function ym(s,o,u){s.pendingLanes|=o,s.suspendedLanes&=~o;var h=31-nn(o);s.entangledLanes|=o,s.entanglements[h]=s.entanglements[h]|1073741824|u&4194090}function bm(s,o){var u=s.entangledLanes|=o;for(s=s.entanglements;u;){var h=31-nn(u),g=1<<h;g&o|s[h]&o&&(s[h]|=o),u&=~g}}function Kf(s){switch(s){case 2:s=1;break;case 8:s=4;break;case 32:s=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:s=128;break;case 268435456:s=134217728;break;default:s=0}return s}function Zf(s){return s&=-s,2<s?8<s?(s&134217727)!==0?32:268435456:8:2}function vm(){var s=ee.p;return s!==0?s:(s=window.event,s===void 0?32:Jb(s.type))}function bS(s,o){var u=ee.p;try{return ee.p=s,o()}finally{ee.p=u}}var kr=Math.random().toString(36).slice(2),Pt="__reactFiber$"+kr,qt="__reactProps$"+kr,us="__reactContainer$"+kr,Qf="__reactEvents$"+kr,vS="__reactListeners$"+kr,TS="__reactHandles$"+kr,Tm="__reactResources$"+kr,za="__reactMarker$"+kr;function Gf(s){delete s[Pt],delete s[qt],delete s[Qf],delete s[vS],delete s[TS]}function fs(s){var o=s[Pt];if(o)return o;for(var u=s.parentNode;u;){if(o=u[us]||u[Pt]){if(u=o.alternate,o.child!==null||u!==null&&u.child!==null)for(s=Fb(s);s!==null;){if(u=s[Pt])return u;s=Fb(s)}return o}s=u,u=s.parentNode}return null}function hs(s){if(s=s[Pt]||s[us]){var o=s.tag;if(o===5||o===6||o===13||o===26||o===27||o===3)return s}return null}function Va(s){var o=s.tag;if(o===5||o===26||o===27||o===6)return s.stateNode;throw Error(r(33))}function ds(s){var o=s[Tm];return o||(o=s[Tm]={hoistableStyles:new Map,hoistableScripts:new Map}),o}function St(s){s[za]=!0}var wm=new Set,xm={};function yi(s,o){ps(s,o),ps(s+"Capture",o)}function ps(s,o){for(xm[s]=o,s=0;s<o.length;s++)wm.add(o[s])}var wS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Sm={},Am={};function xS(s){return oe.call(Am,s)?!0:oe.call(Sm,s)?!1:wS.test(s)?Am[s]=!0:(Sm[s]=!0,!1)}function Hl(s,o,u){if(xS(o))if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":s.removeAttribute(o);return;case"boolean":var h=o.toLowerCase().slice(0,5);if(h!=="data-"&&h!=="aria-"){s.removeAttribute(o);return}}s.setAttribute(o,""+u)}}function jl(s,o,u){if(u===null)s.removeAttribute(o);else{switch(typeof u){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(o);return}s.setAttribute(o,""+u)}}function lr(s,o,u,h){if(h===null)s.removeAttribute(u);else{switch(typeof h){case"undefined":case"function":case"symbol":case"boolean":s.removeAttribute(u);return}s.setAttributeNS(o,u,""+h)}}var Jf,Em;function gs(s){if(Jf===void 0)try{throw Error()}catch(u){var o=u.stack.trim().match(/\n( *(at )?)/);Jf=o&&o[1]||"",Em=-1<u.stack.indexOf(`
    at`)?" (<anonymous>)":-1<u.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Jf+s+Em}var eh=!1;function th(s,o){if(!s||eh)return"";eh=!0;var u=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var h={DetermineComponentFrameRoot:function(){try{if(o){var te=function(){throw Error()};if(Object.defineProperty(te.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(te,[])}catch(Y){var X=Y}Reflect.construct(s,[],te)}else{try{te.call()}catch(Y){X=Y}s.call(te.prototype)}}else{try{throw Error()}catch(Y){X=Y}(te=s())&&typeof te.catch=="function"&&te.catch(function(){})}}catch(Y){if(Y&&X&&typeof Y.stack=="string")return[Y.stack,X.stack]}return[null,null]}};h.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var g=Object.getOwnPropertyDescriptor(h.DetermineComponentFrameRoot,"name");g&&g.configurable&&Object.defineProperty(h.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var m=h.DetermineComponentFrameRoot(),v=m[0],x=m[1];if(v&&x){var I=v.split(`
`),W=x.split(`
`);for(g=h=0;h<I.length&&!I[h].includes("DetermineComponentFrameRoot");)h++;for(;g<W.length&&!W[g].includes("DetermineComponentFrameRoot");)g++;if(h===I.length||g===W.length)for(h=I.length-1,g=W.length-1;1<=h&&0<=g&&I[h]!==W[g];)g--;for(;1<=h&&0<=g;h--,g--)if(I[h]!==W[g]){if(h!==1||g!==1)do if(h--,g--,0>g||I[h]!==W[g]){var Z=`
`+I[h].replace(" at new "," at ");return s.displayName&&Z.includes("<anonymous>")&&(Z=Z.replace("<anonymous>",s.displayName)),Z}while(1<=h&&0<=g);break}}}finally{eh=!1,Error.prepareStackTrace=u}return(u=s?s.displayName||s.name:"")?gs(u):""}function SS(s){switch(s.tag){case 26:case 27:case 5:return gs(s.type);case 16:return gs("Lazy");case 13:return gs("Suspense");case 19:return gs("SuspenseList");case 0:case 15:return th(s.type,!1);case 11:return th(s.type.render,!1);case 1:return th(s.type,!0);case 31:return gs("Activity");default:return""}}function Rm(s){try{var o="";do o+=SS(s),s=s.return;while(s);return o}catch(u){return`
Error generating stack: `+u.message+`
`+u.stack}}function gn(s){switch(typeof s){case"bigint":case"boolean":case"number":case"string":case"undefined":return s;case"object":return s;default:return""}}function Cm(s){var o=s.type;return(s=s.nodeName)&&s.toLowerCase()==="input"&&(o==="checkbox"||o==="radio")}function AS(s){var o=Cm(s)?"checked":"value",u=Object.getOwnPropertyDescriptor(s.constructor.prototype,o),h=""+s[o];if(!s.hasOwnProperty(o)&&typeof u<"u"&&typeof u.get=="function"&&typeof u.set=="function"){var g=u.get,m=u.set;return Object.defineProperty(s,o,{configurable:!0,get:function(){return g.call(this)},set:function(v){h=""+v,m.call(this,v)}}),Object.defineProperty(s,o,{enumerable:u.enumerable}),{getValue:function(){return h},setValue:function(v){h=""+v},stopTracking:function(){s._valueTracker=null,delete s[o]}}}}function $l(s){s._valueTracker||(s._valueTracker=AS(s))}function Mm(s){if(!s)return!1;var o=s._valueTracker;if(!o)return!0;var u=o.getValue(),h="";return s&&(h=Cm(s)?s.checked?"true":"false":s.value),s=h,s!==u?(o.setValue(s),!0):!1}function Wl(s){if(s=s||(typeof document<"u"?document:void 0),typeof s>"u")return null;try{return s.activeElement||s.body}catch{return s.body}}var ES=/[\n"\\]/g;function _n(s){return s.replace(ES,function(o){return"\\"+o.charCodeAt(0).toString(16)+" "})}function nh(s,o,u,h,g,m,v,x){s.name="",v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"?s.type=v:s.removeAttribute("type"),o!=null?v==="number"?(o===0&&s.value===""||s.value!=o)&&(s.value=""+gn(o)):s.value!==""+gn(o)&&(s.value=""+gn(o)):v!=="submit"&&v!=="reset"||s.removeAttribute("value"),o!=null?rh(s,v,gn(o)):u!=null?rh(s,v,gn(u)):h!=null&&s.removeAttribute("value"),g==null&&m!=null&&(s.defaultChecked=!!m),g!=null&&(s.checked=g&&typeof g!="function"&&typeof g!="symbol"),x!=null&&typeof x!="function"&&typeof x!="symbol"&&typeof x!="boolean"?s.name=""+gn(x):s.removeAttribute("name")}function Om(s,o,u,h,g,m,v,x){if(m!=null&&typeof m!="function"&&typeof m!="symbol"&&typeof m!="boolean"&&(s.type=m),o!=null||u!=null){if(!(m!=="submit"&&m!=="reset"||o!=null))return;u=u!=null?""+gn(u):"",o=o!=null?""+gn(o):u,x||o===s.value||(s.value=o),s.defaultValue=o}h=h??g,h=typeof h!="function"&&typeof h!="symbol"&&!!h,s.checked=x?s.checked:!!h,s.defaultChecked=!!h,v!=null&&typeof v!="function"&&typeof v!="symbol"&&typeof v!="boolean"&&(s.name=v)}function rh(s,o,u){o==="number"&&Wl(s.ownerDocument)===s||s.defaultValue===""+u||(s.defaultValue=""+u)}function _s(s,o,u,h){if(s=s.options,o){o={};for(var g=0;g<u.length;g++)o["$"+u[g]]=!0;for(u=0;u<s.length;u++)g=o.hasOwnProperty("$"+s[u].value),s[u].selected!==g&&(s[u].selected=g),g&&h&&(s[u].defaultSelected=!0)}else{for(u=""+gn(u),o=null,g=0;g<s.length;g++){if(s[g].value===u){s[g].selected=!0,h&&(s[g].defaultSelected=!0);return}o!==null||s[g].disabled||(o=s[g])}o!==null&&(o.selected=!0)}}function Im(s,o,u){if(o!=null&&(o=""+gn(o),o!==s.value&&(s.value=o),u==null)){s.defaultValue!==o&&(s.defaultValue=o);return}s.defaultValue=u!=null?""+gn(u):""}function Nm(s,o,u,h){if(o==null){if(h!=null){if(u!=null)throw Error(r(92));if(_e(h)){if(1<h.length)throw Error(r(93));h=h[0]}u=h}u==null&&(u=""),o=u}u=gn(o),s.defaultValue=u,h=s.textContent,h===u&&h!==""&&h!==null&&(s.value=h)}function ms(s,o){if(o){var u=s.firstChild;if(u&&u===s.lastChild&&u.nodeType===3){u.nodeValue=o;return}}s.textContent=o}var RS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function km(s,o,u){var h=o.indexOf("--")===0;u==null||typeof u=="boolean"||u===""?h?s.setProperty(o,""):o==="float"?s.cssFloat="":s[o]="":h?s.setProperty(o,u):typeof u!="number"||u===0||RS.has(o)?o==="float"?s.cssFloat=u:s[o]=(""+u).trim():s[o]=u+"px"}function Dm(s,o,u){if(o!=null&&typeof o!="object")throw Error(r(62));if(s=s.style,u!=null){for(var h in u)!u.hasOwnProperty(h)||o!=null&&o.hasOwnProperty(h)||(h.indexOf("--")===0?s.setProperty(h,""):h==="float"?s.cssFloat="":s[h]="");for(var g in o)h=o[g],o.hasOwnProperty(g)&&u[g]!==h&&km(s,g,h)}else for(var m in o)o.hasOwnProperty(m)&&km(s,m,o[m])}function ih(s){if(s.indexOf("-")===-1)return!1;switch(s){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var CS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xl(s){return MS.test(""+s)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":s}var sh=null;function ah(s){return s=s.target||s.srcElement||window,s.correspondingUseElement&&(s=s.correspondingUseElement),s.nodeType===3?s.parentNode:s}var ys=null,bs=null;function Pm(s){var o=hs(s);if(o&&(s=o.stateNode)){var u=s[qt]||null;e:switch(s=o.stateNode,o.type){case"input":if(nh(s,u.value,u.defaultValue,u.defaultValue,u.checked,u.defaultChecked,u.type,u.name),o=u.name,u.type==="radio"&&o!=null){for(u=s;u.parentNode;)u=u.parentNode;for(u=u.querySelectorAll('input[name="'+_n(""+o)+'"][type="radio"]'),o=0;o<u.length;o++){var h=u[o];if(h!==s&&h.form===s.form){var g=h[qt]||null;if(!g)throw Error(r(90));nh(h,g.value,g.defaultValue,g.defaultValue,g.checked,g.defaultChecked,g.type,g.name)}}for(o=0;o<u.length;o++)h=u[o],h.form===s.form&&Mm(h)}break e;case"textarea":Im(s,u.value,u.defaultValue);break e;case"select":o=u.value,o!=null&&_s(s,!!u.multiple,o,!1)}}}var oh=!1;function Um(s,o,u){if(oh)return s(o,u);oh=!0;try{var h=s(o);return h}finally{if(oh=!1,(ys!==null||bs!==null)&&(Ic(),ys&&(o=ys,s=bs,bs=ys=null,Pm(o),s)))for(o=0;o<s.length;o++)Pm(s[o])}}function Ha(s,o){var u=s.stateNode;if(u===null)return null;var h=u[qt]||null;if(h===null)return null;u=h[o];e:switch(o){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(h=!h.disabled)||(s=s.type,h=!(s==="button"||s==="input"||s==="select"||s==="textarea")),s=!h;break e;default:s=!1}if(s)return null;if(u&&typeof u!="function")throw Error(r(231,o,typeof u));return u}var cr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),lh=!1;if(cr)try{var ja={};Object.defineProperty(ja,"passive",{get:function(){lh=!0}}),window.addEventListener("test",ja,ja),window.removeEventListener("test",ja,ja)}catch{lh=!1}var Dr=null,ch=null,Yl=null;function Bm(){if(Yl)return Yl;var s,o=ch,u=o.length,h,g="value"in Dr?Dr.value:Dr.textContent,m=g.length;for(s=0;s<u&&o[s]===g[s];s++);var v=u-s;for(h=1;h<=v&&o[u-h]===g[m-h];h++);return Yl=g.slice(s,1<h?1-h:void 0)}function ql(s){var o=s.keyCode;return"charCode"in s?(s=s.charCode,s===0&&o===13&&(s=13)):s=o,s===10&&(s=13),32<=s||s===13?s:0}function Kl(){return!0}function Fm(){return!1}function Kt(s){function o(u,h,g,m,v){this._reactName=u,this._targetInst=g,this.type=h,this.nativeEvent=m,this.target=v,this.currentTarget=null;for(var x in s)s.hasOwnProperty(x)&&(u=s[x],this[x]=u?u(m):m[x]);return this.isDefaultPrevented=(m.defaultPrevented!=null?m.defaultPrevented:m.returnValue===!1)?Kl:Fm,this.isPropagationStopped=Fm,this}return p(o.prototype,{preventDefault:function(){this.defaultPrevented=!0;var u=this.nativeEvent;u&&(u.preventDefault?u.preventDefault():typeof u.returnValue!="unknown"&&(u.returnValue=!1),this.isDefaultPrevented=Kl)},stopPropagation:function(){var u=this.nativeEvent;u&&(u.stopPropagation?u.stopPropagation():typeof u.cancelBubble!="unknown"&&(u.cancelBubble=!0),this.isPropagationStopped=Kl)},persist:function(){},isPersistent:Kl}),o}var bi={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(s){return s.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Zl=Kt(bi),$a=p({},bi,{view:0,detail:0}),OS=Kt($a),uh,fh,Wa,Ql=p({},$a,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:dh,button:0,buttons:0,relatedTarget:function(s){return s.relatedTarget===void 0?s.fromElement===s.srcElement?s.toElement:s.fromElement:s.relatedTarget},movementX:function(s){return"movementX"in s?s.movementX:(s!==Wa&&(Wa&&s.type==="mousemove"?(uh=s.screenX-Wa.screenX,fh=s.screenY-Wa.screenY):fh=uh=0,Wa=s),uh)},movementY:function(s){return"movementY"in s?s.movementY:fh}}),Lm=Kt(Ql),IS=p({},Ql,{dataTransfer:0}),NS=Kt(IS),kS=p({},$a,{relatedTarget:0}),hh=Kt(kS),DS=p({},bi,{animationName:0,elapsedTime:0,pseudoElement:0}),PS=Kt(DS),US=p({},bi,{clipboardData:function(s){return"clipboardData"in s?s.clipboardData:window.clipboardData}}),BS=Kt(US),FS=p({},bi,{data:0}),zm=Kt(FS),LS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},zS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},VS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function HS(s){var o=this.nativeEvent;return o.getModifierState?o.getModifierState(s):(s=VS[s])?!!o[s]:!1}function dh(){return HS}var jS=p({},$a,{key:function(s){if(s.key){var o=LS[s.key]||s.key;if(o!=="Unidentified")return o}return s.type==="keypress"?(s=ql(s),s===13?"Enter":String.fromCharCode(s)):s.type==="keydown"||s.type==="keyup"?zS[s.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:dh,charCode:function(s){return s.type==="keypress"?ql(s):0},keyCode:function(s){return s.type==="keydown"||s.type==="keyup"?s.keyCode:0},which:function(s){return s.type==="keypress"?ql(s):s.type==="keydown"||s.type==="keyup"?s.keyCode:0}}),$S=Kt(jS),WS=p({},Ql,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vm=Kt(WS),XS=p({},$a,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:dh}),YS=Kt(XS),qS=p({},bi,{propertyName:0,elapsedTime:0,pseudoElement:0}),KS=Kt(qS),ZS=p({},Ql,{deltaX:function(s){return"deltaX"in s?s.deltaX:"wheelDeltaX"in s?-s.wheelDeltaX:0},deltaY:function(s){return"deltaY"in s?s.deltaY:"wheelDeltaY"in s?-s.wheelDeltaY:"wheelDelta"in s?-s.wheelDelta:0},deltaZ:0,deltaMode:0}),QS=Kt(ZS),GS=p({},bi,{newState:0,oldState:0}),JS=Kt(GS),eA=[9,13,27,32],ph=cr&&"CompositionEvent"in window,Xa=null;cr&&"documentMode"in document&&(Xa=document.documentMode);var tA=cr&&"TextEvent"in window&&!Xa,Hm=cr&&(!ph||Xa&&8<Xa&&11>=Xa),jm=" ",$m=!1;function Wm(s,o){switch(s){case"keyup":return eA.indexOf(o.keyCode)!==-1;case"keydown":return o.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Xm(s){return s=s.detail,typeof s=="object"&&"data"in s?s.data:null}var vs=!1;function nA(s,o){switch(s){case"compositionend":return Xm(o);case"keypress":return o.which!==32?null:($m=!0,jm);case"textInput":return s=o.data,s===jm&&$m?null:s;default:return null}}function rA(s,o){if(vs)return s==="compositionend"||!ph&&Wm(s,o)?(s=Bm(),Yl=ch=Dr=null,vs=!1,s):null;switch(s){case"paste":return null;case"keypress":if(!(o.ctrlKey||o.altKey||o.metaKey)||o.ctrlKey&&o.altKey){if(o.char&&1<o.char.length)return o.char;if(o.which)return String.fromCharCode(o.which)}return null;case"compositionend":return Hm&&o.locale!=="ko"?null:o.data;default:return null}}var iA={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ym(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o==="input"?!!iA[s.type]:o==="textarea"}function qm(s,o,u,h){ys?bs?bs.push(h):bs=[h]:ys=h,o=Bc(o,"onChange"),0<o.length&&(u=new Zl("onChange","change",null,u,h),s.push({event:u,listeners:o}))}var Ya=null,qa=null;function sA(s){Cb(s,0)}function Gl(s){var o=Va(s);if(Mm(o))return s}function Km(s,o){if(s==="change")return o}var Zm=!1;if(cr){var gh;if(cr){var _h="oninput"in document;if(!_h){var Qm=document.createElement("div");Qm.setAttribute("oninput","return;"),_h=typeof Qm.oninput=="function"}gh=_h}else gh=!1;Zm=gh&&(!document.documentMode||9<document.documentMode)}function Gm(){Ya&&(Ya.detachEvent("onpropertychange",Jm),qa=Ya=null)}function Jm(s){if(s.propertyName==="value"&&Gl(qa)){var o=[];qm(o,qa,s,ah(s)),Um(sA,o)}}function aA(s,o,u){s==="focusin"?(Gm(),Ya=o,qa=u,Ya.attachEvent("onpropertychange",Jm)):s==="focusout"&&Gm()}function oA(s){if(s==="selectionchange"||s==="keyup"||s==="keydown")return Gl(qa)}function lA(s,o){if(s==="click")return Gl(o)}function cA(s,o){if(s==="input"||s==="change")return Gl(o)}function uA(s,o){return s===o&&(s!==0||1/s===1/o)||s!==s&&o!==o}var rn=typeof Object.is=="function"?Object.is:uA;function Ka(s,o){if(rn(s,o))return!0;if(typeof s!="object"||s===null||typeof o!="object"||o===null)return!1;var u=Object.keys(s),h=Object.keys(o);if(u.length!==h.length)return!1;for(h=0;h<u.length;h++){var g=u[h];if(!oe.call(o,g)||!rn(s[g],o[g]))return!1}return!0}function ey(s){for(;s&&s.firstChild;)s=s.firstChild;return s}function ty(s,o){var u=ey(s);s=0;for(var h;u;){if(u.nodeType===3){if(h=s+u.textContent.length,s<=o&&h>=o)return{node:u,offset:o-s};s=h}e:{for(;u;){if(u.nextSibling){u=u.nextSibling;break e}u=u.parentNode}u=void 0}u=ey(u)}}function ny(s,o){return s&&o?s===o?!0:s&&s.nodeType===3?!1:o&&o.nodeType===3?ny(s,o.parentNode):"contains"in s?s.contains(o):s.compareDocumentPosition?!!(s.compareDocumentPosition(o)&16):!1:!1}function ry(s){s=s!=null&&s.ownerDocument!=null&&s.ownerDocument.defaultView!=null?s.ownerDocument.defaultView:window;for(var o=Wl(s.document);o instanceof s.HTMLIFrameElement;){try{var u=typeof o.contentWindow.location.href=="string"}catch{u=!1}if(u)s=o.contentWindow;else break;o=Wl(s.document)}return o}function mh(s){var o=s&&s.nodeName&&s.nodeName.toLowerCase();return o&&(o==="input"&&(s.type==="text"||s.type==="search"||s.type==="tel"||s.type==="url"||s.type==="password")||o==="textarea"||s.contentEditable==="true")}var fA=cr&&"documentMode"in document&&11>=document.documentMode,Ts=null,yh=null,Za=null,bh=!1;function iy(s,o,u){var h=u.window===u?u.document:u.nodeType===9?u:u.ownerDocument;bh||Ts==null||Ts!==Wl(h)||(h=Ts,"selectionStart"in h&&mh(h)?h={start:h.selectionStart,end:h.selectionEnd}:(h=(h.ownerDocument&&h.ownerDocument.defaultView||window).getSelection(),h={anchorNode:h.anchorNode,anchorOffset:h.anchorOffset,focusNode:h.focusNode,focusOffset:h.focusOffset}),Za&&Ka(Za,h)||(Za=h,h=Bc(yh,"onSelect"),0<h.length&&(o=new Zl("onSelect","select",null,o,u),s.push({event:o,listeners:h}),o.target=Ts)))}function vi(s,o){var u={};return u[s.toLowerCase()]=o.toLowerCase(),u["Webkit"+s]="webkit"+o,u["Moz"+s]="moz"+o,u}var ws={animationend:vi("Animation","AnimationEnd"),animationiteration:vi("Animation","AnimationIteration"),animationstart:vi("Animation","AnimationStart"),transitionrun:vi("Transition","TransitionRun"),transitionstart:vi("Transition","TransitionStart"),transitioncancel:vi("Transition","TransitionCancel"),transitionend:vi("Transition","TransitionEnd")},vh={},sy={};cr&&(sy=document.createElement("div").style,"AnimationEvent"in window||(delete ws.animationend.animation,delete ws.animationiteration.animation,delete ws.animationstart.animation),"TransitionEvent"in window||delete ws.transitionend.transition);function Ti(s){if(vh[s])return vh[s];if(!ws[s])return s;var o=ws[s],u;for(u in o)if(o.hasOwnProperty(u)&&u in sy)return vh[s]=o[u];return s}var ay=Ti("animationend"),oy=Ti("animationiteration"),ly=Ti("animationstart"),hA=Ti("transitionrun"),dA=Ti("transitionstart"),pA=Ti("transitioncancel"),cy=Ti("transitionend"),uy=new Map,Th="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");Th.push("scrollEnd");function In(s,o){uy.set(s,o),yi(o,[s])}var fy=new WeakMap;function mn(s,o){if(typeof s=="object"&&s!==null){var u=fy.get(s);return u!==void 0?u:(o={value:s,source:o,stack:Rm(o)},fy.set(s,o),o)}return{value:s,source:o,stack:Rm(o)}}var yn=[],xs=0,wh=0;function Jl(){for(var s=xs,o=wh=xs=0;o<s;){var u=yn[o];yn[o++]=null;var h=yn[o];yn[o++]=null;var g=yn[o];yn[o++]=null;var m=yn[o];if(yn[o++]=null,h!==null&&g!==null){var v=h.pending;v===null?g.next=g:(g.next=v.next,v.next=g),h.pending=g}m!==0&&hy(u,g,m)}}function ec(s,o,u,h){yn[xs++]=s,yn[xs++]=o,yn[xs++]=u,yn[xs++]=h,wh|=h,s.lanes|=h,s=s.alternate,s!==null&&(s.lanes|=h)}function xh(s,o,u,h){return ec(s,o,u,h),tc(s)}function Ss(s,o){return ec(s,null,null,o),tc(s)}function hy(s,o,u){s.lanes|=u;var h=s.alternate;h!==null&&(h.lanes|=u);for(var g=!1,m=s.return;m!==null;)m.childLanes|=u,h=m.alternate,h!==null&&(h.childLanes|=u),m.tag===22&&(s=m.stateNode,s===null||s._visibility&1||(g=!0)),s=m,m=m.return;return s.tag===3?(m=s.stateNode,g&&o!==null&&(g=31-nn(u),s=m.hiddenUpdates,h=s[g],h===null?s[g]=[o]:h.push(o),o.lane=u|536870912),m):null}function tc(s){if(50<wo)throw wo=0,Md=null,Error(r(185));for(var o=s.return;o!==null;)s=o,o=s.return;return s.tag===3?s.stateNode:null}var As={};function gA(s,o,u,h){this.tag=s,this.key=u,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=o,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=h,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function sn(s,o,u,h){return new gA(s,o,u,h)}function Sh(s){return s=s.prototype,!(!s||!s.isReactComponent)}function ur(s,o){var u=s.alternate;return u===null?(u=sn(s.tag,o,s.key,s.mode),u.elementType=s.elementType,u.type=s.type,u.stateNode=s.stateNode,u.alternate=s,s.alternate=u):(u.pendingProps=o,u.type=s.type,u.flags=0,u.subtreeFlags=0,u.deletions=null),u.flags=s.flags&65011712,u.childLanes=s.childLanes,u.lanes=s.lanes,u.child=s.child,u.memoizedProps=s.memoizedProps,u.memoizedState=s.memoizedState,u.updateQueue=s.updateQueue,o=s.dependencies,u.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext},u.sibling=s.sibling,u.index=s.index,u.ref=s.ref,u.refCleanup=s.refCleanup,u}function dy(s,o){s.flags&=65011714;var u=s.alternate;return u===null?(s.childLanes=0,s.lanes=o,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=u.childLanes,s.lanes=u.lanes,s.child=u.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=u.memoizedProps,s.memoizedState=u.memoizedState,s.updateQueue=u.updateQueue,s.type=u.type,o=u.dependencies,s.dependencies=o===null?null:{lanes:o.lanes,firstContext:o.firstContext}),s}function nc(s,o,u,h,g,m){var v=0;if(h=s,typeof s=="function")Sh(s)&&(v=1);else if(typeof s=="string")v=mE(s,u,ve.current)?26:s==="html"||s==="head"||s==="body"?27:5;else e:switch(s){case se:return s=sn(31,u,o,g),s.elementType=se,s.lanes=m,s;case T:return wi(u.children,g,m,o);case A:v=8,g|=24;break;case C:return s=sn(12,u,o,g|2),s.elementType=C,s.lanes=m,s;case k:return s=sn(13,u,o,g),s.elementType=k,s.lanes=m,s;case V:return s=sn(19,u,o,g),s.elementType=V,s.lanes=m,s;default:if(typeof s=="object"&&s!==null)switch(s.$$typeof){case N:case R:v=10;break e;case O:v=9;break e;case E:v=11;break e;case ne:v=14;break e;case G:v=16,h=null;break e}v=29,u=Error(r(130,s===null?"null":typeof s,"")),h=null}return o=sn(v,u,o,g),o.elementType=s,o.type=h,o.lanes=m,o}function wi(s,o,u,h){return s=sn(7,s,h,o),s.lanes=u,s}function Ah(s,o,u){return s=sn(6,s,null,o),s.lanes=u,s}function Eh(s,o,u){return o=sn(4,s.children!==null?s.children:[],s.key,o),o.lanes=u,o.stateNode={containerInfo:s.containerInfo,pendingChildren:null,implementation:s.implementation},o}var Es=[],Rs=0,rc=null,ic=0,bn=[],vn=0,xi=null,fr=1,hr="";function Si(s,o){Es[Rs++]=ic,Es[Rs++]=rc,rc=s,ic=o}function py(s,o,u){bn[vn++]=fr,bn[vn++]=hr,bn[vn++]=xi,xi=s;var h=fr;s=hr;var g=32-nn(h)-1;h&=~(1<<g),u+=1;var m=32-nn(o)+g;if(30<m){var v=g-g%5;m=(h&(1<<v)-1).toString(32),h>>=v,g-=v,fr=1<<32-nn(o)+g|u<<g|h,hr=m+s}else fr=1<<m|u<<g|h,hr=s}function Rh(s){s.return!==null&&(Si(s,1),py(s,1,0))}function Ch(s){for(;s===rc;)rc=Es[--Rs],Es[Rs]=null,ic=Es[--Rs],Es[Rs]=null;for(;s===xi;)xi=bn[--vn],bn[vn]=null,hr=bn[--vn],bn[vn]=null,fr=bn[--vn],bn[vn]=null}var Wt=null,at=null,Le=!1,Ai=null,jn=!1,Mh=Error(r(519));function Ei(s){var o=Error(r(418,""));throw Ja(mn(o,s)),Mh}function gy(s){var o=s.stateNode,u=s.type,h=s.memoizedProps;switch(o[Pt]=s,o[qt]=h,u){case"dialog":De("cancel",o),De("close",o);break;case"iframe":case"object":case"embed":De("load",o);break;case"video":case"audio":for(u=0;u<So.length;u++)De(So[u],o);break;case"source":De("error",o);break;case"img":case"image":case"link":De("error",o),De("load",o);break;case"details":De("toggle",o);break;case"input":De("invalid",o),Om(o,h.value,h.defaultValue,h.checked,h.defaultChecked,h.type,h.name,!0),$l(o);break;case"select":De("invalid",o);break;case"textarea":De("invalid",o),Nm(o,h.value,h.defaultValue,h.children),$l(o)}u=h.children,typeof u!="string"&&typeof u!="number"&&typeof u!="bigint"||o.textContent===""+u||h.suppressHydrationWarning===!0||Nb(o.textContent,u)?(h.popover!=null&&(De("beforetoggle",o),De("toggle",o)),h.onScroll!=null&&De("scroll",o),h.onScrollEnd!=null&&De("scrollend",o),h.onClick!=null&&(o.onclick=Fc),o=!0):o=!1,o||Ei(s)}function _y(s){for(Wt=s.return;Wt;)switch(Wt.tag){case 5:case 13:jn=!1;return;case 27:case 3:jn=!0;return;default:Wt=Wt.return}}function Qa(s){if(s!==Wt)return!1;if(!Le)return _y(s),Le=!0,!1;var o=s.tag,u;if((u=o!==3&&o!==27)&&((u=o===5)&&(u=s.type,u=!(u!=="form"&&u!=="button")||Wd(s.type,s.memoizedProps)),u=!u),u&&at&&Ei(s),_y(s),o===13){if(s=s.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(r(317));e:{for(s=s.nextSibling,o=0;s;){if(s.nodeType===8)if(u=s.data,u==="/$"){if(o===0){at=kn(s.nextSibling);break e}o--}else u!=="$"&&u!=="$!"&&u!=="$?"||o++;s=s.nextSibling}at=null}}else o===27?(o=at,Zr(s.type)?(s=Kd,Kd=null,at=s):at=o):at=Wt?kn(s.stateNode.nextSibling):null;return!0}function Ga(){at=Wt=null,Le=!1}function my(){var s=Ai;return s!==null&&(Gt===null?Gt=s:Gt.push.apply(Gt,s),Ai=null),s}function Ja(s){Ai===null?Ai=[s]:Ai.push(s)}var Oh=ie(null),Ri=null,dr=null;function Pr(s,o,u){he(Oh,o._currentValue),o._currentValue=u}function pr(s){s._currentValue=Oh.current,ge(Oh)}function Ih(s,o,u){for(;s!==null;){var h=s.alternate;if((s.childLanes&o)!==o?(s.childLanes|=o,h!==null&&(h.childLanes|=o)):h!==null&&(h.childLanes&o)!==o&&(h.childLanes|=o),s===u)break;s=s.return}}function Nh(s,o,u,h){var g=s.child;for(g!==null&&(g.return=s);g!==null;){var m=g.dependencies;if(m!==null){var v=g.child;m=m.firstContext;e:for(;m!==null;){var x=m;m=g;for(var I=0;I<o.length;I++)if(x.context===o[I]){m.lanes|=u,x=m.alternate,x!==null&&(x.lanes|=u),Ih(m.return,u,s),h||(v=null);break e}m=x.next}}else if(g.tag===18){if(v=g.return,v===null)throw Error(r(341));v.lanes|=u,m=v.alternate,m!==null&&(m.lanes|=u),Ih(v,u,s),v=null}else v=g.child;if(v!==null)v.return=g;else for(v=g;v!==null;){if(v===s){v=null;break}if(g=v.sibling,g!==null){g.return=v.return,v=g;break}v=v.return}g=v}}function eo(s,o,u,h){s=null;for(var g=o,m=!1;g!==null;){if(!m){if((g.flags&524288)!==0)m=!0;else if((g.flags&262144)!==0)break}if(g.tag===10){var v=g.alternate;if(v===null)throw Error(r(387));if(v=v.memoizedProps,v!==null){var x=g.type;rn(g.pendingProps.value,v.value)||(s!==null?s.push(x):s=[x])}}else if(g===Ht.current){if(v=g.alternate,v===null)throw Error(r(387));v.memoizedState.memoizedState!==g.memoizedState.memoizedState&&(s!==null?s.push(Oo):s=[Oo])}g=g.return}s!==null&&Nh(o,s,u,h),o.flags|=262144}function sc(s){for(s=s.firstContext;s!==null;){if(!rn(s.context._currentValue,s.memoizedValue))return!0;s=s.next}return!1}function Ci(s){Ri=s,dr=null,s=s.dependencies,s!==null&&(s.firstContext=null)}function Ut(s){return yy(Ri,s)}function ac(s,o){return Ri===null&&Ci(s),yy(s,o)}function yy(s,o){var u=o._currentValue;if(o={context:o,memoizedValue:u,next:null},dr===null){if(s===null)throw Error(r(308));dr=o,s.dependencies={lanes:0,firstContext:o},s.flags|=524288}else dr=dr.next=o;return u}var _A=typeof AbortController<"u"?AbortController:function(){var s=[],o=this.signal={aborted:!1,addEventListener:function(u,h){s.push(h)}};this.abort=function(){o.aborted=!0,s.forEach(function(u){return u()})}},mA=n.unstable_scheduleCallback,yA=n.unstable_NormalPriority,yt={$$typeof:R,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function kh(){return{controller:new _A,data:new Map,refCount:0}}function to(s){s.refCount--,s.refCount===0&&mA(yA,function(){s.controller.abort()})}var no=null,Dh=0,Cs=0,Ms=null;function bA(s,o){if(no===null){var u=no=[];Dh=0,Cs=Ud(),Ms={status:"pending",value:void 0,then:function(h){u.push(h)}}}return Dh++,o.then(by,by),o}function by(){if(--Dh===0&&no!==null){Ms!==null&&(Ms.status="fulfilled");var s=no;no=null,Cs=0,Ms=null;for(var o=0;o<s.length;o++)(0,s[o])()}}function vA(s,o){var u=[],h={status:"pending",value:null,reason:null,then:function(g){u.push(g)}};return s.then(function(){h.status="fulfilled",h.value=o;for(var g=0;g<u.length;g++)(0,u[g])(o)},function(g){for(h.status="rejected",h.reason=g,g=0;g<u.length;g++)(0,u[g])(void 0)}),h}var vy=$.S;$.S=function(s,o){typeof o=="object"&&o!==null&&typeof o.then=="function"&&bA(s,o),vy!==null&&vy(s,o)};var Mi=ie(null);function Ph(){var s=Mi.current;return s!==null?s:et.pooledCache}function oc(s,o){o===null?he(Mi,Mi.current):he(Mi,o.pool)}function Ty(){var s=Ph();return s===null?null:{parent:yt._currentValue,pool:s}}var ro=Error(r(460)),wy=Error(r(474)),lc=Error(r(542)),Uh={then:function(){}};function xy(s){return s=s.status,s==="fulfilled"||s==="rejected"}function cc(){}function Sy(s,o,u){switch(u=s[u],u===void 0?s.push(o):u!==o&&(o.then(cc,cc),o=u),o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Ey(s),s;default:if(typeof o.status=="string")o.then(cc,cc);else{if(s=et,s!==null&&100<s.shellSuspendCounter)throw Error(r(482));s=o,s.status="pending",s.then(function(h){if(o.status==="pending"){var g=o;g.status="fulfilled",g.value=h}},function(h){if(o.status==="pending"){var g=o;g.status="rejected",g.reason=h}})}switch(o.status){case"fulfilled":return o.value;case"rejected":throw s=o.reason,Ey(s),s}throw io=o,ro}}var io=null;function Ay(){if(io===null)throw Error(r(459));var s=io;return io=null,s}function Ey(s){if(s===ro||s===lc)throw Error(r(483))}var Ur=!1;function Bh(s){s.updateQueue={baseState:s.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function Fh(s,o){s=s.updateQueue,o.updateQueue===s&&(o.updateQueue={baseState:s.baseState,firstBaseUpdate:s.firstBaseUpdate,lastBaseUpdate:s.lastBaseUpdate,shared:s.shared,callbacks:null})}function Br(s){return{lane:s,tag:0,payload:null,callback:null,next:null}}function Fr(s,o,u){var h=s.updateQueue;if(h===null)return null;if(h=h.shared,($e&2)!==0){var g=h.pending;return g===null?o.next=o:(o.next=g.next,g.next=o),h.pending=o,o=tc(s),hy(s,null,u),o}return ec(s,h,o,u),tc(s)}function so(s,o,u){if(o=o.updateQueue,o!==null&&(o=o.shared,(u&4194048)!==0)){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,bm(s,u)}}function Lh(s,o){var u=s.updateQueue,h=s.alternate;if(h!==null&&(h=h.updateQueue,u===h)){var g=null,m=null;if(u=u.firstBaseUpdate,u!==null){do{var v={lane:u.lane,tag:u.tag,payload:u.payload,callback:null,next:null};m===null?g=m=v:m=m.next=v,u=u.next}while(u!==null);m===null?g=m=o:m=m.next=o}else g=m=o;u={baseState:h.baseState,firstBaseUpdate:g,lastBaseUpdate:m,shared:h.shared,callbacks:h.callbacks},s.updateQueue=u;return}s=u.lastBaseUpdate,s===null?u.firstBaseUpdate=o:s.next=o,u.lastBaseUpdate=o}var zh=!1;function ao(){if(zh){var s=Ms;if(s!==null)throw s}}function oo(s,o,u,h){zh=!1;var g=s.updateQueue;Ur=!1;var m=g.firstBaseUpdate,v=g.lastBaseUpdate,x=g.shared.pending;if(x!==null){g.shared.pending=null;var I=x,W=I.next;I.next=null,v===null?m=W:v.next=W,v=I;var Z=s.alternate;Z!==null&&(Z=Z.updateQueue,x=Z.lastBaseUpdate,x!==v&&(x===null?Z.firstBaseUpdate=W:x.next=W,Z.lastBaseUpdate=I))}if(m!==null){var te=g.baseState;v=0,Z=W=I=null,x=m;do{var X=x.lane&-536870913,Y=X!==x.lane;if(Y?(Ue&X)===X:(h&X)===X){X!==0&&X===Cs&&(zh=!0),Z!==null&&(Z=Z.next={lane:0,tag:x.tag,payload:x.payload,callback:null,next:null});e:{var Se=s,Te=x;X=o;var qe=u;switch(Te.tag){case 1:if(Se=Te.payload,typeof Se=="function"){te=Se.call(qe,te,X);break e}te=Se;break e;case 3:Se.flags=Se.flags&-65537|128;case 0:if(Se=Te.payload,X=typeof Se=="function"?Se.call(qe,te,X):Se,X==null)break e;te=p({},te,X);break e;case 2:Ur=!0}}X=x.callback,X!==null&&(s.flags|=64,Y&&(s.flags|=8192),Y=g.callbacks,Y===null?g.callbacks=[X]:Y.push(X))}else Y={lane:X,tag:x.tag,payload:x.payload,callback:x.callback,next:null},Z===null?(W=Z=Y,I=te):Z=Z.next=Y,v|=X;if(x=x.next,x===null){if(x=g.shared.pending,x===null)break;Y=x,x=Y.next,Y.next=null,g.lastBaseUpdate=Y,g.shared.pending=null}}while(!0);Z===null&&(I=te),g.baseState=I,g.firstBaseUpdate=W,g.lastBaseUpdate=Z,m===null&&(g.shared.lanes=0),Xr|=v,s.lanes=v,s.memoizedState=te}}function Ry(s,o){if(typeof s!="function")throw Error(r(191,s));s.call(o)}function Cy(s,o){var u=s.callbacks;if(u!==null)for(s.callbacks=null,s=0;s<u.length;s++)Ry(u[s],o)}var Os=ie(null),uc=ie(0);function My(s,o){s=Tr,he(uc,s),he(Os,o),Tr=s|o.baseLanes}function Vh(){he(uc,Tr),he(Os,Os.current)}function Hh(){Tr=uc.current,ge(Os),ge(uc)}var Lr=0,Oe=null,Xe=null,dt=null,fc=!1,Is=!1,Oi=!1,hc=0,lo=0,Ns=null,TA=0;function ft(){throw Error(r(321))}function jh(s,o){if(o===null)return!1;for(var u=0;u<o.length&&u<s.length;u++)if(!rn(s[u],o[u]))return!1;return!0}function $h(s,o,u,h,g,m){return Lr=m,Oe=o,o.memoizedState=null,o.updateQueue=null,o.lanes=0,$.H=s===null||s.memoizedState===null?h0:d0,Oi=!1,m=u(h,g),Oi=!1,Is&&(m=Iy(o,u,h,g)),Oy(s),m}function Oy(s){$.H=yc;var o=Xe!==null&&Xe.next!==null;if(Lr=0,dt=Xe=Oe=null,fc=!1,lo=0,Ns=null,o)throw Error(r(300));s===null||At||(s=s.dependencies,s!==null&&sc(s)&&(At=!0))}function Iy(s,o,u,h){Oe=s;var g=0;do{if(Is&&(Ns=null),lo=0,Is=!1,25<=g)throw Error(r(301));if(g+=1,dt=Xe=null,s.updateQueue!=null){var m=s.updateQueue;m.lastEffect=null,m.events=null,m.stores=null,m.memoCache!=null&&(m.memoCache.index=0)}$.H=CA,m=o(u,h)}while(Is);return m}function wA(){var s=$.H,o=s.useState()[0];return o=typeof o.then=="function"?co(o):o,s=s.useState()[0],(Xe!==null?Xe.memoizedState:null)!==s&&(Oe.flags|=1024),o}function Wh(){var s=hc!==0;return hc=0,s}function Xh(s,o,u){o.updateQueue=s.updateQueue,o.flags&=-2053,s.lanes&=~u}function Yh(s){if(fc){for(s=s.memoizedState;s!==null;){var o=s.queue;o!==null&&(o.pending=null),s=s.next}fc=!1}Lr=0,dt=Xe=Oe=null,Is=!1,lo=hc=0,Ns=null}function Zt(){var s={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return dt===null?Oe.memoizedState=dt=s:dt=dt.next=s,dt}function pt(){if(Xe===null){var s=Oe.alternate;s=s!==null?s.memoizedState:null}else s=Xe.next;var o=dt===null?Oe.memoizedState:dt.next;if(o!==null)dt=o,Xe=s;else{if(s===null)throw Oe.alternate===null?Error(r(467)):Error(r(310));Xe=s,s={memoizedState:Xe.memoizedState,baseState:Xe.baseState,baseQueue:Xe.baseQueue,queue:Xe.queue,next:null},dt===null?Oe.memoizedState=dt=s:dt=dt.next=s}return dt}function qh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function co(s){var o=lo;return lo+=1,Ns===null&&(Ns=[]),s=Sy(Ns,s,o),o=Oe,(dt===null?o.memoizedState:dt.next)===null&&(o=o.alternate,$.H=o===null||o.memoizedState===null?h0:d0),s}function dc(s){if(s!==null&&typeof s=="object"){if(typeof s.then=="function")return co(s);if(s.$$typeof===R)return Ut(s)}throw Error(r(438,String(s)))}function Kh(s){var o=null,u=Oe.updateQueue;if(u!==null&&(o=u.memoCache),o==null){var h=Oe.alternate;h!==null&&(h=h.updateQueue,h!==null&&(h=h.memoCache,h!=null&&(o={data:h.data.map(function(g){return g.slice()}),index:0})))}if(o==null&&(o={data:[],index:0}),u===null&&(u=qh(),Oe.updateQueue=u),u.memoCache=o,u=o.data[o.index],u===void 0)for(u=o.data[o.index]=Array(s),h=0;h<s;h++)u[h]=re;return o.index++,u}function gr(s,o){return typeof o=="function"?o(s):o}function pc(s){var o=pt();return Zh(o,Xe,s)}function Zh(s,o,u){var h=s.queue;if(h===null)throw Error(r(311));h.lastRenderedReducer=u;var g=s.baseQueue,m=h.pending;if(m!==null){if(g!==null){var v=g.next;g.next=m.next,m.next=v}o.baseQueue=g=m,h.pending=null}if(m=s.baseState,g===null)s.memoizedState=m;else{o=g.next;var x=v=null,I=null,W=o,Z=!1;do{var te=W.lane&-536870913;if(te!==W.lane?(Ue&te)===te:(Lr&te)===te){var X=W.revertLane;if(X===0)I!==null&&(I=I.next={lane:0,revertLane:0,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null}),te===Cs&&(Z=!0);else if((Lr&X)===X){W=W.next,X===Cs&&(Z=!0);continue}else te={lane:0,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},I===null?(x=I=te,v=m):I=I.next=te,Oe.lanes|=X,Xr|=X;te=W.action,Oi&&u(m,te),m=W.hasEagerState?W.eagerState:u(m,te)}else X={lane:te,revertLane:W.revertLane,action:W.action,hasEagerState:W.hasEagerState,eagerState:W.eagerState,next:null},I===null?(x=I=X,v=m):I=I.next=X,Oe.lanes|=te,Xr|=te;W=W.next}while(W!==null&&W!==o);if(I===null?v=m:I.next=x,!rn(m,s.memoizedState)&&(At=!0,Z&&(u=Ms,u!==null)))throw u;s.memoizedState=m,s.baseState=v,s.baseQueue=I,h.lastRenderedState=m}return g===null&&(h.lanes=0),[s.memoizedState,h.dispatch]}function Qh(s){var o=pt(),u=o.queue;if(u===null)throw Error(r(311));u.lastRenderedReducer=s;var h=u.dispatch,g=u.pending,m=o.memoizedState;if(g!==null){u.pending=null;var v=g=g.next;do m=s(m,v.action),v=v.next;while(v!==g);rn(m,o.memoizedState)||(At=!0),o.memoizedState=m,o.baseQueue===null&&(o.baseState=m),u.lastRenderedState=m}return[m,h]}function Ny(s,o,u){var h=Oe,g=pt(),m=Le;if(m){if(u===void 0)throw Error(r(407));u=u()}else u=o();var v=!rn((Xe||g).memoizedState,u);v&&(g.memoizedState=u,At=!0),g=g.queue;var x=Py.bind(null,h,g,s);if(uo(2048,8,x,[s]),g.getSnapshot!==o||v||dt!==null&&dt.memoizedState.tag&1){if(h.flags|=2048,ks(9,gc(),Dy.bind(null,h,g,u,o),null),et===null)throw Error(r(349));m||(Lr&124)!==0||ky(h,o,u)}return u}function ky(s,o,u){s.flags|=16384,s={getSnapshot:o,value:u},o=Oe.updateQueue,o===null?(o=qh(),Oe.updateQueue=o,o.stores=[s]):(u=o.stores,u===null?o.stores=[s]:u.push(s))}function Dy(s,o,u,h){o.value=u,o.getSnapshot=h,Uy(o)&&By(s)}function Py(s,o,u){return u(function(){Uy(o)&&By(s)})}function Uy(s){var o=s.getSnapshot;s=s.value;try{var u=o();return!rn(s,u)}catch{return!0}}function By(s){var o=Ss(s,2);o!==null&&un(o,s,2)}function Gh(s){var o=Zt();if(typeof s=="function"){var u=s;if(s=u(),Oi){Nr(!0);try{u()}finally{Nr(!1)}}}return o.memoizedState=o.baseState=s,o.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:s},o}function Fy(s,o,u,h){return s.baseState=u,Zh(s,Xe,typeof h=="function"?h:gr)}function xA(s,o,u,h,g){if(mc(s))throw Error(r(485));if(s=o.action,s!==null){var m={payload:g,action:s,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(v){m.listeners.push(v)}};$.T!==null?u(!0):m.isTransition=!1,h(m),u=o.pending,u===null?(m.next=o.pending=m,Ly(o,m)):(m.next=u.next,o.pending=u.next=m)}}function Ly(s,o){var u=o.action,h=o.payload,g=s.state;if(o.isTransition){var m=$.T,v={};$.T=v;try{var x=u(g,h),I=$.S;I!==null&&I(v,x),zy(s,o,x)}catch(W){Jh(s,o,W)}finally{$.T=m}}else try{m=u(g,h),zy(s,o,m)}catch(W){Jh(s,o,W)}}function zy(s,o,u){u!==null&&typeof u=="object"&&typeof u.then=="function"?u.then(function(h){Vy(s,o,h)},function(h){return Jh(s,o,h)}):Vy(s,o,u)}function Vy(s,o,u){o.status="fulfilled",o.value=u,Hy(o),s.state=u,o=s.pending,o!==null&&(u=o.next,u===o?s.pending=null:(u=u.next,o.next=u,Ly(s,u)))}function Jh(s,o,u){var h=s.pending;if(s.pending=null,h!==null){h=h.next;do o.status="rejected",o.reason=u,Hy(o),o=o.next;while(o!==h)}s.action=null}function Hy(s){s=s.listeners;for(var o=0;o<s.length;o++)(0,s[o])()}function jy(s,o){return o}function $y(s,o){if(Le){var u=et.formState;if(u!==null){e:{var h=Oe;if(Le){if(at){t:{for(var g=at,m=jn;g.nodeType!==8;){if(!m){g=null;break t}if(g=kn(g.nextSibling),g===null){g=null;break t}}m=g.data,g=m==="F!"||m==="F"?g:null}if(g){at=kn(g.nextSibling),h=g.data==="F!";break e}}Ei(h)}h=!1}h&&(o=u[0])}}return u=Zt(),u.memoizedState=u.baseState=o,h={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jy,lastRenderedState:o},u.queue=h,u=c0.bind(null,Oe,h),h.dispatch=u,h=Gh(!1),m=id.bind(null,Oe,!1,h.queue),h=Zt(),g={state:o,dispatch:null,action:s,pending:null},h.queue=g,u=xA.bind(null,Oe,g,m,u),g.dispatch=u,h.memoizedState=s,[o,u,!1]}function Wy(s){var o=pt();return Xy(o,Xe,s)}function Xy(s,o,u){if(o=Zh(s,o,jy)[0],s=pc(gr)[0],typeof o=="object"&&o!==null&&typeof o.then=="function")try{var h=co(o)}catch(v){throw v===ro?lc:v}else h=o;o=pt();var g=o.queue,m=g.dispatch;return u!==o.memoizedState&&(Oe.flags|=2048,ks(9,gc(),SA.bind(null,g,u),null)),[h,m,s]}function SA(s,o){s.action=o}function Yy(s){var o=pt(),u=Xe;if(u!==null)return Xy(o,u,s);pt(),o=o.memoizedState,u=pt();var h=u.queue.dispatch;return u.memoizedState=s,[o,h,!1]}function ks(s,o,u,h){return s={tag:s,create:u,deps:h,inst:o,next:null},o=Oe.updateQueue,o===null&&(o=qh(),Oe.updateQueue=o),u=o.lastEffect,u===null?o.lastEffect=s.next=s:(h=u.next,u.next=s,s.next=h,o.lastEffect=s),s}function gc(){return{destroy:void 0,resource:void 0}}function qy(){return pt().memoizedState}function _c(s,o,u,h){var g=Zt();h=h===void 0?null:h,Oe.flags|=s,g.memoizedState=ks(1|o,gc(),u,h)}function uo(s,o,u,h){var g=pt();h=h===void 0?null:h;var m=g.memoizedState.inst;Xe!==null&&h!==null&&jh(h,Xe.memoizedState.deps)?g.memoizedState=ks(o,m,u,h):(Oe.flags|=s,g.memoizedState=ks(1|o,m,u,h))}function Ky(s,o){_c(8390656,8,s,o)}function Zy(s,o){uo(2048,8,s,o)}function Qy(s,o){return uo(4,2,s,o)}function Gy(s,o){return uo(4,4,s,o)}function Jy(s,o){if(typeof o=="function"){s=s();var u=o(s);return function(){typeof u=="function"?u():o(null)}}if(o!=null)return s=s(),o.current=s,function(){o.current=null}}function e0(s,o,u){u=u!=null?u.concat([s]):null,uo(4,4,Jy.bind(null,o,s),u)}function ed(){}function t0(s,o){var u=pt();o=o===void 0?null:o;var h=u.memoizedState;return o!==null&&jh(o,h[1])?h[0]:(u.memoizedState=[s,o],s)}function n0(s,o){var u=pt();o=o===void 0?null:o;var h=u.memoizedState;if(o!==null&&jh(o,h[1]))return h[0];if(h=s(),Oi){Nr(!0);try{s()}finally{Nr(!1)}}return u.memoizedState=[h,o],h}function td(s,o,u){return u===void 0||(Lr&1073741824)!==0?s.memoizedState=o:(s.memoizedState=u,s=sb(),Oe.lanes|=s,Xr|=s,u)}function r0(s,o,u,h){return rn(u,o)?u:Os.current!==null?(s=td(s,u,h),rn(s,o)||(At=!0),s):(Lr&42)===0?(At=!0,s.memoizedState=u):(s=sb(),Oe.lanes|=s,Xr|=s,o)}function i0(s,o,u,h,g){var m=ee.p;ee.p=m!==0&&8>m?m:8;var v=$.T,x={};$.T=x,id(s,!1,o,u);try{var I=g(),W=$.S;if(W!==null&&W(x,I),I!==null&&typeof I=="object"&&typeof I.then=="function"){var Z=vA(I,h);fo(s,o,Z,cn(s))}else fo(s,o,h,cn(s))}catch(te){fo(s,o,{then:function(){},status:"rejected",reason:te},cn())}finally{ee.p=m,$.T=v}}function AA(){}function nd(s,o,u,h){if(s.tag!==5)throw Error(r(476));var g=s0(s).queue;i0(s,g,o,fe,u===null?AA:function(){return a0(s),u(h)})}function s0(s){var o=s.memoizedState;if(o!==null)return o;o={memoizedState:fe,baseState:fe,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:fe},next:null};var u={};return o.next={memoizedState:u,baseState:u,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:gr,lastRenderedState:u},next:null},s.memoizedState=o,s=s.alternate,s!==null&&(s.memoizedState=o),o}function a0(s){var o=s0(s).next.queue;fo(s,o,{},cn())}function rd(){return Ut(Oo)}function o0(){return pt().memoizedState}function l0(){return pt().memoizedState}function EA(s){for(var o=s.return;o!==null;){switch(o.tag){case 24:case 3:var u=cn();s=Br(u);var h=Fr(o,s,u);h!==null&&(un(h,o,u),so(h,o,u)),o={cache:kh()},s.payload=o;return}o=o.return}}function RA(s,o,u){var h=cn();u={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null},mc(s)?u0(o,u):(u=xh(s,o,u,h),u!==null&&(un(u,s,h),f0(u,o,h)))}function c0(s,o,u){var h=cn();fo(s,o,u,h)}function fo(s,o,u,h){var g={lane:h,revertLane:0,action:u,hasEagerState:!1,eagerState:null,next:null};if(mc(s))u0(o,g);else{var m=s.alternate;if(s.lanes===0&&(m===null||m.lanes===0)&&(m=o.lastRenderedReducer,m!==null))try{var v=o.lastRenderedState,x=m(v,u);if(g.hasEagerState=!0,g.eagerState=x,rn(x,v))return ec(s,o,g,0),et===null&&Jl(),!1}catch{}finally{}if(u=xh(s,o,g,h),u!==null)return un(u,s,h),f0(u,o,h),!0}return!1}function id(s,o,u,h){if(h={lane:2,revertLane:Ud(),action:h,hasEagerState:!1,eagerState:null,next:null},mc(s)){if(o)throw Error(r(479))}else o=xh(s,u,h,2),o!==null&&un(o,s,2)}function mc(s){var o=s.alternate;return s===Oe||o!==null&&o===Oe}function u0(s,o){Is=fc=!0;var u=s.pending;u===null?o.next=o:(o.next=u.next,u.next=o),s.pending=o}function f0(s,o,u){if((u&4194048)!==0){var h=o.lanes;h&=s.pendingLanes,u|=h,o.lanes=u,bm(s,u)}}var yc={readContext:Ut,use:dc,useCallback:ft,useContext:ft,useEffect:ft,useImperativeHandle:ft,useLayoutEffect:ft,useInsertionEffect:ft,useMemo:ft,useReducer:ft,useRef:ft,useState:ft,useDebugValue:ft,useDeferredValue:ft,useTransition:ft,useSyncExternalStore:ft,useId:ft,useHostTransitionStatus:ft,useFormState:ft,useActionState:ft,useOptimistic:ft,useMemoCache:ft,useCacheRefresh:ft},h0={readContext:Ut,use:dc,useCallback:function(s,o){return Zt().memoizedState=[s,o===void 0?null:o],s},useContext:Ut,useEffect:Ky,useImperativeHandle:function(s,o,u){u=u!=null?u.concat([s]):null,_c(4194308,4,Jy.bind(null,o,s),u)},useLayoutEffect:function(s,o){return _c(4194308,4,s,o)},useInsertionEffect:function(s,o){_c(4,2,s,o)},useMemo:function(s,o){var u=Zt();o=o===void 0?null:o;var h=s();if(Oi){Nr(!0);try{s()}finally{Nr(!1)}}return u.memoizedState=[h,o],h},useReducer:function(s,o,u){var h=Zt();if(u!==void 0){var g=u(o);if(Oi){Nr(!0);try{u(o)}finally{Nr(!1)}}}else g=o;return h.memoizedState=h.baseState=g,s={pending:null,lanes:0,dispatch:null,lastRenderedReducer:s,lastRenderedState:g},h.queue=s,s=s.dispatch=RA.bind(null,Oe,s),[h.memoizedState,s]},useRef:function(s){var o=Zt();return s={current:s},o.memoizedState=s},useState:function(s){s=Gh(s);var o=s.queue,u=c0.bind(null,Oe,o);return o.dispatch=u,[s.memoizedState,u]},useDebugValue:ed,useDeferredValue:function(s,o){var u=Zt();return td(u,s,o)},useTransition:function(){var s=Gh(!1);return s=i0.bind(null,Oe,s.queue,!0,!1),Zt().memoizedState=s,[!1,s]},useSyncExternalStore:function(s,o,u){var h=Oe,g=Zt();if(Le){if(u===void 0)throw Error(r(407));u=u()}else{if(u=o(),et===null)throw Error(r(349));(Ue&124)!==0||ky(h,o,u)}g.memoizedState=u;var m={value:u,getSnapshot:o};return g.queue=m,Ky(Py.bind(null,h,m,s),[s]),h.flags|=2048,ks(9,gc(),Dy.bind(null,h,m,u,o),null),u},useId:function(){var s=Zt(),o=et.identifierPrefix;if(Le){var u=hr,h=fr;u=(h&~(1<<32-nn(h)-1)).toString(32)+u,o=""+o+"R"+u,u=hc++,0<u&&(o+="H"+u.toString(32)),o+=""}else u=TA++,o=""+o+"r"+u.toString(32)+"";return s.memoizedState=o},useHostTransitionStatus:rd,useFormState:$y,useActionState:$y,useOptimistic:function(s){var o=Zt();o.memoizedState=o.baseState=s;var u={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return o.queue=u,o=id.bind(null,Oe,!0,u),u.dispatch=o,[s,o]},useMemoCache:Kh,useCacheRefresh:function(){return Zt().memoizedState=EA.bind(null,Oe)}},d0={readContext:Ut,use:dc,useCallback:t0,useContext:Ut,useEffect:Zy,useImperativeHandle:e0,useInsertionEffect:Qy,useLayoutEffect:Gy,useMemo:n0,useReducer:pc,useRef:qy,useState:function(){return pc(gr)},useDebugValue:ed,useDeferredValue:function(s,o){var u=pt();return r0(u,Xe.memoizedState,s,o)},useTransition:function(){var s=pc(gr)[0],o=pt().memoizedState;return[typeof s=="boolean"?s:co(s),o]},useSyncExternalStore:Ny,useId:o0,useHostTransitionStatus:rd,useFormState:Wy,useActionState:Wy,useOptimistic:function(s,o){var u=pt();return Fy(u,Xe,s,o)},useMemoCache:Kh,useCacheRefresh:l0},CA={readContext:Ut,use:dc,useCallback:t0,useContext:Ut,useEffect:Zy,useImperativeHandle:e0,useInsertionEffect:Qy,useLayoutEffect:Gy,useMemo:n0,useReducer:Qh,useRef:qy,useState:function(){return Qh(gr)},useDebugValue:ed,useDeferredValue:function(s,o){var u=pt();return Xe===null?td(u,s,o):r0(u,Xe.memoizedState,s,o)},useTransition:function(){var s=Qh(gr)[0],o=pt().memoizedState;return[typeof s=="boolean"?s:co(s),o]},useSyncExternalStore:Ny,useId:o0,useHostTransitionStatus:rd,useFormState:Yy,useActionState:Yy,useOptimistic:function(s,o){var u=pt();return Xe!==null?Fy(u,Xe,s,o):(u.baseState=s,[s,u.queue.dispatch])},useMemoCache:Kh,useCacheRefresh:l0},Ds=null,ho=0;function bc(s){var o=ho;return ho+=1,Ds===null&&(Ds=[]),Sy(Ds,s,o)}function po(s,o){o=o.props.ref,s.ref=o!==void 0?o:null}function vc(s,o){throw o.$$typeof===_?Error(r(525)):(s=Object.prototype.toString.call(o),Error(r(31,s==="[object Object]"?"object with keys {"+Object.keys(o).join(", ")+"}":s)))}function p0(s){var o=s._init;return o(s._payload)}function g0(s){function o(L,P){if(s){var j=L.deletions;j===null?(L.deletions=[P],L.flags|=16):j.push(P)}}function u(L,P){if(!s)return null;for(;P!==null;)o(L,P),P=P.sibling;return null}function h(L){for(var P=new Map;L!==null;)L.key!==null?P.set(L.key,L):P.set(L.index,L),L=L.sibling;return P}function g(L,P){return L=ur(L,P),L.index=0,L.sibling=null,L}function m(L,P,j){return L.index=j,s?(j=L.alternate,j!==null?(j=j.index,j<P?(L.flags|=67108866,P):j):(L.flags|=67108866,P)):(L.flags|=1048576,P)}function v(L){return s&&L.alternate===null&&(L.flags|=67108866),L}function x(L,P,j,Q){return P===null||P.tag!==6?(P=Ah(j,L.mode,Q),P.return=L,P):(P=g(P,j),P.return=L,P)}function I(L,P,j,Q){var ye=j.type;return ye===T?Z(L,P,j.props.children,Q,j.key):P!==null&&(P.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===G&&p0(ye)===P.type)?(P=g(P,j.props),po(P,j),P.return=L,P):(P=nc(j.type,j.key,j.props,null,L.mode,Q),po(P,j),P.return=L,P)}function W(L,P,j,Q){return P===null||P.tag!==4||P.stateNode.containerInfo!==j.containerInfo||P.stateNode.implementation!==j.implementation?(P=Eh(j,L.mode,Q),P.return=L,P):(P=g(P,j.children||[]),P.return=L,P)}function Z(L,P,j,Q,ye){return P===null||P.tag!==7?(P=wi(j,L.mode,Q,ye),P.return=L,P):(P=g(P,j),P.return=L,P)}function te(L,P,j){if(typeof P=="string"&&P!==""||typeof P=="number"||typeof P=="bigint")return P=Ah(""+P,L.mode,j),P.return=L,P;if(typeof P=="object"&&P!==null){switch(P.$$typeof){case y:return j=nc(P.type,P.key,P.props,null,L.mode,j),po(j,P),j.return=L,j;case b:return P=Eh(P,L.mode,j),P.return=L,P;case G:var Q=P._init;return P=Q(P._payload),te(L,P,j)}if(_e(P)||ce(P))return P=wi(P,L.mode,j,null),P.return=L,P;if(typeof P.then=="function")return te(L,bc(P),j);if(P.$$typeof===R)return te(L,ac(L,P),j);vc(L,P)}return null}function X(L,P,j,Q){var ye=P!==null?P.key:null;if(typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint")return ye!==null?null:x(L,P,""+j,Q);if(typeof j=="object"&&j!==null){switch(j.$$typeof){case y:return j.key===ye?I(L,P,j,Q):null;case b:return j.key===ye?W(L,P,j,Q):null;case G:return ye=j._init,j=ye(j._payload),X(L,P,j,Q)}if(_e(j)||ce(j))return ye!==null?null:Z(L,P,j,Q,null);if(typeof j.then=="function")return X(L,P,bc(j),Q);if(j.$$typeof===R)return X(L,P,ac(L,j),Q);vc(L,j)}return null}function Y(L,P,j,Q,ye){if(typeof Q=="string"&&Q!==""||typeof Q=="number"||typeof Q=="bigint")return L=L.get(j)||null,x(P,L,""+Q,ye);if(typeof Q=="object"&&Q!==null){switch(Q.$$typeof){case y:return L=L.get(Q.key===null?j:Q.key)||null,I(P,L,Q,ye);case b:return L=L.get(Q.key===null?j:Q.key)||null,W(P,L,Q,ye);case G:var Ie=Q._init;return Q=Ie(Q._payload),Y(L,P,j,Q,ye)}if(_e(Q)||ce(Q))return L=L.get(j)||null,Z(P,L,Q,ye,null);if(typeof Q.then=="function")return Y(L,P,j,bc(Q),ye);if(Q.$$typeof===R)return Y(L,P,j,ac(P,Q),ye);vc(P,Q)}return null}function Se(L,P,j,Q){for(var ye=null,Ie=null,be=P,we=P=0,Rt=null;be!==null&&we<j.length;we++){be.index>we?(Rt=be,be=null):Rt=be.sibling;var Be=X(L,be,j[we],Q);if(Be===null){be===null&&(be=Rt);break}s&&be&&Be.alternate===null&&o(L,be),P=m(Be,P,we),Ie===null?ye=Be:Ie.sibling=Be,Ie=Be,be=Rt}if(we===j.length)return u(L,be),Le&&Si(L,we),ye;if(be===null){for(;we<j.length;we++)be=te(L,j[we],Q),be!==null&&(P=m(be,P,we),Ie===null?ye=be:Ie.sibling=be,Ie=be);return Le&&Si(L,we),ye}for(be=h(be);we<j.length;we++)Rt=Y(be,L,we,j[we],Q),Rt!==null&&(s&&Rt.alternate!==null&&be.delete(Rt.key===null?we:Rt.key),P=m(Rt,P,we),Ie===null?ye=Rt:Ie.sibling=Rt,Ie=Rt);return s&&be.forEach(function(ti){return o(L,ti)}),Le&&Si(L,we),ye}function Te(L,P,j,Q){if(j==null)throw Error(r(151));for(var ye=null,Ie=null,be=P,we=P=0,Rt=null,Be=j.next();be!==null&&!Be.done;we++,Be=j.next()){be.index>we?(Rt=be,be=null):Rt=be.sibling;var ti=X(L,be,Be.value,Q);if(ti===null){be===null&&(be=Rt);break}s&&be&&ti.alternate===null&&o(L,be),P=m(ti,P,we),Ie===null?ye=ti:Ie.sibling=ti,Ie=ti,be=Rt}if(Be.done)return u(L,be),Le&&Si(L,we),ye;if(be===null){for(;!Be.done;we++,Be=j.next())Be=te(L,Be.value,Q),Be!==null&&(P=m(Be,P,we),Ie===null?ye=Be:Ie.sibling=Be,Ie=Be);return Le&&Si(L,we),ye}for(be=h(be);!Be.done;we++,Be=j.next())Be=Y(be,L,we,Be.value,Q),Be!==null&&(s&&Be.alternate!==null&&be.delete(Be.key===null?we:Be.key),P=m(Be,P,we),Ie===null?ye=Be:Ie.sibling=Be,Ie=Be);return s&&be.forEach(function(ME){return o(L,ME)}),Le&&Si(L,we),ye}function qe(L,P,j,Q){if(typeof j=="object"&&j!==null&&j.type===T&&j.key===null&&(j=j.props.children),typeof j=="object"&&j!==null){switch(j.$$typeof){case y:e:{for(var ye=j.key;P!==null;){if(P.key===ye){if(ye=j.type,ye===T){if(P.tag===7){u(L,P.sibling),Q=g(P,j.props.children),Q.return=L,L=Q;break e}}else if(P.elementType===ye||typeof ye=="object"&&ye!==null&&ye.$$typeof===G&&p0(ye)===P.type){u(L,P.sibling),Q=g(P,j.props),po(Q,j),Q.return=L,L=Q;break e}u(L,P);break}else o(L,P);P=P.sibling}j.type===T?(Q=wi(j.props.children,L.mode,Q,j.key),Q.return=L,L=Q):(Q=nc(j.type,j.key,j.props,null,L.mode,Q),po(Q,j),Q.return=L,L=Q)}return v(L);case b:e:{for(ye=j.key;P!==null;){if(P.key===ye)if(P.tag===4&&P.stateNode.containerInfo===j.containerInfo&&P.stateNode.implementation===j.implementation){u(L,P.sibling),Q=g(P,j.children||[]),Q.return=L,L=Q;break e}else{u(L,P);break}else o(L,P);P=P.sibling}Q=Eh(j,L.mode,Q),Q.return=L,L=Q}return v(L);case G:return ye=j._init,j=ye(j._payload),qe(L,P,j,Q)}if(_e(j))return Se(L,P,j,Q);if(ce(j)){if(ye=ce(j),typeof ye!="function")throw Error(r(150));return j=ye.call(j),Te(L,P,j,Q)}if(typeof j.then=="function")return qe(L,P,bc(j),Q);if(j.$$typeof===R)return qe(L,P,ac(L,j),Q);vc(L,j)}return typeof j=="string"&&j!==""||typeof j=="number"||typeof j=="bigint"?(j=""+j,P!==null&&P.tag===6?(u(L,P.sibling),Q=g(P,j),Q.return=L,L=Q):(u(L,P),Q=Ah(j,L.mode,Q),Q.return=L,L=Q),v(L)):u(L,P)}return function(L,P,j,Q){try{ho=0;var ye=qe(L,P,j,Q);return Ds=null,ye}catch(be){if(be===ro||be===lc)throw be;var Ie=sn(29,be,null,L.mode);return Ie.lanes=Q,Ie.return=L,Ie}finally{}}}var Ps=g0(!0),_0=g0(!1),Tn=ie(null),$n=null;function zr(s){var o=s.alternate;he(bt,bt.current&1),he(Tn,s),$n===null&&(o===null||Os.current!==null||o.memoizedState!==null)&&($n=s)}function m0(s){if(s.tag===22){if(he(bt,bt.current),he(Tn,s),$n===null){var o=s.alternate;o!==null&&o.memoizedState!==null&&($n=s)}}else Vr()}function Vr(){he(bt,bt.current),he(Tn,Tn.current)}function _r(s){ge(Tn),$n===s&&($n=null),ge(bt)}var bt=ie(0);function Tc(s){for(var o=s;o!==null;){if(o.tag===13){var u=o.memoizedState;if(u!==null&&(u=u.dehydrated,u===null||u.data==="$?"||qd(u)))return o}else if(o.tag===19&&o.memoizedProps.revealOrder!==void 0){if((o.flags&128)!==0)return o}else if(o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return null;o=o.return}o.sibling.return=o.return,o=o.sibling}return null}function sd(s,o,u,h){o=s.memoizedState,u=u(h,o),u=u==null?o:p({},o,u),s.memoizedState=u,s.lanes===0&&(s.updateQueue.baseState=u)}var ad={enqueueSetState:function(s,o,u){s=s._reactInternals;var h=cn(),g=Br(h);g.payload=o,u!=null&&(g.callback=u),o=Fr(s,g,h),o!==null&&(un(o,s,h),so(o,s,h))},enqueueReplaceState:function(s,o,u){s=s._reactInternals;var h=cn(),g=Br(h);g.tag=1,g.payload=o,u!=null&&(g.callback=u),o=Fr(s,g,h),o!==null&&(un(o,s,h),so(o,s,h))},enqueueForceUpdate:function(s,o){s=s._reactInternals;var u=cn(),h=Br(u);h.tag=2,o!=null&&(h.callback=o),o=Fr(s,h,u),o!==null&&(un(o,s,u),so(o,s,u))}};function y0(s,o,u,h,g,m,v){return s=s.stateNode,typeof s.shouldComponentUpdate=="function"?s.shouldComponentUpdate(h,m,v):o.prototype&&o.prototype.isPureReactComponent?!Ka(u,h)||!Ka(g,m):!0}function b0(s,o,u,h){s=o.state,typeof o.componentWillReceiveProps=="function"&&o.componentWillReceiveProps(u,h),typeof o.UNSAFE_componentWillReceiveProps=="function"&&o.UNSAFE_componentWillReceiveProps(u,h),o.state!==s&&ad.enqueueReplaceState(o,o.state,null)}function Ii(s,o){var u=o;if("ref"in o){u={};for(var h in o)h!=="ref"&&(u[h]=o[h])}if(s=s.defaultProps){u===o&&(u=p({},u));for(var g in s)u[g]===void 0&&(u[g]=s[g])}return u}var wc=typeof reportError=="function"?reportError:function(s){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var o=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof s=="object"&&s!==null&&typeof s.message=="string"?String(s.message):String(s),error:s});if(!window.dispatchEvent(o))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",s);return}console.error(s)};function v0(s){wc(s)}function T0(s){console.error(s)}function w0(s){wc(s)}function xc(s,o){try{var u=s.onUncaughtError;u(o.value,{componentStack:o.stack})}catch(h){setTimeout(function(){throw h})}}function x0(s,o,u){try{var h=s.onCaughtError;h(u.value,{componentStack:u.stack,errorBoundary:o.tag===1?o.stateNode:null})}catch(g){setTimeout(function(){throw g})}}function od(s,o,u){return u=Br(u),u.tag=3,u.payload={element:null},u.callback=function(){xc(s,o)},u}function S0(s){return s=Br(s),s.tag=3,s}function A0(s,o,u,h){var g=u.type.getDerivedStateFromError;if(typeof g=="function"){var m=h.value;s.payload=function(){return g(m)},s.callback=function(){x0(o,u,h)}}var v=u.stateNode;v!==null&&typeof v.componentDidCatch=="function"&&(s.callback=function(){x0(o,u,h),typeof g!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var x=h.stack;this.componentDidCatch(h.value,{componentStack:x!==null?x:""})})}function MA(s,o,u,h,g){if(u.flags|=32768,h!==null&&typeof h=="object"&&typeof h.then=="function"){if(o=u.alternate,o!==null&&eo(o,u,g,!0),u=Tn.current,u!==null){switch(u.tag){case 13:return $n===null?Id():u.alternate===null&&ot===0&&(ot=3),u.flags&=-257,u.flags|=65536,u.lanes=g,h===Uh?u.flags|=16384:(o=u.updateQueue,o===null?u.updateQueue=new Set([h]):o.add(h),kd(s,h,g)),!1;case 22:return u.flags|=65536,h===Uh?u.flags|=16384:(o=u.updateQueue,o===null?(o={transitions:null,markerInstances:null,retryQueue:new Set([h])},u.updateQueue=o):(u=o.retryQueue,u===null?o.retryQueue=new Set([h]):u.add(h)),kd(s,h,g)),!1}throw Error(r(435,u.tag))}return kd(s,h,g),Id(),!1}if(Le)return o=Tn.current,o!==null?((o.flags&65536)===0&&(o.flags|=256),o.flags|=65536,o.lanes=g,h!==Mh&&(s=Error(r(422),{cause:h}),Ja(mn(s,u)))):(h!==Mh&&(o=Error(r(423),{cause:h}),Ja(mn(o,u))),s=s.current.alternate,s.flags|=65536,g&=-g,s.lanes|=g,h=mn(h,u),g=od(s.stateNode,h,g),Lh(s,g),ot!==4&&(ot=2)),!1;var m=Error(r(520),{cause:h});if(m=mn(m,u),To===null?To=[m]:To.push(m),ot!==4&&(ot=2),o===null)return!0;h=mn(h,u),u=o;do{switch(u.tag){case 3:return u.flags|=65536,s=g&-g,u.lanes|=s,s=od(u.stateNode,h,s),Lh(u,s),!1;case 1:if(o=u.type,m=u.stateNode,(u.flags&128)===0&&(typeof o.getDerivedStateFromError=="function"||m!==null&&typeof m.componentDidCatch=="function"&&(Yr===null||!Yr.has(m))))return u.flags|=65536,g&=-g,u.lanes|=g,g=S0(g),A0(g,s,u,h),Lh(u,g),!1}u=u.return}while(u!==null);return!1}var E0=Error(r(461)),At=!1;function Ot(s,o,u,h){o.child=s===null?_0(o,null,u,h):Ps(o,s.child,u,h)}function R0(s,o,u,h,g){u=u.render;var m=o.ref;if("ref"in h){var v={};for(var x in h)x!=="ref"&&(v[x]=h[x])}else v=h;return Ci(o),h=$h(s,o,u,v,m,g),x=Wh(),s!==null&&!At?(Xh(s,o,g),mr(s,o,g)):(Le&&x&&Rh(o),o.flags|=1,Ot(s,o,h,g),o.child)}function C0(s,o,u,h,g){if(s===null){var m=u.type;return typeof m=="function"&&!Sh(m)&&m.defaultProps===void 0&&u.compare===null?(o.tag=15,o.type=m,M0(s,o,m,h,g)):(s=nc(u.type,null,h,o,o.mode,g),s.ref=o.ref,s.return=o,o.child=s)}if(m=s.child,!gd(s,g)){var v=m.memoizedProps;if(u=u.compare,u=u!==null?u:Ka,u(v,h)&&s.ref===o.ref)return mr(s,o,g)}return o.flags|=1,s=ur(m,h),s.ref=o.ref,s.return=o,o.child=s}function M0(s,o,u,h,g){if(s!==null){var m=s.memoizedProps;if(Ka(m,h)&&s.ref===o.ref)if(At=!1,o.pendingProps=h=m,gd(s,g))(s.flags&131072)!==0&&(At=!0);else return o.lanes=s.lanes,mr(s,o,g)}return ld(s,o,u,h,g)}function O0(s,o,u){var h=o.pendingProps,g=h.children,m=s!==null?s.memoizedState:null;if(h.mode==="hidden"){if((o.flags&128)!==0){if(h=m!==null?m.baseLanes|u:u,s!==null){for(g=o.child=s.child,m=0;g!==null;)m=m|g.lanes|g.childLanes,g=g.sibling;o.childLanes=m&~h}else o.childLanes=0,o.child=null;return I0(s,o,h,u)}if((u&536870912)!==0)o.memoizedState={baseLanes:0,cachePool:null},s!==null&&oc(o,m!==null?m.cachePool:null),m!==null?My(o,m):Vh(),m0(o);else return o.lanes=o.childLanes=536870912,I0(s,o,m!==null?m.baseLanes|u:u,u)}else m!==null?(oc(o,m.cachePool),My(o,m),Vr(),o.memoizedState=null):(s!==null&&oc(o,null),Vh(),Vr());return Ot(s,o,g,u),o.child}function I0(s,o,u,h){var g=Ph();return g=g===null?null:{parent:yt._currentValue,pool:g},o.memoizedState={baseLanes:u,cachePool:g},s!==null&&oc(o,null),Vh(),m0(o),s!==null&&eo(s,o,h,!0),null}function Sc(s,o){var u=o.ref;if(u===null)s!==null&&s.ref!==null&&(o.flags|=4194816);else{if(typeof u!="function"&&typeof u!="object")throw Error(r(284));(s===null||s.ref!==u)&&(o.flags|=4194816)}}function ld(s,o,u,h,g){return Ci(o),u=$h(s,o,u,h,void 0,g),h=Wh(),s!==null&&!At?(Xh(s,o,g),mr(s,o,g)):(Le&&h&&Rh(o),o.flags|=1,Ot(s,o,u,g),o.child)}function N0(s,o,u,h,g,m){return Ci(o),o.updateQueue=null,u=Iy(o,h,u,g),Oy(s),h=Wh(),s!==null&&!At?(Xh(s,o,m),mr(s,o,m)):(Le&&h&&Rh(o),o.flags|=1,Ot(s,o,u,m),o.child)}function k0(s,o,u,h,g){if(Ci(o),o.stateNode===null){var m=As,v=u.contextType;typeof v=="object"&&v!==null&&(m=Ut(v)),m=new u(h,m),o.memoizedState=m.state!==null&&m.state!==void 0?m.state:null,m.updater=ad,o.stateNode=m,m._reactInternals=o,m=o.stateNode,m.props=h,m.state=o.memoizedState,m.refs={},Bh(o),v=u.contextType,m.context=typeof v=="object"&&v!==null?Ut(v):As,m.state=o.memoizedState,v=u.getDerivedStateFromProps,typeof v=="function"&&(sd(o,u,v,h),m.state=o.memoizedState),typeof u.getDerivedStateFromProps=="function"||typeof m.getSnapshotBeforeUpdate=="function"||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(v=m.state,typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount(),v!==m.state&&ad.enqueueReplaceState(m,m.state,null),oo(o,h,m,g),ao(),m.state=o.memoizedState),typeof m.componentDidMount=="function"&&(o.flags|=4194308),h=!0}else if(s===null){m=o.stateNode;var x=o.memoizedProps,I=Ii(u,x);m.props=I;var W=m.context,Z=u.contextType;v=As,typeof Z=="object"&&Z!==null&&(v=Ut(Z));var te=u.getDerivedStateFromProps;Z=typeof te=="function"||typeof m.getSnapshotBeforeUpdate=="function",x=o.pendingProps!==x,Z||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(x||W!==v)&&b0(o,m,h,v),Ur=!1;var X=o.memoizedState;m.state=X,oo(o,h,m,g),ao(),W=o.memoizedState,x||X!==W||Ur?(typeof te=="function"&&(sd(o,u,te,h),W=o.memoizedState),(I=Ur||y0(o,u,I,h,X,W,v))?(Z||typeof m.UNSAFE_componentWillMount!="function"&&typeof m.componentWillMount!="function"||(typeof m.componentWillMount=="function"&&m.componentWillMount(),typeof m.UNSAFE_componentWillMount=="function"&&m.UNSAFE_componentWillMount()),typeof m.componentDidMount=="function"&&(o.flags|=4194308)):(typeof m.componentDidMount=="function"&&(o.flags|=4194308),o.memoizedProps=h,o.memoizedState=W),m.props=h,m.state=W,m.context=v,h=I):(typeof m.componentDidMount=="function"&&(o.flags|=4194308),h=!1)}else{m=o.stateNode,Fh(s,o),v=o.memoizedProps,Z=Ii(u,v),m.props=Z,te=o.pendingProps,X=m.context,W=u.contextType,I=As,typeof W=="object"&&W!==null&&(I=Ut(W)),x=u.getDerivedStateFromProps,(W=typeof x=="function"||typeof m.getSnapshotBeforeUpdate=="function")||typeof m.UNSAFE_componentWillReceiveProps!="function"&&typeof m.componentWillReceiveProps!="function"||(v!==te||X!==I)&&b0(o,m,h,I),Ur=!1,X=o.memoizedState,m.state=X,oo(o,h,m,g),ao();var Y=o.memoizedState;v!==te||X!==Y||Ur||s!==null&&s.dependencies!==null&&sc(s.dependencies)?(typeof x=="function"&&(sd(o,u,x,h),Y=o.memoizedState),(Z=Ur||y0(o,u,Z,h,X,Y,I)||s!==null&&s.dependencies!==null&&sc(s.dependencies))?(W||typeof m.UNSAFE_componentWillUpdate!="function"&&typeof m.componentWillUpdate!="function"||(typeof m.componentWillUpdate=="function"&&m.componentWillUpdate(h,Y,I),typeof m.UNSAFE_componentWillUpdate=="function"&&m.UNSAFE_componentWillUpdate(h,Y,I)),typeof m.componentDidUpdate=="function"&&(o.flags|=4),typeof m.getSnapshotBeforeUpdate=="function"&&(o.flags|=1024)):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&X===s.memoizedState||(o.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&X===s.memoizedState||(o.flags|=1024),o.memoizedProps=h,o.memoizedState=Y),m.props=h,m.state=Y,m.context=I,h=Z):(typeof m.componentDidUpdate!="function"||v===s.memoizedProps&&X===s.memoizedState||(o.flags|=4),typeof m.getSnapshotBeforeUpdate!="function"||v===s.memoizedProps&&X===s.memoizedState||(o.flags|=1024),h=!1)}return m=h,Sc(s,o),h=(o.flags&128)!==0,m||h?(m=o.stateNode,u=h&&typeof u.getDerivedStateFromError!="function"?null:m.render(),o.flags|=1,s!==null&&h?(o.child=Ps(o,s.child,null,g),o.child=Ps(o,null,u,g)):Ot(s,o,u,g),o.memoizedState=m.state,s=o.child):s=mr(s,o,g),s}function D0(s,o,u,h){return Ga(),o.flags|=256,Ot(s,o,u,h),o.child}var cd={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function ud(s){return{baseLanes:s,cachePool:Ty()}}function fd(s,o,u){return s=s!==null?s.childLanes&~u:0,o&&(s|=wn),s}function P0(s,o,u){var h=o.pendingProps,g=!1,m=(o.flags&128)!==0,v;if((v=m)||(v=s!==null&&s.memoizedState===null?!1:(bt.current&2)!==0),v&&(g=!0,o.flags&=-129),v=(o.flags&32)!==0,o.flags&=-33,s===null){if(Le){if(g?zr(o):Vr(),Le){var x=at,I;if(I=x){e:{for(I=x,x=jn;I.nodeType!==8;){if(!x){x=null;break e}if(I=kn(I.nextSibling),I===null){x=null;break e}}x=I}x!==null?(o.memoizedState={dehydrated:x,treeContext:xi!==null?{id:fr,overflow:hr}:null,retryLane:536870912,hydrationErrors:null},I=sn(18,null,null,0),I.stateNode=x,I.return=o,o.child=I,Wt=o,at=null,I=!0):I=!1}I||Ei(o)}if(x=o.memoizedState,x!==null&&(x=x.dehydrated,x!==null))return qd(x)?o.lanes=32:o.lanes=536870912,null;_r(o)}return x=h.children,h=h.fallback,g?(Vr(),g=o.mode,x=Ac({mode:"hidden",children:x},g),h=wi(h,g,u,null),x.return=o,h.return=o,x.sibling=h,o.child=x,g=o.child,g.memoizedState=ud(u),g.childLanes=fd(s,v,u),o.memoizedState=cd,h):(zr(o),hd(o,x))}if(I=s.memoizedState,I!==null&&(x=I.dehydrated,x!==null)){if(m)o.flags&256?(zr(o),o.flags&=-257,o=dd(s,o,u)):o.memoizedState!==null?(Vr(),o.child=s.child,o.flags|=128,o=null):(Vr(),g=h.fallback,x=o.mode,h=Ac({mode:"visible",children:h.children},x),g=wi(g,x,u,null),g.flags|=2,h.return=o,g.return=o,h.sibling=g,o.child=h,Ps(o,s.child,null,u),h=o.child,h.memoizedState=ud(u),h.childLanes=fd(s,v,u),o.memoizedState=cd,o=g);else if(zr(o),qd(x)){if(v=x.nextSibling&&x.nextSibling.dataset,v)var W=v.dgst;v=W,h=Error(r(419)),h.stack="",h.digest=v,Ja({value:h,source:null,stack:null}),o=dd(s,o,u)}else if(At||eo(s,o,u,!1),v=(u&s.childLanes)!==0,At||v){if(v=et,v!==null&&(h=u&-u,h=(h&42)!==0?1:Kf(h),h=(h&(v.suspendedLanes|u))!==0?0:h,h!==0&&h!==I.retryLane))throw I.retryLane=h,Ss(s,h),un(v,s,h),E0;x.data==="$?"||Id(),o=dd(s,o,u)}else x.data==="$?"?(o.flags|=192,o.child=s.child,o=null):(s=I.treeContext,at=kn(x.nextSibling),Wt=o,Le=!0,Ai=null,jn=!1,s!==null&&(bn[vn++]=fr,bn[vn++]=hr,bn[vn++]=xi,fr=s.id,hr=s.overflow,xi=o),o=hd(o,h.children),o.flags|=4096);return o}return g?(Vr(),g=h.fallback,x=o.mode,I=s.child,W=I.sibling,h=ur(I,{mode:"hidden",children:h.children}),h.subtreeFlags=I.subtreeFlags&65011712,W!==null?g=ur(W,g):(g=wi(g,x,u,null),g.flags|=2),g.return=o,h.return=o,h.sibling=g,o.child=h,h=g,g=o.child,x=s.child.memoizedState,x===null?x=ud(u):(I=x.cachePool,I!==null?(W=yt._currentValue,I=I.parent!==W?{parent:W,pool:W}:I):I=Ty(),x={baseLanes:x.baseLanes|u,cachePool:I}),g.memoizedState=x,g.childLanes=fd(s,v,u),o.memoizedState=cd,h):(zr(o),u=s.child,s=u.sibling,u=ur(u,{mode:"visible",children:h.children}),u.return=o,u.sibling=null,s!==null&&(v=o.deletions,v===null?(o.deletions=[s],o.flags|=16):v.push(s)),o.child=u,o.memoizedState=null,u)}function hd(s,o){return o=Ac({mode:"visible",children:o},s.mode),o.return=s,s.child=o}function Ac(s,o){return s=sn(22,s,null,o),s.lanes=0,s.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},s}function dd(s,o,u){return Ps(o,s.child,null,u),s=hd(o,o.pendingProps.children),s.flags|=2,o.memoizedState=null,s}function U0(s,o,u){s.lanes|=o;var h=s.alternate;h!==null&&(h.lanes|=o),Ih(s.return,o,u)}function pd(s,o,u,h,g){var m=s.memoizedState;m===null?s.memoizedState={isBackwards:o,rendering:null,renderingStartTime:0,last:h,tail:u,tailMode:g}:(m.isBackwards=o,m.rendering=null,m.renderingStartTime=0,m.last=h,m.tail=u,m.tailMode=g)}function B0(s,o,u){var h=o.pendingProps,g=h.revealOrder,m=h.tail;if(Ot(s,o,h.children,u),h=bt.current,(h&2)!==0)h=h&1|2,o.flags|=128;else{if(s!==null&&(s.flags&128)!==0)e:for(s=o.child;s!==null;){if(s.tag===13)s.memoizedState!==null&&U0(s,u,o);else if(s.tag===19)U0(s,u,o);else if(s.child!==null){s.child.return=s,s=s.child;continue}if(s===o)break e;for(;s.sibling===null;){if(s.return===null||s.return===o)break e;s=s.return}s.sibling.return=s.return,s=s.sibling}h&=1}switch(he(bt,h),g){case"forwards":for(u=o.child,g=null;u!==null;)s=u.alternate,s!==null&&Tc(s)===null&&(g=u),u=u.sibling;u=g,u===null?(g=o.child,o.child=null):(g=u.sibling,u.sibling=null),pd(o,!1,g,u,m);break;case"backwards":for(u=null,g=o.child,o.child=null;g!==null;){if(s=g.alternate,s!==null&&Tc(s)===null){o.child=g;break}s=g.sibling,g.sibling=u,u=g,g=s}pd(o,!0,u,null,m);break;case"together":pd(o,!1,null,null,void 0);break;default:o.memoizedState=null}return o.child}function mr(s,o,u){if(s!==null&&(o.dependencies=s.dependencies),Xr|=o.lanes,(u&o.childLanes)===0)if(s!==null){if(eo(s,o,u,!1),(u&o.childLanes)===0)return null}else return null;if(s!==null&&o.child!==s.child)throw Error(r(153));if(o.child!==null){for(s=o.child,u=ur(s,s.pendingProps),o.child=u,u.return=o;s.sibling!==null;)s=s.sibling,u=u.sibling=ur(s,s.pendingProps),u.return=o;u.sibling=null}return o.child}function gd(s,o){return(s.lanes&o)!==0?!0:(s=s.dependencies,!!(s!==null&&sc(s)))}function OA(s,o,u){switch(o.tag){case 3:Je(o,o.stateNode.containerInfo),Pr(o,yt,s.memoizedState.cache),Ga();break;case 27:case 5:Me(o);break;case 4:Je(o,o.stateNode.containerInfo);break;case 10:Pr(o,o.type,o.memoizedProps.value);break;case 13:var h=o.memoizedState;if(h!==null)return h.dehydrated!==null?(zr(o),o.flags|=128,null):(u&o.child.childLanes)!==0?P0(s,o,u):(zr(o),s=mr(s,o,u),s!==null?s.sibling:null);zr(o);break;case 19:var g=(s.flags&128)!==0;if(h=(u&o.childLanes)!==0,h||(eo(s,o,u,!1),h=(u&o.childLanes)!==0),g){if(h)return B0(s,o,u);o.flags|=128}if(g=o.memoizedState,g!==null&&(g.rendering=null,g.tail=null,g.lastEffect=null),he(bt,bt.current),h)break;return null;case 22:case 23:return o.lanes=0,O0(s,o,u);case 24:Pr(o,yt,s.memoizedState.cache)}return mr(s,o,u)}function F0(s,o,u){if(s!==null)if(s.memoizedProps!==o.pendingProps)At=!0;else{if(!gd(s,u)&&(o.flags&128)===0)return At=!1,OA(s,o,u);At=(s.flags&131072)!==0}else At=!1,Le&&(o.flags&1048576)!==0&&py(o,ic,o.index);switch(o.lanes=0,o.tag){case 16:e:{s=o.pendingProps;var h=o.elementType,g=h._init;if(h=g(h._payload),o.type=h,typeof h=="function")Sh(h)?(s=Ii(h,s),o.tag=1,o=k0(null,o,h,s,u)):(o.tag=0,o=ld(null,o,h,s,u));else{if(h!=null){if(g=h.$$typeof,g===E){o.tag=11,o=R0(null,o,h,s,u);break e}else if(g===ne){o.tag=14,o=C0(null,o,h,s,u);break e}}throw o=de(h)||h,Error(r(306,o,""))}}return o;case 0:return ld(s,o,o.type,o.pendingProps,u);case 1:return h=o.type,g=Ii(h,o.pendingProps),k0(s,o,h,g,u);case 3:e:{if(Je(o,o.stateNode.containerInfo),s===null)throw Error(r(387));h=o.pendingProps;var m=o.memoizedState;g=m.element,Fh(s,o),oo(o,h,null,u);var v=o.memoizedState;if(h=v.cache,Pr(o,yt,h),h!==m.cache&&Nh(o,[yt],u,!0),ao(),h=v.element,m.isDehydrated)if(m={element:h,isDehydrated:!1,cache:v.cache},o.updateQueue.baseState=m,o.memoizedState=m,o.flags&256){o=D0(s,o,h,u);break e}else if(h!==g){g=mn(Error(r(424)),o),Ja(g),o=D0(s,o,h,u);break e}else{switch(s=o.stateNode.containerInfo,s.nodeType){case 9:s=s.body;break;default:s=s.nodeName==="HTML"?s.ownerDocument.body:s}for(at=kn(s.firstChild),Wt=o,Le=!0,Ai=null,jn=!0,u=_0(o,null,h,u),o.child=u;u;)u.flags=u.flags&-3|4096,u=u.sibling}else{if(Ga(),h===g){o=mr(s,o,u);break e}Ot(s,o,h,u)}o=o.child}return o;case 26:return Sc(s,o),s===null?(u=Hb(o.type,null,o.pendingProps,null))?o.memoizedState=u:Le||(u=o.type,s=o.pendingProps,h=Lc(Ae.current).createElement(u),h[Pt]=o,h[qt]=s,Nt(h,u,s),St(h),o.stateNode=h):o.memoizedState=Hb(o.type,s.memoizedProps,o.pendingProps,s.memoizedState),null;case 27:return Me(o),s===null&&Le&&(h=o.stateNode=Lb(o.type,o.pendingProps,Ae.current),Wt=o,jn=!0,g=at,Zr(o.type)?(Kd=g,at=kn(h.firstChild)):at=g),Ot(s,o,o.pendingProps.children,u),Sc(s,o),s===null&&(o.flags|=4194304),o.child;case 5:return s===null&&Le&&((g=h=at)&&(h=iE(h,o.type,o.pendingProps,jn),h!==null?(o.stateNode=h,Wt=o,at=kn(h.firstChild),jn=!1,g=!0):g=!1),g||Ei(o)),Me(o),g=o.type,m=o.pendingProps,v=s!==null?s.memoizedProps:null,h=m.children,Wd(g,m)?h=null:v!==null&&Wd(g,v)&&(o.flags|=32),o.memoizedState!==null&&(g=$h(s,o,wA,null,null,u),Oo._currentValue=g),Sc(s,o),Ot(s,o,h,u),o.child;case 6:return s===null&&Le&&((s=u=at)&&(u=sE(u,o.pendingProps,jn),u!==null?(o.stateNode=u,Wt=o,at=null,s=!0):s=!1),s||Ei(o)),null;case 13:return P0(s,o,u);case 4:return Je(o,o.stateNode.containerInfo),h=o.pendingProps,s===null?o.child=Ps(o,null,h,u):Ot(s,o,h,u),o.child;case 11:return R0(s,o,o.type,o.pendingProps,u);case 7:return Ot(s,o,o.pendingProps,u),o.child;case 8:return Ot(s,o,o.pendingProps.children,u),o.child;case 12:return Ot(s,o,o.pendingProps.children,u),o.child;case 10:return h=o.pendingProps,Pr(o,o.type,h.value),Ot(s,o,h.children,u),o.child;case 9:return g=o.type._context,h=o.pendingProps.children,Ci(o),g=Ut(g),h=h(g),o.flags|=1,Ot(s,o,h,u),o.child;case 14:return C0(s,o,o.type,o.pendingProps,u);case 15:return M0(s,o,o.type,o.pendingProps,u);case 19:return B0(s,o,u);case 31:return h=o.pendingProps,u=o.mode,h={mode:h.mode,children:h.children},s===null?(u=Ac(h,u),u.ref=o.ref,o.child=u,u.return=o,o=u):(u=ur(s.child,h),u.ref=o.ref,o.child=u,u.return=o,o=u),o;case 22:return O0(s,o,u);case 24:return Ci(o),h=Ut(yt),s===null?(g=Ph(),g===null&&(g=et,m=kh(),g.pooledCache=m,m.refCount++,m!==null&&(g.pooledCacheLanes|=u),g=m),o.memoizedState={parent:h,cache:g},Bh(o),Pr(o,yt,g)):((s.lanes&u)!==0&&(Fh(s,o),oo(o,null,null,u),ao()),g=s.memoizedState,m=o.memoizedState,g.parent!==h?(g={parent:h,cache:h},o.memoizedState=g,o.lanes===0&&(o.memoizedState=o.updateQueue.baseState=g),Pr(o,yt,h)):(h=m.cache,Pr(o,yt,h),h!==g.cache&&Nh(o,[yt],u,!0))),Ot(s,o,o.pendingProps.children,u),o.child;case 29:throw o.pendingProps}throw Error(r(156,o.tag))}function yr(s){s.flags|=4}function L0(s,o){if(o.type!=="stylesheet"||(o.state.loading&4)!==0)s.flags&=-16777217;else if(s.flags|=16777216,!Yb(o)){if(o=Tn.current,o!==null&&((Ue&4194048)===Ue?$n!==null:(Ue&62914560)!==Ue&&(Ue&536870912)===0||o!==$n))throw io=Uh,wy;s.flags|=8192}}function Ec(s,o){o!==null&&(s.flags|=4),s.flags&16384&&(o=s.tag!==22?mm():536870912,s.lanes|=o,Ls|=o)}function go(s,o){if(!Le)switch(s.tailMode){case"hidden":o=s.tail;for(var u=null;o!==null;)o.alternate!==null&&(u=o),o=o.sibling;u===null?s.tail=null:u.sibling=null;break;case"collapsed":u=s.tail;for(var h=null;u!==null;)u.alternate!==null&&(h=u),u=u.sibling;h===null?o||s.tail===null?s.tail=null:s.tail.sibling=null:h.sibling=null}}function st(s){var o=s.alternate!==null&&s.alternate.child===s.child,u=0,h=0;if(o)for(var g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags&65011712,h|=g.flags&65011712,g.return=s,g=g.sibling;else for(g=s.child;g!==null;)u|=g.lanes|g.childLanes,h|=g.subtreeFlags,h|=g.flags,g.return=s,g=g.sibling;return s.subtreeFlags|=h,s.childLanes=u,o}function IA(s,o,u){var h=o.pendingProps;switch(Ch(o),o.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return st(o),null;case 1:return st(o),null;case 3:return u=o.stateNode,h=null,s!==null&&(h=s.memoizedState.cache),o.memoizedState.cache!==h&&(o.flags|=2048),pr(yt),pe(),u.pendingContext&&(u.context=u.pendingContext,u.pendingContext=null),(s===null||s.child===null)&&(Qa(o)?yr(o):s===null||s.memoizedState.isDehydrated&&(o.flags&256)===0||(o.flags|=1024,my())),st(o),null;case 26:return u=o.memoizedState,s===null?(yr(o),u!==null?(st(o),L0(o,u)):(st(o),o.flags&=-16777217)):u?u!==s.memoizedState?(yr(o),st(o),L0(o,u)):(st(o),o.flags&=-16777217):(s.memoizedProps!==h&&yr(o),st(o),o.flags&=-16777217),null;case 27:Ne(o),u=Ae.current;var g=o.type;if(s!==null&&o.stateNode!=null)s.memoizedProps!==h&&yr(o);else{if(!h){if(o.stateNode===null)throw Error(r(166));return st(o),null}s=ve.current,Qa(o)?gy(o):(s=Lb(g,h,u),o.stateNode=s,yr(o))}return st(o),null;case 5:if(Ne(o),u=o.type,s!==null&&o.stateNode!=null)s.memoizedProps!==h&&yr(o);else{if(!h){if(o.stateNode===null)throw Error(r(166));return st(o),null}if(s=ve.current,Qa(o))gy(o);else{switch(g=Lc(Ae.current),s){case 1:s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case 2:s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;default:switch(u){case"svg":s=g.createElementNS("http://www.w3.org/2000/svg",u);break;case"math":s=g.createElementNS("http://www.w3.org/1998/Math/MathML",u);break;case"script":s=g.createElement("div"),s.innerHTML="<script><\/script>",s=s.removeChild(s.firstChild);break;case"select":s=typeof h.is=="string"?g.createElement("select",{is:h.is}):g.createElement("select"),h.multiple?s.multiple=!0:h.size&&(s.size=h.size);break;default:s=typeof h.is=="string"?g.createElement(u,{is:h.is}):g.createElement(u)}}s[Pt]=o,s[qt]=h;e:for(g=o.child;g!==null;){if(g.tag===5||g.tag===6)s.appendChild(g.stateNode);else if(g.tag!==4&&g.tag!==27&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===o)break e;for(;g.sibling===null;){if(g.return===null||g.return===o)break e;g=g.return}g.sibling.return=g.return,g=g.sibling}o.stateNode=s;e:switch(Nt(s,u,h),u){case"button":case"input":case"select":case"textarea":s=!!h.autoFocus;break e;case"img":s=!0;break e;default:s=!1}s&&yr(o)}}return st(o),o.flags&=-16777217,null;case 6:if(s&&o.stateNode!=null)s.memoizedProps!==h&&yr(o);else{if(typeof h!="string"&&o.stateNode===null)throw Error(r(166));if(s=Ae.current,Qa(o)){if(s=o.stateNode,u=o.memoizedProps,h=null,g=Wt,g!==null)switch(g.tag){case 27:case 5:h=g.memoizedProps}s[Pt]=o,s=!!(s.nodeValue===u||h!==null&&h.suppressHydrationWarning===!0||Nb(s.nodeValue,u)),s||Ei(o)}else s=Lc(s).createTextNode(h),s[Pt]=o,o.stateNode=s}return st(o),null;case 13:if(h=o.memoizedState,s===null||s.memoizedState!==null&&s.memoizedState.dehydrated!==null){if(g=Qa(o),h!==null&&h.dehydrated!==null){if(s===null){if(!g)throw Error(r(318));if(g=o.memoizedState,g=g!==null?g.dehydrated:null,!g)throw Error(r(317));g[Pt]=o}else Ga(),(o.flags&128)===0&&(o.memoizedState=null),o.flags|=4;st(o),g=!1}else g=my(),s!==null&&s.memoizedState!==null&&(s.memoizedState.hydrationErrors=g),g=!0;if(!g)return o.flags&256?(_r(o),o):(_r(o),null)}if(_r(o),(o.flags&128)!==0)return o.lanes=u,o;if(u=h!==null,s=s!==null&&s.memoizedState!==null,u){h=o.child,g=null,h.alternate!==null&&h.alternate.memoizedState!==null&&h.alternate.memoizedState.cachePool!==null&&(g=h.alternate.memoizedState.cachePool.pool);var m=null;h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(m=h.memoizedState.cachePool.pool),m!==g&&(h.flags|=2048)}return u!==s&&u&&(o.child.flags|=8192),Ec(o,o.updateQueue),st(o),null;case 4:return pe(),s===null&&zd(o.stateNode.containerInfo),st(o),null;case 10:return pr(o.type),st(o),null;case 19:if(ge(bt),g=o.memoizedState,g===null)return st(o),null;if(h=(o.flags&128)!==0,m=g.rendering,m===null)if(h)go(g,!1);else{if(ot!==0||s!==null&&(s.flags&128)!==0)for(s=o.child;s!==null;){if(m=Tc(s),m!==null){for(o.flags|=128,go(g,!1),s=m.updateQueue,o.updateQueue=s,Ec(o,s),o.subtreeFlags=0,s=u,u=o.child;u!==null;)dy(u,s),u=u.sibling;return he(bt,bt.current&1|2),o.child}s=s.sibling}g.tail!==null&&xt()>Mc&&(o.flags|=128,h=!0,go(g,!1),o.lanes=4194304)}else{if(!h)if(s=Tc(m),s!==null){if(o.flags|=128,h=!0,s=s.updateQueue,o.updateQueue=s,Ec(o,s),go(g,!0),g.tail===null&&g.tailMode==="hidden"&&!m.alternate&&!Le)return st(o),null}else 2*xt()-g.renderingStartTime>Mc&&u!==536870912&&(o.flags|=128,h=!0,go(g,!1),o.lanes=4194304);g.isBackwards?(m.sibling=o.child,o.child=m):(s=g.last,s!==null?s.sibling=m:o.child=m,g.last=m)}return g.tail!==null?(o=g.tail,g.rendering=o,g.tail=o.sibling,g.renderingStartTime=xt(),o.sibling=null,s=bt.current,he(bt,h?s&1|2:s&1),o):(st(o),null);case 22:case 23:return _r(o),Hh(),h=o.memoizedState!==null,s!==null?s.memoizedState!==null!==h&&(o.flags|=8192):h&&(o.flags|=8192),h?(u&536870912)!==0&&(o.flags&128)===0&&(st(o),o.subtreeFlags&6&&(o.flags|=8192)):st(o),u=o.updateQueue,u!==null&&Ec(o,u.retryQueue),u=null,s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),h=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(h=o.memoizedState.cachePool.pool),h!==u&&(o.flags|=2048),s!==null&&ge(Mi),null;case 24:return u=null,s!==null&&(u=s.memoizedState.cache),o.memoizedState.cache!==u&&(o.flags|=2048),pr(yt),st(o),null;case 25:return null;case 30:return null}throw Error(r(156,o.tag))}function NA(s,o){switch(Ch(o),o.tag){case 1:return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 3:return pr(yt),pe(),s=o.flags,(s&65536)!==0&&(s&128)===0?(o.flags=s&-65537|128,o):null;case 26:case 27:case 5:return Ne(o),null;case 13:if(_r(o),s=o.memoizedState,s!==null&&s.dehydrated!==null){if(o.alternate===null)throw Error(r(340));Ga()}return s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 19:return ge(bt),null;case 4:return pe(),null;case 10:return pr(o.type),null;case 22:case 23:return _r(o),Hh(),s!==null&&ge(Mi),s=o.flags,s&65536?(o.flags=s&-65537|128,o):null;case 24:return pr(yt),null;case 25:return null;default:return null}}function z0(s,o){switch(Ch(o),o.tag){case 3:pr(yt),pe();break;case 26:case 27:case 5:Ne(o);break;case 4:pe();break;case 13:_r(o);break;case 19:ge(bt);break;case 10:pr(o.type);break;case 22:case 23:_r(o),Hh(),s!==null&&ge(Mi);break;case 24:pr(yt)}}function _o(s,o){try{var u=o.updateQueue,h=u!==null?u.lastEffect:null;if(h!==null){var g=h.next;u=g;do{if((u.tag&s)===s){h=void 0;var m=u.create,v=u.inst;h=m(),v.destroy=h}u=u.next}while(u!==g)}}catch(x){Qe(o,o.return,x)}}function Hr(s,o,u){try{var h=o.updateQueue,g=h!==null?h.lastEffect:null;if(g!==null){var m=g.next;h=m;do{if((h.tag&s)===s){var v=h.inst,x=v.destroy;if(x!==void 0){v.destroy=void 0,g=o;var I=u,W=x;try{W()}catch(Z){Qe(g,I,Z)}}}h=h.next}while(h!==m)}}catch(Z){Qe(o,o.return,Z)}}function V0(s){var o=s.updateQueue;if(o!==null){var u=s.stateNode;try{Cy(o,u)}catch(h){Qe(s,s.return,h)}}}function H0(s,o,u){u.props=Ii(s.type,s.memoizedProps),u.state=s.memoizedState;try{u.componentWillUnmount()}catch(h){Qe(s,o,h)}}function mo(s,o){try{var u=s.ref;if(u!==null){switch(s.tag){case 26:case 27:case 5:var h=s.stateNode;break;case 30:h=s.stateNode;break;default:h=s.stateNode}typeof u=="function"?s.refCleanup=u(h):u.current=h}}catch(g){Qe(s,o,g)}}function Wn(s,o){var u=s.ref,h=s.refCleanup;if(u!==null)if(typeof h=="function")try{h()}catch(g){Qe(s,o,g)}finally{s.refCleanup=null,s=s.alternate,s!=null&&(s.refCleanup=null)}else if(typeof u=="function")try{u(null)}catch(g){Qe(s,o,g)}else u.current=null}function j0(s){var o=s.type,u=s.memoizedProps,h=s.stateNode;try{e:switch(o){case"button":case"input":case"select":case"textarea":u.autoFocus&&h.focus();break e;case"img":u.src?h.src=u.src:u.srcSet&&(h.srcset=u.srcSet)}}catch(g){Qe(s,s.return,g)}}function _d(s,o,u){try{var h=s.stateNode;JA(h,s.type,u,o),h[qt]=o}catch(g){Qe(s,s.return,g)}}function $0(s){return s.tag===5||s.tag===3||s.tag===26||s.tag===27&&Zr(s.type)||s.tag===4}function md(s){e:for(;;){for(;s.sibling===null;){if(s.return===null||$0(s.return))return null;s=s.return}for(s.sibling.return=s.return,s=s.sibling;s.tag!==5&&s.tag!==6&&s.tag!==18;){if(s.tag===27&&Zr(s.type)||s.flags&2||s.child===null||s.tag===4)continue e;s.child.return=s,s=s.child}if(!(s.flags&2))return s.stateNode}}function yd(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?(u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u).insertBefore(s,o):(o=u.nodeType===9?u.body:u.nodeName==="HTML"?u.ownerDocument.body:u,o.appendChild(s),u=u._reactRootContainer,u!=null||o.onclick!==null||(o.onclick=Fc));else if(h!==4&&(h===27&&Zr(s.type)&&(u=s.stateNode,o=null),s=s.child,s!==null))for(yd(s,o,u),s=s.sibling;s!==null;)yd(s,o,u),s=s.sibling}function Rc(s,o,u){var h=s.tag;if(h===5||h===6)s=s.stateNode,o?u.insertBefore(s,o):u.appendChild(s);else if(h!==4&&(h===27&&Zr(s.type)&&(u=s.stateNode),s=s.child,s!==null))for(Rc(s,o,u),s=s.sibling;s!==null;)Rc(s,o,u),s=s.sibling}function W0(s){var o=s.stateNode,u=s.memoizedProps;try{for(var h=s.type,g=o.attributes;g.length;)o.removeAttributeNode(g[0]);Nt(o,h,u),o[Pt]=s,o[qt]=u}catch(m){Qe(s,s.return,m)}}var br=!1,ht=!1,bd=!1,X0=typeof WeakSet=="function"?WeakSet:Set,Et=null;function kA(s,o){if(s=s.containerInfo,jd=Wc,s=ry(s),mh(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{u=(u=s.ownerDocument)&&u.defaultView||window;var h=u.getSelection&&u.getSelection();if(h&&h.rangeCount!==0){u=h.anchorNode;var g=h.anchorOffset,m=h.focusNode;h=h.focusOffset;try{u.nodeType,m.nodeType}catch{u=null;break e}var v=0,x=-1,I=-1,W=0,Z=0,te=s,X=null;t:for(;;){for(var Y;te!==u||g!==0&&te.nodeType!==3||(x=v+g),te!==m||h!==0&&te.nodeType!==3||(I=v+h),te.nodeType===3&&(v+=te.nodeValue.length),(Y=te.firstChild)!==null;)X=te,te=Y;for(;;){if(te===s)break t;if(X===u&&++W===g&&(x=v),X===m&&++Z===h&&(I=v),(Y=te.nextSibling)!==null)break;te=X,X=te.parentNode}te=Y}u=x===-1||I===-1?null:{start:x,end:I}}else u=null}u=u||{start:0,end:0}}else u=null;for($d={focusedElem:s,selectionRange:u},Wc=!1,Et=o;Et!==null;)if(o=Et,s=o.child,(o.subtreeFlags&1024)!==0&&s!==null)s.return=o,Et=s;else for(;Et!==null;){switch(o=Et,m=o.alternate,s=o.flags,o.tag){case 0:break;case 11:case 15:break;case 1:if((s&1024)!==0&&m!==null){s=void 0,u=o,g=m.memoizedProps,m=m.memoizedState,h=u.stateNode;try{var Se=Ii(u.type,g,u.elementType===u.type);s=h.getSnapshotBeforeUpdate(Se,m),h.__reactInternalSnapshotBeforeUpdate=s}catch(Te){Qe(u,u.return,Te)}}break;case 3:if((s&1024)!==0){if(s=o.stateNode.containerInfo,u=s.nodeType,u===9)Yd(s);else if(u===1)switch(s.nodeName){case"HEAD":case"HTML":case"BODY":Yd(s);break;default:s.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((s&1024)!==0)throw Error(r(163))}if(s=o.sibling,s!==null){s.return=o.return,Et=s;break}Et=o.return}}function Y0(s,o,u){var h=u.flags;switch(u.tag){case 0:case 11:case 15:jr(s,u),h&4&&_o(5,u);break;case 1:if(jr(s,u),h&4)if(s=u.stateNode,o===null)try{s.componentDidMount()}catch(v){Qe(u,u.return,v)}else{var g=Ii(u.type,o.memoizedProps);o=o.memoizedState;try{s.componentDidUpdate(g,o,s.__reactInternalSnapshotBeforeUpdate)}catch(v){Qe(u,u.return,v)}}h&64&&V0(u),h&512&&mo(u,u.return);break;case 3:if(jr(s,u),h&64&&(s=u.updateQueue,s!==null)){if(o=null,u.child!==null)switch(u.child.tag){case 27:case 5:o=u.child.stateNode;break;case 1:o=u.child.stateNode}try{Cy(s,o)}catch(v){Qe(u,u.return,v)}}break;case 27:o===null&&h&4&&W0(u);case 26:case 5:jr(s,u),o===null&&h&4&&j0(u),h&512&&mo(u,u.return);break;case 12:jr(s,u);break;case 13:jr(s,u),h&4&&Z0(s,u),h&64&&(s=u.memoizedState,s!==null&&(s=s.dehydrated,s!==null&&(u=HA.bind(null,u),aE(s,u))));break;case 22:if(h=u.memoizedState!==null||br,!h){o=o!==null&&o.memoizedState!==null||ht,g=br;var m=ht;br=h,(ht=o)&&!m?$r(s,u,(u.subtreeFlags&8772)!==0):jr(s,u),br=g,ht=m}break;case 30:break;default:jr(s,u)}}function q0(s){var o=s.alternate;o!==null&&(s.alternate=null,q0(o)),s.child=null,s.deletions=null,s.sibling=null,s.tag===5&&(o=s.stateNode,o!==null&&Gf(o)),s.stateNode=null,s.return=null,s.dependencies=null,s.memoizedProps=null,s.memoizedState=null,s.pendingProps=null,s.stateNode=null,s.updateQueue=null}var nt=null,Qt=!1;function vr(s,o,u){for(u=u.child;u!==null;)K0(s,o,u),u=u.sibling}function K0(s,o,u){if(tn&&typeof tn.onCommitFiberUnmount=="function")try{tn.onCommitFiberUnmount(Ba,u)}catch{}switch(u.tag){case 26:ht||Wn(u,o),vr(s,o,u),u.memoizedState?u.memoizedState.count--:u.stateNode&&(u=u.stateNode,u.parentNode.removeChild(u));break;case 27:ht||Wn(u,o);var h=nt,g=Qt;Zr(u.type)&&(nt=u.stateNode,Qt=!1),vr(s,o,u),Eo(u.stateNode),nt=h,Qt=g;break;case 5:ht||Wn(u,o);case 6:if(h=nt,g=Qt,nt=null,vr(s,o,u),nt=h,Qt=g,nt!==null)if(Qt)try{(nt.nodeType===9?nt.body:nt.nodeName==="HTML"?nt.ownerDocument.body:nt).removeChild(u.stateNode)}catch(m){Qe(u,o,m)}else try{nt.removeChild(u.stateNode)}catch(m){Qe(u,o,m)}break;case 18:nt!==null&&(Qt?(s=nt,Bb(s.nodeType===9?s.body:s.nodeName==="HTML"?s.ownerDocument.body:s,u.stateNode),Do(s)):Bb(nt,u.stateNode));break;case 4:h=nt,g=Qt,nt=u.stateNode.containerInfo,Qt=!0,vr(s,o,u),nt=h,Qt=g;break;case 0:case 11:case 14:case 15:ht||Hr(2,u,o),ht||Hr(4,u,o),vr(s,o,u);break;case 1:ht||(Wn(u,o),h=u.stateNode,typeof h.componentWillUnmount=="function"&&H0(u,o,h)),vr(s,o,u);break;case 21:vr(s,o,u);break;case 22:ht=(h=ht)||u.memoizedState!==null,vr(s,o,u),ht=h;break;default:vr(s,o,u)}}function Z0(s,o){if(o.memoizedState===null&&(s=o.alternate,s!==null&&(s=s.memoizedState,s!==null&&(s=s.dehydrated,s!==null))))try{Do(s)}catch(u){Qe(o,o.return,u)}}function DA(s){switch(s.tag){case 13:case 19:var o=s.stateNode;return o===null&&(o=s.stateNode=new X0),o;case 22:return s=s.stateNode,o=s._retryCache,o===null&&(o=s._retryCache=new X0),o;default:throw Error(r(435,s.tag))}}function vd(s,o){var u=DA(s);o.forEach(function(h){var g=jA.bind(null,s,h);u.has(h)||(u.add(h),h.then(g,g))})}function an(s,o){var u=o.deletions;if(u!==null)for(var h=0;h<u.length;h++){var g=u[h],m=s,v=o,x=v;e:for(;x!==null;){switch(x.tag){case 27:if(Zr(x.type)){nt=x.stateNode,Qt=!1;break e}break;case 5:nt=x.stateNode,Qt=!1;break e;case 3:case 4:nt=x.stateNode.containerInfo,Qt=!0;break e}x=x.return}if(nt===null)throw Error(r(160));K0(m,v,g),nt=null,Qt=!1,m=g.alternate,m!==null&&(m.return=null),g.return=null}if(o.subtreeFlags&13878)for(o=o.child;o!==null;)Q0(o,s),o=o.sibling}var Nn=null;function Q0(s,o){var u=s.alternate,h=s.flags;switch(s.tag){case 0:case 11:case 14:case 15:an(o,s),on(s),h&4&&(Hr(3,s,s.return),_o(3,s),Hr(5,s,s.return));break;case 1:an(o,s),on(s),h&512&&(ht||u===null||Wn(u,u.return)),h&64&&br&&(s=s.updateQueue,s!==null&&(h=s.callbacks,h!==null&&(u=s.shared.hiddenCallbacks,s.shared.hiddenCallbacks=u===null?h:u.concat(h))));break;case 26:var g=Nn;if(an(o,s),on(s),h&512&&(ht||u===null||Wn(u,u.return)),h&4){var m=u!==null?u.memoizedState:null;if(h=s.memoizedState,u===null)if(h===null)if(s.stateNode===null){e:{h=s.type,u=s.memoizedProps,g=g.ownerDocument||g;t:switch(h){case"title":m=g.getElementsByTagName("title")[0],(!m||m[za]||m[Pt]||m.namespaceURI==="http://www.w3.org/2000/svg"||m.hasAttribute("itemprop"))&&(m=g.createElement(h),g.head.insertBefore(m,g.querySelector("head > title"))),Nt(m,h,u),m[Pt]=s,St(m),h=m;break e;case"link":var v=Wb("link","href",g).get(h+(u.href||""));if(v){for(var x=0;x<v.length;x++)if(m=v[x],m.getAttribute("href")===(u.href==null||u.href===""?null:u.href)&&m.getAttribute("rel")===(u.rel==null?null:u.rel)&&m.getAttribute("title")===(u.title==null?null:u.title)&&m.getAttribute("crossorigin")===(u.crossOrigin==null?null:u.crossOrigin)){v.splice(x,1);break t}}m=g.createElement(h),Nt(m,h,u),g.head.appendChild(m);break;case"meta":if(v=Wb("meta","content",g).get(h+(u.content||""))){for(x=0;x<v.length;x++)if(m=v[x],m.getAttribute("content")===(u.content==null?null:""+u.content)&&m.getAttribute("name")===(u.name==null?null:u.name)&&m.getAttribute("property")===(u.property==null?null:u.property)&&m.getAttribute("http-equiv")===(u.httpEquiv==null?null:u.httpEquiv)&&m.getAttribute("charset")===(u.charSet==null?null:u.charSet)){v.splice(x,1);break t}}m=g.createElement(h),Nt(m,h,u),g.head.appendChild(m);break;default:throw Error(r(468,h))}m[Pt]=s,St(m),h=m}s.stateNode=h}else Xb(g,s.type,s.stateNode);else s.stateNode=$b(g,h,s.memoizedProps);else m!==h?(m===null?u.stateNode!==null&&(u=u.stateNode,u.parentNode.removeChild(u)):m.count--,h===null?Xb(g,s.type,s.stateNode):$b(g,h,s.memoizedProps)):h===null&&s.stateNode!==null&&_d(s,s.memoizedProps,u.memoizedProps)}break;case 27:an(o,s),on(s),h&512&&(ht||u===null||Wn(u,u.return)),u!==null&&h&4&&_d(s,s.memoizedProps,u.memoizedProps);break;case 5:if(an(o,s),on(s),h&512&&(ht||u===null||Wn(u,u.return)),s.flags&32){g=s.stateNode;try{ms(g,"")}catch(Y){Qe(s,s.return,Y)}}h&4&&s.stateNode!=null&&(g=s.memoizedProps,_d(s,g,u!==null?u.memoizedProps:g)),h&1024&&(bd=!0);break;case 6:if(an(o,s),on(s),h&4){if(s.stateNode===null)throw Error(r(162));h=s.memoizedProps,u=s.stateNode;try{u.nodeValue=h}catch(Y){Qe(s,s.return,Y)}}break;case 3:if(Hc=null,g=Nn,Nn=zc(o.containerInfo),an(o,s),Nn=g,on(s),h&4&&u!==null&&u.memoizedState.isDehydrated)try{Do(o.containerInfo)}catch(Y){Qe(s,s.return,Y)}bd&&(bd=!1,G0(s));break;case 4:h=Nn,Nn=zc(s.stateNode.containerInfo),an(o,s),on(s),Nn=h;break;case 12:an(o,s),on(s);break;case 13:an(o,s),on(s),s.child.flags&8192&&s.memoizedState!==null!=(u!==null&&u.memoizedState!==null)&&(Ed=xt()),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,vd(s,h)));break;case 22:g=s.memoizedState!==null;var I=u!==null&&u.memoizedState!==null,W=br,Z=ht;if(br=W||g,ht=Z||I,an(o,s),ht=Z,br=W,on(s),h&8192)e:for(o=s.stateNode,o._visibility=g?o._visibility&-2:o._visibility|1,g&&(u===null||I||br||ht||Ni(s)),u=null,o=s;;){if(o.tag===5||o.tag===26){if(u===null){I=u=o;try{if(m=I.stateNode,g)v=m.style,typeof v.setProperty=="function"?v.setProperty("display","none","important"):v.display="none";else{x=I.stateNode;var te=I.memoizedProps.style,X=te!=null&&te.hasOwnProperty("display")?te.display:null;x.style.display=X==null||typeof X=="boolean"?"":(""+X).trim()}}catch(Y){Qe(I,I.return,Y)}}}else if(o.tag===6){if(u===null){I=o;try{I.stateNode.nodeValue=g?"":I.memoizedProps}catch(Y){Qe(I,I.return,Y)}}}else if((o.tag!==22&&o.tag!==23||o.memoizedState===null||o===s)&&o.child!==null){o.child.return=o,o=o.child;continue}if(o===s)break e;for(;o.sibling===null;){if(o.return===null||o.return===s)break e;u===o&&(u=null),o=o.return}u===o&&(u=null),o.sibling.return=o.return,o=o.sibling}h&4&&(h=s.updateQueue,h!==null&&(u=h.retryQueue,u!==null&&(h.retryQueue=null,vd(s,u))));break;case 19:an(o,s),on(s),h&4&&(h=s.updateQueue,h!==null&&(s.updateQueue=null,vd(s,h)));break;case 30:break;case 21:break;default:an(o,s),on(s)}}function on(s){var o=s.flags;if(o&2){try{for(var u,h=s.return;h!==null;){if($0(h)){u=h;break}h=h.return}if(u==null)throw Error(r(160));switch(u.tag){case 27:var g=u.stateNode,m=md(s);Rc(s,m,g);break;case 5:var v=u.stateNode;u.flags&32&&(ms(v,""),u.flags&=-33);var x=md(s);Rc(s,x,v);break;case 3:case 4:var I=u.stateNode.containerInfo,W=md(s);yd(s,W,I);break;default:throw Error(r(161))}}catch(Z){Qe(s,s.return,Z)}s.flags&=-3}o&4096&&(s.flags&=-4097)}function G0(s){if(s.subtreeFlags&1024)for(s=s.child;s!==null;){var o=s;G0(o),o.tag===5&&o.flags&1024&&o.stateNode.reset(),s=s.sibling}}function jr(s,o){if(o.subtreeFlags&8772)for(o=o.child;o!==null;)Y0(s,o.alternate,o),o=o.sibling}function Ni(s){for(s=s.child;s!==null;){var o=s;switch(o.tag){case 0:case 11:case 14:case 15:Hr(4,o,o.return),Ni(o);break;case 1:Wn(o,o.return);var u=o.stateNode;typeof u.componentWillUnmount=="function"&&H0(o,o.return,u),Ni(o);break;case 27:Eo(o.stateNode);case 26:case 5:Wn(o,o.return),Ni(o);break;case 22:o.memoizedState===null&&Ni(o);break;case 30:Ni(o);break;default:Ni(o)}s=s.sibling}}function $r(s,o,u){for(u=u&&(o.subtreeFlags&8772)!==0,o=o.child;o!==null;){var h=o.alternate,g=s,m=o,v=m.flags;switch(m.tag){case 0:case 11:case 15:$r(g,m,u),_o(4,m);break;case 1:if($r(g,m,u),h=m,g=h.stateNode,typeof g.componentDidMount=="function")try{g.componentDidMount()}catch(W){Qe(h,h.return,W)}if(h=m,g=h.updateQueue,g!==null){var x=h.stateNode;try{var I=g.shared.hiddenCallbacks;if(I!==null)for(g.shared.hiddenCallbacks=null,g=0;g<I.length;g++)Ry(I[g],x)}catch(W){Qe(h,h.return,W)}}u&&v&64&&V0(m),mo(m,m.return);break;case 27:W0(m);case 26:case 5:$r(g,m,u),u&&h===null&&v&4&&j0(m),mo(m,m.return);break;case 12:$r(g,m,u);break;case 13:$r(g,m,u),u&&v&4&&Z0(g,m);break;case 22:m.memoizedState===null&&$r(g,m,u),mo(m,m.return);break;case 30:break;default:$r(g,m,u)}o=o.sibling}}function Td(s,o){var u=null;s!==null&&s.memoizedState!==null&&s.memoizedState.cachePool!==null&&(u=s.memoizedState.cachePool.pool),s=null,o.memoizedState!==null&&o.memoizedState.cachePool!==null&&(s=o.memoizedState.cachePool.pool),s!==u&&(s!=null&&s.refCount++,u!=null&&to(u))}function wd(s,o){s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&to(s))}function Xn(s,o,u,h){if(o.subtreeFlags&10256)for(o=o.child;o!==null;)J0(s,o,u,h),o=o.sibling}function J0(s,o,u,h){var g=o.flags;switch(o.tag){case 0:case 11:case 15:Xn(s,o,u,h),g&2048&&_o(9,o);break;case 1:Xn(s,o,u,h);break;case 3:Xn(s,o,u,h),g&2048&&(s=null,o.alternate!==null&&(s=o.alternate.memoizedState.cache),o=o.memoizedState.cache,o!==s&&(o.refCount++,s!=null&&to(s)));break;case 12:if(g&2048){Xn(s,o,u,h),s=o.stateNode;try{var m=o.memoizedProps,v=m.id,x=m.onPostCommit;typeof x=="function"&&x(v,o.alternate===null?"mount":"update",s.passiveEffectDuration,-0)}catch(I){Qe(o,o.return,I)}}else Xn(s,o,u,h);break;case 13:Xn(s,o,u,h);break;case 23:break;case 22:m=o.stateNode,v=o.alternate,o.memoizedState!==null?m._visibility&2?Xn(s,o,u,h):yo(s,o):m._visibility&2?Xn(s,o,u,h):(m._visibility|=2,Us(s,o,u,h,(o.subtreeFlags&10256)!==0)),g&2048&&Td(v,o);break;case 24:Xn(s,o,u,h),g&2048&&wd(o.alternate,o);break;default:Xn(s,o,u,h)}}function Us(s,o,u,h,g){for(g=g&&(o.subtreeFlags&10256)!==0,o=o.child;o!==null;){var m=s,v=o,x=u,I=h,W=v.flags;switch(v.tag){case 0:case 11:case 15:Us(m,v,x,I,g),_o(8,v);break;case 23:break;case 22:var Z=v.stateNode;v.memoizedState!==null?Z._visibility&2?Us(m,v,x,I,g):yo(m,v):(Z._visibility|=2,Us(m,v,x,I,g)),g&&W&2048&&Td(v.alternate,v);break;case 24:Us(m,v,x,I,g),g&&W&2048&&wd(v.alternate,v);break;default:Us(m,v,x,I,g)}o=o.sibling}}function yo(s,o){if(o.subtreeFlags&10256)for(o=o.child;o!==null;){var u=s,h=o,g=h.flags;switch(h.tag){case 22:yo(u,h),g&2048&&Td(h.alternate,h);break;case 24:yo(u,h),g&2048&&wd(h.alternate,h);break;default:yo(u,h)}o=o.sibling}}var bo=8192;function Bs(s){if(s.subtreeFlags&bo)for(s=s.child;s!==null;)eb(s),s=s.sibling}function eb(s){switch(s.tag){case 26:Bs(s),s.flags&bo&&s.memoizedState!==null&&bE(Nn,s.memoizedState,s.memoizedProps);break;case 5:Bs(s);break;case 3:case 4:var o=Nn;Nn=zc(s.stateNode.containerInfo),Bs(s),Nn=o;break;case 22:s.memoizedState===null&&(o=s.alternate,o!==null&&o.memoizedState!==null?(o=bo,bo=16777216,Bs(s),bo=o):Bs(s));break;default:Bs(s)}}function tb(s){var o=s.alternate;if(o!==null&&(s=o.child,s!==null)){o.child=null;do o=s.sibling,s.sibling=null,s=o;while(s!==null)}}function vo(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];Et=h,rb(h,s)}tb(s)}if(s.subtreeFlags&10256)for(s=s.child;s!==null;)nb(s),s=s.sibling}function nb(s){switch(s.tag){case 0:case 11:case 15:vo(s),s.flags&2048&&Hr(9,s,s.return);break;case 3:vo(s);break;case 12:vo(s);break;case 22:var o=s.stateNode;s.memoizedState!==null&&o._visibility&2&&(s.return===null||s.return.tag!==13)?(o._visibility&=-3,Cc(s)):vo(s);break;default:vo(s)}}function Cc(s){var o=s.deletions;if((s.flags&16)!==0){if(o!==null)for(var u=0;u<o.length;u++){var h=o[u];Et=h,rb(h,s)}tb(s)}for(s=s.child;s!==null;){switch(o=s,o.tag){case 0:case 11:case 15:Hr(8,o,o.return),Cc(o);break;case 22:u=o.stateNode,u._visibility&2&&(u._visibility&=-3,Cc(o));break;default:Cc(o)}s=s.sibling}}function rb(s,o){for(;Et!==null;){var u=Et;switch(u.tag){case 0:case 11:case 15:Hr(8,u,o);break;case 23:case 22:if(u.memoizedState!==null&&u.memoizedState.cachePool!==null){var h=u.memoizedState.cachePool.pool;h!=null&&h.refCount++}break;case 24:to(u.memoizedState.cache)}if(h=u.child,h!==null)h.return=u,Et=h;else e:for(u=s;Et!==null;){h=Et;var g=h.sibling,m=h.return;if(q0(h),h===u){Et=null;break e}if(g!==null){g.return=m,Et=g;break e}Et=m}}}var PA={getCacheForType:function(s){var o=Ut(yt),u=o.data.get(s);return u===void 0&&(u=s(),o.data.set(s,u)),u}},UA=typeof WeakMap=="function"?WeakMap:Map,$e=0,et=null,ke=null,Ue=0,We=0,ln=null,Wr=!1,Fs=!1,xd=!1,Tr=0,ot=0,Xr=0,ki=0,Sd=0,wn=0,Ls=0,To=null,Gt=null,Ad=!1,Ed=0,Mc=1/0,Oc=null,Yr=null,It=0,qr=null,zs=null,Vs=0,Rd=0,Cd=null,ib=null,wo=0,Md=null;function cn(){if(($e&2)!==0&&Ue!==0)return Ue&-Ue;if($.T!==null){var s=Cs;return s!==0?s:Ud()}return vm()}function sb(){wn===0&&(wn=(Ue&536870912)===0||Le?_m():536870912);var s=Tn.current;return s!==null&&(s.flags|=32),wn}function un(s,o,u){(s===et&&(We===2||We===9)||s.cancelPendingCommit!==null)&&(Hs(s,0),Kr(s,Ue,wn,!1)),La(s,u),(($e&2)===0||s!==et)&&(s===et&&(($e&2)===0&&(ki|=u),ot===4&&Kr(s,Ue,wn,!1)),Yn(s))}function ab(s,o,u){if(($e&6)!==0)throw Error(r(327));var h=!u&&(o&124)===0&&(o&s.expiredLanes)===0||Fa(s,o),g=h?LA(s,o):Nd(s,o,!0),m=h;do{if(g===0){Fs&&!h&&Kr(s,o,0,!1);break}else{if(u=s.current.alternate,m&&!BA(u)){g=Nd(s,o,!1),m=!1;continue}if(g===2){if(m=o,s.errorRecoveryDisabledLanes&m)var v=0;else v=s.pendingLanes&-536870913,v=v!==0?v:v&536870912?536870912:0;if(v!==0){o=v;e:{var x=s;g=To;var I=x.current.memoizedState.isDehydrated;if(I&&(Hs(x,v).flags|=256),v=Nd(x,v,!1),v!==2){if(xd&&!I){x.errorRecoveryDisabledLanes|=m,ki|=m,g=4;break e}m=Gt,Gt=g,m!==null&&(Gt===null?Gt=m:Gt.push.apply(Gt,m))}g=v}if(m=!1,g!==2)continue}}if(g===1){Hs(s,0),Kr(s,o,0,!0);break}e:{switch(h=s,m=g,m){case 0:case 1:throw Error(r(345));case 4:if((o&4194048)!==o)break;case 6:Kr(h,o,wn,!Wr);break e;case 2:Gt=null;break;case 3:case 5:break;default:throw Error(r(329))}if((o&62914560)===o&&(g=Ed+300-xt(),10<g)){if(Kr(h,o,wn,!Wr),Vl(h,0,!0)!==0)break e;h.timeoutHandle=Pb(ob.bind(null,h,u,Gt,Oc,Ad,o,wn,ki,Ls,Wr,m,2,-0,0),g);break e}ob(h,u,Gt,Oc,Ad,o,wn,ki,Ls,Wr,m,0,-0,0)}}break}while(!0);Yn(s)}function ob(s,o,u,h,g,m,v,x,I,W,Z,te,X,Y){if(s.timeoutHandle=-1,te=o.subtreeFlags,(te&8192||(te&16785408)===16785408)&&(Mo={stylesheets:null,count:0,unsuspend:yE},eb(o),te=vE(),te!==null)){s.cancelPendingCommit=te(pb.bind(null,s,o,m,u,h,g,v,x,I,Z,1,X,Y)),Kr(s,m,v,!W);return}pb(s,o,m,u,h,g,v,x,I)}function BA(s){for(var o=s;;){var u=o.tag;if((u===0||u===11||u===15)&&o.flags&16384&&(u=o.updateQueue,u!==null&&(u=u.stores,u!==null)))for(var h=0;h<u.length;h++){var g=u[h],m=g.getSnapshot;g=g.value;try{if(!rn(m(),g))return!1}catch{return!1}}if(u=o.child,o.subtreeFlags&16384&&u!==null)u.return=o,o=u;else{if(o===s)break;for(;o.sibling===null;){if(o.return===null||o.return===s)return!0;o=o.return}o.sibling.return=o.return,o=o.sibling}}return!0}function Kr(s,o,u,h){o&=~Sd,o&=~ki,s.suspendedLanes|=o,s.pingedLanes&=~o,h&&(s.warmLanes|=o),h=s.expirationTimes;for(var g=o;0<g;){var m=31-nn(g),v=1<<m;h[m]=-1,g&=~v}u!==0&&ym(s,u,o)}function Ic(){return($e&6)===0?(xo(0),!1):!0}function Od(){if(ke!==null){if(We===0)var s=ke.return;else s=ke,dr=Ri=null,Yh(s),Ds=null,ho=0,s=ke;for(;s!==null;)z0(s.alternate,s),s=s.return;ke=null}}function Hs(s,o){var u=s.timeoutHandle;u!==-1&&(s.timeoutHandle=-1,tE(u)),u=s.cancelPendingCommit,u!==null&&(s.cancelPendingCommit=null,u()),Od(),et=s,ke=u=ur(s.current,null),Ue=o,We=0,ln=null,Wr=!1,Fs=Fa(s,o),xd=!1,Ls=wn=Sd=ki=Xr=ot=0,Gt=To=null,Ad=!1,(o&8)!==0&&(o|=o&32);var h=s.entangledLanes;if(h!==0)for(s=s.entanglements,h&=o;0<h;){var g=31-nn(h),m=1<<g;o|=s[g],h&=~m}return Tr=o,Jl(),u}function lb(s,o){Oe=null,$.H=yc,o===ro||o===lc?(o=Ay(),We=3):o===wy?(o=Ay(),We=4):We=o===E0?8:o!==null&&typeof o=="object"&&typeof o.then=="function"?6:1,ln=o,ke===null&&(ot=1,xc(s,mn(o,s.current)))}function cb(){var s=$.H;return $.H=yc,s===null?yc:s}function ub(){var s=$.A;return $.A=PA,s}function Id(){ot=4,Wr||(Ue&4194048)!==Ue&&Tn.current!==null||(Fs=!0),(Xr&134217727)===0&&(ki&134217727)===0||et===null||Kr(et,Ue,wn,!1)}function Nd(s,o,u){var h=$e;$e|=2;var g=cb(),m=ub();(et!==s||Ue!==o)&&(Oc=null,Hs(s,o)),o=!1;var v=ot;e:do try{if(We!==0&&ke!==null){var x=ke,I=ln;switch(We){case 8:Od(),v=6;break e;case 3:case 2:case 9:case 6:Tn.current===null&&(o=!0);var W=We;if(We=0,ln=null,js(s,x,I,W),u&&Fs){v=0;break e}break;default:W=We,We=0,ln=null,js(s,x,I,W)}}FA(),v=ot;break}catch(Z){lb(s,Z)}while(!0);return o&&s.shellSuspendCounter++,dr=Ri=null,$e=h,$.H=g,$.A=m,ke===null&&(et=null,Ue=0,Jl()),v}function FA(){for(;ke!==null;)fb(ke)}function LA(s,o){var u=$e;$e|=2;var h=cb(),g=ub();et!==s||Ue!==o?(Oc=null,Mc=xt()+500,Hs(s,o)):Fs=Fa(s,o);e:do try{if(We!==0&&ke!==null){o=ke;var m=ln;t:switch(We){case 1:We=0,ln=null,js(s,o,m,1);break;case 2:case 9:if(xy(m)){We=0,ln=null,hb(o);break}o=function(){We!==2&&We!==9||et!==s||(We=7),Yn(s)},m.then(o,o);break e;case 3:We=7;break e;case 4:We=5;break e;case 7:xy(m)?(We=0,ln=null,hb(o)):(We=0,ln=null,js(s,o,m,7));break;case 5:var v=null;switch(ke.tag){case 26:v=ke.memoizedState;case 5:case 27:var x=ke;if(!v||Yb(v)){We=0,ln=null;var I=x.sibling;if(I!==null)ke=I;else{var W=x.return;W!==null?(ke=W,Nc(W)):ke=null}break t}}We=0,ln=null,js(s,o,m,5);break;case 6:We=0,ln=null,js(s,o,m,6);break;case 8:Od(),ot=6;break e;default:throw Error(r(462))}}zA();break}catch(Z){lb(s,Z)}while(!0);return dr=Ri=null,$.H=h,$.A=g,$e=u,ke!==null?0:(et=null,Ue=0,Jl(),ot)}function zA(){for(;ke!==null&&!jt();)fb(ke)}function fb(s){var o=F0(s.alternate,s,Tr);s.memoizedProps=s.pendingProps,o===null?Nc(s):ke=o}function hb(s){var o=s,u=o.alternate;switch(o.tag){case 15:case 0:o=N0(u,o,o.pendingProps,o.type,void 0,Ue);break;case 11:o=N0(u,o,o.pendingProps,o.type.render,o.ref,Ue);break;case 5:Yh(o);default:z0(u,o),o=ke=dy(o,Tr),o=F0(u,o,Tr)}s.memoizedProps=s.pendingProps,o===null?Nc(s):ke=o}function js(s,o,u,h){dr=Ri=null,Yh(o),Ds=null,ho=0;var g=o.return;try{if(MA(s,g,o,u,Ue)){ot=1,xc(s,mn(u,s.current)),ke=null;return}}catch(m){if(g!==null)throw ke=g,m;ot=1,xc(s,mn(u,s.current)),ke=null;return}o.flags&32768?(Le||h===1?s=!0:Fs||(Ue&536870912)!==0?s=!1:(Wr=s=!0,(h===2||h===9||h===3||h===6)&&(h=Tn.current,h!==null&&h.tag===13&&(h.flags|=16384))),db(o,s)):Nc(o)}function Nc(s){var o=s;do{if((o.flags&32768)!==0){db(o,Wr);return}s=o.return;var u=IA(o.alternate,o,Tr);if(u!==null){ke=u;return}if(o=o.sibling,o!==null){ke=o;return}ke=o=s}while(o!==null);ot===0&&(ot=5)}function db(s,o){do{var u=NA(s.alternate,s);if(u!==null){u.flags&=32767,ke=u;return}if(u=s.return,u!==null&&(u.flags|=32768,u.subtreeFlags=0,u.deletions=null),!o&&(s=s.sibling,s!==null)){ke=s;return}ke=s=u}while(s!==null);ot=6,ke=null}function pb(s,o,u,h,g,m,v,x,I){s.cancelPendingCommit=null;do kc();while(It!==0);if(($e&6)!==0)throw Error(r(327));if(o!==null){if(o===s.current)throw Error(r(177));if(m=o.lanes|o.childLanes,m|=wh,yS(s,u,m,v,x,I),s===et&&(ke=et=null,Ue=0),zs=o,qr=s,Vs=u,Rd=m,Cd=g,ib=h,(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?(s.callbackNode=null,s.callbackPriority=0,$A(Fl,function(){return bb(),null})):(s.callbackNode=null,s.callbackPriority=0),h=(o.flags&13878)!==0,(o.subtreeFlags&13878)!==0||h){h=$.T,$.T=null,g=ee.p,ee.p=2,v=$e,$e|=4;try{kA(s,o,u)}finally{$e=v,ee.p=g,$.T=h}}It=1,gb(),_b(),mb()}}function gb(){if(It===1){It=0;var s=qr,o=zs,u=(o.flags&13878)!==0;if((o.subtreeFlags&13878)!==0||u){u=$.T,$.T=null;var h=ee.p;ee.p=2;var g=$e;$e|=4;try{Q0(o,s);var m=$d,v=ry(s.containerInfo),x=m.focusedElem,I=m.selectionRange;if(v!==x&&x&&x.ownerDocument&&ny(x.ownerDocument.documentElement,x)){if(I!==null&&mh(x)){var W=I.start,Z=I.end;if(Z===void 0&&(Z=W),"selectionStart"in x)x.selectionStart=W,x.selectionEnd=Math.min(Z,x.value.length);else{var te=x.ownerDocument||document,X=te&&te.defaultView||window;if(X.getSelection){var Y=X.getSelection(),Se=x.textContent.length,Te=Math.min(I.start,Se),qe=I.end===void 0?Te:Math.min(I.end,Se);!Y.extend&&Te>qe&&(v=qe,qe=Te,Te=v);var L=ty(x,Te),P=ty(x,qe);if(L&&P&&(Y.rangeCount!==1||Y.anchorNode!==L.node||Y.anchorOffset!==L.offset||Y.focusNode!==P.node||Y.focusOffset!==P.offset)){var j=te.createRange();j.setStart(L.node,L.offset),Y.removeAllRanges(),Te>qe?(Y.addRange(j),Y.extend(P.node,P.offset)):(j.setEnd(P.node,P.offset),Y.addRange(j))}}}}for(te=[],Y=x;Y=Y.parentNode;)Y.nodeType===1&&te.push({element:Y,left:Y.scrollLeft,top:Y.scrollTop});for(typeof x.focus=="function"&&x.focus(),x=0;x<te.length;x++){var Q=te[x];Q.element.scrollLeft=Q.left,Q.element.scrollTop=Q.top}}Wc=!!jd,$d=jd=null}finally{$e=g,ee.p=h,$.T=u}}s.current=o,It=2}}function _b(){if(It===2){It=0;var s=qr,o=zs,u=(o.flags&8772)!==0;if((o.subtreeFlags&8772)!==0||u){u=$.T,$.T=null;var h=ee.p;ee.p=2;var g=$e;$e|=4;try{Y0(s,o.alternate,o)}finally{$e=g,ee.p=h,$.T=u}}It=3}}function mb(){if(It===4||It===3){It=0,$t();var s=qr,o=zs,u=Vs,h=ib;(o.subtreeFlags&10256)!==0||(o.flags&10256)!==0?It=5:(It=0,zs=qr=null,yb(s,s.pendingLanes));var g=s.pendingLanes;if(g===0&&(Yr=null),Zf(u),o=o.stateNode,tn&&typeof tn.onCommitFiberRoot=="function")try{tn.onCommitFiberRoot(Ba,o,void 0,(o.current.flags&128)===128)}catch{}if(h!==null){o=$.T,g=ee.p,ee.p=2,$.T=null;try{for(var m=s.onRecoverableError,v=0;v<h.length;v++){var x=h[v];m(x.value,{componentStack:x.stack})}}finally{$.T=o,ee.p=g}}(Vs&3)!==0&&kc(),Yn(s),g=s.pendingLanes,(u&4194090)!==0&&(g&42)!==0?s===Md?wo++:(wo=0,Md=s):wo=0,xo(0)}}function yb(s,o){(s.pooledCacheLanes&=o)===0&&(o=s.pooledCache,o!=null&&(s.pooledCache=null,to(o)))}function kc(s){return gb(),_b(),mb(),bb()}function bb(){if(It!==5)return!1;var s=qr,o=Rd;Rd=0;var u=Zf(Vs),h=$.T,g=ee.p;try{ee.p=32>u?32:u,$.T=null,u=Cd,Cd=null;var m=qr,v=Vs;if(It=0,zs=qr=null,Vs=0,($e&6)!==0)throw Error(r(331));var x=$e;if($e|=4,nb(m.current),J0(m,m.current,v,u),$e=x,xo(0,!1),tn&&typeof tn.onPostCommitFiberRoot=="function")try{tn.onPostCommitFiberRoot(Ba,m)}catch{}return!0}finally{ee.p=g,$.T=h,yb(s,o)}}function vb(s,o,u){o=mn(u,o),o=od(s.stateNode,o,2),s=Fr(s,o,2),s!==null&&(La(s,2),Yn(s))}function Qe(s,o,u){if(s.tag===3)vb(s,s,u);else for(;o!==null;){if(o.tag===3){vb(o,s,u);break}else if(o.tag===1){var h=o.stateNode;if(typeof o.type.getDerivedStateFromError=="function"||typeof h.componentDidCatch=="function"&&(Yr===null||!Yr.has(h))){s=mn(u,s),u=S0(2),h=Fr(o,u,2),h!==null&&(A0(u,h,o,s),La(h,2),Yn(h));break}}o=o.return}}function kd(s,o,u){var h=s.pingCache;if(h===null){h=s.pingCache=new UA;var g=new Set;h.set(o,g)}else g=h.get(o),g===void 0&&(g=new Set,h.set(o,g));g.has(u)||(xd=!0,g.add(u),s=VA.bind(null,s,o,u),o.then(s,s))}function VA(s,o,u){var h=s.pingCache;h!==null&&h.delete(o),s.pingedLanes|=s.suspendedLanes&u,s.warmLanes&=~u,et===s&&(Ue&u)===u&&(ot===4||ot===3&&(Ue&62914560)===Ue&&300>xt()-Ed?($e&2)===0&&Hs(s,0):Sd|=u,Ls===Ue&&(Ls=0)),Yn(s)}function Tb(s,o){o===0&&(o=mm()),s=Ss(s,o),s!==null&&(La(s,o),Yn(s))}function HA(s){var o=s.memoizedState,u=0;o!==null&&(u=o.retryLane),Tb(s,u)}function jA(s,o){var u=0;switch(s.tag){case 13:var h=s.stateNode,g=s.memoizedState;g!==null&&(u=g.retryLane);break;case 19:h=s.stateNode;break;case 22:h=s.stateNode._retryCache;break;default:throw Error(r(314))}h!==null&&h.delete(o),Tb(s,u)}function $A(s,o){return wt(s,o)}var Dc=null,$s=null,Dd=!1,Pc=!1,Pd=!1,Di=0;function Yn(s){s!==$s&&s.next===null&&($s===null?Dc=$s=s:$s=$s.next=s),Pc=!0,Dd||(Dd=!0,XA())}function xo(s,o){if(!Pd&&Pc){Pd=!0;do for(var u=!1,h=Dc;h!==null;){if(s!==0){var g=h.pendingLanes;if(g===0)var m=0;else{var v=h.suspendedLanes,x=h.pingedLanes;m=(1<<31-nn(42|s)+1)-1,m&=g&~(v&~x),m=m&201326741?m&201326741|1:m?m|2:0}m!==0&&(u=!0,Ab(h,m))}else m=Ue,m=Vl(h,h===et?m:0,h.cancelPendingCommit!==null||h.timeoutHandle!==-1),(m&3)===0||Fa(h,m)||(u=!0,Ab(h,m));h=h.next}while(u);Pd=!1}}function WA(){wb()}function wb(){Pc=Dd=!1;var s=0;Di!==0&&(eE()&&(s=Di),Di=0);for(var o=xt(),u=null,h=Dc;h!==null;){var g=h.next,m=xb(h,o);m===0?(h.next=null,u===null?Dc=g:u.next=g,g===null&&($s=u)):(u=h,(s!==0||(m&3)!==0)&&(Pc=!0)),h=g}xo(s)}function xb(s,o){for(var u=s.suspendedLanes,h=s.pingedLanes,g=s.expirationTimes,m=s.pendingLanes&-62914561;0<m;){var v=31-nn(m),x=1<<v,I=g[v];I===-1?((x&u)===0||(x&h)!==0)&&(g[v]=mS(x,o)):I<=o&&(s.expiredLanes|=x),m&=~x}if(o=et,u=Ue,u=Vl(s,s===o?u:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h=s.callbackNode,u===0||s===o&&(We===2||We===9)||s.cancelPendingCommit!==null)return h!==null&&h!==null&&He(h),s.callbackNode=null,s.callbackPriority=0;if((u&3)===0||Fa(s,u)){if(o=u&-u,o===s.callbackPriority)return o;switch(h!==null&&He(h),Zf(u)){case 2:case 8:u=pm;break;case 32:u=Fl;break;case 268435456:u=gm;break;default:u=Fl}return h=Sb.bind(null,s),u=wt(u,h),s.callbackPriority=o,s.callbackNode=u,o}return h!==null&&h!==null&&He(h),s.callbackPriority=2,s.callbackNode=null,2}function Sb(s,o){if(It!==0&&It!==5)return s.callbackNode=null,s.callbackPriority=0,null;var u=s.callbackNode;if(kc()&&s.callbackNode!==u)return null;var h=Ue;return h=Vl(s,s===et?h:0,s.cancelPendingCommit!==null||s.timeoutHandle!==-1),h===0?null:(ab(s,h,o),xb(s,xt()),s.callbackNode!=null&&s.callbackNode===u?Sb.bind(null,s):null)}function Ab(s,o){if(kc())return null;ab(s,o,!0)}function XA(){nE(function(){($e&6)!==0?wt(dm,WA):wb()})}function Ud(){return Di===0&&(Di=_m()),Di}function Eb(s){return s==null||typeof s=="symbol"||typeof s=="boolean"?null:typeof s=="function"?s:Xl(""+s)}function Rb(s,o){var u=o.ownerDocument.createElement("input");return u.name=o.name,u.value=o.value,s.id&&u.setAttribute("form",s.id),o.parentNode.insertBefore(u,o),s=new FormData(s),u.parentNode.removeChild(u),s}function YA(s,o,u,h,g){if(o==="submit"&&u&&u.stateNode===g){var m=Eb((g[qt]||null).action),v=h.submitter;v&&(o=(o=v[qt]||null)?Eb(o.formAction):v.getAttribute("formAction"),o!==null&&(m=o,v=null));var x=new Zl("action","action",null,h,g);s.push({event:x,listeners:[{instance:null,listener:function(){if(h.defaultPrevented){if(Di!==0){var I=v?Rb(g,v):new FormData(g);nd(u,{pending:!0,data:I,method:g.method,action:m},null,I)}}else typeof m=="function"&&(x.preventDefault(),I=v?Rb(g,v):new FormData(g),nd(u,{pending:!0,data:I,method:g.method,action:m},m,I))},currentTarget:g}]})}}for(var Bd=0;Bd<Th.length;Bd++){var Fd=Th[Bd],qA=Fd.toLowerCase(),KA=Fd[0].toUpperCase()+Fd.slice(1);In(qA,"on"+KA)}In(ay,"onAnimationEnd"),In(oy,"onAnimationIteration"),In(ly,"onAnimationStart"),In("dblclick","onDoubleClick"),In("focusin","onFocus"),In("focusout","onBlur"),In(hA,"onTransitionRun"),In(dA,"onTransitionStart"),In(pA,"onTransitionCancel"),In(cy,"onTransitionEnd"),ps("onMouseEnter",["mouseout","mouseover"]),ps("onMouseLeave",["mouseout","mouseover"]),ps("onPointerEnter",["pointerout","pointerover"]),ps("onPointerLeave",["pointerout","pointerover"]),yi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),yi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),yi("onBeforeInput",["compositionend","keypress","textInput","paste"]),yi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),yi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var So="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ZA=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(So));function Cb(s,o){o=(o&4)!==0;for(var u=0;u<s.length;u++){var h=s[u],g=h.event;h=h.listeners;e:{var m=void 0;if(o)for(var v=h.length-1;0<=v;v--){var x=h[v],I=x.instance,W=x.currentTarget;if(x=x.listener,I!==m&&g.isPropagationStopped())break e;m=x,g.currentTarget=W;try{m(g)}catch(Z){wc(Z)}g.currentTarget=null,m=I}else for(v=0;v<h.length;v++){if(x=h[v],I=x.instance,W=x.currentTarget,x=x.listener,I!==m&&g.isPropagationStopped())break e;m=x,g.currentTarget=W;try{m(g)}catch(Z){wc(Z)}g.currentTarget=null,m=I}}}}function De(s,o){var u=o[Qf];u===void 0&&(u=o[Qf]=new Set);var h=s+"__bubble";u.has(h)||(Mb(o,s,2,!1),u.add(h))}function Ld(s,o,u){var h=0;o&&(h|=4),Mb(u,s,h,o)}var Uc="_reactListening"+Math.random().toString(36).slice(2);function zd(s){if(!s[Uc]){s[Uc]=!0,wm.forEach(function(u){u!=="selectionchange"&&(ZA.has(u)||Ld(u,!1,s),Ld(u,!0,s))});var o=s.nodeType===9?s:s.ownerDocument;o===null||o[Uc]||(o[Uc]=!0,Ld("selectionchange",!1,o))}}function Mb(s,o,u,h){switch(Jb(o)){case 2:var g=xE;break;case 8:g=SE;break;default:g=ep}u=g.bind(null,o,u,s),g=void 0,!lh||o!=="touchstart"&&o!=="touchmove"&&o!=="wheel"||(g=!0),h?g!==void 0?s.addEventListener(o,u,{capture:!0,passive:g}):s.addEventListener(o,u,!0):g!==void 0?s.addEventListener(o,u,{passive:g}):s.addEventListener(o,u,!1)}function Vd(s,o,u,h,g){var m=h;if((o&1)===0&&(o&2)===0&&h!==null)e:for(;;){if(h===null)return;var v=h.tag;if(v===3||v===4){var x=h.stateNode.containerInfo;if(x===g)break;if(v===4)for(v=h.return;v!==null;){var I=v.tag;if((I===3||I===4)&&v.stateNode.containerInfo===g)return;v=v.return}for(;x!==null;){if(v=fs(x),v===null)return;if(I=v.tag,I===5||I===6||I===26||I===27){h=m=v;continue e}x=x.parentNode}}h=h.return}Um(function(){var W=m,Z=ah(u),te=[];e:{var X=uy.get(s);if(X!==void 0){var Y=Zl,Se=s;switch(s){case"keypress":if(ql(u)===0)break e;case"keydown":case"keyup":Y=$S;break;case"focusin":Se="focus",Y=hh;break;case"focusout":Se="blur",Y=hh;break;case"beforeblur":case"afterblur":Y=hh;break;case"click":if(u.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Y=Lm;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Y=NS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Y=YS;break;case ay:case oy:case ly:Y=PS;break;case cy:Y=KS;break;case"scroll":case"scrollend":Y=OS;break;case"wheel":Y=QS;break;case"copy":case"cut":case"paste":Y=BS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Y=Vm;break;case"toggle":case"beforetoggle":Y=JS}var Te=(o&4)!==0,qe=!Te&&(s==="scroll"||s==="scrollend"),L=Te?X!==null?X+"Capture":null:X;Te=[];for(var P=W,j;P!==null;){var Q=P;if(j=Q.stateNode,Q=Q.tag,Q!==5&&Q!==26&&Q!==27||j===null||L===null||(Q=Ha(P,L),Q!=null&&Te.push(Ao(P,Q,j))),qe)break;P=P.return}0<Te.length&&(X=new Y(X,Se,null,u,Z),te.push({event:X,listeners:Te}))}}if((o&7)===0){e:{if(X=s==="mouseover"||s==="pointerover",Y=s==="mouseout"||s==="pointerout",X&&u!==sh&&(Se=u.relatedTarget||u.fromElement)&&(fs(Se)||Se[us]))break e;if((Y||X)&&(X=Z.window===Z?Z:(X=Z.ownerDocument)?X.defaultView||X.parentWindow:window,Y?(Se=u.relatedTarget||u.toElement,Y=W,Se=Se?fs(Se):null,Se!==null&&(qe=a(Se),Te=Se.tag,Se!==qe||Te!==5&&Te!==27&&Te!==6)&&(Se=null)):(Y=null,Se=W),Y!==Se)){if(Te=Lm,Q="onMouseLeave",L="onMouseEnter",P="mouse",(s==="pointerout"||s==="pointerover")&&(Te=Vm,Q="onPointerLeave",L="onPointerEnter",P="pointer"),qe=Y==null?X:Va(Y),j=Se==null?X:Va(Se),X=new Te(Q,P+"leave",Y,u,Z),X.target=qe,X.relatedTarget=j,Q=null,fs(Z)===W&&(Te=new Te(L,P+"enter",Se,u,Z),Te.target=j,Te.relatedTarget=qe,Q=Te),qe=Q,Y&&Se)t:{for(Te=Y,L=Se,P=0,j=Te;j;j=Ws(j))P++;for(j=0,Q=L;Q;Q=Ws(Q))j++;for(;0<P-j;)Te=Ws(Te),P--;for(;0<j-P;)L=Ws(L),j--;for(;P--;){if(Te===L||L!==null&&Te===L.alternate)break t;Te=Ws(Te),L=Ws(L)}Te=null}else Te=null;Y!==null&&Ob(te,X,Y,Te,!1),Se!==null&&qe!==null&&Ob(te,qe,Se,Te,!0)}}e:{if(X=W?Va(W):window,Y=X.nodeName&&X.nodeName.toLowerCase(),Y==="select"||Y==="input"&&X.type==="file")var ye=Km;else if(Ym(X))if(Zm)ye=cA;else{ye=oA;var Ie=aA}else Y=X.nodeName,!Y||Y.toLowerCase()!=="input"||X.type!=="checkbox"&&X.type!=="radio"?W&&ih(W.elementType)&&(ye=Km):ye=lA;if(ye&&(ye=ye(s,W))){qm(te,ye,u,Z);break e}Ie&&Ie(s,X,W),s==="focusout"&&W&&X.type==="number"&&W.memoizedProps.value!=null&&rh(X,"number",X.value)}switch(Ie=W?Va(W):window,s){case"focusin":(Ym(Ie)||Ie.contentEditable==="true")&&(Ts=Ie,yh=W,Za=null);break;case"focusout":Za=yh=Ts=null;break;case"mousedown":bh=!0;break;case"contextmenu":case"mouseup":case"dragend":bh=!1,iy(te,u,Z);break;case"selectionchange":if(fA)break;case"keydown":case"keyup":iy(te,u,Z)}var be;if(ph)e:{switch(s){case"compositionstart":var we="onCompositionStart";break e;case"compositionend":we="onCompositionEnd";break e;case"compositionupdate":we="onCompositionUpdate";break e}we=void 0}else vs?Wm(s,u)&&(we="onCompositionEnd"):s==="keydown"&&u.keyCode===229&&(we="onCompositionStart");we&&(Hm&&u.locale!=="ko"&&(vs||we!=="onCompositionStart"?we==="onCompositionEnd"&&vs&&(be=Bm()):(Dr=Z,ch="value"in Dr?Dr.value:Dr.textContent,vs=!0)),Ie=Bc(W,we),0<Ie.length&&(we=new zm(we,s,null,u,Z),te.push({event:we,listeners:Ie}),be?we.data=be:(be=Xm(u),be!==null&&(we.data=be)))),(be=tA?nA(s,u):rA(s,u))&&(we=Bc(W,"onBeforeInput"),0<we.length&&(Ie=new zm("onBeforeInput","beforeinput",null,u,Z),te.push({event:Ie,listeners:we}),Ie.data=be)),YA(te,s,W,u,Z)}Cb(te,o)})}function Ao(s,o,u){return{instance:s,listener:o,currentTarget:u}}function Bc(s,o){for(var u=o+"Capture",h=[];s!==null;){var g=s,m=g.stateNode;if(g=g.tag,g!==5&&g!==26&&g!==27||m===null||(g=Ha(s,u),g!=null&&h.unshift(Ao(s,g,m)),g=Ha(s,o),g!=null&&h.push(Ao(s,g,m))),s.tag===3)return h;s=s.return}return[]}function Ws(s){if(s===null)return null;do s=s.return;while(s&&s.tag!==5&&s.tag!==27);return s||null}function Ob(s,o,u,h,g){for(var m=o._reactName,v=[];u!==null&&u!==h;){var x=u,I=x.alternate,W=x.stateNode;if(x=x.tag,I!==null&&I===h)break;x!==5&&x!==26&&x!==27||W===null||(I=W,g?(W=Ha(u,m),W!=null&&v.unshift(Ao(u,W,I))):g||(W=Ha(u,m),W!=null&&v.push(Ao(u,W,I)))),u=u.return}v.length!==0&&s.push({event:o,listeners:v})}var QA=/\r\n?/g,GA=/\u0000|\uFFFD/g;function Ib(s){return(typeof s=="string"?s:""+s).replace(QA,`
`).replace(GA,"")}function Nb(s,o){return o=Ib(o),Ib(s)===o}function Fc(){}function Ye(s,o,u,h,g,m){switch(u){case"children":typeof h=="string"?o==="body"||o==="textarea"&&h===""||ms(s,h):(typeof h=="number"||typeof h=="bigint")&&o!=="body"&&ms(s,""+h);break;case"className":jl(s,"class",h);break;case"tabIndex":jl(s,"tabindex",h);break;case"dir":case"role":case"viewBox":case"width":case"height":jl(s,u,h);break;case"style":Dm(s,h,m);break;case"data":if(o!=="object"){jl(s,"data",h);break}case"src":case"href":if(h===""&&(o!=="a"||u!=="href")){s.removeAttribute(u);break}if(h==null||typeof h=="function"||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Xl(""+h),s.setAttribute(u,h);break;case"action":case"formAction":if(typeof h=="function"){s.setAttribute(u,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof m=="function"&&(u==="formAction"?(o!=="input"&&Ye(s,o,"name",g.name,g,null),Ye(s,o,"formEncType",g.formEncType,g,null),Ye(s,o,"formMethod",g.formMethod,g,null),Ye(s,o,"formTarget",g.formTarget,g,null)):(Ye(s,o,"encType",g.encType,g,null),Ye(s,o,"method",g.method,g,null),Ye(s,o,"target",g.target,g,null)));if(h==null||typeof h=="symbol"||typeof h=="boolean"){s.removeAttribute(u);break}h=Xl(""+h),s.setAttribute(u,h);break;case"onClick":h!=null&&(s.onclick=Fc);break;case"onScroll":h!=null&&De("scroll",s);break;case"onScrollEnd":h!=null&&De("scrollend",s);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"multiple":s.multiple=h&&typeof h!="function"&&typeof h!="symbol";break;case"muted":s.muted=h&&typeof h!="function"&&typeof h!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(h==null||typeof h=="function"||typeof h=="boolean"||typeof h=="symbol"){s.removeAttribute("xlink:href");break}u=Xl(""+h),s.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",u);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""+h):s.removeAttribute(u);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":h&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,""):s.removeAttribute(u);break;case"capture":case"download":h===!0?s.setAttribute(u,""):h!==!1&&h!=null&&typeof h!="function"&&typeof h!="symbol"?s.setAttribute(u,h):s.removeAttribute(u);break;case"cols":case"rows":case"size":case"span":h!=null&&typeof h!="function"&&typeof h!="symbol"&&!isNaN(h)&&1<=h?s.setAttribute(u,h):s.removeAttribute(u);break;case"rowSpan":case"start":h==null||typeof h=="function"||typeof h=="symbol"||isNaN(h)?s.removeAttribute(u):s.setAttribute(u,h);break;case"popover":De("beforetoggle",s),De("toggle",s),Hl(s,"popover",h);break;case"xlinkActuate":lr(s,"http://www.w3.org/1999/xlink","xlink:actuate",h);break;case"xlinkArcrole":lr(s,"http://www.w3.org/1999/xlink","xlink:arcrole",h);break;case"xlinkRole":lr(s,"http://www.w3.org/1999/xlink","xlink:role",h);break;case"xlinkShow":lr(s,"http://www.w3.org/1999/xlink","xlink:show",h);break;case"xlinkTitle":lr(s,"http://www.w3.org/1999/xlink","xlink:title",h);break;case"xlinkType":lr(s,"http://www.w3.org/1999/xlink","xlink:type",h);break;case"xmlBase":lr(s,"http://www.w3.org/XML/1998/namespace","xml:base",h);break;case"xmlLang":lr(s,"http://www.w3.org/XML/1998/namespace","xml:lang",h);break;case"xmlSpace":lr(s,"http://www.w3.org/XML/1998/namespace","xml:space",h);break;case"is":Hl(s,"is",h);break;case"innerText":case"textContent":break;default:(!(2<u.length)||u[0]!=="o"&&u[0]!=="O"||u[1]!=="n"&&u[1]!=="N")&&(u=CS.get(u)||u,Hl(s,u,h))}}function Hd(s,o,u,h,g,m){switch(u){case"style":Dm(s,h,m);break;case"dangerouslySetInnerHTML":if(h!=null){if(typeof h!="object"||!("__html"in h))throw Error(r(61));if(u=h.__html,u!=null){if(g.children!=null)throw Error(r(60));s.innerHTML=u}}break;case"children":typeof h=="string"?ms(s,h):(typeof h=="number"||typeof h=="bigint")&&ms(s,""+h);break;case"onScroll":h!=null&&De("scroll",s);break;case"onScrollEnd":h!=null&&De("scrollend",s);break;case"onClick":h!=null&&(s.onclick=Fc);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!xm.hasOwnProperty(u))e:{if(u[0]==="o"&&u[1]==="n"&&(g=u.endsWith("Capture"),o=u.slice(2,g?u.length-7:void 0),m=s[qt]||null,m=m!=null?m[u]:null,typeof m=="function"&&s.removeEventListener(o,m,g),typeof h=="function")){typeof m!="function"&&m!==null&&(u in s?s[u]=null:s.hasAttribute(u)&&s.removeAttribute(u)),s.addEventListener(o,h,g);break e}u in s?s[u]=h:h===!0?s.setAttribute(u,""):Hl(s,u,h)}}}function Nt(s,o,u){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":De("error",s),De("load",s);var h=!1,g=!1,m;for(m in u)if(u.hasOwnProperty(m)){var v=u[m];if(v!=null)switch(m){case"src":h=!0;break;case"srcSet":g=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Ye(s,o,m,v,u,null)}}g&&Ye(s,o,"srcSet",u.srcSet,u,null),h&&Ye(s,o,"src",u.src,u,null);return;case"input":De("invalid",s);var x=m=v=g=null,I=null,W=null;for(h in u)if(u.hasOwnProperty(h)){var Z=u[h];if(Z!=null)switch(h){case"name":g=Z;break;case"type":v=Z;break;case"checked":I=Z;break;case"defaultChecked":W=Z;break;case"value":m=Z;break;case"defaultValue":x=Z;break;case"children":case"dangerouslySetInnerHTML":if(Z!=null)throw Error(r(137,o));break;default:Ye(s,o,h,Z,u,null)}}Om(s,m,x,I,W,v,g,!1),$l(s);return;case"select":De("invalid",s),h=v=m=null;for(g in u)if(u.hasOwnProperty(g)&&(x=u[g],x!=null))switch(g){case"value":m=x;break;case"defaultValue":v=x;break;case"multiple":h=x;default:Ye(s,o,g,x,u,null)}o=m,u=v,s.multiple=!!h,o!=null?_s(s,!!h,o,!1):u!=null&&_s(s,!!h,u,!0);return;case"textarea":De("invalid",s),m=g=h=null;for(v in u)if(u.hasOwnProperty(v)&&(x=u[v],x!=null))switch(v){case"value":h=x;break;case"defaultValue":g=x;break;case"children":m=x;break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:Ye(s,o,v,x,u,null)}Nm(s,h,g,m),$l(s);return;case"option":for(I in u)if(u.hasOwnProperty(I)&&(h=u[I],h!=null))switch(I){case"selected":s.selected=h&&typeof h!="function"&&typeof h!="symbol";break;default:Ye(s,o,I,h,u,null)}return;case"dialog":De("beforetoggle",s),De("toggle",s),De("cancel",s),De("close",s);break;case"iframe":case"object":De("load",s);break;case"video":case"audio":for(h=0;h<So.length;h++)De(So[h],s);break;case"image":De("error",s),De("load",s);break;case"details":De("toggle",s);break;case"embed":case"source":case"link":De("error",s),De("load",s);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(W in u)if(u.hasOwnProperty(W)&&(h=u[W],h!=null))switch(W){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,o));default:Ye(s,o,W,h,u,null)}return;default:if(ih(o)){for(Z in u)u.hasOwnProperty(Z)&&(h=u[Z],h!==void 0&&Hd(s,o,Z,h,u,void 0));return}}for(x in u)u.hasOwnProperty(x)&&(h=u[x],h!=null&&Ye(s,o,x,h,u,null))}function JA(s,o,u,h){switch(o){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var g=null,m=null,v=null,x=null,I=null,W=null,Z=null;for(Y in u){var te=u[Y];if(u.hasOwnProperty(Y)&&te!=null)switch(Y){case"checked":break;case"value":break;case"defaultValue":I=te;default:h.hasOwnProperty(Y)||Ye(s,o,Y,null,h,te)}}for(var X in h){var Y=h[X];if(te=u[X],h.hasOwnProperty(X)&&(Y!=null||te!=null))switch(X){case"type":m=Y;break;case"name":g=Y;break;case"checked":W=Y;break;case"defaultChecked":Z=Y;break;case"value":v=Y;break;case"defaultValue":x=Y;break;case"children":case"dangerouslySetInnerHTML":if(Y!=null)throw Error(r(137,o));break;default:Y!==te&&Ye(s,o,X,Y,h,te)}}nh(s,v,x,I,W,Z,m,g);return;case"select":Y=v=x=X=null;for(m in u)if(I=u[m],u.hasOwnProperty(m)&&I!=null)switch(m){case"value":break;case"multiple":Y=I;default:h.hasOwnProperty(m)||Ye(s,o,m,null,h,I)}for(g in h)if(m=h[g],I=u[g],h.hasOwnProperty(g)&&(m!=null||I!=null))switch(g){case"value":X=m;break;case"defaultValue":x=m;break;case"multiple":v=m;default:m!==I&&Ye(s,o,g,m,h,I)}o=x,u=v,h=Y,X!=null?_s(s,!!u,X,!1):!!h!=!!u&&(o!=null?_s(s,!!u,o,!0):_s(s,!!u,u?[]:"",!1));return;case"textarea":Y=X=null;for(x in u)if(g=u[x],u.hasOwnProperty(x)&&g!=null&&!h.hasOwnProperty(x))switch(x){case"value":break;case"children":break;default:Ye(s,o,x,null,h,g)}for(v in h)if(g=h[v],m=u[v],h.hasOwnProperty(v)&&(g!=null||m!=null))switch(v){case"value":X=g;break;case"defaultValue":Y=g;break;case"children":break;case"dangerouslySetInnerHTML":if(g!=null)throw Error(r(91));break;default:g!==m&&Ye(s,o,v,g,h,m)}Im(s,X,Y);return;case"option":for(var Se in u)if(X=u[Se],u.hasOwnProperty(Se)&&X!=null&&!h.hasOwnProperty(Se))switch(Se){case"selected":s.selected=!1;break;default:Ye(s,o,Se,null,h,X)}for(I in h)if(X=h[I],Y=u[I],h.hasOwnProperty(I)&&X!==Y&&(X!=null||Y!=null))switch(I){case"selected":s.selected=X&&typeof X!="function"&&typeof X!="symbol";break;default:Ye(s,o,I,X,h,Y)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Te in u)X=u[Te],u.hasOwnProperty(Te)&&X!=null&&!h.hasOwnProperty(Te)&&Ye(s,o,Te,null,h,X);for(W in h)if(X=h[W],Y=u[W],h.hasOwnProperty(W)&&X!==Y&&(X!=null||Y!=null))switch(W){case"children":case"dangerouslySetInnerHTML":if(X!=null)throw Error(r(137,o));break;default:Ye(s,o,W,X,h,Y)}return;default:if(ih(o)){for(var qe in u)X=u[qe],u.hasOwnProperty(qe)&&X!==void 0&&!h.hasOwnProperty(qe)&&Hd(s,o,qe,void 0,h,X);for(Z in h)X=h[Z],Y=u[Z],!h.hasOwnProperty(Z)||X===Y||X===void 0&&Y===void 0||Hd(s,o,Z,X,h,Y);return}}for(var L in u)X=u[L],u.hasOwnProperty(L)&&X!=null&&!h.hasOwnProperty(L)&&Ye(s,o,L,null,h,X);for(te in h)X=h[te],Y=u[te],!h.hasOwnProperty(te)||X===Y||X==null&&Y==null||Ye(s,o,te,X,h,Y)}var jd=null,$d=null;function Lc(s){return s.nodeType===9?s:s.ownerDocument}function kb(s){switch(s){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function Db(s,o){if(s===0)switch(o){case"svg":return 1;case"math":return 2;default:return 0}return s===1&&o==="foreignObject"?0:s}function Wd(s,o){return s==="textarea"||s==="noscript"||typeof o.children=="string"||typeof o.children=="number"||typeof o.children=="bigint"||typeof o.dangerouslySetInnerHTML=="object"&&o.dangerouslySetInnerHTML!==null&&o.dangerouslySetInnerHTML.__html!=null}var Xd=null;function eE(){var s=window.event;return s&&s.type==="popstate"?s===Xd?!1:(Xd=s,!0):(Xd=null,!1)}var Pb=typeof setTimeout=="function"?setTimeout:void 0,tE=typeof clearTimeout=="function"?clearTimeout:void 0,Ub=typeof Promise=="function"?Promise:void 0,nE=typeof queueMicrotask=="function"?queueMicrotask:typeof Ub<"u"?function(s){return Ub.resolve(null).then(s).catch(rE)}:Pb;function rE(s){setTimeout(function(){throw s})}function Zr(s){return s==="head"}function Bb(s,o){var u=o,h=0,g=0;do{var m=u.nextSibling;if(s.removeChild(u),m&&m.nodeType===8)if(u=m.data,u==="/$"){if(0<h&&8>h){u=h;var v=s.ownerDocument;if(u&1&&Eo(v.documentElement),u&2&&Eo(v.body),u&4)for(u=v.head,Eo(u),v=u.firstChild;v;){var x=v.nextSibling,I=v.nodeName;v[za]||I==="SCRIPT"||I==="STYLE"||I==="LINK"&&v.rel.toLowerCase()==="stylesheet"||u.removeChild(v),v=x}}if(g===0){s.removeChild(m),Do(o);return}g--}else u==="$"||u==="$?"||u==="$!"?g++:h=u.charCodeAt(0)-48;else h=0;u=m}while(u);Do(o)}function Yd(s){var o=s.firstChild;for(o&&o.nodeType===10&&(o=o.nextSibling);o;){var u=o;switch(o=o.nextSibling,u.nodeName){case"HTML":case"HEAD":case"BODY":Yd(u),Gf(u);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(u.rel.toLowerCase()==="stylesheet")continue}s.removeChild(u)}}function iE(s,o,u,h){for(;s.nodeType===1;){var g=u;if(s.nodeName.toLowerCase()!==o.toLowerCase()){if(!h&&(s.nodeName!=="INPUT"||s.type!=="hidden"))break}else if(h){if(!s[za])switch(o){case"meta":if(!s.hasAttribute("itemprop"))break;return s;case"link":if(m=s.getAttribute("rel"),m==="stylesheet"&&s.hasAttribute("data-precedence"))break;if(m!==g.rel||s.getAttribute("href")!==(g.href==null||g.href===""?null:g.href)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin)||s.getAttribute("title")!==(g.title==null?null:g.title))break;return s;case"style":if(s.hasAttribute("data-precedence"))break;return s;case"script":if(m=s.getAttribute("src"),(m!==(g.src==null?null:g.src)||s.getAttribute("type")!==(g.type==null?null:g.type)||s.getAttribute("crossorigin")!==(g.crossOrigin==null?null:g.crossOrigin))&&m&&s.hasAttribute("async")&&!s.hasAttribute("itemprop"))break;return s;default:return s}}else if(o==="input"&&s.type==="hidden"){var m=g.name==null?null:""+g.name;if(g.type==="hidden"&&s.getAttribute("name")===m)return s}else return s;if(s=kn(s.nextSibling),s===null)break}return null}function sE(s,o,u){if(o==="")return null;for(;s.nodeType!==3;)if((s.nodeType!==1||s.nodeName!=="INPUT"||s.type!=="hidden")&&!u||(s=kn(s.nextSibling),s===null))return null;return s}function qd(s){return s.data==="$!"||s.data==="$?"&&s.ownerDocument.readyState==="complete"}function aE(s,o){var u=s.ownerDocument;if(s.data!=="$?"||u.readyState==="complete")o();else{var h=function(){o(),u.removeEventListener("DOMContentLoaded",h)};u.addEventListener("DOMContentLoaded",h),s._reactRetry=h}}function kn(s){for(;s!=null;s=s.nextSibling){var o=s.nodeType;if(o===1||o===3)break;if(o===8){if(o=s.data,o==="$"||o==="$!"||o==="$?"||o==="F!"||o==="F")break;if(o==="/$")return null}}return s}var Kd=null;function Fb(s){s=s.previousSibling;for(var o=0;s;){if(s.nodeType===8){var u=s.data;if(u==="$"||u==="$!"||u==="$?"){if(o===0)return s;o--}else u==="/$"&&o++}s=s.previousSibling}return null}function Lb(s,o,u){switch(o=Lc(u),s){case"html":if(s=o.documentElement,!s)throw Error(r(452));return s;case"head":if(s=o.head,!s)throw Error(r(453));return s;case"body":if(s=o.body,!s)throw Error(r(454));return s;default:throw Error(r(451))}}function Eo(s){for(var o=s.attributes;o.length;)s.removeAttributeNode(o[0]);Gf(s)}var xn=new Map,zb=new Set;function zc(s){return typeof s.getRootNode=="function"?s.getRootNode():s.nodeType===9?s:s.ownerDocument}var wr=ee.d;ee.d={f:oE,r:lE,D:cE,C:uE,L:fE,m:hE,X:pE,S:dE,M:gE};function oE(){var s=wr.f(),o=Ic();return s||o}function lE(s){var o=hs(s);o!==null&&o.tag===5&&o.type==="form"?a0(o):wr.r(s)}var Xs=typeof document>"u"?null:document;function Vb(s,o,u){var h=Xs;if(h&&typeof o=="string"&&o){var g=_n(o);g='link[rel="'+s+'"][href="'+g+'"]',typeof u=="string"&&(g+='[crossorigin="'+u+'"]'),zb.has(g)||(zb.add(g),s={rel:s,crossOrigin:u,href:o},h.querySelector(g)===null&&(o=h.createElement("link"),Nt(o,"link",s),St(o),h.head.appendChild(o)))}}function cE(s){wr.D(s),Vb("dns-prefetch",s,null)}function uE(s,o){wr.C(s,o),Vb("preconnect",s,o)}function fE(s,o,u){wr.L(s,o,u);var h=Xs;if(h&&s&&o){var g='link[rel="preload"][as="'+_n(o)+'"]';o==="image"&&u&&u.imageSrcSet?(g+='[imagesrcset="'+_n(u.imageSrcSet)+'"]',typeof u.imageSizes=="string"&&(g+='[imagesizes="'+_n(u.imageSizes)+'"]')):g+='[href="'+_n(s)+'"]';var m=g;switch(o){case"style":m=Ys(s);break;case"script":m=qs(s)}xn.has(m)||(s=p({rel:"preload",href:o==="image"&&u&&u.imageSrcSet?void 0:s,as:o},u),xn.set(m,s),h.querySelector(g)!==null||o==="style"&&h.querySelector(Ro(m))||o==="script"&&h.querySelector(Co(m))||(o=h.createElement("link"),Nt(o,"link",s),St(o),h.head.appendChild(o)))}}function hE(s,o){wr.m(s,o);var u=Xs;if(u&&s){var h=o&&typeof o.as=="string"?o.as:"script",g='link[rel="modulepreload"][as="'+_n(h)+'"][href="'+_n(s)+'"]',m=g;switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":m=qs(s)}if(!xn.has(m)&&(s=p({rel:"modulepreload",href:s},o),xn.set(m,s),u.querySelector(g)===null)){switch(h){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(u.querySelector(Co(m)))return}h=u.createElement("link"),Nt(h,"link",s),St(h),u.head.appendChild(h)}}}function dE(s,o,u){wr.S(s,o,u);var h=Xs;if(h&&s){var g=ds(h).hoistableStyles,m=Ys(s);o=o||"default";var v=g.get(m);if(!v){var x={loading:0,preload:null};if(v=h.querySelector(Ro(m)))x.loading=5;else{s=p({rel:"stylesheet",href:s,"data-precedence":o},u),(u=xn.get(m))&&Zd(s,u);var I=v=h.createElement("link");St(I),Nt(I,"link",s),I._p=new Promise(function(W,Z){I.onload=W,I.onerror=Z}),I.addEventListener("load",function(){x.loading|=1}),I.addEventListener("error",function(){x.loading|=2}),x.loading|=4,Vc(v,o,h)}v={type:"stylesheet",instance:v,count:1,state:x},g.set(m,v)}}}function pE(s,o){wr.X(s,o);var u=Xs;if(u&&s){var h=ds(u).hoistableScripts,g=qs(s),m=h.get(g);m||(m=u.querySelector(Co(g)),m||(s=p({src:s,async:!0},o),(o=xn.get(g))&&Qd(s,o),m=u.createElement("script"),St(m),Nt(m,"link",s),u.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function gE(s,o){wr.M(s,o);var u=Xs;if(u&&s){var h=ds(u).hoistableScripts,g=qs(s),m=h.get(g);m||(m=u.querySelector(Co(g)),m||(s=p({src:s,async:!0,type:"module"},o),(o=xn.get(g))&&Qd(s,o),m=u.createElement("script"),St(m),Nt(m,"link",s),u.head.appendChild(m)),m={type:"script",instance:m,count:1,state:null},h.set(g,m))}}function Hb(s,o,u,h){var g=(g=Ae.current)?zc(g):null;if(!g)throw Error(r(446));switch(s){case"meta":case"title":return null;case"style":return typeof u.precedence=="string"&&typeof u.href=="string"?(o=Ys(u.href),u=ds(g).hoistableStyles,h=u.get(o),h||(h={type:"style",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};case"link":if(u.rel==="stylesheet"&&typeof u.href=="string"&&typeof u.precedence=="string"){s=Ys(u.href);var m=ds(g).hoistableStyles,v=m.get(s);if(v||(g=g.ownerDocument||g,v={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},m.set(s,v),(m=g.querySelector(Ro(s)))&&!m._p&&(v.instance=m,v.state.loading=5),xn.has(s)||(u={rel:"preload",as:"style",href:u.href,crossOrigin:u.crossOrigin,integrity:u.integrity,media:u.media,hrefLang:u.hrefLang,referrerPolicy:u.referrerPolicy},xn.set(s,u),m||_E(g,s,u,v.state))),o&&h===null)throw Error(r(528,""));return v}if(o&&h!==null)throw Error(r(529,""));return null;case"script":return o=u.async,u=u.src,typeof u=="string"&&o&&typeof o!="function"&&typeof o!="symbol"?(o=qs(u),u=ds(g).hoistableScripts,h=u.get(o),h||(h={type:"script",instance:null,count:0,state:null},u.set(o,h)),h):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,s))}}function Ys(s){return'href="'+_n(s)+'"'}function Ro(s){return'link[rel="stylesheet"]['+s+"]"}function jb(s){return p({},s,{"data-precedence":s.precedence,precedence:null})}function _E(s,o,u,h){s.querySelector('link[rel="preload"][as="style"]['+o+"]")?h.loading=1:(o=s.createElement("link"),h.preload=o,o.addEventListener("load",function(){return h.loading|=1}),o.addEventListener("error",function(){return h.loading|=2}),Nt(o,"link",u),St(o),s.head.appendChild(o))}function qs(s){return'[src="'+_n(s)+'"]'}function Co(s){return"script[async]"+s}function $b(s,o,u){if(o.count++,o.instance===null)switch(o.type){case"style":var h=s.querySelector('style[data-href~="'+_n(u.href)+'"]');if(h)return o.instance=h,St(h),h;var g=p({},u,{"data-href":u.href,"data-precedence":u.precedence,href:null,precedence:null});return h=(s.ownerDocument||s).createElement("style"),St(h),Nt(h,"style",g),Vc(h,u.precedence,s),o.instance=h;case"stylesheet":g=Ys(u.href);var m=s.querySelector(Ro(g));if(m)return o.state.loading|=4,o.instance=m,St(m),m;h=jb(u),(g=xn.get(g))&&Zd(h,g),m=(s.ownerDocument||s).createElement("link"),St(m);var v=m;return v._p=new Promise(function(x,I){v.onload=x,v.onerror=I}),Nt(m,"link",h),o.state.loading|=4,Vc(m,u.precedence,s),o.instance=m;case"script":return m=qs(u.src),(g=s.querySelector(Co(m)))?(o.instance=g,St(g),g):(h=u,(g=xn.get(m))&&(h=p({},u),Qd(h,g)),s=s.ownerDocument||s,g=s.createElement("script"),St(g),Nt(g,"link",h),s.head.appendChild(g),o.instance=g);case"void":return null;default:throw Error(r(443,o.type))}else o.type==="stylesheet"&&(o.state.loading&4)===0&&(h=o.instance,o.state.loading|=4,Vc(h,u.precedence,s));return o.instance}function Vc(s,o,u){for(var h=u.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),g=h.length?h[h.length-1]:null,m=g,v=0;v<h.length;v++){var x=h[v];if(x.dataset.precedence===o)m=x;else if(m!==g)break}m?m.parentNode.insertBefore(s,m.nextSibling):(o=u.nodeType===9?u.head:u,o.insertBefore(s,o.firstChild))}function Zd(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.title==null&&(s.title=o.title)}function Qd(s,o){s.crossOrigin==null&&(s.crossOrigin=o.crossOrigin),s.referrerPolicy==null&&(s.referrerPolicy=o.referrerPolicy),s.integrity==null&&(s.integrity=o.integrity)}var Hc=null;function Wb(s,o,u){if(Hc===null){var h=new Map,g=Hc=new Map;g.set(u,h)}else g=Hc,h=g.get(u),h||(h=new Map,g.set(u,h));if(h.has(s))return h;for(h.set(s,null),u=u.getElementsByTagName(s),g=0;g<u.length;g++){var m=u[g];if(!(m[za]||m[Pt]||s==="link"&&m.getAttribute("rel")==="stylesheet")&&m.namespaceURI!=="http://www.w3.org/2000/svg"){var v=m.getAttribute(o)||"";v=s+v;var x=h.get(v);x?x.push(m):h.set(v,[m])}}return h}function Xb(s,o,u){s=s.ownerDocument||s,s.head.insertBefore(u,o==="title"?s.querySelector("head > title"):null)}function mE(s,o,u){if(u===1||o.itemProp!=null)return!1;switch(s){case"meta":case"title":return!0;case"style":if(typeof o.precedence!="string"||typeof o.href!="string"||o.href==="")break;return!0;case"link":if(typeof o.rel!="string"||typeof o.href!="string"||o.href===""||o.onLoad||o.onError)break;switch(o.rel){case"stylesheet":return s=o.disabled,typeof o.precedence=="string"&&s==null;default:return!0}case"script":if(o.async&&typeof o.async!="function"&&typeof o.async!="symbol"&&!o.onLoad&&!o.onError&&o.src&&typeof o.src=="string")return!0}return!1}function Yb(s){return!(s.type==="stylesheet"&&(s.state.loading&3)===0)}var Mo=null;function yE(){}function bE(s,o,u){if(Mo===null)throw Error(r(475));var h=Mo;if(o.type==="stylesheet"&&(typeof u.media!="string"||matchMedia(u.media).matches!==!1)&&(o.state.loading&4)===0){if(o.instance===null){var g=Ys(u.href),m=s.querySelector(Ro(g));if(m){s=m._p,s!==null&&typeof s=="object"&&typeof s.then=="function"&&(h.count++,h=jc.bind(h),s.then(h,h)),o.state.loading|=4,o.instance=m,St(m);return}m=s.ownerDocument||s,u=jb(u),(g=xn.get(g))&&Zd(u,g),m=m.createElement("link"),St(m);var v=m;v._p=new Promise(function(x,I){v.onload=x,v.onerror=I}),Nt(m,"link",u),o.instance=m}h.stylesheets===null&&(h.stylesheets=new Map),h.stylesheets.set(o,s),(s=o.state.preload)&&(o.state.loading&3)===0&&(h.count++,o=jc.bind(h),s.addEventListener("load",o),s.addEventListener("error",o))}}function vE(){if(Mo===null)throw Error(r(475));var s=Mo;return s.stylesheets&&s.count===0&&Gd(s,s.stylesheets),0<s.count?function(o){var u=setTimeout(function(){if(s.stylesheets&&Gd(s,s.stylesheets),s.unsuspend){var h=s.unsuspend;s.unsuspend=null,h()}},6e4);return s.unsuspend=o,function(){s.unsuspend=null,clearTimeout(u)}}:null}function jc(){if(this.count--,this.count===0){if(this.stylesheets)Gd(this,this.stylesheets);else if(this.unsuspend){var s=this.unsuspend;this.unsuspend=null,s()}}}var $c=null;function Gd(s,o){s.stylesheets=null,s.unsuspend!==null&&(s.count++,$c=new Map,o.forEach(TE,s),$c=null,jc.call(s))}function TE(s,o){if(!(o.state.loading&4)){var u=$c.get(s);if(u)var h=u.get(null);else{u=new Map,$c.set(s,u);for(var g=s.querySelectorAll("link[data-precedence],style[data-precedence]"),m=0;m<g.length;m++){var v=g[m];(v.nodeName==="LINK"||v.getAttribute("media")!=="not all")&&(u.set(v.dataset.precedence,v),h=v)}h&&u.set(null,h)}g=o.instance,v=g.getAttribute("data-precedence"),m=u.get(v)||h,m===h&&u.set(null,g),u.set(v,g),this.count++,h=jc.bind(this),g.addEventListener("load",h),g.addEventListener("error",h),m?m.parentNode.insertBefore(g,m.nextSibling):(s=s.nodeType===9?s.head:s,s.insertBefore(g,s.firstChild)),o.state.loading|=4}}var Oo={$$typeof:R,Provider:null,Consumer:null,_currentValue:fe,_currentValue2:fe,_threadCount:0};function wE(s,o,u,h,g,m,v,x){this.tag=1,this.containerInfo=s,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=qf(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=qf(0),this.hiddenUpdates=qf(null),this.identifierPrefix=h,this.onUncaughtError=g,this.onCaughtError=m,this.onRecoverableError=v,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=x,this.incompleteTransitions=new Map}function qb(s,o,u,h,g,m,v,x,I,W,Z,te){return s=new wE(s,o,u,v,x,I,W,te),o=1,m===!0&&(o|=24),m=sn(3,null,null,o),s.current=m,m.stateNode=s,o=kh(),o.refCount++,s.pooledCache=o,o.refCount++,m.memoizedState={element:h,isDehydrated:u,cache:o},Bh(m),s}function Kb(s){return s?(s=As,s):As}function Zb(s,o,u,h,g,m){g=Kb(g),h.context===null?h.context=g:h.pendingContext=g,h=Br(o),h.payload={element:u},m=m===void 0?null:m,m!==null&&(h.callback=m),u=Fr(s,h,o),u!==null&&(un(u,s,o),so(u,s,o))}function Qb(s,o){if(s=s.memoizedState,s!==null&&s.dehydrated!==null){var u=s.retryLane;s.retryLane=u!==0&&u<o?u:o}}function Jd(s,o){Qb(s,o),(s=s.alternate)&&Qb(s,o)}function Gb(s){if(s.tag===13){var o=Ss(s,67108864);o!==null&&un(o,s,67108864),Jd(s,67108864)}}var Wc=!0;function xE(s,o,u,h){var g=$.T;$.T=null;var m=ee.p;try{ee.p=2,ep(s,o,u,h)}finally{ee.p=m,$.T=g}}function SE(s,o,u,h){var g=$.T;$.T=null;var m=ee.p;try{ee.p=8,ep(s,o,u,h)}finally{ee.p=m,$.T=g}}function ep(s,o,u,h){if(Wc){var g=tp(h);if(g===null)Vd(s,o,h,Xc,u),ev(s,h);else if(EE(g,s,o,u,h))h.stopPropagation();else if(ev(s,h),o&4&&-1<AE.indexOf(s)){for(;g!==null;){var m=hs(g);if(m!==null)switch(m.tag){case 3:if(m=m.stateNode,m.current.memoizedState.isDehydrated){var v=mi(m.pendingLanes);if(v!==0){var x=m;for(x.pendingLanes|=2,x.entangledLanes|=2;v;){var I=1<<31-nn(v);x.entanglements[1]|=I,v&=~I}Yn(m),($e&6)===0&&(Mc=xt()+500,xo(0))}}break;case 13:x=Ss(m,2),x!==null&&un(x,m,2),Ic(),Jd(m,2)}if(m=tp(h),m===null&&Vd(s,o,h,Xc,u),m===g)break;g=m}g!==null&&h.stopPropagation()}else Vd(s,o,h,null,u)}}function tp(s){return s=ah(s),np(s)}var Xc=null;function np(s){if(Xc=null,s=fs(s),s!==null){var o=a(s);if(o===null)s=null;else{var u=o.tag;if(u===13){if(s=l(o),s!==null)return s;s=null}else if(u===3){if(o.stateNode.current.memoizedState.isDehydrated)return o.tag===3?o.stateNode.containerInfo:null;s=null}else o!==s&&(s=null)}}return Xc=s,null}function Jb(s){switch(s){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Bl()){case dm:return 2;case pm:return 8;case Fl:case fS:return 32;case gm:return 268435456;default:return 32}default:return 32}}var rp=!1,Qr=null,Gr=null,Jr=null,Io=new Map,No=new Map,ei=[],AE="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function ev(s,o){switch(s){case"focusin":case"focusout":Qr=null;break;case"dragenter":case"dragleave":Gr=null;break;case"mouseover":case"mouseout":Jr=null;break;case"pointerover":case"pointerout":Io.delete(o.pointerId);break;case"gotpointercapture":case"lostpointercapture":No.delete(o.pointerId)}}function ko(s,o,u,h,g,m){return s===null||s.nativeEvent!==m?(s={blockedOn:o,domEventName:u,eventSystemFlags:h,nativeEvent:m,targetContainers:[g]},o!==null&&(o=hs(o),o!==null&&Gb(o)),s):(s.eventSystemFlags|=h,o=s.targetContainers,g!==null&&o.indexOf(g)===-1&&o.push(g),s)}function EE(s,o,u,h,g){switch(o){case"focusin":return Qr=ko(Qr,s,o,u,h,g),!0;case"dragenter":return Gr=ko(Gr,s,o,u,h,g),!0;case"mouseover":return Jr=ko(Jr,s,o,u,h,g),!0;case"pointerover":var m=g.pointerId;return Io.set(m,ko(Io.get(m)||null,s,o,u,h,g)),!0;case"gotpointercapture":return m=g.pointerId,No.set(m,ko(No.get(m)||null,s,o,u,h,g)),!0}return!1}function tv(s){var o=fs(s.target);if(o!==null){var u=a(o);if(u!==null){if(o=u.tag,o===13){if(o=l(u),o!==null){s.blockedOn=o,bS(s.priority,function(){if(u.tag===13){var h=cn();h=Kf(h);var g=Ss(u,h);g!==null&&un(g,u,h),Jd(u,h)}});return}}else if(o===3&&u.stateNode.current.memoizedState.isDehydrated){s.blockedOn=u.tag===3?u.stateNode.containerInfo:null;return}}}s.blockedOn=null}function Yc(s){if(s.blockedOn!==null)return!1;for(var o=s.targetContainers;0<o.length;){var u=tp(s.nativeEvent);if(u===null){u=s.nativeEvent;var h=new u.constructor(u.type,u);sh=h,u.target.dispatchEvent(h),sh=null}else return o=hs(u),o!==null&&Gb(o),s.blockedOn=u,!1;o.shift()}return!0}function nv(s,o,u){Yc(s)&&u.delete(o)}function RE(){rp=!1,Qr!==null&&Yc(Qr)&&(Qr=null),Gr!==null&&Yc(Gr)&&(Gr=null),Jr!==null&&Yc(Jr)&&(Jr=null),Io.forEach(nv),No.forEach(nv)}function qc(s,o){s.blockedOn===o&&(s.blockedOn=null,rp||(rp=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,RE)))}var Kc=null;function rv(s){Kc!==s&&(Kc=s,n.unstable_scheduleCallback(n.unstable_NormalPriority,function(){Kc===s&&(Kc=null);for(var o=0;o<s.length;o+=3){var u=s[o],h=s[o+1],g=s[o+2];if(typeof h!="function"){if(np(h||u)===null)continue;break}var m=hs(u);m!==null&&(s.splice(o,3),o-=3,nd(m,{pending:!0,data:g,method:u.method,action:h},h,g))}}))}function Do(s){function o(I){return qc(I,s)}Qr!==null&&qc(Qr,s),Gr!==null&&qc(Gr,s),Jr!==null&&qc(Jr,s),Io.forEach(o),No.forEach(o);for(var u=0;u<ei.length;u++){var h=ei[u];h.blockedOn===s&&(h.blockedOn=null)}for(;0<ei.length&&(u=ei[0],u.blockedOn===null);)tv(u),u.blockedOn===null&&ei.shift();if(u=(s.ownerDocument||s).$$reactFormReplay,u!=null)for(h=0;h<u.length;h+=3){var g=u[h],m=u[h+1],v=g[qt]||null;if(typeof m=="function")v||rv(u);else if(v){var x=null;if(m&&m.hasAttribute("formAction")){if(g=m,v=m[qt]||null)x=v.formAction;else if(np(g)!==null)continue}else x=v.action;typeof x=="function"?u[h+1]=x:(u.splice(h,3),h-=3),rv(u)}}}function ip(s){this._internalRoot=s}Zc.prototype.render=ip.prototype.render=function(s){var o=this._internalRoot;if(o===null)throw Error(r(409));var u=o.current,h=cn();Zb(u,h,s,o,null,null)},Zc.prototype.unmount=ip.prototype.unmount=function(){var s=this._internalRoot;if(s!==null){this._internalRoot=null;var o=s.containerInfo;Zb(s.current,2,null,s,null,null),Ic(),o[us]=null}};function Zc(s){this._internalRoot=s}Zc.prototype.unstable_scheduleHydration=function(s){if(s){var o=vm();s={blockedOn:null,target:s,priority:o};for(var u=0;u<ei.length&&o!==0&&o<ei[u].priority;u++);ei.splice(u,0,s),u===0&&tv(s)}};var iv=e.version;if(iv!=="19.1.0")throw Error(r(527,iv,"19.1.0"));ee.findDOMNode=function(s){var o=s._reactInternals;if(o===void 0)throw typeof s.render=="function"?Error(r(188)):(s=Object.keys(s).join(","),Error(r(268,s)));return s=f(o),s=s!==null?d(s):null,s=s===null?null:s.stateNode,s};var CE={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:$,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Qc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Qc.isDisabled&&Qc.supportsFiber)try{Ba=Qc.inject(CE),tn=Qc}catch{}}return Uo.createRoot=function(s,o){if(!i(s))throw Error(r(299));var u=!1,h="",g=v0,m=T0,v=w0,x=null;return o!=null&&(o.unstable_strictMode===!0&&(u=!0),o.identifierPrefix!==void 0&&(h=o.identifierPrefix),o.onUncaughtError!==void 0&&(g=o.onUncaughtError),o.onCaughtError!==void 0&&(m=o.onCaughtError),o.onRecoverableError!==void 0&&(v=o.onRecoverableError),o.unstable_transitionCallbacks!==void 0&&(x=o.unstable_transitionCallbacks)),o=qb(s,1,!1,null,null,u,h,g,m,v,x,null),s[us]=o.current,zd(s),new ip(o)},Uo.hydrateRoot=function(s,o,u){if(!i(s))throw Error(r(299));var h=!1,g="",m=v0,v=T0,x=w0,I=null,W=null;return u!=null&&(u.unstable_strictMode===!0&&(h=!0),u.identifierPrefix!==void 0&&(g=u.identifierPrefix),u.onUncaughtError!==void 0&&(m=u.onUncaughtError),u.onCaughtError!==void 0&&(v=u.onCaughtError),u.onRecoverableError!==void 0&&(x=u.onRecoverableError),u.unstable_transitionCallbacks!==void 0&&(I=u.unstable_transitionCallbacks),u.formState!==void 0&&(W=u.formState)),o=qb(s,1,!0,o,u??null,h,g,m,v,x,I,W),o.context=Kb(null),u=o.current,h=cn(),h=Kf(h),g=Br(h),g.callback=null,Fr(u,g,h),u=h,o.current.lanes=u,La(o,u),Yn(o),s[us]=o.current,zd(s),new Zc(o)},Uo.version="19.1.0",Uo}var pv;function zE(){if(pv)return op.exports;pv=1;function n(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(n)}catch(e){console.error(e)}}return n(),op.exports=LE(),op.exports}var VE=zE();function mu(n,e){return n==null||e==null?NaN:n<e?-1:n>e?1:n>=e?0:NaN}function HE(n,e){return n==null||e==null?NaN:e<n?-1:e>n?1:e>=n?0:NaN}function k2(n){let e,t,r;n.length!==2?(e=mu,t=(c,f)=>mu(n(c),f),r=(c,f)=>n(c)-f):(e=n===mu||n===HE?n:jE,t=n,r=n);function i(c,f,d=0,p=c.length){if(d<p){if(e(f,f)!==0)return p;do{const _=d+p>>>1;t(c[_],f)<0?d=_+1:p=_}while(d<p)}return d}function a(c,f,d=0,p=c.length){if(d<p){if(e(f,f)!==0)return p;do{const _=d+p>>>1;t(c[_],f)<=0?d=_+1:p=_}while(d<p)}return d}function l(c,f,d=0,p=c.length){const _=i(c,f,d,p-1);return _>d&&r(c[_-1],f)>-r(c[_],f)?_-1:_}return{left:i,center:l,right:a}}function jE(){return 0}function $E(n){return n===null?NaN:+n}const WE=k2(mu),XE=WE.right;k2($E).center;const YE=qE(KE);function qE(n){return function(e,t,r=t){if(!((t=+t)>=0))throw new RangeError("invalid rx");if(!((r=+r)>=0))throw new RangeError("invalid ry");let{data:i,width:a,height:l}=e;if(!((a=Math.floor(a))>=0))throw new RangeError("invalid width");if(!((l=Math.floor(l!==void 0?l:i.length/a))>=0))throw new RangeError("invalid height");if(!a||!l||!t&&!r)return e;const c=t&&n(t),f=r&&n(r),d=i.slice();return c&&f?(Ks(c,d,i,a,l),Ks(c,i,d,a,l),Ks(c,d,i,a,l),Zs(f,i,d,a,l),Zs(f,d,i,a,l),Zs(f,i,d,a,l)):c?(Ks(c,i,d,a,l),Ks(c,d,i,a,l),Ks(c,i,d,a,l)):f&&(Zs(f,i,d,a,l),Zs(f,d,i,a,l),Zs(f,i,d,a,l)),e}}function Ks(n,e,t,r,i){for(let a=0,l=r*i;a<l;)n(e,t,a,a+=r,1)}function Zs(n,e,t,r,i){for(let a=0,l=r*i;a<r;++a)n(e,t,a,a+l,r)}function KE(n){const e=Math.floor(n);if(e===n)return ZE(n);const t=n-e,r=2*n+1;return(i,a,l,c,f)=>{if(!((c-=f)>=l))return;let d=e*a[l];const p=f*e,_=p+f;for(let y=l,b=l+p;y<b;y+=f)d+=a[Math.min(c,y)];for(let y=l,b=c;y<=b;y+=f)d+=a[Math.min(c,y+p)],i[y]=(d+t*(a[Math.max(l,y-_)]+a[Math.min(c,y+_)]))/r,d-=a[Math.max(l,y-p)]}}function ZE(n){const e=2*n+1;return(t,r,i,a,l)=>{if(!((a-=l)>=i))return;let c=n*r[i];const f=l*n;for(let d=i,p=i+f;d<p;d+=l)c+=r[Math.min(a,d)];for(let d=i,p=a;d<=p;d+=l)c+=r[Math.min(a,d+f)],t[d]=c/e,c-=r[Math.max(i,d-f)]}}function QE(n,e){let t=0;for(let r of n)r!=null&&(r=+r)>=r&&++t;return t}function GE(n,e){let t,r;if(e===void 0)for(const i of n)i!=null&&(t===void 0?i>=i&&(t=r=i):(t>i&&(t=i),r<i&&(r=i)));else{let i=-1;for(let a of n)(a=e(a,++i,n))!=null&&(t===void 0?a>=a&&(t=r=a):(t>a&&(t=a),r<a&&(r=a)))}return[t,r]}class ya{constructor(){this._partials=new Float64Array(32),this._n=0}add(e){const t=this._partials;let r=0;for(let i=0;i<this._n&&i<32;i++){const a=t[i],l=e+a,c=Math.abs(e)<Math.abs(a)?e-(l-a):a-(l-e);c&&(t[r++]=c),e=l}return t[r]=e,this._n=r+1,this}valueOf(){const e=this._partials;let t=this._n,r,i,a,l=0;if(t>0){for(l=e[--t];t>0&&(r=l,i=e[--t],l=r+i,a=i-(l-r),!a););t>0&&(a<0&&e[t-1]<0||a>0&&e[t-1]>0)&&(i=a*2,r=l+i,i==r-l&&(l=r))}return l}}class gv extends Map{constructor(e,t=tR){if(super(),Object.defineProperties(this,{_intern:{value:new Map},_key:{value:t}}),e!=null)for(const[r,i]of e)this.set(r,i)}get(e){return super.get(_v(this,e))}has(e){return super.has(_v(this,e))}set(e,t){return super.set(JE(this,e),t)}delete(e){return super.delete(eR(this,e))}}function _v({_intern:n,_key:e},t){const r=e(t);return n.has(r)?n.get(r):t}function JE({_intern:n,_key:e},t){const r=e(t);return n.has(r)?n.get(r):(n.set(r,t),t)}function eR({_intern:n,_key:e},t){const r=e(t);return n.has(r)&&(t=n.get(r),n.delete(r)),t}function tR(n){return n!==null&&typeof n=="object"?n.valueOf():n}const nR=Math.sqrt(50),rR=Math.sqrt(10),iR=Math.sqrt(2);function Ru(n,e,t){const r=(e-n)/Math.max(0,t),i=Math.floor(Math.log10(r)),a=r/Math.pow(10,i),l=a>=nR?10:a>=rR?5:a>=iR?2:1;let c,f,d;return i<0?(d=Math.pow(10,-i)/l,c=Math.round(n*d),f=Math.round(e*d),c/d<n&&++c,f/d>e&&--f,d=-d):(d=Math.pow(10,i)*l,c=Math.round(n/d),f=Math.round(e/d),c*d<n&&++c,f*d>e&&--f),f<c&&.5<=t&&t<2?Ru(n,e,t*2):[c,f,d]}function pl(n,e,t){if(e=+e,n=+n,t=+t,!(t>0))return[];if(n===e)return[n];const r=e<n,[i,a,l]=r?Ru(e,n,t):Ru(n,e,t);if(!(a>=i))return[];const c=a-i+1,f=new Array(c);if(r)if(l<0)for(let d=0;d<c;++d)f[d]=(a-d)/-l;else for(let d=0;d<c;++d)f[d]=(a-d)*l;else if(l<0)for(let d=0;d<c;++d)f[d]=(i+d)/-l;else for(let d=0;d<c;++d)f[d]=(i+d)*l;return f}function Cu(n,e,t){return e=+e,n=+n,t=+t,Ru(n,e,t)[2]}function sR(n,e,t){e=+e,n=+n,t=+t;const r=e<n,i=r?Cu(e,n,t):Cu(n,e,t);return(r?-1:1)*(i<0?1/-i:i)}function aR(n,e,t){let r;for(;;){const i=Cu(n,e,t);if(i===r||i===0||!isFinite(i))return[n,e];i>0?(n=Math.floor(n/i)*i,e=Math.ceil(e/i)*i):i<0&&(n=Math.ceil(n*i)/i,e=Math.floor(e*i)/i),r=i}}function oR(n){return Math.max(1,Math.ceil(Math.log(QE(n))/Math.LN2)+1)}function og(n,e){let t;if(e===void 0)for(const r of n)r!=null&&(t<r||t===void 0&&r>=r)&&(t=r);else{let r=-1;for(let i of n)(i=e(i,++r,n))!=null&&(t<i||t===void 0&&i>=i)&&(t=i)}return t}function lR(n,e,t){n=+n,e=+e,t=(i=arguments.length)<2?(e=n,n=0,1):i<3?1:+t;for(var r=-1,i=Math.max(0,Math.ceil((e-n)/t))|0,a=new Array(i);++r<i;)a[r]=n+r*t;return a}var cR={value:()=>{}};function D2(){for(var n=0,e=arguments.length,t={},r;n<e;++n){if(!(r=arguments[n]+"")||r in t||/[\s.]/.test(r))throw new Error("illegal type: "+r);t[r]=[]}return new yu(t)}function yu(n){this._=n}function uR(n,e){return n.trim().split(/^|\s+/).map(function(t){var r="",i=t.indexOf(".");if(i>=0&&(r=t.slice(i+1),t=t.slice(0,i)),t&&!e.hasOwnProperty(t))throw new Error("unknown type: "+t);return{type:t,name:r}})}yu.prototype=D2.prototype={constructor:yu,on:function(n,e){var t=this._,r=uR(n+"",t),i,a=-1,l=r.length;if(arguments.length<2){for(;++a<l;)if((i=(n=r[a]).type)&&(i=fR(t[i],n.name)))return i;return}if(e!=null&&typeof e!="function")throw new Error("invalid callback: "+e);for(;++a<l;)if(i=(n=r[a]).type)t[i]=mv(t[i],n.name,e);else if(e==null)for(i in t)t[i]=mv(t[i],n.name,null);return this},copy:function(){var n={},e=this._;for(var t in e)n[t]=e[t].slice();return new yu(n)},call:function(n,e){if((i=arguments.length-2)>0)for(var t=new Array(i),r=0,i,a;r<i;++r)t[r]=arguments[r+2];if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(a=this._[n],r=0,i=a.length;r<i;++r)a[r].value.apply(e,t)},apply:function(n,e,t){if(!this._.hasOwnProperty(n))throw new Error("unknown type: "+n);for(var r=this._[n],i=0,a=r.length;i<a;++i)r[i].value.apply(e,t)}};function fR(n,e){for(var t=0,r=n.length,i;t<r;++t)if((i=n[t]).name===e)return i.value}function mv(n,e,t){for(var r=0,i=n.length;r<i;++r)if(n[r].name===e){n[r]=cR,n=n.slice(0,r).concat(n.slice(r+1));break}return t!=null&&n.push({name:e,value:t}),n}var lg="http://www.w3.org/1999/xhtml";const yv={svg:"http://www.w3.org/2000/svg",xhtml:lg,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function Df(n){var e=n+="",t=e.indexOf(":");return t>=0&&(e=n.slice(0,t))!=="xmlns"&&(n=n.slice(t+1)),yv.hasOwnProperty(e)?{space:yv[e],local:n}:n}function hR(n){return function(){var e=this.ownerDocument,t=this.namespaceURI;return t===lg&&e.documentElement.namespaceURI===lg?e.createElement(n):e.createElementNS(t,n)}}function dR(n){return function(){return this.ownerDocument.createElementNS(n.space,n.local)}}function P2(n){var e=Df(n);return(e.local?dR:hR)(e)}function pR(){}function v_(n){return n==null?pR:function(){return this.querySelector(n)}}function gR(n){typeof n!="function"&&(n=v_(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],l=a.length,c=r[i]=new Array(l),f,d,p=0;p<l;++p)(f=a[p])&&(d=n.call(f,f.__data__,p,a))&&("__data__"in f&&(d.__data__=f.__data__),c[p]=d);return new pn(r,this._parents)}function _R(n){return n==null?[]:Array.isArray(n)?n:Array.from(n)}function mR(){return[]}function U2(n){return n==null?mR:function(){return this.querySelectorAll(n)}}function yR(n){return function(){return _R(n.apply(this,arguments))}}function bR(n){typeof n=="function"?n=yR(n):n=U2(n);for(var e=this._groups,t=e.length,r=[],i=[],a=0;a<t;++a)for(var l=e[a],c=l.length,f,d=0;d<c;++d)(f=l[d])&&(r.push(n.call(f,f.__data__,d,l)),i.push(f));return new pn(r,i)}function B2(n){return function(){return this.matches(n)}}function F2(n){return function(e){return e.matches(n)}}var vR=Array.prototype.find;function TR(n){return function(){return vR.call(this.children,n)}}function wR(){return this.firstElementChild}function xR(n){return this.select(n==null?wR:TR(typeof n=="function"?n:F2(n)))}var SR=Array.prototype.filter;function AR(){return Array.from(this.children)}function ER(n){return function(){return SR.call(this.children,n)}}function RR(n){return this.selectAll(n==null?AR:ER(typeof n=="function"?n:F2(n)))}function CR(n){typeof n!="function"&&(n=B2(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],l=a.length,c=r[i]=[],f,d=0;d<l;++d)(f=a[d])&&n.call(f,f.__data__,d,a)&&c.push(f);return new pn(r,this._parents)}function L2(n){return new Array(n.length)}function MR(){return new pn(this._enter||this._groups.map(L2),this._parents)}function Mu(n,e){this.ownerDocument=n.ownerDocument,this.namespaceURI=n.namespaceURI,this._next=null,this._parent=n,this.__data__=e}Mu.prototype={constructor:Mu,appendChild:function(n){return this._parent.insertBefore(n,this._next)},insertBefore:function(n,e){return this._parent.insertBefore(n,e)},querySelector:function(n){return this._parent.querySelector(n)},querySelectorAll:function(n){return this._parent.querySelectorAll(n)}};function OR(n){return function(){return n}}function IR(n,e,t,r,i,a){for(var l=0,c,f=e.length,d=a.length;l<d;++l)(c=e[l])?(c.__data__=a[l],r[l]=c):t[l]=new Mu(n,a[l]);for(;l<f;++l)(c=e[l])&&(i[l]=c)}function NR(n,e,t,r,i,a,l){var c,f,d=new Map,p=e.length,_=a.length,y=new Array(p),b;for(c=0;c<p;++c)(f=e[c])&&(y[c]=b=l.call(f,f.__data__,c,e)+"",d.has(b)?i[c]=f:d.set(b,f));for(c=0;c<_;++c)b=l.call(n,a[c],c,a)+"",(f=d.get(b))?(r[c]=f,f.__data__=a[c],d.delete(b)):t[c]=new Mu(n,a[c]);for(c=0;c<p;++c)(f=e[c])&&d.get(y[c])===f&&(i[c]=f)}function kR(n){return n.__data__}function DR(n,e){if(!arguments.length)return Array.from(this,kR);var t=e?NR:IR,r=this._parents,i=this._groups;typeof n!="function"&&(n=OR(n));for(var a=i.length,l=new Array(a),c=new Array(a),f=new Array(a),d=0;d<a;++d){var p=r[d],_=i[d],y=_.length,b=PR(n.call(p,p&&p.__data__,d,r)),T=b.length,A=c[d]=new Array(T),C=l[d]=new Array(T),N=f[d]=new Array(y);t(p,_,A,C,N,b,e);for(var O=0,R=0,E,k;O<T;++O)if(E=A[O]){for(O>=R&&(R=O+1);!(k=C[R])&&++R<T;);E._next=k||null}}return l=new pn(l,r),l._enter=c,l._exit=f,l}function PR(n){return typeof n=="object"&&"length"in n?n:Array.from(n)}function UR(){return new pn(this._exit||this._groups.map(L2),this._parents)}function BR(n,e,t){var r=this.enter(),i=this,a=this.exit();return typeof n=="function"?(r=n(r),r&&(r=r.selection())):r=r.append(n+""),e!=null&&(i=e(i),i&&(i=i.selection())),t==null?a.remove():t(a),r&&i?r.merge(i).order():i}function FR(n){for(var e=n.selection?n.selection():n,t=this._groups,r=e._groups,i=t.length,a=r.length,l=Math.min(i,a),c=new Array(i),f=0;f<l;++f)for(var d=t[f],p=r[f],_=d.length,y=c[f]=new Array(_),b,T=0;T<_;++T)(b=d[T]||p[T])&&(y[T]=b);for(;f<i;++f)c[f]=t[f];return new pn(c,this._parents)}function LR(){for(var n=this._groups,e=-1,t=n.length;++e<t;)for(var r=n[e],i=r.length-1,a=r[i],l;--i>=0;)(l=r[i])&&(a&&l.compareDocumentPosition(a)^4&&a.parentNode.insertBefore(l,a),a=l);return this}function zR(n){n||(n=VR);function e(_,y){return _&&y?n(_.__data__,y.__data__):!_-!y}for(var t=this._groups,r=t.length,i=new Array(r),a=0;a<r;++a){for(var l=t[a],c=l.length,f=i[a]=new Array(c),d,p=0;p<c;++p)(d=l[p])&&(f[p]=d);f.sort(e)}return new pn(i,this._parents).order()}function VR(n,e){return n<e?-1:n>e?1:n>=e?0:NaN}function HR(){var n=arguments[0];return arguments[0]=this,n.apply(null,arguments),this}function jR(){return Array.from(this)}function $R(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,a=r.length;i<a;++i){var l=r[i];if(l)return l}return null}function WR(){let n=0;for(const e of this)++n;return n}function XR(){return!this.node()}function YR(n){for(var e=this._groups,t=0,r=e.length;t<r;++t)for(var i=e[t],a=0,l=i.length,c;a<l;++a)(c=i[a])&&n.call(c,c.__data__,a,i);return this}function qR(n){return function(){this.removeAttribute(n)}}function KR(n){return function(){this.removeAttributeNS(n.space,n.local)}}function ZR(n,e){return function(){this.setAttribute(n,e)}}function QR(n,e){return function(){this.setAttributeNS(n.space,n.local,e)}}function GR(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttribute(n):this.setAttribute(n,t)}}function JR(n,e){return function(){var t=e.apply(this,arguments);t==null?this.removeAttributeNS(n.space,n.local):this.setAttributeNS(n.space,n.local,t)}}function eC(n,e){var t=Df(n);if(arguments.length<2){var r=this.node();return t.local?r.getAttributeNS(t.space,t.local):r.getAttribute(t)}return this.each((e==null?t.local?KR:qR:typeof e=="function"?t.local?JR:GR:t.local?QR:ZR)(t,e))}function z2(n){return n.ownerDocument&&n.ownerDocument.defaultView||n.document&&n||n.defaultView}function tC(n){return function(){this.style.removeProperty(n)}}function nC(n,e,t){return function(){this.style.setProperty(n,e,t)}}function rC(n,e,t){return function(){var r=e.apply(this,arguments);r==null?this.style.removeProperty(n):this.style.setProperty(n,r,t)}}function iC(n,e,t){return arguments.length>1?this.each((e==null?tC:typeof e=="function"?rC:nC)(n,e,t??"")):ba(this.node(),n)}function ba(n,e){return n.style.getPropertyValue(e)||z2(n).getComputedStyle(n,null).getPropertyValue(e)}function sC(n){return function(){delete this[n]}}function aC(n,e){return function(){this[n]=e}}function oC(n,e){return function(){var t=e.apply(this,arguments);t==null?delete this[n]:this[n]=t}}function lC(n,e){return arguments.length>1?this.each((e==null?sC:typeof e=="function"?oC:aC)(n,e)):this.node()[n]}function V2(n){return n.trim().split(/^|\s+/)}function T_(n){return n.classList||new H2(n)}function H2(n){this._node=n,this._names=V2(n.getAttribute("class")||"")}H2.prototype={add:function(n){var e=this._names.indexOf(n);e<0&&(this._names.push(n),this._node.setAttribute("class",this._names.join(" ")))},remove:function(n){var e=this._names.indexOf(n);e>=0&&(this._names.splice(e,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(n){return this._names.indexOf(n)>=0}};function j2(n,e){for(var t=T_(n),r=-1,i=e.length;++r<i;)t.add(e[r])}function $2(n,e){for(var t=T_(n),r=-1,i=e.length;++r<i;)t.remove(e[r])}function cC(n){return function(){j2(this,n)}}function uC(n){return function(){$2(this,n)}}function fC(n,e){return function(){(e.apply(this,arguments)?j2:$2)(this,n)}}function hC(n,e){var t=V2(n+"");if(arguments.length<2){for(var r=T_(this.node()),i=-1,a=t.length;++i<a;)if(!r.contains(t[i]))return!1;return!0}return this.each((typeof e=="function"?fC:e?cC:uC)(t,e))}function dC(){this.textContent=""}function pC(n){return function(){this.textContent=n}}function gC(n){return function(){var e=n.apply(this,arguments);this.textContent=e??""}}function _C(n){return arguments.length?this.each(n==null?dC:(typeof n=="function"?gC:pC)(n)):this.node().textContent}function mC(){this.innerHTML=""}function yC(n){return function(){this.innerHTML=n}}function bC(n){return function(){var e=n.apply(this,arguments);this.innerHTML=e??""}}function vC(n){return arguments.length?this.each(n==null?mC:(typeof n=="function"?bC:yC)(n)):this.node().innerHTML}function TC(){this.nextSibling&&this.parentNode.appendChild(this)}function wC(){return this.each(TC)}function xC(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function SC(){return this.each(xC)}function AC(n){var e=typeof n=="function"?n:P2(n);return this.select(function(){return this.appendChild(e.apply(this,arguments))})}function EC(){return null}function RC(n,e){var t=typeof n=="function"?n:P2(n),r=e==null?EC:typeof e=="function"?e:v_(e);return this.select(function(){return this.insertBefore(t.apply(this,arguments),r.apply(this,arguments)||null)})}function CC(){var n=this.parentNode;n&&n.removeChild(this)}function MC(){return this.each(CC)}function OC(){var n=this.cloneNode(!1),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function IC(){var n=this.cloneNode(!0),e=this.parentNode;return e?e.insertBefore(n,this.nextSibling):n}function NC(n){return this.select(n?IC:OC)}function kC(n){return arguments.length?this.property("__data__",n):this.node().__data__}function DC(n){return function(e){n.call(this,e,this.__data__)}}function PC(n){return n.trim().split(/^|\s+/).map(function(e){var t="",r=e.indexOf(".");return r>=0&&(t=e.slice(r+1),e=e.slice(0,r)),{type:e,name:t}})}function UC(n){return function(){var e=this.__on;if(e){for(var t=0,r=-1,i=e.length,a;t<i;++t)a=e[t],(!n.type||a.type===n.type)&&a.name===n.name?this.removeEventListener(a.type,a.listener,a.options):e[++r]=a;++r?e.length=r:delete this.__on}}}function BC(n,e,t){return function(){var r=this.__on,i,a=DC(e);if(r){for(var l=0,c=r.length;l<c;++l)if((i=r[l]).type===n.type&&i.name===n.name){this.removeEventListener(i.type,i.listener,i.options),this.addEventListener(i.type,i.listener=a,i.options=t),i.value=e;return}}this.addEventListener(n.type,a,t),i={type:n.type,name:n.name,value:e,listener:a,options:t},r?r.push(i):this.__on=[i]}}function FC(n,e,t){var r=PC(n+""),i,a=r.length,l;if(arguments.length<2){var c=this.node().__on;if(c){for(var f=0,d=c.length,p;f<d;++f)for(i=0,p=c[f];i<a;++i)if((l=r[i]).type===p.type&&l.name===p.name)return p.value}return}for(c=e?BC:UC,i=0;i<a;++i)this.each(c(r[i],e,t));return this}function W2(n,e,t){var r=z2(n),i=r.CustomEvent;typeof i=="function"?i=new i(e,t):(i=r.document.createEvent("Event"),t?(i.initEvent(e,t.bubbles,t.cancelable),i.detail=t.detail):i.initEvent(e,!1,!1)),n.dispatchEvent(i)}function LC(n,e){return function(){return W2(this,n,e)}}function zC(n,e){return function(){return W2(this,n,e.apply(this,arguments))}}function VC(n,e){return this.each((typeof e=="function"?zC:LC)(n,e))}function*HC(){for(var n=this._groups,e=0,t=n.length;e<t;++e)for(var r=n[e],i=0,a=r.length,l;i<a;++i)(l=r[i])&&(yield l)}var X2=[null];function pn(n,e){this._groups=n,this._parents=e}function Cl(){return new pn([[document.documentElement]],X2)}function jC(){return this}pn.prototype=Cl.prototype={constructor:pn,select:gR,selectAll:bR,selectChild:xR,selectChildren:RR,filter:CR,data:DR,enter:MR,exit:UR,join:BR,merge:FR,selection:jC,order:LR,sort:zR,call:HR,nodes:jR,node:$R,size:WR,empty:XR,each:YR,attr:eC,style:iC,property:lC,classed:hC,text:_C,html:vC,raise:wC,lower:SC,append:AC,insert:RC,remove:MC,clone:NC,datum:kC,on:FC,dispatch:VC,[Symbol.iterator]:HC};function Zn(n){return typeof n=="string"?new pn([[document.querySelector(n)]],[document.documentElement]):new pn([[n]],X2)}function w_(n,e,t){n.prototype=e.prototype=t,t.constructor=n}function Y2(n,e){var t=Object.create(n.prototype);for(var r in e)t[r]=e[r];return t}function Ml(){}var gl=.7,Ou=1/gl,ga="\\s*([+-]?\\d+)\\s*",_l="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",nr="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",$C=/^#([0-9a-f]{3,8})$/,WC=new RegExp(`^rgb\\(${ga},${ga},${ga}\\)$`),XC=new RegExp(`^rgb\\(${nr},${nr},${nr}\\)$`),YC=new RegExp(`^rgba\\(${ga},${ga},${ga},${_l}\\)$`),qC=new RegExp(`^rgba\\(${nr},${nr},${nr},${_l}\\)$`),KC=new RegExp(`^hsl\\(${_l},${nr},${nr}\\)$`),ZC=new RegExp(`^hsla\\(${_l},${nr},${nr},${_l}\\)$`),bv={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};w_(Ml,Ki,{copy(n){return Object.assign(new this.constructor,this,n)},displayable(){return this.rgb().displayable()},hex:vv,formatHex:vv,formatHex8:QC,formatHsl:GC,formatRgb:Tv,toString:Tv});function vv(){return this.rgb().formatHex()}function QC(){return this.rgb().formatHex8()}function GC(){return q2(this).formatHsl()}function Tv(){return this.rgb().formatRgb()}function Ki(n){var e,t;return n=(n+"").trim().toLowerCase(),(e=$C.exec(n))?(t=e[1].length,e=parseInt(e[1],16),t===6?wv(e):t===3?new en(e>>8&15|e>>4&240,e>>4&15|e&240,(e&15)<<4|e&15,1):t===8?Gc(e>>24&255,e>>16&255,e>>8&255,(e&255)/255):t===4?Gc(e>>12&15|e>>8&240,e>>8&15|e>>4&240,e>>4&15|e&240,((e&15)<<4|e&15)/255):null):(e=WC.exec(n))?new en(e[1],e[2],e[3],1):(e=XC.exec(n))?new en(e[1]*255/100,e[2]*255/100,e[3]*255/100,1):(e=YC.exec(n))?Gc(e[1],e[2],e[3],e[4]):(e=qC.exec(n))?Gc(e[1]*255/100,e[2]*255/100,e[3]*255/100,e[4]):(e=KC.exec(n))?Av(e[1],e[2]/100,e[3]/100,1):(e=ZC.exec(n))?Av(e[1],e[2]/100,e[3]/100,e[4]):bv.hasOwnProperty(n)?wv(bv[n]):n==="transparent"?new en(NaN,NaN,NaN,0):null}function wv(n){return new en(n>>16&255,n>>8&255,n&255,1)}function Gc(n,e,t,r){return r<=0&&(n=e=t=NaN),new en(n,e,t,r)}function JC(n){return n instanceof Ml||(n=Ki(n)),n?(n=n.rgb(),new en(n.r,n.g,n.b,n.opacity)):new en}function cg(n,e,t,r){return arguments.length===1?JC(n):new en(n,e,t,r??1)}function en(n,e,t,r){this.r=+n,this.g=+e,this.b=+t,this.opacity=+r}w_(en,cg,Y2(Ml,{brighter(n){return n=n==null?Ou:Math.pow(Ou,n),new en(this.r*n,this.g*n,this.b*n,this.opacity)},darker(n){return n=n==null?gl:Math.pow(gl,n),new en(this.r*n,this.g*n,this.b*n,this.opacity)},rgb(){return this},clamp(){return new en(ji(this.r),ji(this.g),ji(this.b),Iu(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:xv,formatHex:xv,formatHex8:eM,formatRgb:Sv,toString:Sv}));function xv(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}`}function eM(){return`#${Vi(this.r)}${Vi(this.g)}${Vi(this.b)}${Vi((isNaN(this.opacity)?1:this.opacity)*255)}`}function Sv(){const n=Iu(this.opacity);return`${n===1?"rgb(":"rgba("}${ji(this.r)}, ${ji(this.g)}, ${ji(this.b)}${n===1?")":`, ${n})`}`}function Iu(n){return isNaN(n)?1:Math.max(0,Math.min(1,n))}function ji(n){return Math.max(0,Math.min(255,Math.round(n)||0))}function Vi(n){return n=ji(n),(n<16?"0":"")+n.toString(16)}function Av(n,e,t,r){return r<=0?n=e=t=NaN:t<=0||t>=1?n=e=NaN:e<=0&&(n=NaN),new Fn(n,e,t,r)}function q2(n){if(n instanceof Fn)return new Fn(n.h,n.s,n.l,n.opacity);if(n instanceof Ml||(n=Ki(n)),!n)return new Fn;if(n instanceof Fn)return n;n=n.rgb();var e=n.r/255,t=n.g/255,r=n.b/255,i=Math.min(e,t,r),a=Math.max(e,t,r),l=NaN,c=a-i,f=(a+i)/2;return c?(e===a?l=(t-r)/c+(t<r)*6:t===a?l=(r-e)/c+2:l=(e-t)/c+4,c/=f<.5?a+i:2-a-i,l*=60):c=f>0&&f<1?0:l,new Fn(l,c,f,n.opacity)}function tM(n,e,t,r){return arguments.length===1?q2(n):new Fn(n,e,t,r??1)}function Fn(n,e,t,r){this.h=+n,this.s=+e,this.l=+t,this.opacity=+r}w_(Fn,tM,Y2(Ml,{brighter(n){return n=n==null?Ou:Math.pow(Ou,n),new Fn(this.h,this.s,this.l*n,this.opacity)},darker(n){return n=n==null?gl:Math.pow(gl,n),new Fn(this.h,this.s,this.l*n,this.opacity)},rgb(){var n=this.h%360+(this.h<0)*360,e=isNaN(n)||isNaN(this.s)?0:this.s,t=this.l,r=t+(t<.5?t:1-t)*e,i=2*t-r;return new en(fp(n>=240?n-240:n+120,i,r),fp(n,i,r),fp(n<120?n+240:n-120,i,r),this.opacity)},clamp(){return new Fn(Ev(this.h),Jc(this.s),Jc(this.l),Iu(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const n=Iu(this.opacity);return`${n===1?"hsl(":"hsla("}${Ev(this.h)}, ${Jc(this.s)*100}%, ${Jc(this.l)*100}%${n===1?")":`, ${n})`}`}}));function Ev(n){return n=(n||0)%360,n<0?n+360:n}function Jc(n){return Math.max(0,Math.min(1,n||0))}function fp(n,e,t){return(n<60?e+(t-e)*n/60:n<180?t:n<240?e+(t-e)*(240-n)/60:e)*255}const x_=n=>()=>n;function nM(n,e){return function(t){return n+t*e}}function rM(n,e,t){return n=Math.pow(n,t),e=Math.pow(e,t)-n,t=1/t,function(r){return Math.pow(n+r*e,t)}}function iM(n){return(n=+n)==1?K2:function(e,t){return t-e?rM(e,t,n):x_(isNaN(e)?t:e)}}function K2(n,e){var t=e-n;return t?nM(n,t):x_(isNaN(n)?e:n)}const Nu=function n(e){var t=iM(e);function r(i,a){var l=t((i=cg(i)).r,(a=cg(a)).r),c=t(i.g,a.g),f=t(i.b,a.b),d=K2(i.opacity,a.opacity);return function(p){return i.r=l(p),i.g=c(p),i.b=f(p),i.opacity=d(p),i+""}}return r.gamma=n,r}(1);function sM(n,e){e||(e=[]);var t=n?Math.min(e.length,n.length):0,r=e.slice(),i;return function(a){for(i=0;i<t;++i)r[i]=n[i]*(1-a)+e[i]*a;return r}}function aM(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function oM(n,e){var t=e?e.length:0,r=n?Math.min(t,n.length):0,i=new Array(r),a=new Array(t),l;for(l=0;l<r;++l)i[l]=S_(n[l],e[l]);for(;l<t;++l)a[l]=e[l];return function(c){for(l=0;l<r;++l)a[l]=i[l](c);return a}}function lM(n,e){var t=new Date;return n=+n,e=+e,function(r){return t.setTime(n*(1-r)+e*r),t}}function Bn(n,e){return n=+n,e=+e,function(t){return n*(1-t)+e*t}}function cM(n,e){var t={},r={},i;(n===null||typeof n!="object")&&(n={}),(e===null||typeof e!="object")&&(e={});for(i in e)i in n?t[i]=S_(n[i],e[i]):r[i]=e[i];return function(a){for(i in t)r[i]=t[i](a);return r}}var ug=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,hp=new RegExp(ug.source,"g");function uM(n){return function(){return n}}function fM(n){return function(e){return n(e)+""}}function Z2(n,e){var t=ug.lastIndex=hp.lastIndex=0,r,i,a,l=-1,c=[],f=[];for(n=n+"",e=e+"";(r=ug.exec(n))&&(i=hp.exec(e));)(a=i.index)>t&&(a=e.slice(t,a),c[l]?c[l]+=a:c[++l]=a),(r=r[0])===(i=i[0])?c[l]?c[l]+=i:c[++l]=i:(c[++l]=null,f.push({i:l,x:Bn(r,i)})),t=hp.lastIndex;return t<e.length&&(a=e.slice(t),c[l]?c[l]+=a:c[++l]=a),c.length<2?f[0]?fM(f[0].x):uM(e):(e=f.length,function(d){for(var p=0,_;p<e;++p)c[(_=f[p]).i]=_.x(d);return c.join("")})}function S_(n,e){var t=typeof e,r;return e==null||t==="boolean"?x_(e):(t==="number"?Bn:t==="string"?(r=Ki(e))?(e=r,Nu):Z2:e instanceof Ki?Nu:e instanceof Date?lM:aM(e)?sM:Array.isArray(e)?oM:typeof e.valueOf!="function"&&typeof e.toString!="function"||isNaN(e)?cM:Bn)(n,e)}function hM(n,e){return n=+n,e=+e,function(t){return Math.round(n*(1-t)+e*t)}}var Rv=180/Math.PI,fg={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function Q2(n,e,t,r,i,a){var l,c,f;return(l=Math.sqrt(n*n+e*e))&&(n/=l,e/=l),(f=n*t+e*r)&&(t-=n*f,r-=e*f),(c=Math.sqrt(t*t+r*r))&&(t/=c,r/=c,f/=c),n*r<e*t&&(n=-n,e=-e,f=-f,l=-l),{translateX:i,translateY:a,rotate:Math.atan2(e,n)*Rv,skewX:Math.atan(f)*Rv,scaleX:l,scaleY:c}}var eu;function dM(n){const e=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(n+"");return e.isIdentity?fg:Q2(e.a,e.b,e.c,e.d,e.e,e.f)}function pM(n){return n==null||(eu||(eu=document.createElementNS("http://www.w3.org/2000/svg","g")),eu.setAttribute("transform",n),!(n=eu.transform.baseVal.consolidate()))?fg:(n=n.matrix,Q2(n.a,n.b,n.c,n.d,n.e,n.f))}function G2(n,e,t,r){function i(d){return d.length?d.pop()+" ":""}function a(d,p,_,y,b,T){if(d!==_||p!==y){var A=b.push("translate(",null,e,null,t);T.push({i:A-4,x:Bn(d,_)},{i:A-2,x:Bn(p,y)})}else(_||y)&&b.push("translate("+_+e+y+t)}function l(d,p,_,y){d!==p?(d-p>180?p+=360:p-d>180&&(d+=360),y.push({i:_.push(i(_)+"rotate(",null,r)-2,x:Bn(d,p)})):p&&_.push(i(_)+"rotate("+p+r)}function c(d,p,_,y){d!==p?y.push({i:_.push(i(_)+"skewX(",null,r)-2,x:Bn(d,p)}):p&&_.push(i(_)+"skewX("+p+r)}function f(d,p,_,y,b,T){if(d!==_||p!==y){var A=b.push(i(b)+"scale(",null,",",null,")");T.push({i:A-4,x:Bn(d,_)},{i:A-2,x:Bn(p,y)})}else(_!==1||y!==1)&&b.push(i(b)+"scale("+_+","+y+")")}return function(d,p){var _=[],y=[];return d=n(d),p=n(p),a(d.translateX,d.translateY,p.translateX,p.translateY,_,y),l(d.rotate,p.rotate,_,y),c(d.skewX,p.skewX,_,y),f(d.scaleX,d.scaleY,p.scaleX,p.scaleY,_,y),d=p=null,function(b){for(var T=-1,A=y.length,C;++T<A;)_[(C=y[T]).i]=C.x(b);return _.join("")}}}var gM=G2(dM,"px, ","px)","deg)"),_M=G2(pM,", ",")",")"),va=0,Yo=0,Bo=0,J2=1e3,ku,qo,Du=0,Zi=0,Pf=0,ml=typeof performance=="object"&&performance.now?performance:Date,e3=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(n){setTimeout(n,17)};function A_(){return Zi||(e3(mM),Zi=ml.now()+Pf)}function mM(){Zi=0}function Pu(){this._call=this._time=this._next=null}Pu.prototype=t3.prototype={constructor:Pu,restart:function(n,e,t){if(typeof n!="function")throw new TypeError("callback is not a function");t=(t==null?A_():+t)+(e==null?0:+e),!this._next&&qo!==this&&(qo?qo._next=this:ku=this,qo=this),this._call=n,this._time=t,hg()},stop:function(){this._call&&(this._call=null,this._time=1/0,hg())}};function t3(n,e,t){var r=new Pu;return r.restart(n,e,t),r}function yM(){A_(),++va;for(var n=ku,e;n;)(e=Zi-n._time)>=0&&n._call.call(void 0,e),n=n._next;--va}function Cv(){Zi=(Du=ml.now())+Pf,va=Yo=0;try{yM()}finally{va=0,vM(),Zi=0}}function bM(){var n=ml.now(),e=n-Du;e>J2&&(Pf-=e,Du=n)}function vM(){for(var n,e=ku,t,r=1/0;e;)e._call?(r>e._time&&(r=e._time),n=e,e=e._next):(t=e._next,e._next=null,e=n?n._next=t:ku=t);qo=n,hg(r)}function hg(n){if(!va){Yo&&(Yo=clearTimeout(Yo));var e=n-Zi;e>24?(n<1/0&&(Yo=setTimeout(Cv,n-ml.now()-Pf)),Bo&&(Bo=clearInterval(Bo))):(Bo||(Du=ml.now(),Bo=setInterval(bM,J2)),va=1,e3(Cv))}}function Mv(n,e,t){var r=new Pu;return e=e==null?0:+e,r.restart(i=>{r.stop(),n(i+e)},e,t),r}var TM=D2("start","end","cancel","interrupt"),wM=[],n3=0,Ov=1,dg=2,bu=3,Iv=4,pg=5,vu=6;function Uf(n,e,t,r,i,a){var l=n.__transition;if(!l)n.__transition={};else if(t in l)return;xM(n,t,{name:e,index:r,group:i,on:TM,tween:wM,time:a.time,delay:a.delay,duration:a.duration,ease:a.ease,timer:null,state:n3})}function E_(n,e){var t=Hn(n,e);if(t.state>n3)throw new Error("too late; already scheduled");return t}function sr(n,e){var t=Hn(n,e);if(t.state>bu)throw new Error("too late; already running");return t}function Hn(n,e){var t=n.__transition;if(!t||!(t=t[e]))throw new Error("transition not found");return t}function xM(n,e,t){var r=n.__transition,i;r[e]=t,t.timer=t3(a,0,t.time);function a(d){t.state=Ov,t.timer.restart(l,t.delay,t.time),t.delay<=d&&l(d-t.delay)}function l(d){var p,_,y,b;if(t.state!==Ov)return f();for(p in r)if(b=r[p],b.name===t.name){if(b.state===bu)return Mv(l);b.state===Iv?(b.state=vu,b.timer.stop(),b.on.call("interrupt",n,n.__data__,b.index,b.group),delete r[p]):+p<e&&(b.state=vu,b.timer.stop(),b.on.call("cancel",n,n.__data__,b.index,b.group),delete r[p])}if(Mv(function(){t.state===bu&&(t.state=Iv,t.timer.restart(c,t.delay,t.time),c(d))}),t.state=dg,t.on.call("start",n,n.__data__,t.index,t.group),t.state===dg){for(t.state=bu,i=new Array(y=t.tween.length),p=0,_=-1;p<y;++p)(b=t.tween[p].value.call(n,n.__data__,t.index,t.group))&&(i[++_]=b);i.length=_+1}}function c(d){for(var p=d<t.duration?t.ease.call(null,d/t.duration):(t.timer.restart(f),t.state=pg,1),_=-1,y=i.length;++_<y;)i[_].call(n,p);t.state===pg&&(t.on.call("end",n,n.__data__,t.index,t.group),f())}function f(){t.state=vu,t.timer.stop(),delete r[e];for(var d in r)return;delete n.__transition}}function SM(n,e){var t=n.__transition,r,i,a=!0,l;if(t){e=e==null?null:e+"";for(l in t){if((r=t[l]).name!==e){a=!1;continue}i=r.state>dg&&r.state<pg,r.state=vu,r.timer.stop(),r.on.call(i?"interrupt":"cancel",n,n.__data__,r.index,r.group),delete t[l]}a&&delete n.__transition}}function AM(n){return this.each(function(){SM(this,n)})}function EM(n,e){var t,r;return function(){var i=sr(this,n),a=i.tween;if(a!==t){r=t=a;for(var l=0,c=r.length;l<c;++l)if(r[l].name===e){r=r.slice(),r.splice(l,1);break}}i.tween=r}}function RM(n,e,t){var r,i;if(typeof t!="function")throw new Error;return function(){var a=sr(this,n),l=a.tween;if(l!==r){i=(r=l).slice();for(var c={name:e,value:t},f=0,d=i.length;f<d;++f)if(i[f].name===e){i[f]=c;break}f===d&&i.push(c)}a.tween=i}}function CM(n,e){var t=this._id;if(n+="",arguments.length<2){for(var r=Hn(this.node(),t).tween,i=0,a=r.length,l;i<a;++i)if((l=r[i]).name===n)return l.value;return null}return this.each((e==null?EM:RM)(t,n,e))}function R_(n,e,t){var r=n._id;return n.each(function(){var i=sr(this,r);(i.value||(i.value={}))[e]=t.apply(this,arguments)}),function(i){return Hn(i,r).value[e]}}function r3(n,e){var t;return(typeof e=="number"?Bn:e instanceof Ki?Nu:(t=Ki(e))?(e=t,Nu):Z2)(n,e)}function MM(n){return function(){this.removeAttribute(n)}}function OM(n){return function(){this.removeAttributeNS(n.space,n.local)}}function IM(n,e,t){var r,i=t+"",a;return function(){var l=this.getAttribute(n);return l===i?null:l===r?a:a=e(r=l,t)}}function NM(n,e,t){var r,i=t+"",a;return function(){var l=this.getAttributeNS(n.space,n.local);return l===i?null:l===r?a:a=e(r=l,t)}}function kM(n,e,t){var r,i,a;return function(){var l,c=t(this),f;return c==null?void this.removeAttribute(n):(l=this.getAttribute(n),f=c+"",l===f?null:l===r&&f===i?a:(i=f,a=e(r=l,c)))}}function DM(n,e,t){var r,i,a;return function(){var l,c=t(this),f;return c==null?void this.removeAttributeNS(n.space,n.local):(l=this.getAttributeNS(n.space,n.local),f=c+"",l===f?null:l===r&&f===i?a:(i=f,a=e(r=l,c)))}}function PM(n,e){var t=Df(n),r=t==="transform"?_M:r3;return this.attrTween(n,typeof e=="function"?(t.local?DM:kM)(t,r,R_(this,"attr."+n,e)):e==null?(t.local?OM:MM)(t):(t.local?NM:IM)(t,r,e))}function UM(n,e){return function(t){this.setAttribute(n,e.call(this,t))}}function BM(n,e){return function(t){this.setAttributeNS(n.space,n.local,e.call(this,t))}}function FM(n,e){var t,r;function i(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&BM(n,a)),t}return i._value=e,i}function LM(n,e){var t,r;function i(){var a=e.apply(this,arguments);return a!==r&&(t=(r=a)&&UM(n,a)),t}return i._value=e,i}function zM(n,e){var t="attr."+n;if(arguments.length<2)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;var r=Df(n);return this.tween(t,(r.local?FM:LM)(r,e))}function VM(n,e){return function(){E_(this,n).delay=+e.apply(this,arguments)}}function HM(n,e){return e=+e,function(){E_(this,n).delay=e}}function jM(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?VM:HM)(e,n)):Hn(this.node(),e).delay}function $M(n,e){return function(){sr(this,n).duration=+e.apply(this,arguments)}}function WM(n,e){return e=+e,function(){sr(this,n).duration=e}}function XM(n){var e=this._id;return arguments.length?this.each((typeof n=="function"?$M:WM)(e,n)):Hn(this.node(),e).duration}function YM(n,e){if(typeof e!="function")throw new Error;return function(){sr(this,n).ease=e}}function qM(n){var e=this._id;return arguments.length?this.each(YM(e,n)):Hn(this.node(),e).ease}function KM(n,e){return function(){var t=e.apply(this,arguments);if(typeof t!="function")throw new Error;sr(this,n).ease=t}}function ZM(n){if(typeof n!="function")throw new Error;return this.each(KM(this._id,n))}function QM(n){typeof n!="function"&&(n=B2(n));for(var e=this._groups,t=e.length,r=new Array(t),i=0;i<t;++i)for(var a=e[i],l=a.length,c=r[i]=[],f,d=0;d<l;++d)(f=a[d])&&n.call(f,f.__data__,d,a)&&c.push(f);return new Or(r,this._parents,this._name,this._id)}function GM(n){if(n._id!==this._id)throw new Error;for(var e=this._groups,t=n._groups,r=e.length,i=t.length,a=Math.min(r,i),l=new Array(r),c=0;c<a;++c)for(var f=e[c],d=t[c],p=f.length,_=l[c]=new Array(p),y,b=0;b<p;++b)(y=f[b]||d[b])&&(_[b]=y);for(;c<r;++c)l[c]=e[c];return new Or(l,this._parents,this._name,this._id)}function JM(n){return(n+"").trim().split(/^|\s+/).every(function(e){var t=e.indexOf(".");return t>=0&&(e=e.slice(0,t)),!e||e==="start"})}function eO(n,e,t){var r,i,a=JM(e)?E_:sr;return function(){var l=a(this,n),c=l.on;c!==r&&(i=(r=c).copy()).on(e,t),l.on=i}}function tO(n,e){var t=this._id;return arguments.length<2?Hn(this.node(),t).on.on(n):this.each(eO(t,n,e))}function nO(n){return function(){var e=this.parentNode;for(var t in this.__transition)if(+t!==n)return;e&&e.removeChild(this)}}function rO(){return this.on("end.remove",nO(this._id))}function iO(n){var e=this._name,t=this._id;typeof n!="function"&&(n=v_(n));for(var r=this._groups,i=r.length,a=new Array(i),l=0;l<i;++l)for(var c=r[l],f=c.length,d=a[l]=new Array(f),p,_,y=0;y<f;++y)(p=c[y])&&(_=n.call(p,p.__data__,y,c))&&("__data__"in p&&(_.__data__=p.__data__),d[y]=_,Uf(d[y],e,t,y,d,Hn(p,t)));return new Or(a,this._parents,e,t)}function sO(n){var e=this._name,t=this._id;typeof n!="function"&&(n=U2(n));for(var r=this._groups,i=r.length,a=[],l=[],c=0;c<i;++c)for(var f=r[c],d=f.length,p,_=0;_<d;++_)if(p=f[_]){for(var y=n.call(p,p.__data__,_,f),b,T=Hn(p,t),A=0,C=y.length;A<C;++A)(b=y[A])&&Uf(b,e,t,A,y,T);a.push(y),l.push(p)}return new Or(a,l,e,t)}var aO=Cl.prototype.constructor;function oO(){return new aO(this._groups,this._parents)}function lO(n,e){var t,r,i;return function(){var a=ba(this,n),l=(this.style.removeProperty(n),ba(this,n));return a===l?null:a===t&&l===r?i:i=e(t=a,r=l)}}function i3(n){return function(){this.style.removeProperty(n)}}function cO(n,e,t){var r,i=t+"",a;return function(){var l=ba(this,n);return l===i?null:l===r?a:a=e(r=l,t)}}function uO(n,e,t){var r,i,a;return function(){var l=ba(this,n),c=t(this),f=c+"";return c==null&&(f=c=(this.style.removeProperty(n),ba(this,n))),l===f?null:l===r&&f===i?a:(i=f,a=e(r=l,c))}}function fO(n,e){var t,r,i,a="style."+e,l="end."+a,c;return function(){var f=sr(this,n),d=f.on,p=f.value[a]==null?c||(c=i3(e)):void 0;(d!==t||i!==p)&&(r=(t=d).copy()).on(l,i=p),f.on=r}}function hO(n,e,t){var r=(n+="")=="transform"?gM:r3;return e==null?this.styleTween(n,lO(n,r)).on("end.style."+n,i3(n)):typeof e=="function"?this.styleTween(n,uO(n,r,R_(this,"style."+n,e))).each(fO(this._id,n)):this.styleTween(n,cO(n,r,e),t).on("end.style."+n,null)}function dO(n,e,t){return function(r){this.style.setProperty(n,e.call(this,r),t)}}function pO(n,e,t){var r,i;function a(){var l=e.apply(this,arguments);return l!==i&&(r=(i=l)&&dO(n,l,t)),r}return a._value=e,a}function gO(n,e,t){var r="style."+(n+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(e==null)return this.tween(r,null);if(typeof e!="function")throw new Error;return this.tween(r,pO(n,e,t??""))}function _O(n){return function(){this.textContent=n}}function mO(n){return function(){var e=n(this);this.textContent=e??""}}function yO(n){return this.tween("text",typeof n=="function"?mO(R_(this,"text",n)):_O(n==null?"":n+""))}function bO(n){return function(e){this.textContent=n.call(this,e)}}function vO(n){var e,t;function r(){var i=n.apply(this,arguments);return i!==t&&(e=(t=i)&&bO(i)),e}return r._value=n,r}function TO(n){var e="text";if(arguments.length<1)return(e=this.tween(e))&&e._value;if(n==null)return this.tween(e,null);if(typeof n!="function")throw new Error;return this.tween(e,vO(n))}function wO(){for(var n=this._name,e=this._id,t=s3(),r=this._groups,i=r.length,a=0;a<i;++a)for(var l=r[a],c=l.length,f,d=0;d<c;++d)if(f=l[d]){var p=Hn(f,e);Uf(f,n,t,d,l,{time:p.time+p.delay+p.duration,delay:0,duration:p.duration,ease:p.ease})}return new Or(r,this._parents,n,t)}function xO(){var n,e,t=this,r=t._id,i=t.size();return new Promise(function(a,l){var c={value:l},f={value:function(){--i===0&&a()}};t.each(function(){var d=sr(this,r),p=d.on;p!==n&&(e=(n=p).copy(),e._.cancel.push(c),e._.interrupt.push(c),e._.end.push(f)),d.on=e}),i===0&&a()})}var SO=0;function Or(n,e,t,r){this._groups=n,this._parents=e,this._name=t,this._id=r}function s3(){return++SO}var xr=Cl.prototype;Or.prototype={constructor:Or,select:iO,selectAll:sO,selectChild:xr.selectChild,selectChildren:xr.selectChildren,filter:QM,merge:GM,selection:oO,transition:wO,call:xr.call,nodes:xr.nodes,node:xr.node,size:xr.size,empty:xr.empty,each:xr.each,on:tO,attr:PM,attrTween:zM,style:hO,styleTween:gO,text:yO,textTween:TO,remove:rO,tween:CM,delay:jM,duration:XM,ease:qM,easeVarying:ZM,end:xO,[Symbol.iterator]:xr[Symbol.iterator]};function a3(n){return((n*=2)<=1?n*n*n:(n-=2)*n*n+2)/2}var AO={time:null,delay:0,duration:250,ease:a3};function EO(n,e){for(var t;!(t=n.__transition)||!(t=t[e]);)if(!(n=n.parentNode))throw new Error(`transition ${e} not found`);return t}function RO(n){var e,t;n instanceof Or?(e=n._id,n=n._name):(e=s3(),(t=AO).time=A_(),n=n==null?null:n+"");for(var r=this._groups,i=r.length,a=0;a<i;++a)for(var l=r[a],c=l.length,f,d=0;d<c;++d)(f=l[d])&&Uf(f,n,e,d,l,t||EO(f,e));return new Or(r,this._parents,n,e)}Cl.prototype.interrupt=AM;Cl.prototype.transition=RO;const gg=Math.PI,_g=2*gg,Li=1e-6,CO=_g-Li;function o3(n){this._+=n[0];for(let e=1,t=n.length;e<t;++e)this._+=arguments[e]+n[e]}function MO(n){let e=Math.floor(n);if(!(e>=0))throw new Error(`invalid digits: ${n}`);if(e>15)return o3;const t=10**e;return function(r){this._+=r[0];for(let i=1,a=r.length;i<a;++i)this._+=Math.round(arguments[i]*t)/t+r[i]}}class l3{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?o3:MO(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,r,i){this._append`Q${+e},${+t},${this._x1=+r},${this._y1=+i}`}bezierCurveTo(e,t,r,i,a,l){this._append`C${+e},${+t},${+r},${+i},${this._x1=+a},${this._y1=+l}`}arcTo(e,t,r,i,a){if(e=+e,t=+t,r=+r,i=+i,a=+a,a<0)throw new Error(`negative radius: ${a}`);let l=this._x1,c=this._y1,f=r-e,d=i-t,p=l-e,_=c-t,y=p*p+_*_;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(y>Li)if(!(Math.abs(_*f-d*p)>Li)||!a)this._append`L${this._x1=e},${this._y1=t}`;else{let b=r-l,T=i-c,A=f*f+d*d,C=b*b+T*T,N=Math.sqrt(A),O=Math.sqrt(y),R=a*Math.tan((gg-Math.acos((A+y-C)/(2*N*O)))/2),E=R/O,k=R/N;Math.abs(E-1)>Li&&this._append`L${e+E*p},${t+E*_}`,this._append`A${a},${a},0,0,${+(_*b>p*T)},${this._x1=e+k*f},${this._y1=t+k*d}`}}arc(e,t,r,i,a,l){if(e=+e,t=+t,r=+r,l=!!l,r<0)throw new Error(`negative radius: ${r}`);let c=r*Math.cos(i),f=r*Math.sin(i),d=e+c,p=t+f,_=1^l,y=l?i-a:a-i;this._x1===null?this._append`M${d},${p}`:(Math.abs(this._x1-d)>Li||Math.abs(this._y1-p)>Li)&&this._append`L${d},${p}`,r&&(y<0&&(y=y%_g+_g),y>CO?this._append`A${r},${r},0,1,${_},${e-c},${t-f}A${r},${r},0,1,${_},${this._x1=d},${this._y1=p}`:y>Li&&this._append`A${r},${r},0,${+(y>=gg)},${_},${this._x1=e+r*Math.cos(a)},${this._y1=t+r*Math.sin(a)}`)}rect(e,t,r,i){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${r=+r}v${+i}h${-r}Z`}toString(){return this._}}function c3(){return new l3}c3.prototype=l3.prototype;var OO=Array.prototype,u3=OO.slice;function IO(n,e){return n-e}function NO(n){for(var e=0,t=n.length,r=n[t-1][1]*n[0][0]-n[t-1][0]*n[0][1];++e<t;)r+=n[e-1][1]*n[e][0]-n[e-1][0]*n[e][1];return r}const ai=n=>()=>n;function kO(n,e){for(var t=-1,r=e.length,i;++t<r;)if(i=DO(n,e[t]))return i;return 0}function DO(n,e){for(var t=e[0],r=e[1],i=-1,a=0,l=n.length,c=l-1;a<l;c=a++){var f=n[a],d=f[0],p=f[1],_=n[c],y=_[0],b=_[1];if(PO(f,_,e))return 0;p>r!=b>r&&t<(y-d)*(r-p)/(b-p)+d&&(i=-i)}return i}function PO(n,e,t){var r;return UO(n,e,t)&&BO(n[r=+(n[0]===e[0])],t[r],e[r])}function UO(n,e,t){return(e[0]-n[0])*(t[1]-n[1])===(t[0]-n[0])*(e[1]-n[1])}function BO(n,e,t){return n<=e&&e<=t||t<=e&&e<=n}function FO(){}var Sr=[[],[[[1,1.5],[.5,1]]],[[[1.5,1],[1,1.5]]],[[[1.5,1],[.5,1]]],[[[1,.5],[1.5,1]]],[[[1,1.5],[.5,1]],[[1,.5],[1.5,1]]],[[[1,.5],[1,1.5]]],[[[1,.5],[.5,1]]],[[[.5,1],[1,.5]]],[[[1,1.5],[1,.5]]],[[[.5,1],[1,.5]],[[1.5,1],[1,1.5]]],[[[1.5,1],[1,.5]]],[[[.5,1],[1.5,1]]],[[[1,1.5],[1.5,1]]],[[[.5,1],[1,1.5]]],[]];function Nv(){var n=1,e=1,t=oR,r=f;function i(d){var p=t(d);if(Array.isArray(p))p=p.slice().sort(IO);else{const _=GE(d,LO);for(p=pl(...aR(_[0],_[1],p),p);p[p.length-1]>=_[1];)p.pop();for(;p[1]<_[0];)p.shift()}return p.map(_=>a(d,_))}function a(d,p){const _=p==null?NaN:+p;if(isNaN(_))throw new Error(`invalid value: ${p}`);var y=[],b=[];return l(d,_,function(T){r(T,d,_),NO(T)>0?y.push([T]):b.push(T)}),b.forEach(function(T){for(var A=0,C=y.length,N;A<C;++A)if(kO((N=y[A])[0],T)!==-1){N.push(T);return}}),{type:"MultiPolygon",value:p,coordinates:y}}function l(d,p,_){var y=new Array,b=new Array,T,A,C,N,O,R;for(T=A=-1,N=Pi(d[0],p),Sr[N<<1].forEach(E);++T<n-1;)C=N,N=Pi(d[T+1],p),Sr[C|N<<1].forEach(E);for(Sr[N<<0].forEach(E);++A<e-1;){for(T=-1,N=Pi(d[A*n+n],p),O=Pi(d[A*n],p),Sr[N<<1|O<<2].forEach(E);++T<n-1;)C=N,N=Pi(d[A*n+n+T+1],p),R=O,O=Pi(d[A*n+T+1],p),Sr[C|N<<1|O<<2|R<<3].forEach(E);Sr[N|O<<3].forEach(E)}for(T=-1,O=d[A*n]>=p,Sr[O<<2].forEach(E);++T<n-1;)R=O,O=Pi(d[A*n+T+1],p),Sr[O<<2|R<<3].forEach(E);Sr[O<<3].forEach(E);function E(k){var V=[k[0][0]+T,k[0][1]+A],ne=[k[1][0]+T,k[1][1]+A],G=c(V),se=c(ne),re,q;(re=b[G])?(q=y[se])?(delete b[re.end],delete y[q.start],re===q?(re.ring.push(ne),_(re.ring)):y[re.start]=b[q.end]={start:re.start,end:q.end,ring:re.ring.concat(q.ring)}):(delete b[re.end],re.ring.push(ne),b[re.end=se]=re):(re=y[se])?(q=b[G])?(delete y[re.start],delete b[q.end],re===q?(re.ring.push(ne),_(re.ring)):y[q.start]=b[re.end]={start:q.start,end:re.end,ring:q.ring.concat(re.ring)}):(delete y[re.start],re.ring.unshift(V),y[re.start=G]=re):y[G]=b[se]={start:G,end:se,ring:[V,ne]}}}function c(d){return d[0]*2+d[1]*(n+1)*4}function f(d,p,_){d.forEach(function(y){var b=y[0],T=y[1],A=b|0,C=T|0,N=dp(p[C*n+A]);b>0&&b<n&&A===b&&(y[0]=kv(b,dp(p[C*n+A-1]),N,_)),T>0&&T<e&&C===T&&(y[1]=kv(T,dp(p[(C-1)*n+A]),N,_))})}return i.contour=a,i.size=function(d){if(!arguments.length)return[n,e];var p=Math.floor(d[0]),_=Math.floor(d[1]);if(!(p>=0&&_>=0))throw new Error("invalid size");return n=p,e=_,i},i.thresholds=function(d){return arguments.length?(t=typeof d=="function"?d:Array.isArray(d)?ai(u3.call(d)):ai(d),i):t},i.smooth=function(d){return arguments.length?(r=d?f:FO,i):r===f},i}function LO(n){return isFinite(n)?n:NaN}function Pi(n,e){return n==null?!1:+n>=e}function dp(n){return n==null||isNaN(n=+n)?-1/0:n}function kv(n,e,t,r){const i=r-e,a=t-e,l=isFinite(i)||isFinite(a)?i/a:Math.sign(i)/Math.sign(a);return isNaN(l)?n:n+l-.5}function zO(n){return n[0]}function VO(n){return n[1]}function HO(){return 1}function jO(){var n=zO,e=VO,t=HO,r=960,i=500,a=20,l=2,c=a*3,f=r+c*2>>l,d=i+c*2>>l,p=ai(20);function _(O){var R=new Float32Array(f*d),E=Math.pow(2,-l),k=-1;for(const me of O){var V=(n(me,++k,O)+c)*E,ne=(e(me,k,O)+c)*E,G=+t(me,k,O);if(G&&V>=0&&V<f&&ne>=0&&ne<d){var se=Math.floor(V),re=Math.floor(ne),q=V-se-.5,ce=ne-re-.5;R[se+re*f]+=(1-q)*(1-ce)*G,R[se+1+re*f]+=q*(1-ce)*G,R[se+1+(re+1)*f]+=q*ce*G,R[se+(re+1)*f]+=(1-q)*ce*G}}return YE({data:R,width:f,height:d},a*E),R}function y(O){var R=_(O),E=p(R),k=Math.pow(2,2*l);return Array.isArray(E)||(E=pl(Number.MIN_VALUE,og(R)/k,E)),Nv().size([f,d]).thresholds(E.map(V=>V*k))(R).map((V,ne)=>(V.value=+E[ne],b(V)))}y.contours=function(O){var R=_(O),E=Nv().size([f,d]),k=Math.pow(2,2*l),V=ne=>{ne=+ne;var G=b(E.contour(R,ne*k));return G.value=ne,G};return Object.defineProperty(V,"max",{get:()=>og(R)/k}),V};function b(O){return O.coordinates.forEach(T),O}function T(O){O.forEach(A)}function A(O){O.forEach(C)}function C(O){O[0]=O[0]*Math.pow(2,l)-c,O[1]=O[1]*Math.pow(2,l)-c}function N(){return c=a*3,f=r+c*2>>l,d=i+c*2>>l,y}return y.x=function(O){return arguments.length?(n=typeof O=="function"?O:ai(+O),y):n},y.y=function(O){return arguments.length?(e=typeof O=="function"?O:ai(+O),y):e},y.weight=function(O){return arguments.length?(t=typeof O=="function"?O:ai(+O),y):t},y.size=function(O){if(!arguments.length)return[r,i];var R=+O[0],E=+O[1];if(!(R>=0&&E>=0))throw new Error("invalid size");return r=R,i=E,N()},y.cellSize=function(O){if(!arguments.length)return 1<<l;if(!((O=+O)>=1))throw new Error("invalid cell size");return l=Math.floor(Math.log(O)/Math.LN2),N()},y.thresholds=function(O){return arguments.length?(p=typeof O=="function"?O:Array.isArray(O)?ai(u3.call(O)):ai(O),y):p},y.bandwidth=function(O){if(!arguments.length)return Math.sqrt(a*(a+1));if(!((O=+O)>=0))throw new Error("invalid bandwidth");return a=(Math.sqrt(4*O*O+1)-1)/2,N()},y}var Dv={},pp={},gp=34,Fo=10,_p=13;function f3(n){return new Function("d","return {"+n.map(function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'}).join(",")+"}")}function $O(n,e){var t=f3(n);return function(r,i){return e(t(r),i,n)}}function Pv(n){var e=Object.create(null),t=[];return n.forEach(function(r){for(var i in r)i in e||t.push(e[i]=i)}),t}function Jt(n,e){var t=n+"",r=t.length;return r<e?new Array(e-r+1).join(0)+t:t}function WO(n){return n<0?"-"+Jt(-n,6):n>9999?"+"+Jt(n,6):Jt(n,4)}function XO(n){var e=n.getUTCHours(),t=n.getUTCMinutes(),r=n.getUTCSeconds(),i=n.getUTCMilliseconds();return isNaN(n)?"Invalid Date":WO(n.getUTCFullYear())+"-"+Jt(n.getUTCMonth()+1,2)+"-"+Jt(n.getUTCDate(),2)+(i?"T"+Jt(e,2)+":"+Jt(t,2)+":"+Jt(r,2)+"."+Jt(i,3)+"Z":r?"T"+Jt(e,2)+":"+Jt(t,2)+":"+Jt(r,2)+"Z":t||e?"T"+Jt(e,2)+":"+Jt(t,2)+"Z":"")}function YO(n){var e=new RegExp('["'+n+`
\r]`),t=n.charCodeAt(0);function r(_,y){var b,T,A=i(_,function(C,N){if(b)return b(C,N-1);T=C,b=y?$O(C,y):f3(C)});return A.columns=T||[],A}function i(_,y){var b=[],T=_.length,A=0,C=0,N,O=T<=0,R=!1;_.charCodeAt(T-1)===Fo&&--T,_.charCodeAt(T-1)===_p&&--T;function E(){if(O)return pp;if(R)return R=!1,Dv;var V,ne=A,G;if(_.charCodeAt(ne)===gp){for(;A++<T&&_.charCodeAt(A)!==gp||_.charCodeAt(++A)===gp;);return(V=A)>=T?O=!0:(G=_.charCodeAt(A++))===Fo?R=!0:G===_p&&(R=!0,_.charCodeAt(A)===Fo&&++A),_.slice(ne+1,V-1).replace(/""/g,'"')}for(;A<T;){if((G=_.charCodeAt(V=A++))===Fo)R=!0;else if(G===_p)R=!0,_.charCodeAt(A)===Fo&&++A;else if(G!==t)continue;return _.slice(ne,V)}return O=!0,_.slice(ne,T)}for(;(N=E())!==pp;){for(var k=[];N!==Dv&&N!==pp;)k.push(N),N=E();y&&(k=y(k,C++))==null||b.push(k)}return b}function a(_,y){return _.map(function(b){return y.map(function(T){return p(b[T])}).join(n)})}function l(_,y){return y==null&&(y=Pv(_)),[y.map(p).join(n)].concat(a(_,y)).join(`
`)}function c(_,y){return y==null&&(y=Pv(_)),a(_,y).join(`
`)}function f(_){return _.map(d).join(`
`)}function d(_){return _.map(p).join(n)}function p(_){return _==null?"":_ instanceof Date?XO(_):e.test(_+="")?'"'+_.replace(/"/g,'""')+'"':_}return{parse:r,parseRows:i,format:l,formatBody:c,formatRows:f,formatRow:d,formatValue:p}}var qO=YO(","),KO=qO.parse;function mp(n){for(var e in n){var t=n[e].trim(),r,i;if(!t)t=null;else if(t==="true")t=!0;else if(t==="false")t=!1;else if(t==="NaN")t=NaN;else if(!isNaN(r=+t))t=r;else if(i=t.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/))ZO&&i[4]&&!i[7]&&(t=t.replace(/-/g,"/").replace(/T/," ")),t=new Date(t);else continue;n[e]=t}return n}const ZO=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function QO(n){if(!n.ok)throw new Error(n.status+" "+n.statusText);return n.text()}function GO(n,e){return fetch(n,e).then(QO)}function JO(n){return function(e,t,r){return arguments.length===2&&typeof t=="function"&&(r=t,t=void 0),GO(e,t).then(function(i){return n(i,r)})}}var yp=JO(KO);function e4(n){return Math.abs(n=Math.round(n))>=1e21?n.toLocaleString("en").replace(/,/g,""):n.toString(10)}function Uu(n,e){if((t=(n=e?n.toExponential(e-1):n.toExponential()).indexOf("e"))<0)return null;var t,r=n.slice(0,t);return[r.length>1?r[0]+r.slice(2):r,+n.slice(t+1)]}function Ta(n){return n=Uu(Math.abs(n)),n?n[1]:NaN}function t4(n,e){return function(t,r){for(var i=t.length,a=[],l=0,c=n[0],f=0;i>0&&c>0&&(f+c+1>r&&(c=Math.max(1,r-f)),a.push(t.substring(i-=c,i+c)),!((f+=c+1)>r));)c=n[l=(l+1)%n.length];return a.reverse().join(e)}}function n4(n){return function(e){return e.replace(/[0-9]/g,function(t){return n[+t]})}}var r4=/^(?:(.)?([<>=^]))?([+\-( ])?([$#])?(0)?(\d+)?(,)?(\.\d+)?(~)?([a-z%])?$/i;function yl(n){if(!(e=r4.exec(n)))throw new Error("invalid format: "+n);var e;return new C_({fill:e[1],align:e[2],sign:e[3],symbol:e[4],zero:e[5],width:e[6],comma:e[7],precision:e[8]&&e[8].slice(1),trim:e[9],type:e[10]})}yl.prototype=C_.prototype;function C_(n){this.fill=n.fill===void 0?" ":n.fill+"",this.align=n.align===void 0?">":n.align+"",this.sign=n.sign===void 0?"-":n.sign+"",this.symbol=n.symbol===void 0?"":n.symbol+"",this.zero=!!n.zero,this.width=n.width===void 0?void 0:+n.width,this.comma=!!n.comma,this.precision=n.precision===void 0?void 0:+n.precision,this.trim=!!n.trim,this.type=n.type===void 0?"":n.type+""}C_.prototype.toString=function(){return this.fill+this.align+this.sign+this.symbol+(this.zero?"0":"")+(this.width===void 0?"":Math.max(1,this.width|0))+(this.comma?",":"")+(this.precision===void 0?"":"."+Math.max(0,this.precision|0))+(this.trim?"~":"")+this.type};function i4(n){e:for(var e=n.length,t=1,r=-1,i;t<e;++t)switch(n[t]){case".":r=i=t;break;case"0":r===0&&(r=t),i=t;break;default:if(!+n[t])break e;r>0&&(r=0);break}return r>0?n.slice(0,r)+n.slice(i+1):n}var h3;function s4(n,e){var t=Uu(n,e);if(!t)return n+"";var r=t[0],i=t[1],a=i-(h3=Math.max(-8,Math.min(8,Math.floor(i/3)))*3)+1,l=r.length;return a===l?r:a>l?r+new Array(a-l+1).join("0"):a>0?r.slice(0,a)+"."+r.slice(a):"0."+new Array(1-a).join("0")+Uu(n,Math.max(0,e+a-1))[0]}function Uv(n,e){var t=Uu(n,e);if(!t)return n+"";var r=t[0],i=t[1];return i<0?"0."+new Array(-i).join("0")+r:r.length>i+1?r.slice(0,i+1)+"."+r.slice(i+1):r+new Array(i-r.length+2).join("0")}const Bv={"%":(n,e)=>(n*100).toFixed(e),b:n=>Math.round(n).toString(2),c:n=>n+"",d:e4,e:(n,e)=>n.toExponential(e),f:(n,e)=>n.toFixed(e),g:(n,e)=>n.toPrecision(e),o:n=>Math.round(n).toString(8),p:(n,e)=>Uv(n*100,e),r:Uv,s:s4,X:n=>Math.round(n).toString(16).toUpperCase(),x:n=>Math.round(n).toString(16)};function Fv(n){return n}var Lv=Array.prototype.map,zv=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"];function a4(n){var e=n.grouping===void 0||n.thousands===void 0?Fv:t4(Lv.call(n.grouping,Number),n.thousands+""),t=n.currency===void 0?"":n.currency[0]+"",r=n.currency===void 0?"":n.currency[1]+"",i=n.decimal===void 0?".":n.decimal+"",a=n.numerals===void 0?Fv:n4(Lv.call(n.numerals,String)),l=n.percent===void 0?"%":n.percent+"",c=n.minus===void 0?"":n.minus+"",f=n.nan===void 0?"NaN":n.nan+"";function d(_){_=yl(_);var y=_.fill,b=_.align,T=_.sign,A=_.symbol,C=_.zero,N=_.width,O=_.comma,R=_.precision,E=_.trim,k=_.type;k==="n"?(O=!0,k="g"):Bv[k]||(R===void 0&&(R=12),E=!0,k="g"),(C||y==="0"&&b==="=")&&(C=!0,y="0",b="=");var V=A==="$"?t:A==="#"&&/[boxX]/.test(k)?"0"+k.toLowerCase():"",ne=A==="$"?r:/[%p]/.test(k)?l:"",G=Bv[k],se=/[defgprs%]/.test(k);R=R===void 0?6:/[gprs]/.test(k)?Math.max(1,Math.min(21,R)):Math.max(0,Math.min(20,R));function re(q){var ce=V,me=ne,de,_e,$;if(k==="c")me=G(q)+me,q="";else{q=+q;var ee=q<0||1/q<0;if(q=isNaN(q)?f:G(Math.abs(q),R),E&&(q=i4(q)),ee&&+q==0&&T!=="+"&&(ee=!1),ce=(ee?T==="("?T:c:T==="-"||T==="("?"":T)+ce,me=(k==="s"?zv[8+h3/3]:"")+me+(ee&&T==="("?")":""),se){for(de=-1,_e=q.length;++de<_e;)if($=q.charCodeAt(de),48>$||$>57){me=($===46?i+q.slice(de+1):q.slice(de))+me,q=q.slice(0,de);break}}}O&&!C&&(q=e(q,1/0));var fe=ce.length+q.length+me.length,Re=fe<N?new Array(N-fe+1).join(y):"";switch(O&&C&&(q=e(Re+q,Re.length?N-me.length:1/0),Re=""),b){case"<":q=ce+q+me+Re;break;case"=":q=ce+Re+q+me;break;case"^":q=Re.slice(0,fe=Re.length>>1)+ce+q+me+Re.slice(fe);break;default:q=Re+ce+q+me;break}return a(q)}return re.toString=function(){return _+""},re}function p(_,y){var b=d((_=yl(_),_.type="f",_)),T=Math.max(-8,Math.min(8,Math.floor(Ta(y)/3)))*3,A=Math.pow(10,-T),C=zv[8+T/3];return function(N){return b(A*N)+C}}return{format:d,formatPrefix:p}}var tu,M_,d3;o4({thousands:",",grouping:[3],currency:["$",""]});function o4(n){return tu=a4(n),M_=tu.format,d3=tu.formatPrefix,tu}function l4(n){return Math.max(0,-Ta(Math.abs(n)))}function c4(n,e){return Math.max(0,Math.max(-8,Math.min(8,Math.floor(Ta(e)/3)))*3-Ta(Math.abs(n)))}function u4(n,e){return n=Math.abs(n),e=Math.abs(e)-n,Math.max(0,Ta(e)-Ta(n))+1}var f4=Math.PI,h4=f4*2,d4=Math.abs,O_=Math.sqrt;function Ln(){}function Bu(n,e){n&&Hv.hasOwnProperty(n.type)&&Hv[n.type](n,e)}var Vv={Feature:function(n,e){Bu(n.geometry,e)},FeatureCollection:function(n,e){for(var t=n.features,r=-1,i=t.length;++r<i;)Bu(t[r].geometry,e)}},Hv={Sphere:function(n,e){e.sphere()},Point:function(n,e){n=n.coordinates,e.point(n[0],n[1],n[2])},MultiPoint:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)n=t[r],e.point(n[0],n[1],n[2])},LineString:function(n,e){mg(n.coordinates,e,0)},MultiLineString:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)mg(t[r],e,0)},Polygon:function(n,e){jv(n.coordinates,e)},MultiPolygon:function(n,e){for(var t=n.coordinates,r=-1,i=t.length;++r<i;)jv(t[r],e)},GeometryCollection:function(n,e){for(var t=n.geometries,r=-1,i=t.length;++r<i;)Bu(t[r],e)}};function mg(n,e,t){var r=-1,i=n.length-t,a;for(e.lineStart();++r<i;)a=n[r],e.point(a[0],a[1],a[2]);e.lineEnd()}function jv(n,e){var t=-1,r=n.length;for(e.polygonStart();++t<r;)mg(n[t],e,1);e.polygonEnd()}function Lo(n,e){n&&Vv.hasOwnProperty(n.type)?Vv[n.type](n,e):Bu(n,e)}const p4=n=>n;var bp=new ya,yg=new ya,p3,g3,bg,vg,Rr={point:Ln,lineStart:Ln,lineEnd:Ln,polygonStart:function(){Rr.lineStart=g4,Rr.lineEnd=m4},polygonEnd:function(){Rr.lineStart=Rr.lineEnd=Rr.point=Ln,bp.add(d4(yg)),yg=new ya},result:function(){var n=bp/2;return bp=new ya,n}};function g4(){Rr.point=_4}function _4(n,e){Rr.point=_3,p3=bg=n,g3=vg=e}function _3(n,e){yg.add(vg*n-bg*e),bg=n,vg=e}function m4(){_3(p3,g3)}var wa=1/0,Fu=wa,bl=-wa,Lu=bl,$v={point:y4,lineStart:Ln,lineEnd:Ln,polygonStart:Ln,polygonEnd:Ln,result:function(){var n=[[wa,Fu],[bl,Lu]];return bl=Lu=-(Fu=wa=1/0),n}};function y4(n,e){n<wa&&(wa=n),n>bl&&(bl=n),e<Fu&&(Fu=e),e>Lu&&(Lu=e)}var Tg=0,wg=0,Ko=0,zu=0,Vu=0,oa=0,xg=0,Sg=0,Zo=0,m3,y3,Gn,Jn,Sn={point:Qi,lineStart:Wv,lineEnd:Xv,polygonStart:function(){Sn.lineStart=T4,Sn.lineEnd=w4},polygonEnd:function(){Sn.point=Qi,Sn.lineStart=Wv,Sn.lineEnd=Xv},result:function(){var n=Zo?[xg/Zo,Sg/Zo]:oa?[zu/oa,Vu/oa]:Ko?[Tg/Ko,wg/Ko]:[NaN,NaN];return Tg=wg=Ko=zu=Vu=oa=xg=Sg=Zo=0,n}};function Qi(n,e){Tg+=n,wg+=e,++Ko}function Wv(){Sn.point=b4}function b4(n,e){Sn.point=v4,Qi(Gn=n,Jn=e)}function v4(n,e){var t=n-Gn,r=e-Jn,i=O_(t*t+r*r);zu+=i*(Gn+n)/2,Vu+=i*(Jn+e)/2,oa+=i,Qi(Gn=n,Jn=e)}function Xv(){Sn.point=Qi}function T4(){Sn.point=x4}function w4(){b3(m3,y3)}function x4(n,e){Sn.point=b3,Qi(m3=Gn=n,y3=Jn=e)}function b3(n,e){var t=n-Gn,r=e-Jn,i=O_(t*t+r*r);zu+=i*(Gn+n)/2,Vu+=i*(Jn+e)/2,oa+=i,i=Jn*n-Gn*e,xg+=i*(Gn+n),Sg+=i*(Jn+e),Zo+=i*3,Qi(Gn=n,Jn=e)}function v3(n){this._context=n}v3.prototype={_radius:4.5,pointRadius:function(n){return this._radius=n,this},polygonStart:function(){this._line=0},polygonEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){this._line===0&&this._context.closePath(),this._point=NaN},point:function(n,e){switch(this._point){case 0:{this._context.moveTo(n,e),this._point=1;break}case 1:{this._context.lineTo(n,e);break}default:{this._context.moveTo(n+this._radius,e),this._context.arc(n,e,this._radius,0,h4);break}}},result:Ln};var Ag=new ya,vp,T3,w3,Qo,Go,vl={point:Ln,lineStart:function(){vl.point=S4},lineEnd:function(){vp&&x3(T3,w3),vl.point=Ln},polygonStart:function(){vp=!0},polygonEnd:function(){vp=null},result:function(){var n=+Ag;return Ag=new ya,n}};function S4(n,e){vl.point=x3,T3=Qo=n,w3=Go=e}function x3(n,e){Qo-=n,Go-=e,Ag.add(O_(Qo*Qo+Go*Go)),Qo=n,Go=e}let Yv,Hu,qv,Kv;class Zv{constructor(e){this._append=e==null?S3:A4(e),this._radius=4.5,this._=""}pointRadius(e){return this._radius=+e,this}polygonStart(){this._line=0}polygonEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){this._line===0&&(this._+="Z"),this._point=NaN}point(e,t){switch(this._point){case 0:{this._append`M${e},${t}`,this._point=1;break}case 1:{this._append`L${e},${t}`;break}default:{if(this._append`M${e},${t}`,this._radius!==qv||this._append!==Hu){const r=this._radius,i=this._;this._="",this._append`m0,${r}a${r},${r} 0 1,1 0,${-2*r}a${r},${r} 0 1,1 0,${2*r}z`,qv=r,Hu=this._append,Kv=this._,this._=i}this._+=Kv;break}}}result(){const e=this._;return this._="",e.length?e:null}}function S3(n){let e=1;this._+=n[0];for(const t=n.length;e<t;++e)this._+=arguments[e]+n[e]}function A4(n){const e=Math.floor(n);if(!(e>=0))throw new RangeError(`invalid digits: ${n}`);if(e>15)return S3;if(e!==Yv){const t=10**e;Yv=e,Hu=function(i){let a=1;this._+=i[0];for(const l=i.length;a<l;++a)this._+=Math.round(arguments[a]*t)/t+i[a]}}return Hu}function E4(n,e){let t=3,r=4.5,i,a;function l(c){return c&&(typeof r=="function"&&a.pointRadius(+r.apply(this,arguments)),Lo(c,i(a))),a.result()}return l.area=function(c){return Lo(c,i(Rr)),Rr.result()},l.measure=function(c){return Lo(c,i(vl)),vl.result()},l.bounds=function(c){return Lo(c,i($v)),$v.result()},l.centroid=function(c){return Lo(c,i(Sn)),Sn.result()},l.projection=function(c){return arguments.length?(i=c==null?(n=null,p4):(n=c).stream,l):n},l.context=function(c){return arguments.length?(a=c==null?(e=null,new Zv(t)):new v3(e=c),typeof r!="function"&&a.pointRadius(r),l):e},l.pointRadius=function(c){return arguments.length?(r=typeof c=="function"?c:(a.pointRadius(+c),+c),l):r},l.digits=function(c){if(!arguments.length)return t;if(c==null)t=null;else{const f=Math.floor(c);if(!(f>=0))throw new RangeError(`invalid digits: ${c}`);t=f}return e===null&&(a=new Zv(t)),l},l.projection(n).digits(t).context(e)}function Bf(n,e){switch(arguments.length){case 0:break;case 1:this.range(n);break;default:this.range(e).domain(n);break}return this}const Qv=Symbol("implicit");function I_(){var n=new gv,e=[],t=[],r=Qv;function i(a){let l=n.get(a);if(l===void 0){if(r!==Qv)return r;n.set(a,l=e.push(a)-1)}return t[l%t.length]}return i.domain=function(a){if(!arguments.length)return e.slice();e=[],n=new gv;for(const l of a)n.has(l)||n.set(l,e.push(l)-1);return i},i.range=function(a){return arguments.length?(t=Array.from(a),i):t.slice()},i.unknown=function(a){return arguments.length?(r=a,i):r},i.copy=function(){return I_(e,t).unknown(r)},Bf.apply(i,arguments),i}function N_(){var n=I_().unknown(void 0),e=n.domain,t=n.range,r=0,i=1,a,l,c=!1,f=0,d=0,p=.5;delete n.unknown;function _(){var y=e().length,b=i<r,T=b?i:r,A=b?r:i;a=(A-T)/Math.max(1,y-f+d*2),c&&(a=Math.floor(a)),T+=(A-T-a*(y-f))*p,l=a*(1-f),c&&(T=Math.round(T),l=Math.round(l));var C=lR(y).map(function(N){return T+a*N});return t(b?C.reverse():C)}return n.domain=function(y){return arguments.length?(e(y),_()):e()},n.range=function(y){return arguments.length?([r,i]=y,r=+r,i=+i,_()):[r,i]},n.rangeRound=function(y){return[r,i]=y,r=+r,i=+i,c=!0,_()},n.bandwidth=function(){return l},n.step=function(){return a},n.round=function(y){return arguments.length?(c=!!y,_()):c},n.padding=function(y){return arguments.length?(f=Math.min(1,d=+y),_()):f},n.paddingInner=function(y){return arguments.length?(f=Math.min(1,y),_()):f},n.paddingOuter=function(y){return arguments.length?(d=+y,_()):d},n.align=function(y){return arguments.length?(p=Math.max(0,Math.min(1,y)),_()):p},n.copy=function(){return N_(e(),[r,i]).round(c).paddingInner(f).paddingOuter(d).align(p)},Bf.apply(_(),arguments)}function A3(n){var e=n.copy;return n.padding=n.paddingOuter,delete n.paddingInner,delete n.paddingOuter,n.copy=function(){return A3(e())},n}function R4(){return A3(N_.apply(null,arguments).paddingInner(1))}function C4(n){return function(){return n}}function M4(n){return+n}var Gv=[0,1];function la(n){return n}function Eg(n,e){return(e-=n=+n)?function(t){return(t-n)/e}:C4(isNaN(e)?NaN:.5)}function O4(n,e){var t;return n>e&&(t=n,n=e,e=t),function(r){return Math.max(n,Math.min(e,r))}}function I4(n,e,t){var r=n[0],i=n[1],a=e[0],l=e[1];return i<r?(r=Eg(i,r),a=t(l,a)):(r=Eg(r,i),a=t(a,l)),function(c){return a(r(c))}}function N4(n,e,t){var r=Math.min(n.length,e.length)-1,i=new Array(r),a=new Array(r),l=-1;for(n[r]<n[0]&&(n=n.slice().reverse(),e=e.slice().reverse());++l<r;)i[l]=Eg(n[l],n[l+1]),a[l]=t(e[l],e[l+1]);return function(c){var f=XE(n,c,1,r)-1;return a[f](i[f](c))}}function E3(n,e){return e.domain(n.domain()).range(n.range()).interpolate(n.interpolate()).clamp(n.clamp()).unknown(n.unknown())}function R3(){var n=Gv,e=Gv,t=S_,r,i,a,l=la,c,f,d;function p(){var y=Math.min(n.length,e.length);return l!==la&&(l=O4(n[0],n[y-1])),c=y>2?N4:I4,f=d=null,_}function _(y){return y==null||isNaN(y=+y)?a:(f||(f=c(n.map(r),e,t)))(r(l(y)))}return _.invert=function(y){return l(i((d||(d=c(e,n.map(r),Bn)))(y)))},_.domain=function(y){return arguments.length?(n=Array.from(y,M4),p()):n.slice()},_.range=function(y){return arguments.length?(e=Array.from(y),p()):e.slice()},_.rangeRound=function(y){return e=Array.from(y),t=hM,p()},_.clamp=function(y){return arguments.length?(l=y?!0:la,p()):l!==la},_.interpolate=function(y){return arguments.length?(t=y,p()):t},_.unknown=function(y){return arguments.length?(a=y,_):a},function(y,b){return r=y,i=b,p()}}function k4(){return R3()(la,la)}function D4(n,e,t,r){var i=sR(n,e,t),a;switch(r=yl(r??",f"),r.type){case"s":{var l=Math.max(Math.abs(n),Math.abs(e));return r.precision==null&&!isNaN(a=c4(i,l))&&(r.precision=a),d3(r,l)}case"":case"e":case"g":case"p":case"r":{r.precision==null&&!isNaN(a=u4(i,Math.max(Math.abs(n),Math.abs(e))))&&(r.precision=a-(r.type==="e"));break}case"f":case"%":{r.precision==null&&!isNaN(a=l4(i))&&(r.precision=a-(r.type==="%")*2);break}}return M_(r)}function P4(n){var e=n.domain;return n.ticks=function(t){var r=e();return pl(r[0],r[r.length-1],t??10)},n.tickFormat=function(t,r){var i=e();return D4(i[0],i[i.length-1],t??10,r)},n.nice=function(t){t==null&&(t=10);var r=e(),i=0,a=r.length-1,l=r[i],c=r[a],f,d,p=10;for(c<l&&(d=l,l=c,c=d,d=i,i=a,a=d);p-- >0;){if(d=Cu(l,c,t),d===f)return r[i]=l,r[a]=c,e(r);if(d>0)l=Math.floor(l/d)*d,c=Math.ceil(c/d)*d;else if(d<0)l=Math.ceil(l*d)/d,c=Math.floor(c*d)/d;else break;f=d}return n},n}function ju(){var n=k4();return n.copy=function(){return E3(n,ju())},Bf.apply(n,arguments),P4(n)}function U4(n,e){n=n.slice();var t=0,r=n.length-1,i=n[t],a=n[r],l;return a<i&&(l=t,t=r,r=l,l=i,i=a,a=l),n[t]=e.floor(i),n[r]=e.ceil(a),n}function Jv(n){return Math.log(n)}function e1(n){return Math.exp(n)}function B4(n){return-Math.log(-n)}function F4(n){return-Math.exp(-n)}function L4(n){return isFinite(n)?+("1e"+n):n<0?0:n}function z4(n){return n===10?L4:n===Math.E?Math.exp:e=>Math.pow(n,e)}function V4(n){return n===Math.E?Math.log:n===10&&Math.log10||n===2&&Math.log2||(n=Math.log(n),e=>Math.log(e)/n)}function t1(n){return(e,t)=>-n(-e,t)}function H4(n){const e=n(Jv,e1),t=e.domain;let r=10,i,a;function l(){return i=V4(r),a=z4(r),t()[0]<0?(i=t1(i),a=t1(a),n(B4,F4)):n(Jv,e1),e}return e.base=function(c){return arguments.length?(r=+c,l()):r},e.domain=function(c){return arguments.length?(t(c),l()):t()},e.ticks=c=>{const f=t();let d=f[0],p=f[f.length-1];const _=p<d;_&&([d,p]=[p,d]);let y=i(d),b=i(p),T,A;const C=c==null?10:+c;let N=[];if(!(r%1)&&b-y<C){if(y=Math.floor(y),b=Math.ceil(b),d>0){for(;y<=b;++y)for(T=1;T<r;++T)if(A=y<0?T/a(-y):T*a(y),!(A<d)){if(A>p)break;N.push(A)}}else for(;y<=b;++y)for(T=r-1;T>=1;--T)if(A=y>0?T/a(-y):T*a(y),!(A<d)){if(A>p)break;N.push(A)}N.length*2<C&&(N=pl(d,p,C))}else N=pl(y,b,Math.min(b-y,C)).map(a);return _?N.reverse():N},e.tickFormat=(c,f)=>{if(c==null&&(c=10),f==null&&(f=r===10?"s":","),typeof f!="function"&&(!(r%1)&&(f=yl(f)).precision==null&&(f.trim=!0),f=M_(f)),c===1/0)return f;const d=Math.max(1,r*c/e.ticks().length);return p=>{let _=p/a(Math.round(i(p)));return _*r<r-.5&&(_*=r),_<=d?f(p):""}},e.nice=()=>t(U4(t(),{floor:c=>a(Math.floor(i(c))),ceil:c=>a(Math.ceil(i(c)))})),e}function C3(){const n=H4(R3()).domain([1,10]);return n.copy=()=>E3(n,C3()).base(n.base()),Bf.apply(n,arguments),n}const Tp=new Date,wp=new Date;function ar(n,e,t,r){function i(a){return n(a=arguments.length===0?new Date:new Date(+a)),a}return i.floor=a=>(n(a=new Date(+a)),a),i.ceil=a=>(n(a=new Date(a-1)),e(a,1),n(a),a),i.round=a=>{const l=i(a),c=i.ceil(a);return a-l<c-a?l:c},i.offset=(a,l)=>(e(a=new Date(+a),l==null?1:Math.floor(l)),a),i.range=(a,l,c)=>{const f=[];if(a=i.ceil(a),c=c==null?1:Math.floor(c),!(a<l)||!(c>0))return f;let d;do f.push(d=new Date(+a)),e(a,c),n(a);while(d<a&&a<l);return f},i.filter=a=>ar(l=>{if(l>=l)for(;n(l),!a(l);)l.setTime(l-1)},(l,c)=>{if(l>=l)if(c<0)for(;++c<=0;)for(;e(l,-1),!a(l););else for(;--c>=0;)for(;e(l,1),!a(l););}),t&&(i.count=(a,l)=>(Tp.setTime(+a),wp.setTime(+l),n(Tp),n(wp),Math.floor(t(Tp,wp))),i.every=a=>(a=Math.floor(a),!isFinite(a)||!(a>0)?null:a>1?i.filter(r?l=>r(l)%a===0:l=>i.count(0,l)%a===0):i)),i}const j4=1e3,k_=j4*60,$4=k_*60,Tl=$4*24,M3=Tl*7,D_=ar(n=>n.setHours(0,0,0,0),(n,e)=>n.setDate(n.getDate()+e),(n,e)=>(e-n-(e.getTimezoneOffset()-n.getTimezoneOffset())*k_)/Tl,n=>n.getDate()-1);D_.range;const P_=ar(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/Tl,n=>n.getUTCDate()-1);P_.range;const W4=ar(n=>{n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCDate(n.getUTCDate()+e)},(n,e)=>(e-n)/Tl,n=>Math.floor(n/Tl));W4.range;function is(n){return ar(e=>{e.setDate(e.getDate()-(e.getDay()+7-n)%7),e.setHours(0,0,0,0)},(e,t)=>{e.setDate(e.getDate()+t*7)},(e,t)=>(t-e-(t.getTimezoneOffset()-e.getTimezoneOffset())*k_)/M3)}const O3=is(0),$u=is(1),X4=is(2),Y4=is(3),xa=is(4),q4=is(5),K4=is(6);O3.range;$u.range;X4.range;Y4.range;xa.range;q4.range;K4.range;function ss(n){return ar(e=>{e.setUTCDate(e.getUTCDate()-(e.getUTCDay()+7-n)%7),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCDate(e.getUTCDate()+t*7)},(e,t)=>(t-e)/M3)}const I3=ss(0),Wu=ss(1),Z4=ss(2),Q4=ss(3),Sa=ss(4),G4=ss(5),J4=ss(6);I3.range;Wu.range;Z4.range;Q4.range;Sa.range;G4.range;J4.range;const Gi=ar(n=>{n.setMonth(0,1),n.setHours(0,0,0,0)},(n,e)=>{n.setFullYear(n.getFullYear()+e)},(n,e)=>e.getFullYear()-n.getFullYear(),n=>n.getFullYear());Gi.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:ar(e=>{e.setFullYear(Math.floor(e.getFullYear()/n)*n),e.setMonth(0,1),e.setHours(0,0,0,0)},(e,t)=>{e.setFullYear(e.getFullYear()+t*n)});Gi.range;const Ji=ar(n=>{n.setUTCMonth(0,1),n.setUTCHours(0,0,0,0)},(n,e)=>{n.setUTCFullYear(n.getUTCFullYear()+e)},(n,e)=>e.getUTCFullYear()-n.getUTCFullYear(),n=>n.getUTCFullYear());Ji.every=n=>!isFinite(n=Math.floor(n))||!(n>0)?null:ar(e=>{e.setUTCFullYear(Math.floor(e.getUTCFullYear()/n)*n),e.setUTCMonth(0,1),e.setUTCHours(0,0,0,0)},(e,t)=>{e.setUTCFullYear(e.getUTCFullYear()+t*n)});Ji.range;function xp(n){if(0<=n.y&&n.y<100){var e=new Date(-1,n.m,n.d,n.H,n.M,n.S,n.L);return e.setFullYear(n.y),e}return new Date(n.y,n.m,n.d,n.H,n.M,n.S,n.L)}function Sp(n){if(0<=n.y&&n.y<100){var e=new Date(Date.UTC(-1,n.m,n.d,n.H,n.M,n.S,n.L));return e.setUTCFullYear(n.y),e}return new Date(Date.UTC(n.y,n.m,n.d,n.H,n.M,n.S,n.L))}function zo(n,e,t){return{y:n,m:e,d:t,H:0,M:0,S:0,L:0}}function eI(n){var e=n.dateTime,t=n.date,r=n.time,i=n.periods,a=n.days,l=n.shortDays,c=n.months,f=n.shortMonths,d=Vo(i),p=Ho(i),_=Vo(a),y=Ho(a),b=Vo(l),T=Ho(l),A=Vo(c),C=Ho(c),N=Vo(f),O=Ho(f),R={a:ee,A:fe,b:Re,B:D,c:null,d:o1,e:o1,f:xI,g:kI,G:PI,H:vI,I:TI,j:wI,L:N3,m:SI,M:AI,p:ie,q:ge,Q:u1,s:f1,S:EI,u:RI,U:CI,V:MI,w:OI,W:II,x:null,X:null,y:NI,Y:DI,Z:UI,"%":c1},E={a:he,A:ve,b:Pe,B:Ae,c:null,d:l1,e:l1,f:zI,g:ZI,G:GI,H:BI,I:FI,j:LI,L:D3,m:VI,M:HI,p:Ht,q:Je,Q:u1,s:f1,S:jI,u:$I,U:WI,V:XI,w:YI,W:qI,x:null,X:null,y:KI,Y:QI,Z:JI,"%":c1},k={a:re,A:q,b:ce,B:me,c:de,d:s1,e:s1,f:_I,g:i1,G:r1,H:a1,I:a1,j:hI,L:gI,m:fI,M:dI,p:se,q:uI,Q:yI,s:bI,S:pI,u:sI,U:aI,V:oI,w:iI,W:lI,x:_e,X:$,y:i1,Y:r1,Z:cI,"%":mI};R.x=V(t,R),R.X=V(r,R),R.c=V(e,R),E.x=V(t,E),E.X=V(r,E),E.c=V(e,E);function V(pe,Me){return function(Ne){var oe=[],wt=-1,He=0,jt=pe.length,$t,xt,Bl;for(Ne instanceof Date||(Ne=new Date(+Ne));++wt<jt;)pe.charCodeAt(wt)===37&&(oe.push(pe.slice(He,wt)),(xt=n1[$t=pe.charAt(++wt)])!=null?$t=pe.charAt(++wt):xt=$t==="e"?" ":"0",(Bl=Me[$t])&&($t=Bl(Ne,xt)),oe.push($t),He=wt+1);return oe.push(pe.slice(He,wt)),oe.join("")}}function ne(pe,Me){return function(Ne){var oe=zo(1900,void 0,1),wt=G(oe,pe,Ne+="",0),He,jt;if(wt!=Ne.length)return null;if("Q"in oe)return new Date(oe.Q);if("s"in oe)return new Date(oe.s*1e3+("L"in oe?oe.L:0));if(Me&&!("Z"in oe)&&(oe.Z=0),"p"in oe&&(oe.H=oe.H%12+oe.p*12),oe.m===void 0&&(oe.m="q"in oe?oe.q:0),"V"in oe){if(oe.V<1||oe.V>53)return null;"w"in oe||(oe.w=1),"Z"in oe?(He=Sp(zo(oe.y,0,1)),jt=He.getUTCDay(),He=jt>4||jt===0?Wu.ceil(He):Wu(He),He=P_.offset(He,(oe.V-1)*7),oe.y=He.getUTCFullYear(),oe.m=He.getUTCMonth(),oe.d=He.getUTCDate()+(oe.w+6)%7):(He=xp(zo(oe.y,0,1)),jt=He.getDay(),He=jt>4||jt===0?$u.ceil(He):$u(He),He=D_.offset(He,(oe.V-1)*7),oe.y=He.getFullYear(),oe.m=He.getMonth(),oe.d=He.getDate()+(oe.w+6)%7)}else("W"in oe||"U"in oe)&&("w"in oe||(oe.w="u"in oe?oe.u%7:"W"in oe?1:0),jt="Z"in oe?Sp(zo(oe.y,0,1)).getUTCDay():xp(zo(oe.y,0,1)).getDay(),oe.m=0,oe.d="W"in oe?(oe.w+6)%7+oe.W*7-(jt+5)%7:oe.w+oe.U*7-(jt+6)%7);return"Z"in oe?(oe.H+=oe.Z/100|0,oe.M+=oe.Z%100,Sp(oe)):xp(oe)}}function G(pe,Me,Ne,oe){for(var wt=0,He=Me.length,jt=Ne.length,$t,xt;wt<He;){if(oe>=jt)return-1;if($t=Me.charCodeAt(wt++),$t===37){if($t=Me.charAt(wt++),xt=k[$t in n1?Me.charAt(wt++):$t],!xt||(oe=xt(pe,Ne,oe))<0)return-1}else if($t!=Ne.charCodeAt(oe++))return-1}return oe}function se(pe,Me,Ne){var oe=d.exec(Me.slice(Ne));return oe?(pe.p=p.get(oe[0].toLowerCase()),Ne+oe[0].length):-1}function re(pe,Me,Ne){var oe=b.exec(Me.slice(Ne));return oe?(pe.w=T.get(oe[0].toLowerCase()),Ne+oe[0].length):-1}function q(pe,Me,Ne){var oe=_.exec(Me.slice(Ne));return oe?(pe.w=y.get(oe[0].toLowerCase()),Ne+oe[0].length):-1}function ce(pe,Me,Ne){var oe=N.exec(Me.slice(Ne));return oe?(pe.m=O.get(oe[0].toLowerCase()),Ne+oe[0].length):-1}function me(pe,Me,Ne){var oe=A.exec(Me.slice(Ne));return oe?(pe.m=C.get(oe[0].toLowerCase()),Ne+oe[0].length):-1}function de(pe,Me,Ne){return G(pe,e,Me,Ne)}function _e(pe,Me,Ne){return G(pe,t,Me,Ne)}function $(pe,Me,Ne){return G(pe,r,Me,Ne)}function ee(pe){return l[pe.getDay()]}function fe(pe){return a[pe.getDay()]}function Re(pe){return f[pe.getMonth()]}function D(pe){return c[pe.getMonth()]}function ie(pe){return i[+(pe.getHours()>=12)]}function ge(pe){return 1+~~(pe.getMonth()/3)}function he(pe){return l[pe.getUTCDay()]}function ve(pe){return a[pe.getUTCDay()]}function Pe(pe){return f[pe.getUTCMonth()]}function Ae(pe){return c[pe.getUTCMonth()]}function Ht(pe){return i[+(pe.getUTCHours()>=12)]}function Je(pe){return 1+~~(pe.getUTCMonth()/3)}return{format:function(pe){var Me=V(pe+="",R);return Me.toString=function(){return pe},Me},parse:function(pe){var Me=ne(pe+="",!1);return Me.toString=function(){return pe},Me},utcFormat:function(pe){var Me=V(pe+="",E);return Me.toString=function(){return pe},Me},utcParse:function(pe){var Me=ne(pe+="",!0);return Me.toString=function(){return pe},Me}}}var n1={"-":"",_:" ",0:"0"},Mt=/^\s*\d+/,tI=/^%/,nI=/[\\^$*+?|[\]().{}]/g;function Fe(n,e,t){var r=n<0?"-":"",i=(r?-n:n)+"",a=i.length;return r+(a<t?new Array(t-a+1).join(e)+i:i)}function rI(n){return n.replace(nI,"\\$&")}function Vo(n){return new RegExp("^(?:"+n.map(rI).join("|")+")","i")}function Ho(n){return new Map(n.map((e,t)=>[e.toLowerCase(),t]))}function iI(n,e,t){var r=Mt.exec(e.slice(t,t+1));return r?(n.w=+r[0],t+r[0].length):-1}function sI(n,e,t){var r=Mt.exec(e.slice(t,t+1));return r?(n.u=+r[0],t+r[0].length):-1}function aI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.U=+r[0],t+r[0].length):-1}function oI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.V=+r[0],t+r[0].length):-1}function lI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.W=+r[0],t+r[0].length):-1}function r1(n,e,t){var r=Mt.exec(e.slice(t,t+4));return r?(n.y=+r[0],t+r[0].length):-1}function i1(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.y=+r[0]+(+r[0]>68?1900:2e3),t+r[0].length):-1}function cI(n,e,t){var r=/^(Z)|([+-]\d\d)(?::?(\d\d))?/.exec(e.slice(t,t+6));return r?(n.Z=r[1]?0:-(r[2]+(r[3]||"00")),t+r[0].length):-1}function uI(n,e,t){var r=Mt.exec(e.slice(t,t+1));return r?(n.q=r[0]*3-3,t+r[0].length):-1}function fI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.m=r[0]-1,t+r[0].length):-1}function s1(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.d=+r[0],t+r[0].length):-1}function hI(n,e,t){var r=Mt.exec(e.slice(t,t+3));return r?(n.m=0,n.d=+r[0],t+r[0].length):-1}function a1(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.H=+r[0],t+r[0].length):-1}function dI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.M=+r[0],t+r[0].length):-1}function pI(n,e,t){var r=Mt.exec(e.slice(t,t+2));return r?(n.S=+r[0],t+r[0].length):-1}function gI(n,e,t){var r=Mt.exec(e.slice(t,t+3));return r?(n.L=+r[0],t+r[0].length):-1}function _I(n,e,t){var r=Mt.exec(e.slice(t,t+6));return r?(n.L=Math.floor(r[0]/1e3),t+r[0].length):-1}function mI(n,e,t){var r=tI.exec(e.slice(t,t+1));return r?t+r[0].length:-1}function yI(n,e,t){var r=Mt.exec(e.slice(t));return r?(n.Q=+r[0],t+r[0].length):-1}function bI(n,e,t){var r=Mt.exec(e.slice(t));return r?(n.s=+r[0],t+r[0].length):-1}function o1(n,e){return Fe(n.getDate(),e,2)}function vI(n,e){return Fe(n.getHours(),e,2)}function TI(n,e){return Fe(n.getHours()%12||12,e,2)}function wI(n,e){return Fe(1+D_.count(Gi(n),n),e,3)}function N3(n,e){return Fe(n.getMilliseconds(),e,3)}function xI(n,e){return N3(n,e)+"000"}function SI(n,e){return Fe(n.getMonth()+1,e,2)}function AI(n,e){return Fe(n.getMinutes(),e,2)}function EI(n,e){return Fe(n.getSeconds(),e,2)}function RI(n){var e=n.getDay();return e===0?7:e}function CI(n,e){return Fe(O3.count(Gi(n)-1,n),e,2)}function k3(n){var e=n.getDay();return e>=4||e===0?xa(n):xa.ceil(n)}function MI(n,e){return n=k3(n),Fe(xa.count(Gi(n),n)+(Gi(n).getDay()===4),e,2)}function OI(n){return n.getDay()}function II(n,e){return Fe($u.count(Gi(n)-1,n),e,2)}function NI(n,e){return Fe(n.getFullYear()%100,e,2)}function kI(n,e){return n=k3(n),Fe(n.getFullYear()%100,e,2)}function DI(n,e){return Fe(n.getFullYear()%1e4,e,4)}function PI(n,e){var t=n.getDay();return n=t>=4||t===0?xa(n):xa.ceil(n),Fe(n.getFullYear()%1e4,e,4)}function UI(n){var e=n.getTimezoneOffset();return(e>0?"-":(e*=-1,"+"))+Fe(e/60|0,"0",2)+Fe(e%60,"0",2)}function l1(n,e){return Fe(n.getUTCDate(),e,2)}function BI(n,e){return Fe(n.getUTCHours(),e,2)}function FI(n,e){return Fe(n.getUTCHours()%12||12,e,2)}function LI(n,e){return Fe(1+P_.count(Ji(n),n),e,3)}function D3(n,e){return Fe(n.getUTCMilliseconds(),e,3)}function zI(n,e){return D3(n,e)+"000"}function VI(n,e){return Fe(n.getUTCMonth()+1,e,2)}function HI(n,e){return Fe(n.getUTCMinutes(),e,2)}function jI(n,e){return Fe(n.getUTCSeconds(),e,2)}function $I(n){var e=n.getUTCDay();return e===0?7:e}function WI(n,e){return Fe(I3.count(Ji(n)-1,n),e,2)}function P3(n){var e=n.getUTCDay();return e>=4||e===0?Sa(n):Sa.ceil(n)}function XI(n,e){return n=P3(n),Fe(Sa.count(Ji(n),n)+(Ji(n).getUTCDay()===4),e,2)}function YI(n){return n.getUTCDay()}function qI(n,e){return Fe(Wu.count(Ji(n)-1,n),e,2)}function KI(n,e){return Fe(n.getUTCFullYear()%100,e,2)}function ZI(n,e){return n=P3(n),Fe(n.getUTCFullYear()%100,e,2)}function QI(n,e){return Fe(n.getUTCFullYear()%1e4,e,4)}function GI(n,e){var t=n.getUTCDay();return n=t>=4||t===0?Sa(n):Sa.ceil(n),Fe(n.getUTCFullYear()%1e4,e,4)}function JI(){return"+0000"}function c1(){return"%"}function u1(n){return+n}function f1(n){return Math.floor(+n/1e3)}var Qs,U3;eN({dateTime:"%x, %X",date:"%-m/%-d/%Y",time:"%-I:%M:%S %p",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});function eN(n){return Qs=eI(n),Qs.format,U3=Qs.parse,Qs.utcFormat,Qs.utcParse,Qs}function Jo(n,e,t){this.k=n,this.x=e,this.y=t}Jo.prototype={constructor:Jo,scale:function(n){return n===1?this:new Jo(this.k*n,this.x,this.y)},translate:function(n,e){return n===0&e===0?this:new Jo(this.k,this.x+this.k*n,this.y+this.k*e)},apply:function(n){return[n[0]*this.k+this.x,n[1]*this.k+this.y]},applyX:function(n){return n*this.k+this.x},applyY:function(n){return n*this.k+this.y},invert:function(n){return[(n[0]-this.x)/this.k,(n[1]-this.y)/this.k]},invertX:function(n){return(n-this.x)/this.k},invertY:function(n){return(n-this.y)/this.k},rescaleX:function(n){return n.copy().domain(n.range().map(this.invertX,this).map(n.invert,n))},rescaleY:function(n){return n.copy().domain(n.range().map(this.invertY,this).map(n.invert,n))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Jo.prototype;const Gs={top:40,right:40,bottom:40,left:40},h1=800,d1=800,tN=K.forwardRef(({data:n,onBubbleClick:e,currentStep:t},r)=>{const i=K.useRef(),a=K.useRef(null),l=K.useRef(),c=K.useRef(),f=K.useRef(),d=K.useRef(),p=K.useRef(),_=K.useRef(),y=K.useRef(),b=h1-Gs.left-Gs.right,T=d1-Gs.top-Gs.bottom,A=K.useRef(t),C=K.useRef(null);K.useImperativeHandle(r,()=>({updateVisualization(R){A.current!==R&&(A.current=R,O(R))}}));const N=K.useRef(!1);K.useEffect(()=>{if(!n||n.length===0||N.current)return;N.current=!0,a.current=document.getElementById("global-tooltip");const R=Zn(i.current);R.selectAll("*").remove(),Zn(a.current).style("opacity",0);const E=R.append("g").attr("transform",`translate(${Gs.left}, ${Gs.top})`);E.append("g").attr("class","contour-layer");const k=E.append("g").attr("class","bubble-layer");c.current=E.append("line").attr("x1",b/2).attr("x2",b/2).attr("y1",0).attr("y2",T).attr("stroke","#aaa").style("display","none"),f.current=E.append("line").attr("x1",0).attr("x2",b).attr("y1",T/2).attr("y2",T/2).attr("stroke","#aaa").style("display","none"),d.current=E.append("text").attr("x",10).attr("y",T/2-10).attr("text-anchor","start").style("font-size","12px").style("fill","#555").style("display","none").text("Critique of Government Policies"),p.current=E.append("text").attr("x",b/2+65).attr("y",15).attr("text-anchor","middle").style("font-size","12px").style("fill","#555").style("display","none").text("Environment Aligned"),_.current=E.append("text").attr("x",b/2+45).attr("y",T-10).attr("text-anchor","middle").style("font-size","12px").style("fill","#555").style("display","none").text("Belief Aligned"),y.current=E.append("text").attr("x",b-60).attr("y",T/2-10).attr("text-anchor","end").style("font-size","12px").style("fill","#555").style("display","none").text("In Favour of Government");const V=13,ne=40,G=k.selectAll(".bubble").data(n).enter().append("circle").attr("cx",(se,re)=>re%V*ne).attr("cy",(se,re)=>Math.floor(re/V)*ne).attr("r",se=>se.size||9).attr("fill",se=>nN(se)).attr("opacity",0).on("mouseover",(se,re)=>{if(!a.current)return;const q=Zn(a.current),ce=220,me=100,de=window.innerWidth,_e=window.innerHeight;let $=se.clientX+10,ee=se.clientY-20;$+ce>de&&($=se.clientX-ce-10),ee+me>_e&&(ee=_e-me-10),ee<0&&(ee=10),q.style("opacity",1).style("left",`${$}px`).style("top",`${ee}px`).html(rN(re))}).on("mousemove",se=>{if(!a.current)return;const re=Zn(a.current),q=220,ce=100,me=window.innerWidth,de=window.innerHeight;let _e=se.clientX+10,$=se.clientY-20;_e+q>me&&(_e=se.clientX-q-10),$+ce>de&&($=de-ce-10),$<0&&($=10),re.style("left",`${_e}px`).style("top",`${$}px`)}).on("mouseout",()=>{a.current&&Zn(a.current).style("opacity",0)}).on("click",(se,re)=>{se.stopImmediatePropagation(),e&&e(re),C.current&&C.current.attr("stroke",null).attr("stroke-width",null).attr("r",ce=>ce.size||9);const q=Zn(se.currentTarget);q.attr("stroke","#ffba08").attr("stroke-width",3).attr("r",ce=>(ce.size||9)+4),C.current=q});l.current=G,A.current=t,O(t)},[n]);function O(R){var se,re,q,ce,me,de;if(!l.current)return;const E=ju().domain([-1,1]).range([0,b]),k=ju().domain([-1,1]).range([T,0]),V=_e=>{const $=_e.Predicted_Label_gov,ee=_e.Crit_Gov_Score??0,fe=_e.Pro_Gov_Score??0;return $==="Critical of Government"?E(-ee):$==="Pro-Government"?E(fe):$==="Neutral"?ee>fe?E(-ee):E(fe):b/2},ne=_e=>{const $=_e.Predicted_Label,ee=_e.Belief_Score??0,fe=_e.Environment_Score??0;return $==="Belief Aligned"?k(-ee):$==="Environment Aligned"?k(fe):$==="Neutral"?ee>fe?k(-ee):k(fe):T/2};C.current&&(C.current.attr("stroke",null).attr("stroke-width",null).attr("r",_e=>_e.size||9),C.current=null);const G=R===17||R===18||R===19;if((se=c.current)==null||se.style("display",G?"block":"none"),(re=f.current)==null||re.style("display",G?"block":"none"),(q=d.current)==null||q.style("display",G?"block":"none"),(ce=p.current)==null||ce.style("display",G?"block":"none"),(me=_.current)==null||me.style("display",G?"block":"none"),(de=y.current)==null||de.style("display",G?"block":"none"),Zn(i.current).select(".contour-layer").selectAll("*").remove(),R>=17&&R<=19){const _e=n.filter(fe=>R===17?!0:R===18?fe.source==="Reddit":R===19?fe.source==="Articles":!1).filter(fe=>isFinite(V(fe))&&isFinite(ne(fe))),ee=jO().x(fe=>V(fe)).y(fe=>ne(fe)).size([b,T]).bandwidth(R===17?30:20).thresholds(15)(_e);Zn(i.current).select(".contour-layer").selectAll("path").data(ee).enter().append("path").attr("d",E4()).attr("fill","#ecc8af").attr("stroke","#e85d04").attr("stroke-width",.8).attr("opacity",.1).style("pointer-events","none").lower()}l.current.interrupt().transition().duration(1e3).attr("opacity",_e=>R===16||R===17?.9:R===18?_e.source==="Reddit"?.9:0:R===19&&_e.source==="Articles"?.9:0).attr("cx",(_e,$)=>R===16?$%13*40:V(_e)).attr("cy",(_e,$)=>R===16?Math.floor($/13)*40:ne(_e))}return ae.jsx("div",{children:ae.jsx("svg",{ref:i,width:h1,height:d1})})});function nN(n){const e=n.type||n.Category;return e==="Reddit"?"#ff002b":e==="International"?"#a0001c":"#fcba04"}function rN(n){const e=(t,r)=>{const i=Math.min(100,r*100);return`
      <div style="margin-bottom: 8px;">
        <div style="font-weight: 500; font-size: 12px; color: #e0e0e0;">${t}</div>
        <div style="background: #e0e0e0; height: 6px; border-radius: 4px; width: 100%;">
          <div style="width: ${i}%; background: #9d0208; height: 6px; border-radius: 4px;"></div>
        </div>
        <div style="font-size: 11px; color: #777;">Score: ${r==null?void 0:r.toFixed(2)}</div>
      </div>`};return`
    <div style="line-height:1.4;">
      <strong style="font-size: 14px;">${n.Predicted_Label} | ${n.Predicted_Label_gov}</strong><br/><br/>
      ${e("Pro-Gov",n.Pro_Gov_Score)}
      ${e("Crit-Gov",n.Crit_Gov_Score)}
      ${e("Environment",n.Environment_Score)}
      ${e("Belief",n.Belief_Score)}
      <br/>
      <strong>Category:</strong> ${n.type||n.Category}
    </div>`}function p1(n,e){(e==null||e>n.length)&&(e=n.length);for(var t=0,r=Array(e);t<e;t++)r[t]=n[t];return r}function iN(n){if(Array.isArray(n))return n}function sN(n,e,t){return(e=cN(e))in n?Object.defineProperty(n,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[e]=t,n}function aN(n,e){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var r,i,a,l,c=[],f=!0,d=!1;try{if(a=(t=t.call(n)).next,e!==0)for(;!(f=(r=a.call(t)).done)&&(c.push(r.value),c.length!==e);f=!0);}catch(p){d=!0,i=p}finally{try{if(!f&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(d)throw i}}return c}}function oN(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function g1(n,e){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(n);e&&(r=r.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,r)}return t}function _1(n){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?g1(Object(t),!0).forEach(function(r){sN(n,r,t[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):g1(Object(t)).forEach(function(r){Object.defineProperty(n,r,Object.getOwnPropertyDescriptor(t,r))})}return n}function Rg(n,e){return iN(n)||aN(n,e)||uN(n,e)||oN()}function lN(n,e){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var r=t.call(n,e);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(n)}function cN(n){var e=lN(n,"string");return typeof e=="symbol"?e:e+""}function uN(n,e){if(n){if(typeof n=="string")return p1(n,e);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?p1(n,e):void 0}}var B3=function(e){return typeof e=="string"&&e.includes("px")},fN={position:"fixed",left:0,width:"100%",height:0,borderTop:"2px dashed black",zIndex:9999},hN={fontSize:"12px",fontFamily:"monospace",margin:0,padding:6},dN=function(e){var t=B3(e);return t?e:"".concat(e*100,"%")},pN=function(e){var t=e.offset,r=dN(t);return ui.createElement("div",{style:_1(_1({},fN),{},{top:r})},ui.createElement("p",{style:hN},"trigger: ",t))},gN=function(e,t){for(var r=Math.ceil(t/e),i=[],a=1/r,l=0;l<=r;l+=1)i.push(l*a);return i},_N=function(e){var t=e.debug,r=e.children,i=e.offset,a=i===void 0?.3:i,l=e.onStepEnter,c=l===void 0?function(){}:l,f=e.onStepExit,d=f===void 0?function(){}:f,p=e.onStepProgress,_=p===void 0?null:p,y=e.threshold,b=y===void 0?4:y,T=B3(a),A=K.useState(0),C=Rg(A,2),N=C[0],O=C[1],R=K.useState(null),E=Rg(R,2),k=E[0],V=E[1],ne=function(de){O(de)},G=function(de){V(window.innerHeight)};K.useEffect(function(){if(T)return window.addEventListener("resize",G),function(){window.removeEventListener("resize",G)}},[]);var se=typeof window<"u",re=se?k||window.innerHeight:0,q=T?+a.replace("px","")/re:a,ce=K.useMemo(function(){return gN(b,re)},[re]);return ui.createElement(ui.Fragment,null,t&&ui.createElement(pN,{offset:a}),ui.Children.map(r,function(me,de){return ui.cloneElement(me,{scrollamaId:"react-scrollama-".concat(de),offset:q,onStepEnter:c,onStepExit:d,onStepProgress:_,lastScrollTop:N,handleSetLastScrollTop:ne,progressThreshold:ce,innerHeight:re})}))},Cg=new Map,nu=new WeakMap,m1=0,mN=void 0;function yN(n){return n?(nu.has(n)||(m1+=1,nu.set(n,m1.toString())),nu.get(n)):"0"}function bN(n){return Object.keys(n).sort().filter(e=>n[e]!==void 0).map(e=>`${e}_${e==="root"?yN(n.root):n[e]}`).toString()}function vN(n){const e=bN(n);let t=Cg.get(e);if(!t){const r=new Map;let i;const a=new IntersectionObserver(l=>{l.forEach(c=>{var f;const d=c.isIntersecting&&i.some(p=>c.intersectionRatio>=p);n.trackVisibility&&typeof c.isVisible>"u"&&(c.isVisible=d),(f=r.get(c.target))==null||f.forEach(p=>{p(d,c)})})},n);i=a.thresholds||(Array.isArray(n.threshold)?n.threshold:[n.threshold||0]),t={id:e,observer:a,elements:r},Cg.set(e,t)}return t}function TN(n,e,t={},r=mN){if(typeof window.IntersectionObserver>"u"&&r!==void 0){const f=n.getBoundingClientRect();return e(r,{isIntersecting:r,target:n,intersectionRatio:typeof t.threshold=="number"?t.threshold:0,time:0,boundingClientRect:f,intersectionRect:f,rootBounds:f}),()=>{}}const{id:i,observer:a,elements:l}=vN(t),c=l.get(n)||[];return l.has(n)||l.set(n,c),c.push(e),a.observe(n),function(){c.splice(c.indexOf(e),1),c.length===0&&(l.delete(n),a.unobserve(n)),l.size===0&&(a.disconnect(),Cg.delete(i))}}function y1({threshold:n,delay:e,trackVisibility:t,rootMargin:r,root:i,triggerOnce:a,skip:l,initialInView:c,fallbackInView:f,onChange:d}={}){var p;const[_,y]=K.useState(null),b=K.useRef(d),[T,A]=K.useState({inView:!!c,entry:void 0});b.current=d,K.useEffect(()=>{if(l||!_)return;let R;return R=TN(_,(E,k)=>{A({inView:E,entry:k}),b.current&&b.current(E,k),k.isIntersecting&&a&&R&&(R(),R=void 0)},{root:i,rootMargin:r,threshold:n,trackVisibility:t,delay:e},f),()=>{R&&R()}},[Array.isArray(n)?n.toString():n,_,i,r,a,l,t,f,e]);const C=(p=T.entry)==null?void 0:p.target,N=K.useRef(void 0);!_&&C&&!a&&!l&&N.current!==C&&(N.current=C,A({inView:!!c,entry:void 0}));const O=[y,T.inView,T.entry];return O.ref=O[0],O.inView=O[1],O.entry=O[2],O}var wN=function(e){return"-".concat(e*100,"% 0px -").concat(100-e*100,"% 0px")},xN=function(e,t,r,i){if(!r.current)return"0px";var a=r.current.offsetHeight/i;return e==="down"?"".concat((a-t)*100,"% 0px ").concat(t*100-100,"% 0px"):"-".concat(t*100,"% 0px ").concat(a*100-(100-t*100),"% 0px")},SN=function(e){var t=e.children,r=e.data,i=e.handleSetLastScrollTop,a=e.lastScrollTop,l=e.onStepEnter,c=l===void 0?function(){}:l,f=e.onStepExit,d=f===void 0?function(){}:f,p=e.onStepProgress,_=p===void 0?null:p,y=e.offset,b=e.scrollamaId,T=e.progressThreshold,A=e.innerHeight,C=typeof window<"u",N=C?document.documentElement.scrollTop:0,O=a>N?"up":"down",R=wN(y),E=K.useRef(null),k=K.useState(!1),V=Rg(k,2),ne=V[0],G=V[1],se=y1({rootMargin:R,threshold:0}),re=se.ref,q=se.entry,ce=K.useMemo(function(){return xN(O,y,E,A)},[O,y,E,A]),me=y1({rootMargin:ce,threshold:T}),de=me.ref,_e=me.entry,$=K.useCallback(function(ee){E.current=ee,re(ee),de(ee)},[re,de]);return K.useEffect(function(){if(ne){var ee=_e.target.getBoundingClientRect(),fe=ee.height,Re=ee.top,D=Math.min(1,Math.max(0,(window.innerHeight*y-Re)/fe));_&&_({progress:D,scrollamaId:b,data:r,element:_e.target,entry:_e,direction:O})}},[_e]),K.useEffect(function(){q&&!q.isIntersecting&&ne?(d({element:q.target,scrollamaId:b,data:r,entry:q,direction:O}),G(!1),i(N)):q&&q.isIntersecting&&!ne&&(G(!0),c({element:q.target,scrollamaId:b,data:r,entry:q,direction:O}),i(N))},[q]),K.cloneElement(ui.Children.only(t),{"data-react-scrollama-id":b,ref:$,entry:q})};function Xu(n,e){if(!n)throw new Error(e||"loader assertion failed.")}const U_=!!(typeof process!="object"||String(process)!=="[object process]"||process.browser),b1=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);b1&&parseFloat(b1[1]);const ru=globalThis,Js=globalThis.process||{},AN=globalThis.navigator||{};function F3(n){var r,i;if(typeof window<"u"&&((r=window.process)==null?void 0:r.type)==="renderer"||typeof process<"u"&&((i=process.versions)!=null&&i.electron))return!0;const t=typeof navigator<"u"&&navigator.userAgent;return!!(t&&t.indexOf("Electron")>=0)}function as(){return!(typeof process=="object"&&String(process)==="[object process]"&&!(process!=null&&process.browser))||F3()}function EN(n){return as()?F3()?"Electron":(AN.userAgent||"").indexOf("Edge")>-1?"Edge":globalThis.chrome?"Chrome":globalThis.safari?"Safari":globalThis.mozInnerScreenX?"Firefox":"Unknown":"Node"}const L3="4.1.0";function RN(n){try{const e=window[n],t="__storage_test__";return e.setItem(t,t),e.removeItem(t),e}catch{return null}}class CN{constructor(e,t,r="sessionStorage"){this.storage=RN(r),this.id=e,this.config=t,this._loadConfiguration()}getConfiguration(){return this.config}setConfiguration(e){if(Object.assign(this.config,e),this.storage){const t=JSON.stringify(this.config);this.storage.setItem(this.id,t)}}_loadConfiguration(){let e={};if(this.storage){const t=this.storage.getItem(this.id);e=t?JSON.parse(t):{}}return Object.assign(this.config,e),this}}function MN(n){let e;return n<10?e=`${n.toFixed(2)}ms`:n<100?e=`${n.toFixed(1)}ms`:n<1e3?e=`${n.toFixed(0)}ms`:e=`${(n/1e3).toFixed(2)}s`,e}function ON(n,e=8){const t=Math.max(e-n.length,0);return`${" ".repeat(t)}${n}`}var Yu;(function(n){n[n.BLACK=30]="BLACK",n[n.RED=31]="RED",n[n.GREEN=32]="GREEN",n[n.YELLOW=33]="YELLOW",n[n.BLUE=34]="BLUE",n[n.MAGENTA=35]="MAGENTA",n[n.CYAN=36]="CYAN",n[n.WHITE=37]="WHITE",n[n.BRIGHT_BLACK=90]="BRIGHT_BLACK",n[n.BRIGHT_RED=91]="BRIGHT_RED",n[n.BRIGHT_GREEN=92]="BRIGHT_GREEN",n[n.BRIGHT_YELLOW=93]="BRIGHT_YELLOW",n[n.BRIGHT_BLUE=94]="BRIGHT_BLUE",n[n.BRIGHT_MAGENTA=95]="BRIGHT_MAGENTA",n[n.BRIGHT_CYAN=96]="BRIGHT_CYAN",n[n.BRIGHT_WHITE=97]="BRIGHT_WHITE"})(Yu||(Yu={}));const IN=10;function v1(n){return typeof n!="string"?n:(n=n.toUpperCase(),Yu[n]||Yu.WHITE)}function NN(n,e,t){return!as&&typeof n=="string"&&(e&&(n=`\x1B[${v1(e)}m${n}\x1B[39m`),t&&(n=`\x1B[${v1(t)+IN}m${n}\x1B[49m`)),n}function kN(n,e=["constructor"]){const t=Object.getPrototypeOf(n),r=Object.getOwnPropertyNames(t),i=n;for(const a of r){const l=i[a];typeof l=="function"&&(e.find(c=>a===c)||(i[a]=l.bind(n)))}}function B_(n,e){if(!n)throw new Error("Assertion failed")}function ea(){var e,t,r;let n;if(as()&&ru.performance)n=(t=(e=ru==null?void 0:ru.performance)==null?void 0:e.now)==null?void 0:t.call(e);else if("hrtime"in Js){const i=(r=Js==null?void 0:Js.hrtime)==null?void 0:r.call(Js);n=i[0]*1e3+i[1]/1e6}else n=Date.now();return n}const ta={debug:as()&&console.debug||console.log,log:console.log,info:console.info,warn:console.warn,error:console.error},DN={enabled:!0,level:0};function na(){}const T1={},w1={once:!0};class Ol{constructor({id:e}={id:""}){this.VERSION=L3,this._startTs=ea(),this._deltaTs=ea(),this.userData={},this.LOG_THROTTLE_TIMEOUT=0,this.id=e,this.userData={},this._storage=new CN(`__probe-${this.id}__`,DN),this.timeStamp(`${this.id} started`),kN(this),Object.seal(this)}set level(e){this.setLevel(e)}get level(){return this.getLevel()}isEnabled(){return this._storage.config.enabled}getLevel(){return this._storage.config.level}getTotal(){return Number((ea()-this._startTs).toPrecision(10))}getDelta(){return Number((ea()-this._deltaTs).toPrecision(10))}set priority(e){this.level=e}get priority(){return this.level}getPriority(){return this.level}enable(e=!0){return this._storage.setConfiguration({enabled:e}),this}setLevel(e){return this._storage.setConfiguration({level:e}),this}get(e){return this._storage.config[e]}set(e,t){this._storage.setConfiguration({[e]:t})}settings(){console.table?console.table(this._storage.config):console.log(this._storage.config)}assert(e,t){if(!e)throw new Error(t||"Assertion failed")}warn(e){return this._getLogFunction(0,e,ta.warn,arguments,w1)}error(e){return this._getLogFunction(0,e,ta.error,arguments)}deprecated(e,t){return this.warn(`\`${e}\` is deprecated and will be removed in a later version. Use \`${t}\` instead`)}removed(e,t){return this.error(`\`${e}\` has been removed. Use \`${t}\` instead`)}probe(e,t){return this._getLogFunction(e,t,ta.log,arguments,{time:!0,once:!0})}log(e,t){return this._getLogFunction(e,t,ta.debug,arguments)}info(e,t){return this._getLogFunction(e,t,console.info,arguments)}once(e,t){return this._getLogFunction(e,t,ta.debug||ta.info,arguments,w1)}table(e,t,r){return t?this._getLogFunction(e,t,console.table||na,r&&[r],{tag:UN(t)}):na}time(e,t){return this._getLogFunction(e,t,console.time?console.time:console.info)}timeEnd(e,t){return this._getLogFunction(e,t,console.timeEnd?console.timeEnd:console.info)}timeStamp(e,t){return this._getLogFunction(e,t,console.timeStamp||na)}group(e,t,r={collapsed:!1}){const i=x1({logLevel:e,message:t,opts:r}),{collapsed:a}=r;return i.method=(a?console.groupCollapsed:console.group)||console.info,this._getLogFunction(i)}groupCollapsed(e,t,r={}){return this.group(e,t,Object.assign({},r,{collapsed:!0}))}groupEnd(e){return this._getLogFunction(e,"",console.groupEnd||na)}withGroup(e,t,r){this.group(e,t)();try{r()}finally{this.groupEnd(e)()}}trace(){console.trace&&console.trace()}_shouldLog(e){return this.isEnabled()&&this.getLevel()>=z3(e)}_getLogFunction(e,t,r,i,a){if(this._shouldLog(e)){a=x1({logLevel:e,message:t,args:i,opts:a}),r=r||a.method,B_(r),a.total=this.getTotal(),a.delta=this.getDelta(),this._deltaTs=ea();const l=a.tag||a.message;if(a.once&&l)if(!T1[l])T1[l]=ea();else return na;return t=PN(this.id,a.message,a),r.bind(console,t,...a.args)}return na}}Ol.VERSION=L3;function z3(n){if(!n)return 0;let e;switch(typeof n){case"number":e=n;break;case"object":e=n.logLevel||n.priority||0;break;default:return 0}return B_(Number.isFinite(e)&&e>=0),e}function x1(n){const{logLevel:e,message:t}=n;n.logLevel=z3(e);const r=n.args?Array.from(n.args):[];for(;r.length&&r.shift()!==t;);switch(typeof e){case"string":case"function":t!==void 0&&r.unshift(t),n.message=e;break;case"object":Object.assign(n,e);break}typeof n.message=="function"&&(n.message=n.message());const i=typeof n.message;return B_(i==="string"||i==="object"),Object.assign(n,{args:r},n.opts)}function PN(n,e,t){if(typeof e=="string"){const r=t.time?ON(MN(t.total)):"";e=t.time?`${n}: ${r}  ${e}`:`${n}: ${e}`,e=NN(e,t.color,t.background)}return e}function UN(n){for(const e in n)for(const t in n[e])return t||"untitled";return"empty"}const Ap="4.3.2",BN=Ap[0]>="0"&&Ap[0]<="9"?`v${Ap}`:"";function FN(){const n=new Ol({id:"loaders.gl"});return globalThis.loaders=globalThis.loaders||{},globalThis.loaders.log=n,globalThis.loaders.version=BN,globalThis.probe=globalThis.probe||{},globalThis.probe.loaders=n,n}const LN=FN();function zN(n,e){return V3(n||{},e)}function V3(n,e,t=0){if(t>3)return e;const r={...n};for(const[i,a]of Object.entries(e))a&&typeof a=="object"&&!Array.isArray(a)?r[i]=V3(r[i]||{},e[i],t+1):r[i]=e[i];return r}const VN="latest";function HN(){var n;return(n=globalThis._loadersgl_)!=null&&n.version||(globalThis._loadersgl_=globalThis._loadersgl_||{},globalThis._loadersgl_.version="4.3.2"),globalThis._loadersgl_.version}const jN=HN();function _i(n,e){if(!n)throw new Error(e||"loaders.gl assertion failed.")}const $i=typeof process!="object"||String(process)!=="[object process]"||process.browser,$N=typeof window<"u"&&typeof window.orientation<"u",S1=typeof process<"u"&&process.version&&/v([0-9]*)/.exec(process.version);S1&&parseFloat(S1[1]);class WN{constructor(e,t){w(this,"name");w(this,"workerThread");w(this,"isRunning",!0);w(this,"result");w(this,"_resolve",()=>{});w(this,"_reject",()=>{});this.name=e,this.workerThread=t,this.result=new Promise((r,i)=>{this._resolve=r,this._reject=i})}postMessage(e,t){this.workerThread.postMessage({source:"loaders.gl",type:e,payload:t})}done(e){_i(this.isRunning),this.isRunning=!1,this._resolve(e)}error(e){_i(this.isRunning),this.isRunning=!1,this._reject(e)}}class Ep{terminate(){}}const Rp=new Map;function XN(n){_i(n.source&&!n.url||!n.source&&n.url);let e=Rp.get(n.source||n.url);return e||(n.url&&(e=YN(n.url),Rp.set(n.url,e)),n.source&&(e=H3(n.source),Rp.set(n.source,e))),_i(e),e}function YN(n){if(!n.startsWith("http"))return n;const e=qN(n);return H3(e)}function H3(n){const e=new Blob([n],{type:"application/javascript"});return URL.createObjectURL(e)}function qN(n){return`try {
  importScripts('${n}');
} catch (error) {
  console.error(error);
  throw error;
}`}function j3(n,e=!0,t){const r=t||new Set;if(n){if(A1(n))r.add(n);else if(A1(n.buffer))r.add(n.buffer);else if(!ArrayBuffer.isView(n)){if(e&&typeof n=="object")for(const i in n)j3(n[i],e,r)}}return t===void 0?Array.from(r):[]}function A1(n){return n?n instanceof ArrayBuffer||typeof MessagePort<"u"&&n instanceof MessagePort||typeof ImageBitmap<"u"&&n instanceof ImageBitmap||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas:!1}const Cp=()=>{};class Mg{constructor(e){w(this,"name");w(this,"source");w(this,"url");w(this,"terminated",!1);w(this,"worker");w(this,"onMessage");w(this,"onError");w(this,"_loadableURL","");const{name:t,source:r,url:i}=e;_i(r||i),this.name=t,this.source=r,this.url=i,this.onMessage=Cp,this.onError=a=>console.log(a),this.worker=$i?this._createBrowserWorker():this._createNodeWorker()}static isSupported(){return typeof Worker<"u"&&$i||typeof Ep<"u"&&!$i}destroy(){this.onMessage=Cp,this.onError=Cp,this.worker.terminate(),this.terminated=!0}get isRunning(){return!!this.onMessage}postMessage(e,t){t=t||j3(e),this.worker.postMessage(e,t)}_getErrorFromErrorEvent(e){let t="Failed to load ";return t+=`worker ${this.name} from ${this.url}. `,e.message&&(t+=`${e.message} in `),e.lineno&&(t+=`:${e.lineno}:${e.colno}`),new Error(t)}_createBrowserWorker(){this._loadableURL=XN({source:this.source,url:this.url});const e=new Worker(this._loadableURL,{name:this.name});return e.onmessage=t=>{t.data?this.onMessage(t.data):this.onError(new Error("No data received"))},e.onerror=t=>{this.onError(this._getErrorFromErrorEvent(t)),this.terminated=!0},e.onmessageerror=t=>console.error(t),e}_createNodeWorker(){let e;if(this.url){const r=this.url.includes(":/")||this.url.startsWith("/")?this.url:`./${this.url}`;e=new Ep(r,{eval:!1})}else if(this.source)e=new Ep(this.source,{eval:!0});else throw new Error("no worker");return e.on("message",t=>{this.onMessage(t)}),e.on("error",t=>{this.onError(t)}),e.on("exit",t=>{}),e}}class KN{constructor(e){w(this,"name","unnamed");w(this,"source");w(this,"url");w(this,"maxConcurrency",1);w(this,"maxMobileConcurrency",1);w(this,"onDebug",()=>{});w(this,"reuseWorkers",!0);w(this,"props",{});w(this,"jobQueue",[]);w(this,"idleQueue",[]);w(this,"count",0);w(this,"isDestroyed",!1);this.source=e.source,this.url=e.url,this.setProps(e)}static isSupported(){return Mg.isSupported()}destroy(){this.idleQueue.forEach(e=>e.destroy()),this.isDestroyed=!0}setProps(e){this.props={...this.props,...e},e.name!==void 0&&(this.name=e.name),e.maxConcurrency!==void 0&&(this.maxConcurrency=e.maxConcurrency),e.maxMobileConcurrency!==void 0&&(this.maxMobileConcurrency=e.maxMobileConcurrency),e.reuseWorkers!==void 0&&(this.reuseWorkers=e.reuseWorkers),e.onDebug!==void 0&&(this.onDebug=e.onDebug)}async startJob(e,t=(i,a,l)=>i.done(l),r=(i,a)=>i.error(a)){const i=new Promise(a=>(this.jobQueue.push({name:e,onMessage:t,onError:r,onStart:a}),this));return this._startQueuedJob(),await i}async _startQueuedJob(){if(!this.jobQueue.length)return;const e=this._getAvailableWorker();if(!e)return;const t=this.jobQueue.shift();if(t){this.onDebug({message:"Starting job",name:t.name,workerThread:e,backlog:this.jobQueue.length});const r=new WN(t.name,e);e.onMessage=i=>t.onMessage(r,i.type,i.payload),e.onError=i=>t.onError(r,i),t.onStart(r);try{await r.result}catch(i){console.error(`Worker exception: ${i}`)}finally{this.returnWorkerToQueue(e)}}}returnWorkerToQueue(e){!$i||this.isDestroyed||!this.reuseWorkers||this.count>this._getMaxConcurrency()?(e.destroy(),this.count--):this.idleQueue.push(e),this.isDestroyed||this._startQueuedJob()}_getAvailableWorker(){if(this.idleQueue.length>0)return this.idleQueue.shift()||null;if(this.count<this._getMaxConcurrency()){this.count++;const e=`${this.name.toLowerCase()} (#${this.count} of ${this.maxConcurrency})`;return new Mg({name:e,source:this.source,url:this.url})}return null}_getMaxConcurrency(){return $N?this.maxMobileConcurrency:this.maxConcurrency}}const ZN={maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:!0,onDebug:()=>{}},li=class li{constructor(e){w(this,"props");w(this,"workerPools",new Map);this.props={...ZN},this.setProps(e),this.workerPools=new Map}static isSupported(){return Mg.isSupported()}static getWorkerFarm(e={}){return li._workerFarm=li._workerFarm||new li({}),li._workerFarm.setProps(e),li._workerFarm}destroy(){for(const e of this.workerPools.values())e.destroy();this.workerPools=new Map}setProps(e){this.props={...this.props,...e};for(const t of this.workerPools.values())t.setProps(this._getWorkerPoolProps())}getWorkerPool(e){const{name:t,source:r,url:i}=e;let a=this.workerPools.get(t);return a||(a=new KN({name:t,source:r,url:i}),a.setProps(this._getWorkerPoolProps()),this.workerPools.set(t,a)),a}_getWorkerPoolProps(){return{maxConcurrency:this.props.maxConcurrency,maxMobileConcurrency:this.props.maxMobileConcurrency,reuseWorkers:this.props.reuseWorkers,onDebug:this.props.onDebug}}};w(li,"_workerFarm");let qu=li;function QN(n,e={}){const t=e[n.id]||{},r=$i?`${n.id}-worker.js`:`${n.id}-worker-node.js`;let i=t.workerUrl;if(!i&&n.id==="compression"&&(i=e.workerUrl),e._workerType==="test"&&($i?i=`modules/${n.module}/dist/${r}`:i=`modules/${n.module}/src/workers/${n.id}-worker-node.ts`),!i){let a=n.version;a==="latest"&&(a=VN);const l=a?`@${a}`:"";i=`https://unpkg.com/@loaders.gl/${n.module}${l}/dist/${r}`}return _i(i),i}function GN(n,e=jN){_i(n,"no worker provided");const t=n.version;return!(!e||!t)}function JN(n,e){return!qu.isSupported()||!$i&&!(e!=null&&e._nodeWorkers)?!1:n.worker&&(e==null?void 0:e.worker)}async function ek(n,e,t,r,i){const a=n.id,l=QN(n,t),f=qu.getWorkerFarm(t).getWorkerPool({name:a,url:l});t=JSON.parse(JSON.stringify(t)),r=JSON.parse(JSON.stringify(r||{}));const d=await f.startJob("process-on-worker",tk.bind(null,i));return d.postMessage("process",{input:e,options:t,context:r}),await(await d.result).result}async function tk(n,e,t,r){switch(t){case"done":e.done(r);break;case"error":e.error(new Error(r.error));break;case"process":const{id:i,input:a,options:l}=r;try{const c=await n(a,l);e.postMessage("done",{id:i,result:c})}catch(c){const f=c instanceof Error?c.message:"unknown error";e.postMessage("error",{id:i,error:f})}break;default:console.warn(`parse-with-worker unknown message ${t}`)}}function nk(n,e,t){if(t=t||n.byteLength,n.byteLength<t||e.byteLength<t)return!1;const r=new Uint8Array(n),i=new Uint8Array(e);for(let a=0;a<r.length;++a)if(r[a]!==i[a])return!1;return!0}function rk(...n){return ik(n)}function ik(n){const e=n.map(a=>a instanceof ArrayBuffer?new Uint8Array(a):a),t=e.reduce((a,l)=>a+l.byteLength,0),r=new Uint8Array(t);let i=0;for(const a of e)r.set(a,i),i+=a.byteLength;return r.buffer}async function sk(n){const e=[];for await(const t of n)e.push(t);return rk(...e)}function E1(){let n;if(typeof window<"u"&&window.performance)n=window.performance.now();else if(typeof process<"u"&&process.hrtime){const e=process.hrtime();n=e[0]*1e3+e[1]/1e6}else n=Date.now();return n}class R1{constructor(e,t){this.sampleSize=1,this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this.name=e,this.type=t,this.reset()}reset(){return this.time=0,this.count=0,this.samples=0,this.lastTiming=0,this.lastSampleTime=0,this.lastSampleCount=0,this._count=0,this._time=0,this._samples=0,this._startTime=0,this._timerPending=!1,this}setSampleSize(e){return this.sampleSize=e,this}incrementCount(){return this.addCount(1),this}decrementCount(){return this.subtractCount(1),this}addCount(e){return this._count+=e,this._samples++,this._checkSampling(),this}subtractCount(e){return this._count-=e,this._samples++,this._checkSampling(),this}addTime(e){return this._time+=e,this.lastTiming=e,this._samples++,this._checkSampling(),this}timeStart(){return this._startTime=E1(),this._timerPending=!0,this}timeEnd(){return this._timerPending?(this.addTime(E1()-this._startTime),this._timerPending=!1,this._checkSampling(),this):this}getSampleAverageCount(){return this.sampleSize>0?this.lastSampleCount/this.sampleSize:0}getSampleAverageTime(){return this.sampleSize>0?this.lastSampleTime/this.sampleSize:0}getSampleHz(){return this.lastSampleTime>0?this.sampleSize/(this.lastSampleTime/1e3):0}getAverageCount(){return this.samples>0?this.count/this.samples:0}getAverageTime(){return this.samples>0?this.time/this.samples:0}getHz(){return this.time>0?this.samples/(this.time/1e3):0}_checkSampling(){this._samples===this.sampleSize&&(this.lastSampleTime=this._time,this.lastSampleCount=this._count,this.count+=this._count,this.time+=this._time,this.samples+=this._samples,this._time=0,this._count=0,this._samples=0)}}class Ff{constructor(e){this.stats={},this.id=e.id,this.stats={},this._initializeStats(e.stats),Object.seal(this)}get(e,t="count"){return this._getOrCreate({name:e,type:t})}get size(){return Object.keys(this.stats).length}reset(){for(const e of Object.values(this.stats))e.reset();return this}forEach(e){for(const t of Object.values(this.stats))e(t)}getTable(){const e={};return this.forEach(t=>{e[t.name]={time:t.time||0,count:t.count||0,average:t.getAverageTime()||0,hz:t.getHz()||0}}),e}_initializeStats(e=[]){e.forEach(t=>this._getOrCreate(t))}_getOrCreate(e){const{name:t,type:r}=e;let i=this.stats[t];return i||(e instanceof R1?i=e:i=new R1(t,r),this.stats[t]=i),i}}let ak="";const C1={};function ok(n){for(const e in C1)if(n.startsWith(e)){const t=C1[e];n=n.replace(e,t)}return!n.startsWith("http://")&&!n.startsWith("https://")&&(n=`${ak}${n}`),n}function lk(n){return n&&typeof n=="object"&&n.isBuffer}function $3(n){if(lk(n))return n;if(n instanceof ArrayBuffer)return n;if(ArrayBuffer.isView(n))return n.byteOffset===0&&n.byteLength===n.buffer.byteLength?n.buffer:n.buffer.slice(n.byteOffset,n.byteOffset+n.byteLength);if(typeof n=="string"){const e=n;return new TextEncoder().encode(e).buffer}if(n&&typeof n=="object"&&n._toArrayBuffer)return n._toArrayBuffer();throw new Error("toArrayBuffer")}function W3(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(e+1):""}function ck(n){const e=n?n.lastIndexOf("/"):-1;return e>=0?n.substr(0,e):""}const uk=n=>typeof n=="boolean",sl=n=>typeof n=="function",Il=n=>n!==null&&typeof n=="object",M1=n=>Il(n)&&n.constructor==={}.constructor,fk=n=>!!n&&typeof n[Symbol.iterator]=="function",hk=n=>n&&typeof n[Symbol.asyncIterator]=="function",os=n=>typeof Response<"u"&&n instanceof Response||n&&n.arrayBuffer&&n.text&&n.json,ls=n=>typeof Blob<"u"&&n instanceof Blob,dk=n=>n&&typeof n=="object"&&n.isBuffer,pk=n=>typeof ReadableStream<"u"&&n instanceof ReadableStream||Il(n)&&sl(n.tee)&&sl(n.cancel)&&sl(n.getReader),gk=n=>Il(n)&&sl(n.read)&&sl(n.pipe)&&uk(n.readable),X3=n=>pk(n)||gk(n);class _k extends Error{constructor(t,r){super(t);w(this,"reason");w(this,"url");w(this,"response");this.reason=r.reason,this.url=r.url,this.response=r.response}}const mk=/^data:([-\w.]+\/[-\w.+]+)(;|,)/,yk=/^([-\w.]+\/[-\w.+]+)/;function O1(n,e){return n.toLowerCase()===e.toLowerCase()}function bk(n){const e=yk.exec(n);return e?e[1]:n}function I1(n){const e=mk.exec(n);return e?e[1]:""}const Y3=/\?.*/;function vk(n){const e=n.match(Y3);return e&&e[0]}function F_(n){return n.replace(Y3,"")}function Tk(n){if(n.length<50)return n;const e=n.slice(n.length-15);return`${n.substr(0,32)}...${e}`}function Lf(n){return os(n)?n.url:ls(n)?n.name||"":typeof n=="string"?n:""}function L_(n){if(os(n)){const e=n,t=e.headers.get("content-type")||"",r=F_(e.url);return bk(t)||I1(r)}return ls(n)?n.type||"":typeof n=="string"?I1(n):""}function wk(n){return os(n)?n.headers["content-length"]||-1:ls(n)?n.size:typeof n=="string"?n.length:n instanceof ArrayBuffer||ArrayBuffer.isView(n)?n.byteLength:-1}async function q3(n){if(os(n))return n;const e={},t=wk(n);t>=0&&(e["content-length"]=String(t));const r=Lf(n),i=L_(n);i&&(e["content-type"]=i);const a=await Ak(n);a&&(e["x-first-bytes"]=a),typeof n=="string"&&(n=new TextEncoder().encode(n));const l=new Response(n,{headers:e});return Object.defineProperty(l,"url",{value:r}),l}async function xk(n){if(!n.ok)throw await Sk(n)}async function Sk(n){const e=Tk(n.url);let t=`Failed to fetch resource (${n.status}) ${n.statusText}: ${e}`;t=t.length>100?`${t.slice(0,100)}...`:t;const r={reason:n.statusText,url:n.url,response:n};try{const i=n.headers.get("Content-Type");r.reason=!n.bodyUsed&&(i!=null&&i.includes("application/json"))?await n.json():await n.text()}catch{}return new _k(t,r)}async function Ak(n){if(typeof n=="string")return`data:,${n.slice(0,5)}`;if(n instanceof Blob){const t=n.slice(0,5);return await new Promise(r=>{const i=new FileReader;i.onload=a=>{var l;return r((l=a==null?void 0:a.target)==null?void 0:l.result)},i.readAsDataURL(t)})}if(n instanceof ArrayBuffer){const t=n.slice(0,5);return`data:base64,${Ek(t)}`}return null}function Ek(n){let e="";const t=new Uint8Array(n);for(let r=0;r<t.byteLength;r++)e+=String.fromCharCode(t[r]);return btoa(e)}function Rk(n){return!Ck(n)&&!Mk(n)}function Ck(n){return n.startsWith("http:")||n.startsWith("https:")}function Mk(n){return n.startsWith("data:")}async function N1(n,e){var t,r;if(typeof n=="string"){const i=ok(n);return Rk(i)&&(t=globalThis.loaders)!=null&&t.fetchNode?(r=globalThis.loaders)==null?void 0:r.fetchNode(i,e):await fetch(i,e)}return await q3(n)}const k1=new Ol({id:"loaders.gl"});class Ok{log(){return()=>{}}info(){return()=>{}}warn(){return()=>{}}error(){return()=>{}}}class Ik{constructor(){w(this,"console");this.console=console}log(...e){return this.console.log.bind(this.console,...e)}info(...e){return this.console.info.bind(this.console,...e)}warn(...e){return this.console.warn.bind(this.console,...e)}error(...e){return this.console.error.bind(this.console,...e)}}const K3={fetch:null,mimeType:void 0,nothrow:!1,log:new Ik,useLocalLibraries:!1,CDN:"https://unpkg.com/@loaders.gl",worker:!0,maxConcurrency:3,maxMobileConcurrency:1,reuseWorkers:U_,_nodeWorkers:!1,_workerType:"",limit:0,_limitMB:0,batchSize:"auto",batchDebounceMs:0,metadata:!1,transforms:[]},Nk={throws:"nothrow",dataType:"(no longer used)",uri:"baseUri",method:"fetch.method",headers:"fetch.headers",body:"fetch.body",mode:"fetch.mode",credentials:"fetch.credentials",cache:"fetch.cache",redirect:"fetch.redirect",referrer:"fetch.referrer",referrerPolicy:"fetch.referrerPolicy",integrity:"fetch.integrity",keepalive:"fetch.keepalive",signal:"fetch.signal"};function Z3(){globalThis.loaders=globalThis.loaders||{};const{loaders:n}=globalThis;return n._state||(n._state={}),n._state}function Q3(){const n=Z3();return n.globalOptions=n.globalOptions||{...K3},n.globalOptions}function kk(n,e,t,r){return t=t||[],t=Array.isArray(t)?t:[t],Dk(n,t),Uk(e,n,r)}function Dk(n,e){D1(n,null,K3,Nk,e);for(const t of e){const r=n&&n[t.id]||{},i=t.options&&t.options[t.id]||{},a=t.deprecatedOptions&&t.deprecatedOptions[t.id]||{};D1(r,t.id,i,a,e)}}function D1(n,e,t,r,i){const a=e||"Top level",l=e?`${e}.`:"";for(const c in n){const f=!e&&Il(n[c]),d=c==="baseUri"&&!e,p=c==="workerUrl"&&e;if(!(c in t)&&!d&&!p){if(c in r)k1.warn(`${a} loader option '${l}${c}' no longer supported, use '${r[c]}'`)();else if(!f){const _=Pk(c,i);k1.warn(`${a} loader option '${l}${c}' not recognized. ${_}`)()}}}}function Pk(n,e){const t=n.toLowerCase();let r="";for(const i of e)for(const a in i.options){if(n===a)return`Did you mean '${i.id}.${a}'?`;const l=a.toLowerCase();(t.startsWith(l)||l.startsWith(t))&&(r=r||`Did you mean '${i.id}.${a}'?`)}return r}function Uk(n,e,t){const i={...n.options||{}};return Bk(i,t),i.log===null&&(i.log=new Ok),P1(i,Q3()),P1(i,e),i}function P1(n,e){for(const t in e)if(t in e){const r=e[t];M1(r)&&M1(n[t])?n[t]={...n[t],...e[t]}:n[t]=e[t]}}function Bk(n,e){e&&!("baseUri"in n)&&(n.baseUri=e)}function z_(n){return n?(Array.isArray(n)&&(n=n[0]),Array.isArray(n==null?void 0:n.extensions)):!1}function V_(n){Xu(n,"null loader"),Xu(z_(n),"invalid loader");let e;return Array.isArray(n)&&(e=n[1],n=n[0],n={...n,options:{...n.options,...e}}),(n!=null&&n.parseTextSync||n!=null&&n.parseText)&&(n.text=!0),n.text||(n.binary=!0),n}const G3=()=>{const n=Z3();return n.loaderRegistry=n.loaderRegistry||[],n.loaderRegistry};function Fk(n){const e=G3();n=Array.isArray(n)?n:[n];for(const t of n){const r=V_(t);e.find(i=>r===i)||e.unshift(r)}}function Lk(){return G3()}const zk=/\.([^.]+)$/;async function Vk(n,e=[],t,r){if(!J3(n))return null;let i=U1(n,e,{...t,nothrow:!0},r);if(i)return i;if(ls(n)&&(n=await n.slice(0,10).arrayBuffer(),i=U1(n,e,t,r)),!i&&!(t!=null&&t.nothrow))throw new Error(ew(n));return i}function U1(n,e=[],t,r){if(!J3(n))return null;if(e&&!Array.isArray(e))return V_(e);let i=[];e&&(i=i.concat(e)),t!=null&&t.ignoreRegisteredLoaders||i.push(...Lk()),jk(i);const a=Hk(n,i,t,r);if(!a&&!(t!=null&&t.nothrow))throw new Error(ew(n));return a}function Hk(n,e,t,r){const i=Lf(n),a=L_(n),l=F_(i)||(r==null?void 0:r.url);let c=null,f="";return t!=null&&t.mimeType&&(c=Mp(e,t==null?void 0:t.mimeType),f=`match forced by supplied MIME type ${t==null?void 0:t.mimeType}`),c=c||$k(e,l),f=f||(c?`matched url ${l}`:""),c=c||Mp(e,a),f=f||(c?`matched MIME type ${a}`:""),c=c||Xk(e,n),f=f||(c?`matched initial data ${tw(n)}`:""),t!=null&&t.fallbackMimeType&&(c=c||Mp(e,t==null?void 0:t.fallbackMimeType),f=f||(c?`matched fallback MIME type ${a}`:"")),f&&LN.log(1,`selectLoader selected ${c==null?void 0:c.name}: ${f}.`),c}function J3(n){return!(n instanceof Response&&n.status===204)}function ew(n){const e=Lf(n),t=L_(n);let r="No valid loader found (";r+=e?`${W3(e)}, `:"no url provided, ",r+=`MIME type: ${t?`"${t}"`:"not provided"}, `;const i=n?tw(n):"";return r+=i?` first bytes: "${i}"`:"first bytes: not available",r+=")",r}function jk(n){for(const e of n)V_(e)}function $k(n,e){const t=e&&zk.exec(e),r=t&&t[1];return r?Wk(n,r):null}function Wk(n,e){e=e.toLowerCase();for(const t of n)for(const r of t.extensions)if(r.toLowerCase()===e)return t;return null}function Mp(n,e){var t;for(const r of n)if((t=r.mimeTypes)!=null&&t.some(i=>O1(e,i))||O1(e,`application/x.${r.id}`))return r;return null}function Xk(n,e){if(!e)return null;for(const t of n)if(typeof e=="string"){if(Yk(e,t))return t}else if(ArrayBuffer.isView(e)){if(B1(e.buffer,e.byteOffset,t))return t}else if(e instanceof ArrayBuffer&&B1(e,0,t))return t;return null}function Yk(n,e){return e.testText?e.testText(n):(Array.isArray(e.tests)?e.tests:[e.tests]).some(r=>n.startsWith(r))}function B1(n,e,t){return(Array.isArray(t.tests)?t.tests:[t.tests]).some(i=>qk(n,e,t,i))}function qk(n,e,t,r){if(r instanceof ArrayBuffer)return nk(r,n,r.byteLength);switch(typeof r){case"function":return r(n);case"string":const i=Og(n,e,r.length);return r===i;default:return!1}}function tw(n,e=5){return typeof n=="string"?n.slice(0,e):ArrayBuffer.isView(n)?Og(n.buffer,n.byteOffset,e):n instanceof ArrayBuffer?Og(n,0,e):""}function Og(n,e,t){if(n.byteLength<e+t)return"";const r=new DataView(n);let i="";for(let a=0;a<t;a++)i+=String.fromCharCode(r.getUint8(e+a));return i}const Kk=256*1024;function*Zk(n,e){const t=(e==null?void 0:e.chunkSize)||Kk;let r=0;const i=new TextEncoder;for(;r<n.length;){const a=Math.min(n.length-r,t),l=n.slice(r,r+a);r+=a,yield i.encode(l)}}const Qk=256*1024;function*Gk(n,e={}){const{chunkSize:t=Qk}=e;let r=0;for(;r<n.byteLength;){const i=Math.min(n.byteLength-r,t),a=new ArrayBuffer(i),l=new Uint8Array(n,r,i);new Uint8Array(a).set(l),r+=i,yield a}}const Jk=1024*1024;async function*eD(n,e){const t=(e==null?void 0:e.chunkSize)||Jk;let r=0;for(;r<n.size;){const i=r+t,a=await n.slice(r,i).arrayBuffer();r=i,yield a}}function F1(n,e){return U_?tD(n,e):nD(n)}async function*tD(n,e){const t=n.getReader();let r;try{for(;;){const i=r||t.read();e!=null&&e._streamReadAhead&&(r=t.read());const{done:a,value:l}=await i;if(a)return;yield $3(l)}}catch{t.releaseLock()}}async function*nD(n,e){for await(const t of n)yield $3(t)}function rD(n,e){if(typeof n=="string")return Zk(n,e);if(n instanceof ArrayBuffer)return Gk(n,e);if(ls(n))return eD(n,e);if(X3(n))return F1(n,e);if(os(n))return F1(n.body,e);throw new Error("makeIterator")}const nw="Cannot convert supplied data type";function iD(n,e,t){if(e.text&&typeof n=="string")return n;if(dk(n)&&(n=n.buffer),n instanceof ArrayBuffer){const r=n;return e.text&&!e.binary?new TextDecoder("utf8").decode(r):r}if(ArrayBuffer.isView(n)){if(e.text&&!e.binary)return new TextDecoder("utf8").decode(n);let r=n.buffer;const i=n.byteLength||n.length;return(n.byteOffset!==0||i!==r.byteLength)&&(r=r.slice(n.byteOffset,n.byteOffset+i)),r}throw new Error(nw)}async function sD(n,e,t){const r=n instanceof ArrayBuffer||ArrayBuffer.isView(n);if(typeof n=="string"||r)return iD(n,e);if(ls(n)&&(n=await q3(n)),os(n)){const i=n;return await xk(i),e.binary?await i.arrayBuffer():await i.text()}if(X3(n)&&(n=rD(n,t)),fk(n)||hk(n))return sk(n);throw new Error(nw)}function rw(n,e){const t=Q3(),r=n||t;return typeof r.fetch=="function"?r.fetch:Il(r.fetch)?i=>N1(i,r.fetch):e!=null&&e.fetch?e==null?void 0:e.fetch:N1}function aD(n,e,t){if(t)return t;const r={fetch:rw(e,n),...n};if(r.url){const i=F_(r.url);r.baseUrl=i,r.queryString=vk(r.url),r.filename=W3(i),r.baseUrl=ck(i)}return Array.isArray(r.loaders)||(r.loaders=null),r}function oD(n,e){if(n&&!Array.isArray(n))return n;let t;if(n&&(t=Array.isArray(n)?n:[n]),e&&e.loaders){const r=Array.isArray(e.loaders)?e.loaders:[e.loaders];t=t?[...t,...r]:r}return t&&t.length?t:void 0}async function Ku(n,e,t,r){e&&!Array.isArray(e)&&!z_(e)&&(r=void 0,t=e,e=void 0),n=await n,t=t||{};const i=Lf(n),l=oD(e,r),c=await Vk(n,l,t);return c?(t=kk(t,c,l,i),r=aD({url:i,_parse:Ku,loaders:l},t,r||null),await lD(c,n,t,r)):null}async function lD(n,e,t,r){if(GN(n),t=zN(n.options,t),os(e)){const a=e,{ok:l,redirected:c,status:f,statusText:d,type:p,url:_}=a,y=Object.fromEntries(a.headers.entries());r.response={headers:y,ok:l,redirected:c,status:f,statusText:d,type:p,url:_}}e=await sD(e,n,t);const i=n;if(i.parseTextSync&&typeof e=="string")return i.parseTextSync(e,t,r);if(JN(n,t))return await ek(n,e,t,r,Ku);if(i.parseText&&typeof e=="string")return await i.parseText(e,t,r);if(i.parse)return await i.parse(e,t,r);throw _i(!i.parseSync),new Error(`${n.id} loader - no parser found and worker is disabled`)}async function Ig(n,e,t,r){let i,a;!Array.isArray(e)&&!z_(e)?(i=[],a=e):(i=e,a=t);const l=rw(a);let c=n;return typeof n=="string"&&(c=await l(n)),ls(n)&&(c=await l(n)),Array.isArray(i)?await Ku(c,i,a):await Ku(c,i,a)}const cD="4.3.2";var I2;const uD=(I2=globalThis.loaders)==null?void 0:I2.parseImageNode,Ng=typeof Image<"u",kg=typeof ImageBitmap<"u",fD=!!uD,Dg=U_?!0:fD;function hD(n){switch(n){case"auto":return kg||Ng||Dg;case"imagebitmap":return kg;case"image":return Ng;case"data":return Dg;default:throw new Error(`@loaders.gl/images: image ${n} not supported in this environment`)}}function dD(){if(kg)return"imagebitmap";if(Ng)return"image";if(Dg)return"data";throw new Error("Install '@loaders.gl/polyfills' to parse images under Node.js")}function pD(n){const e=_D(n);if(!e)throw new Error("Not an image");return e}function gD(n){switch(pD(n)){case"data":return n;case"image":case"imagebitmap":const e=document.createElement("canvas"),t=e.getContext("2d");if(!t)throw new Error("getImageData");return e.width=n.width,e.height=n.height,t.drawImage(n,0,0),t.getImageData(0,0,n.width,n.height);default:throw new Error("getImageData")}}function _D(n){return typeof ImageBitmap<"u"&&n instanceof ImageBitmap?"imagebitmap":typeof Image<"u"&&n instanceof Image?"image":n&&typeof n=="object"&&n.data&&n.width&&n.height?"data":null}const mD=/^data:image\/svg\+xml/,yD=/\.svg((\?|#).*)?$/;function H_(n){return n&&(mD.test(n)||yD.test(n))}function bD(n,e){if(H_(e)){let r=new TextDecoder().decode(n);try{typeof unescape=="function"&&typeof encodeURIComponent=="function"&&(r=unescape(encodeURIComponent(r)))}catch(a){throw new Error(a.message)}return`data:image/svg+xml;base64,${btoa(r)}`}return iw(n,e)}function iw(n,e){if(H_(e))throw new Error("SVG cannot be parsed directly to imagebitmap");return new Blob([new Uint8Array(n)])}async function sw(n,e,t){const r=bD(n,t),i=self.URL||self.webkitURL,a=typeof r!="string"&&i.createObjectURL(r);try{return await vD(a||r,e)}finally{a&&i.revokeObjectURL(a)}}async function vD(n,e){const t=new Image;return t.src=n,e.image&&e.image.decode&&t.decode?(await t.decode(),t):await new Promise((r,i)=>{try{t.onload=()=>r(t),t.onerror=a=>{const l=a instanceof Error?a.message:"error";i(new Error(l))}}catch(a){i(a)}})}const TD={};let L1=!0;async function wD(n,e,t){let r;H_(t)?r=await sw(n,e,t):r=iw(n,t);const i=e&&e.imagebitmap;return await xD(r,i)}async function xD(n,e=null){if((SD(e)||!L1)&&(e=null),e)try{return await createImageBitmap(n,e)}catch(t){console.warn(t),L1=!1}return await createImageBitmap(n)}function SD(n){for(const e in n||TD)return!1;return!0}function AD(n){return!MD(n,"ftyp",4)||(n[8]&96)===0?null:ED(n)}function ED(n){switch(RD(n,8,12).replace("\0"," ").trim()){case"avif":case"avis":return{extension:"avif",mimeType:"image/avif"};default:return null}}function RD(n,e,t){return String.fromCharCode(...n.slice(e,t))}function CD(n){return[...n].map(e=>e.charCodeAt(0))}function MD(n,e,t=0){const r=CD(e);for(let i=0;i<r.length;++i)if(r[i]!==n[i+t])return!1;return!0}const er=!1,al=!0;function aw(n){const e=Nl(n);return ID(e)||DD(e)||ND(e)||kD(e)||OD(e)}function OD(n){const e=new Uint8Array(n instanceof DataView?n.buffer:n),t=AD(e);return t?{mimeType:t.mimeType,width:0,height:0}:null}function ID(n){const e=Nl(n);return e.byteLength>=24&&e.getUint32(0,er)===2303741511?{mimeType:"image/png",width:e.getUint32(16,er),height:e.getUint32(20,er)}:null}function ND(n){const e=Nl(n);return e.byteLength>=10&&e.getUint32(0,er)===1195984440?{mimeType:"image/gif",width:e.getUint16(6,al),height:e.getUint16(8,al)}:null}function kD(n){const e=Nl(n);return e.byteLength>=14&&e.getUint16(0,er)===16973&&e.getUint32(2,al)===e.byteLength?{mimeType:"image/bmp",width:e.getUint32(18,al),height:e.getUint32(22,al)}:null}function DD(n){const e=Nl(n);if(!(e.byteLength>=3&&e.getUint16(0,er)===65496&&e.getUint8(2)===255))return null;const{tableMarkers:r,sofMarkers:i}=PD();let a=2;for(;a+9<e.byteLength;){const l=e.getUint16(a,er);if(i.has(l))return{mimeType:"image/jpeg",height:e.getUint16(a+5,er),width:e.getUint16(a+7,er)};if(!r.has(l))return null;a+=2,a+=e.getUint16(a,er)}return null}function PD(){const n=new Set([65499,65476,65484,65501,65534]);for(let t=65504;t<65520;++t)n.add(t);return{tableMarkers:n,sofMarkers:new Set([65472,65473,65474,65475,65477,65478,65479,65481,65482,65483,65485,65486,65487,65502])}}function Nl(n){if(n instanceof DataView)return n;if(ArrayBuffer.isView(n))return new DataView(n.buffer);if(n instanceof ArrayBuffer)return new DataView(n);throw new Error("toDataView")}async function UD(n,e){var i;const{mimeType:t}=aw(n)||{},r=(i=globalThis.loaders)==null?void 0:i.parseImageNode;return Xu(r),await r(n,t)}async function BD(n,e,t){e=e||{};const i=(e.image||{}).type||"auto",{url:a}=t||{},l=FD(i);let c;switch(l){case"imagebitmap":c=await wD(n,e,a);break;case"image":c=await sw(n,e,a);break;case"data":c=await UD(n);break;default:Xu(!1)}return i==="data"&&(c=gD(c)),c}function FD(n){switch(n){case"auto":case"data":return dD();default:return hD(n),n}}const LD=["png","jpg","jpeg","gif","webp","bmp","ico","svg","avif"],zD=["image/png","image/jpeg","image/gif","image/webp","image/avif","image/bmp","image/vnd.microsoft.icon","image/svg+xml"],VD={image:{type:"auto",decode:!0}},HD={dataType:null,batchType:null,id:"image",module:"images",name:"Images",version:cD,mimeTypes:zD,extensions:LD,parse:BD,tests:[n=>!!aw(new DataView(n))],options:VD},tt=new Ol({id:"deck"});let Pg={};function jD(n){Pg=n}function Yt(n,e,t,r){tt.level>0&&Pg[n]&&Pg[n].call(null,e,t,r)}function $D(n){const e=n[0],t=n[n.length-1];return e==="{"&&t==="}"||e==="["&&t==="]"}const WD={dataType:null,batchType:null,id:"JSON",name:"JSON",module:"",version:"",options:{},extensions:["json","geojson"],mimeTypes:["application/json","application/geo+json"],testText:$D,parseTextSync:JSON.parse};function XD(){const n="9.1.9",e=globalThis.deck&&globalThis.deck.VERSION;if(e&&e!==n)throw new Error(`deck.gl - multiple versions detected: ${e} vs ${n}`);return e||(tt.log(1,`deck.gl ${n}`)(),globalThis.deck={...globalThis.deck,VERSION:n,version:n,log:tt,_registerLoggers:jD},Fk([WD,[HD,{imagebitmap:{premultiplyAlpha:"none"}}]])),n}const YD=XD();function j_(n,e){if(!n)throw new Error(e||"shadertools: assertion failed.")}const Op={number:{type:"number",validate(n,e){return Number.isFinite(n)&&typeof e=="object"&&(e.max===void 0||n<=e.max)&&(e.min===void 0||n>=e.min)}},array:{type:"array",validate(n,e){return Array.isArray(n)||ArrayBuffer.isView(n)}}};function qD(n){const e={};for(const[t,r]of Object.entries(n))e[t]=KD(r);return e}function KD(n){let e=z1(n);if(e!=="object")return{value:n,...Op[e],type:e};if(typeof n=="object")return n?n.type!==void 0?{...n,...Op[n.type],type:n.type}:n.value===void 0?{type:"object",value:n}:(e=z1(n.value),{...n,...Op[e],type:e}):{type:"object",value:null};throw new Error("props")}function z1(n){return Array.isArray(n)||ArrayBuffer.isView(n)?"array":typeof n}const ZD=`#ifdef MODULE_LOGDEPTH
  logdepth_adjustPosition(gl_Position);
#endif
`,QD=`#ifdef MODULE_MATERIAL
  fragColor = material_filterColor(fragColor);
#endif

#ifdef MODULE_LIGHTING
  fragColor = lighting_filterColor(fragColor);
#endif

#ifdef MODULE_FOG
  fragColor = fog_filterColor(fragColor);
#endif

#ifdef MODULE_PICKING
  fragColor = picking_filterHighlightColor(fragColor);
  fragColor = picking_filterPickingColor(fragColor);
#endif

#ifdef MODULE_LOGDEPTH
  logdepth_setFragDepth();
#endif
`,GD={vertex:ZD,fragment:QD},V1=/void\s+main\s*\([^)]*\)\s*\{\n?/,H1=/}\n?[^{}]*$/,Ip=[],Tu="__LUMA_INJECT_DECLARATIONS__";function JD(n){const e={vertex:{},fragment:{}};for(const t in n){let r=n[t];const i=eP(t);typeof r=="string"&&(r={order:0,injection:r}),e[i][t]=r}return e}function eP(n){const e=n.slice(0,2);switch(e){case"vs":return"vertex";case"fs":return"fragment";default:throw new Error(e)}}function Zu(n,e,t,r=!1){const i=e==="vertex";for(const a in t){const l=t[a];l.sort((f,d)=>f.order-d.order),Ip.length=l.length;for(let f=0,d=l.length;f<d;++f)Ip[f]=l[f].injection;const c=`${Ip.join(`
`)}
`;switch(a){case"vs:#decl":i&&(n=n.replace(Tu,c));break;case"vs:#main-start":i&&(n=n.replace(V1,f=>f+c));break;case"vs:#main-end":i&&(n=n.replace(H1,f=>c+f));break;case"fs:#decl":i||(n=n.replace(Tu,c));break;case"fs:#main-start":i||(n=n.replace(V1,f=>f+c));break;case"fs:#main-end":i||(n=n.replace(H1,f=>c+f));break;default:n=n.replace(a,f=>f+c)}}return n=n.replace(Tu,""),r&&(n=n.replace(/\}\s*$/,a=>a+GD[e])),n}function Qu(n){n.map(e=>tP(e))}function tP(n){if(n.instance)return;Qu(n.dependencies||[]);const{propTypes:e={},deprecations:t=[],inject:r={}}=n,i={normalizedInjections:JD(r),parsedDeprecations:nP(t)};e&&(i.propValidators=qD(e)),n.instance=i;let a={};e&&(a=Object.entries(e).reduce((l,[c,f])=>{const d=f==null?void 0:f.value;return d&&(l[c]=d),l},{})),n.defaultUniforms={...n.defaultUniforms,...a}}function ow(n,e,t){var r;(r=n.deprecations)==null||r.forEach(i=>{var a;(a=i.regex)!=null&&a.test(e)&&(i.deprecated?t.deprecated(i.old,i.new)():t.removed(i.old,i.new)())})}function nP(n){return n.forEach(e=>{switch(e.type){case"function":e.regex=new RegExp(`\\b${e.old}\\(`);break;default:e.regex=new RegExp(`${e.type} ${e.old};`)}}),n}function $_(n){Qu(n);const e={},t={};lw({modules:n,level:0,moduleMap:e,moduleDepth:t});const r=Object.keys(t).sort((i,a)=>t[a]-t[i]).map(i=>e[i]);return Qu(r),r}function lw(n){const{modules:e,level:t,moduleMap:r,moduleDepth:i}=n;if(t>=5)throw new Error("Possible loop in shader dependency graph");for(const a of e)r[a.name]=a,(i[a.name]===void 0||i[a.name]<t)&&(i[a.name]=t);for(const a of e)a.dependencies&&lw({modules:a.dependencies,level:t+1,moduleMap:r,moduleDepth:i})}function rP(n){switch(n==null?void 0:n.gpu.toLowerCase()){case"apple":return`#define APPLE_GPU
// Apple optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"nvidia":return`#define NVIDIA_GPU
// Nvidia optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
`;case"intel":return`#define INTEL_GPU
// Intel optimizes away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Intel's built-in 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// Intel GPU doesn't have full 32 bits precision in same cases, causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`;case"amd":return`#define AMD_GPU
`;default:return`#define DEFAULT_GPU
// Prevent driver from optimizing away the calculation necessary for emulated fp64
#define LUMA_FP64_CODE_ELIMINATION_WORKAROUND 1
// Headless Chrome's software shader 'tan' function doesn't have acceptable precision
#define LUMA_FP32_TAN_PRECISION_WORKAROUND 1
// If the GPU doesn't have full 32 bits precision, will causes overflow
#define LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND 1
`}}function iP(n,e){var r;if(Number(((r=n.match(/^#version[ \t]+(\d+)/m))==null?void 0:r[1])||100)!==300)throw new Error("luma.gl v9 only supports GLSL 3.00 shader sources");switch(e){case"vertex":return n=j1(n,sP),n;case"fragment":return n=j1(n,aP),n;default:throw new Error(e)}}const cw=[[/^(#version[ \t]+(100|300[ \t]+es))?[ \t]*\n/,`#version 300 es
`],[/\btexture(2D|2DProj|Cube)Lod(EXT)?\(/g,"textureLod("],[/\btexture(2D|2DProj|Cube)(EXT)?\(/g,"texture("]],sP=[...cw,[Ug("attribute"),"in $1"],[Ug("varying"),"out $1"]],aP=[...cw,[Ug("varying"),"in $1"]];function j1(n,e){for(const[t,r]of e)n=n.replace(t,r);return n}function Ug(n){return new RegExp(`\\b${n}[ \\t]+(\\w+[ \\t]+\\w+(\\[\\w+\\])?;)`,"g")}function uw(n,e){let t="";for(const r in n){const i=n[r];if(t+=`void ${i.signature} {
`,i.header&&(t+=`  ${i.header}`),e[r]){const a=e[r];a.sort((l,c)=>l.order-c.order);for(const l of a)t+=`  ${l.injection}
`}i.footer&&(t+=`  ${i.footer}`),t+=`}
`}return t}function fw(n){const e={vertex:{},fragment:{}};for(const t of n){let r,i;typeof t!="string"?(r=t,i=r.hook):(r={},i=t),i=i.trim();const[a,l]=i.split(":"),c=i.replace(/\(.+/,""),f=Object.assign(r,{signature:l});switch(a){case"vs":e.vertex[c]=f;break;case"fs":e.fragment[c]=f;break;default:throw new Error(a)}}return e}function oP(n,e){return{name:lP(n,e),language:"glsl",version:cP(n)}}function lP(n,e="unnamed"){const r=/#define[^\S\r\n]*SHADER_NAME[^\S\r\n]*([A-Za-z0-9_-]+)\s*/.exec(n);return r?r[1]:e}function cP(n){let e=100;const t=n.match(/[^\s]+/g);if(t&&t.length>=2&&t[0]==="#version"){const r=parseInt(t[1],10);Number.isFinite(r)&&(e=r)}if(e!==100&&e!==300)throw new Error(`Invalid GLSL version ${e}`);return e}const hw=`

${Tu}
`,uP=`precision highp float;
`;function fP(n){const e=$_(n.modules||[]);return{source:dP(n.platformInfo,{...n,source:n.source,stage:"vertex",modules:e}),getUniforms:dw(e)}}function hP(n){const{vs:e,fs:t}=n,r=$_(n.modules||[]);return{vs:$1(n.platformInfo,{...n,source:e,stage:"vertex",modules:r}),fs:$1(n.platformInfo,{...n,source:t,stage:"fragment",modules:r}),getUniforms:dw(r)}}function dP(n,e){var A;const{source:t,stage:r,modules:i,hookFunctions:a=[],inject:l={},log:c}=e;j_(typeof t=="string","shader source must be a string");const f=t;let d="";const p=fw(a),_={},y={},b={};for(const C in l){const N=typeof l[C]=="string"?{injection:l[C],order:0}:l[C],O=/^(v|f)s:(#)?([\w-]+)$/.exec(C);if(O){const R=O[2],E=O[3];R?E==="decl"?y[C]=[N]:b[C]=[N]:_[C]=[N]}else b[C]=[N]}const T=i;for(const C of T){c&&ow(C,f,c);const N=pw(C,"wgsl");d+=N;const O=((A=C.injections)==null?void 0:A[r])||{};for(const R in O){const E=/^(v|f)s:#([\w-]+)$/.exec(R);if(E){const V=E[2]==="decl"?y:b;V[R]=V[R]||[],V[R].push(O[R])}else _[R]=_[R]||[],_[R].push(O[R])}}return d+=hw,d=Zu(d,r,y),d+=uw(p[r],_),d+=f,d=Zu(d,r,b),d}function $1(n,e){var ne;const{id:t,source:r,stage:i,language:a="glsl",modules:l,defines:c={},hookFunctions:f=[],inject:d={},prologue:p=!0,log:_}=e;j_(typeof r=="string","shader source must be a string");const y=a==="glsl"?oP(r).version:-1,b=n.shaderLanguageVersion,T=y===100?"#version 100":"#version 300 es",C=r.split(`
`).slice(1).join(`
`),N={};l.forEach(G=>{Object.assign(N,G.defines)}),Object.assign(N,c);let O="";switch(a){case"wgsl":break;case"glsl":O=p?`${T}

// ----- PROLOGUE -------------------------
${pP({id:t,source:r,stage:i})}
${`#define SHADER_TYPE_${i.toUpperCase()}`}

${rP(n)}
${i==="fragment"?uP:""}

// ----- APPLICATION DEFINES -------------------------

${gP(N)}

`:`${T}
`;break}const R=fw(f),E={},k={},V={};for(const G in d){const se=typeof d[G]=="string"?{injection:d[G],order:0}:d[G],re=/^(v|f)s:(#)?([\w-]+)$/.exec(G);if(re){const q=re[2],ce=re[3];q?ce==="decl"?k[G]=[se]:V[G]=[se]:E[G]=[se]}else V[G]=[se]}for(const G of l){_&&ow(G,C,_);const se=pw(G,i);O+=se;const re=((ne=G.instance)==null?void 0:ne.normalizedInjections[i])||{};for(const q in re){const ce=/^(v|f)s:#([\w-]+)$/.exec(q);if(ce){const de=ce[2]==="decl"?k:V;de[q]=de[q]||[],de[q].push(re[q])}else E[q]=E[q]||[],E[q].push(re[q])}}return O+="// ----- MAIN SHADER SOURCE -------------------------",O+=hw,O=Zu(O,i,k),O+=uw(R[i],E),O+=C,O=Zu(O,i,V),a==="glsl"&&y!==b&&(O=iP(O,i)),O.trim()}function dw(n){return function(t){var i;const r={};for(const a of n){const l=(i=a.getUniforms)==null?void 0:i.call(a,t,r);Object.assign(r,l)}return r}}function pP(n){const{id:e,source:t,stage:r}=n;return e&&t.indexOf("SHADER_NAME")===-1?`
#define SHADER_NAME ${e}_${r}`:""}function gP(n={}){let e="";for(const t in n){const r=n[t];(r||Number.isFinite(r))&&(e+=`#define ${t.toUpperCase()} ${n[t]}
`)}return e}function pw(n,e){let t;switch(e){case"vertex":t=n.vs||"";break;case"fragment":t=n.fs||"";break;case"wgsl":t=n.source||"";break;default:j_(!1)}if(!n.name)throw new Error("Shader module must have a name");const r=n.name.toUpperCase().replace(/[^0-9a-z]/gi,"_");let i=`// ----- MODULE ${n.name} ---------------

`;return e!=="wgsl"&&(i+=`#define MODULE_${r}
`),i+=`${t}
`,i}const _P=/^\s*\#\s*ifdef\s*([a-zA-Z_]+)\s*$/,mP=/^\s*\#\s*endif\s*$/;function yP(n,e){var l;const t=n.split(`
`),r=[];let i=!0,a=null;for(const c of t){const f=c.match(_P),d=c.match(mP);f?(a=f[1],i=!!((l=e==null?void 0:e.defines)!=null&&l[a])):d?i=!0:i&&r.push(c)}return r.join(`
`)}const zi=class zi{constructor(){w(this,"_hookFunctions",[]);w(this,"_defaultModules",[])}static getDefaultShaderAssembler(){return zi.defaultShaderAssembler=zi.defaultShaderAssembler||new zi,zi.defaultShaderAssembler}addDefaultModule(e){this._defaultModules.find(t=>t.name===(typeof e=="string"?e:e.name))||this._defaultModules.push(e)}removeDefaultModule(e){const t=typeof e=="string"?e:e.name;this._defaultModules=this._defaultModules.filter(r=>r.name!==t)}addShaderHook(e,t){t&&(e=Object.assign(t,{hook:e})),this._hookFunctions.push(e)}assembleWGSLShader(e){const t=this._getModuleList(e.modules),r=this._hookFunctions,{source:i,getUniforms:a}=fP({...e,source:e.source,modules:t,hookFunctions:r});return{source:e.platformInfo.shaderLanguage==="wgsl"?yP(i):i,getUniforms:a,modules:t}}assembleGLSLShaderPair(e){const t=this._getModuleList(e.modules),r=this._hookFunctions;return{...hP({...e,vs:e.vs,fs:e.fs,modules:t,hookFunctions:r}),modules:t}}_getModuleList(e=[]){const t=new Array(this._defaultModules.length+e.length),r={};let i=0;for(let a=0,l=this._defaultModules.length;a<l;++a){const c=this._defaultModules[a],f=c.name;t[i++]=c,r[f]=!0}for(let a=0,l=e.length;a<l;++a){const c=e[a],f=c.name;r[f]||(t[i++]=c,r[f]=!0)}return t.length=i,Qu(t),t}};w(zi,"defaultShaderAssembler");let Gu=zi;const bP=`out vec4 transform_output;
void main() {
  transform_output = vec4(0);
}`,vP=`#version 300 es
${bP}`;function TP(n){const{input:e,inputChannels:t,output:r}={};if(!e)return vP;if(!t)throw new Error("inputChannels");const i=wP(t),a=xP(e,t);return`#version 300 es
in ${i} ${e};
out vec4 ${r};
void main() {
  ${r} = ${a};
}`}function wP(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`invalid channels: ${n}`)}}function xP(n,e){switch(e){case 1:return`vec4(${n}, 0.0, 0.0, 1.0)`;case 2:return`vec4(${n}, 0.0, 1.0)`;case 3:return`vec4(${n}, 1.0)`;case 4:return n;default:throw new Error(`invalid channels: ${e}`)}}class SP{constructor(){w(this,"stats",new Map)}getStats(e){return this.get(e)}get(e){return this.stats.has(e)||this.stats.set(e,new Ff({id:e})),this.stats.get(e)}}const gw=new SP,le=new Ol({id:"luma.gl"}),Np={};function zf(n="id"){Np[n]=Np[n]||1;const e=Np[n]++;return`${n}-${e}`}var ag;let Ze=(ag=class{constructor(e,t,r){w(this,"id");w(this,"props");w(this,"userData",{});w(this,"_device");w(this,"destroyed",!1);w(this,"allocatedBytes",0);w(this,"_attachedResources",new Set);if(!e)throw new Error("no device");this._device=e,this.props=AP(t,r);const i=this.props.id!=="undefined"?this.props.id:zf(this[Symbol.toStringTag]);this.props.id=i,this.id=i,this.userData=this.props.userData||{},this.addStats()}toString(){return`${this[Symbol.toStringTag]||this.constructor.name}:"${this.id}"`}destroy(){this.destroyResource()}delete(){return this.destroy(),this}getProps(){return this.props}attachResource(e){this._attachedResources.add(e)}detachResource(e){this._attachedResources.delete(e)}destroyAttachedResource(e){this._attachedResources.delete(e)&&e.destroy()}destroyAttachedResources(){for(const e of Object.values(this._attachedResources))e.destroy();this._attachedResources=new Set}destroyResource(){this.destroyAttachedResources(),this.removeStats(),this.destroyed=!0}removeStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get(`${t}s Active`).decrementCount()}trackAllocatedMemory(e,t=this[Symbol.toStringTag]){const r=this._device.statsManager.getStats("Resource Counts");r.get("GPU Memory").addCount(e),r.get(`${t} Memory`).addCount(e),this.allocatedBytes=e}trackDeallocatedMemory(e=this[Symbol.toStringTag]){const t=this._device.statsManager.getStats("Resource Counts");t.get("GPU Memory").subtractCount(this.allocatedBytes),t.get(`${e} Memory`).subtractCount(this.allocatedBytes),this.allocatedBytes=0}addStats(){const e=this._device.statsManager.getStats("Resource Counts"),t=this[Symbol.toStringTag];e.get("Resources Created").incrementCount(),e.get(`${t}s Created`).incrementCount(),e.get(`${t}s Active`).incrementCount()}},w(ag,"defaultProps",{id:"undefined",handle:void 0,userData:void 0}),ag);function AP(n,e){const t={...e};for(const r in n)n[r]!==void 0&&(t[r]=n[r]);return t}const kt=class kt extends Ze{constructor(t,r){const i={...r};(r.usage||0)&kt.INDEX&&!r.indexType&&(r.data instanceof Uint32Array?i.indexType="uint32":r.data instanceof Uint16Array&&(i.indexType="uint16")),delete i.data;super(t,i,kt.defaultProps);w(this,"usage");w(this,"indexType");w(this,"updateTimestamp");w(this,"debugData",new ArrayBuffer(0));this.usage=i.usage||0,this.indexType=i.indexType,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Buffer"}clone(t){return this.device.createBuffer({...this.props,...t})}readSyncWebGL(t,r){throw new Error("not implemented")}_setDebugData(t,r,i){const a=ArrayBuffer.isView(t)?t.buffer:t,l=Math.min(t?t.byteLength:i,kt.DEBUG_DATA_MAX_LENGTH);a===null?this.debugData=new ArrayBuffer(l):r===0&&i===a.byteLength?this.debugData=a.slice(0,l):this.debugData=a.slice(r,r+l)}};w(kt,"defaultProps",{...Ze.defaultProps,usage:0,byteLength:0,byteOffset:0,data:null,indexType:"uint16",mappedAtCreation:!1}),w(kt,"MAP_READ",1),w(kt,"MAP_WRITE",2),w(kt,"COPY_SRC",4),w(kt,"COPY_DST",8),w(kt,"INDEX",16),w(kt,"VERTEX",32),w(kt,"UNIFORM",64),w(kt,"STORAGE",128),w(kt,"INDIRECT",256),w(kt,"QUERY_RESOLVE",512),w(kt,"DEBUG_DATA_MAX_LENGTH",32);let rt=kt;function _w(n){const e=W1[n],t=EP(e),r=n.includes("norm"),i=!r&&!n.startsWith("float"),a=n.startsWith("s");return{dataType:W1[n],byteLength:t,integer:i,signed:a,normalized:r}}function EP(n){return RP[n]}const W1={uint8:"uint8",sint8:"sint8",unorm8:"uint8",snorm8:"sint8",uint16:"uint16",sint16:"sint16",unorm16:"uint16",snorm16:"sint16",float16:"float16",float32:"float32",uint32:"uint32",sint32:"sint32"},RP={uint8:1,sint8:1,uint16:2,sint16:2,float16:2,float32:4,uint32:4,sint32:4},Ft="texture-compression-bc",Ke="texture-compression-astc",qn="texture-compression-etc2",CP="texture-compression-etc1-webgl",iu="texture-compression-pvrtc-webgl",kp="texture-compression-atc-webgl",su="float32-renderable-webgl",Dp="float16-renderable-webgl",MP="rgb9e5ufloat-renderable-webgl",Pp="snorm8-renderable-webgl",jo="norm16-renderable-webgl",Up="snorm16-renderable-webgl",au="float32-filterable",X1="float16-filterable-webgl";function mw(n){const e=OP[n];if(!e)throw new Error(`Unsupported texture format ${n}`);return e}const OP={r8unorm:{},r8snorm:{render:Pp},r8uint:{},r8sint:{},rg8unorm:{},rg8snorm:{render:Pp},rg8uint:{},rg8sint:{},r16uint:{},r16sint:{},r16float:{render:Dp,filter:"float16-filterable-webgl"},"r16unorm-webgl":{f:jo},"r16snorm-webgl":{f:Up},"rgba4unorm-webgl":{channels:"rgba",bitsPerChannel:[4,4,4,4],packed:!0},"rgb565unorm-webgl":{channels:"rgb",bitsPerChannel:[5,6,5,0],packed:!0},"rgb5a1unorm-webgl":{channels:"rgba",bitsPerChannel:[5,5,5,1],packed:!0},"rgb8unorm-webgl":{},"rgb8snorm-webgl":{},rgba8unorm:{},"rgba8unorm-srgb":{},rgba8snorm:{render:Pp},rgba8uint:{},rgba8sint:{},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{},rg16sint:{},rg16float:{render:Dp,filter:X1},"rg16unorm-webgl":{render:jo},"rg16snorm-webgl":{render:Up},r32uint:{},r32sint:{},r32float:{render:su,filter:au},rgb9e5ufloat:{channels:"rgb",packed:!0,render:MP},rg11b10ufloat:{channels:"rgb",bitsPerChannel:[11,11,10,0],packed:!0,p:1,render:su},rgb10a2unorm:{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1},"rgb10a2uint-webgl":{channels:"rgba",bitsPerChannel:[10,10,10,2],packed:!0,p:1,wgpu:!1},"rgb16unorm-webgl":{f:jo},"rgb16snorm-webgl":{f:jo},rg32uint:{},rg32sint:{},rg32float:{render:!1,filter:au},rgba16uint:{},rgba16sint:{},rgba16float:{render:Dp,filter:X1},"rgba16unorm-webgl":{render:jo},"rgba16snorm-webgl":{render:Up},"rgb32float-webgl":{render:su,filter:au},rgba32uint:{},rgba32sint:{},rgba32float:{render:su,filter:au},stencil8:{attachment:"stencil",bitsPerChannel:[8,0,0,0],dataType:"uint8"},depth16unorm:{attachment:"depth",bitsPerChannel:[16,0,0,0],dataType:"uint16"},depth24plus:{attachment:"depth",bitsPerChannel:[24,0,0,0],dataType:"uint32"},depth32float:{attachment:"depth",bitsPerChannel:[32,0,0,0],dataType:"float32"},"depth24plus-stencil8":{attachment:"depth-stencil",bitsPerChannel:[24,8,0,0],packed:!0},"depth32float-stencil8":{attachment:"depth-stencil",bitsPerChannel:[32,8,0,0],packed:!0},"bc1-rgb-unorm-webgl":{f:Ft},"bc1-rgb-unorm-srgb-webgl":{f:Ft},"bc1-rgba-unorm":{f:Ft},"bc1-rgba-unorm-srgb":{f:Ft},"bc2-rgba-unorm":{f:Ft},"bc2-rgba-unorm-srgb":{f:Ft},"bc3-rgba-unorm":{f:Ft},"bc3-rgba-unorm-srgb":{f:Ft},"bc4-r-unorm":{f:Ft},"bc4-r-snorm":{f:Ft},"bc5-rg-unorm":{f:Ft},"bc5-rg-snorm":{f:Ft},"bc6h-rgb-ufloat":{f:Ft},"bc6h-rgb-float":{f:Ft},"bc7-rgba-unorm":{f:Ft},"bc7-rgba-unorm-srgb":{f:Ft},"etc2-rgb8unorm":{f:qn},"etc2-rgb8unorm-srgb":{f:qn},"etc2-rgb8a1unorm":{f:qn},"etc2-rgb8a1unorm-srgb":{f:qn},"etc2-rgba8unorm":{f:qn},"etc2-rgba8unorm-srgb":{f:qn},"eac-r11unorm":{f:qn},"eac-r11snorm":{f:qn},"eac-rg11unorm":{f:qn},"eac-rg11snorm":{f:qn},"astc-4x4-unorm":{f:Ke},"astc-4x4-unorm-srgb":{f:Ke},"astc-5x4-unorm":{f:Ke},"astc-5x4-unorm-srgb":{f:Ke},"astc-5x5-unorm":{f:Ke},"astc-5x5-unorm-srgb":{f:Ke},"astc-6x5-unorm":{f:Ke},"astc-6x5-unorm-srgb":{f:Ke},"astc-6x6-unorm":{f:Ke},"astc-6x6-unorm-srgb":{f:Ke},"astc-8x5-unorm":{f:Ke},"astc-8x5-unorm-srgb":{f:Ke},"astc-8x6-unorm":{f:Ke},"astc-8x6-unorm-srgb":{f:Ke},"astc-8x8-unorm":{f:Ke},"astc-8x8-unorm-srgb":{f:Ke},"astc-10x5-unorm":{f:Ke},"astc-10x5-unorm-srgb":{f:Ke},"astc-10x6-unorm":{f:Ke},"astc-10x6-unorm-srgb":{f:Ke},"astc-10x8-unorm":{f:Ke},"astc-10x8-unorm-srgb":{f:Ke},"astc-10x10-unorm":{f:Ke},"astc-10x10-unorm-srgb":{f:Ke},"astc-12x10-unorm":{f:Ke},"astc-12x10-unorm-srgb":{f:Ke},"astc-12x12-unorm":{f:Ke},"astc-12x12-unorm-srgb":{f:Ke},"pvrtc-rgb4unorm-webgl":{f:iu},"pvrtc-rgba4unorm-webgl":{f:iu},"pvrtc-rbg2unorm-webgl":{f:iu},"pvrtc-rgba2unorm-webgl":{f:iu},"etc1-rbg-unorm-webgl":{f:CP},"atc-rgb-unorm-webgl":{f:kp},"atc-rgba-unorm-webgl":{f:kp},"atc-rgbai-unorm-webgl":{f:kp}},IP=["bc1","bc2","bc3","bc4","bc5","bc6","bc7","etc1","etc2","eac","atc","astc","pvrtc"],NP=/^(r|rg|rgb|rgba|bgra)([0-9]*)([a-z]*)(-srgb)?(-webgl)?$/;function yw(n){return IP.some(e=>n.startsWith(e))}function W_(n){let e=kP(n);if(yw(n)){e.channels="rgb",e.components=3,e.bytesPerPixel=1,e.srgb=!1,e.compressed=!0;const r=DP(n);r&&(e.blockWidth=r.blockWidth,e.blockHeight=r.blockHeight)}const t=NP.exec(n);if(t){const[,r,i,a,l,c]=t,f=`${a}${i}`,d=_w(f),p=d.byteLength*8,_=r.length,y=[p,_>=2?p:0,_>=3?p:0,_>=4?p:0];e={format:n,attachment:e.attachment,dataType:d.dataType,components:_,channels:r,integer:d.integer,signed:d.signed,normalized:d.normalized,bitsPerChannel:y,bytesPerPixel:d.byteLength*r.length,packed:e.packed,srgb:e.srgb},c==="-webgl"&&(e.webgl=!0),l==="-srgb"&&(e.srgb=!0)}return n.endsWith("-webgl")&&(e.webgl=!0),n.endsWith("-srgb")&&(e.srgb=!0),e}function kP(n){var a;const e=mw(n),t=e.bytesPerPixel||1,r=e.bitsPerChannel||[8,8,8,8];return delete e.bitsPerChannel,delete e.bytesPerPixel,delete e.f,delete e.render,delete e.filter,delete e.blend,delete e.store,{...e,format:n,attachment:e.attachment||"color",channels:e.channels||"r",components:e.components||((a=e.channels)==null?void 0:a.length)||1,bytesPerPixel:t,bitsPerChannel:r,dataType:e.dataType||"uint8",srgb:e.srgb??!1,packed:e.packed??!1,webgl:e.webgl??!1,integer:e.integer??!1,signed:e.signed??!1,normalized:e.normalized??!1,compressed:e.compressed??!1}}function DP(n){const t=/.*-(\d+)x(\d+)-.*/.exec(n);if(t){const[,r,i]=t;return{blockWidth:Number(r),blockHeight:Number(i)}}return null}function PP(n){const e=mw(n),t={format:n,create:e.f??!0,render:e.render??!0,filter:e.filter??!0,blend:e.blend??!0,store:e.store??!0},r=W_(n),i=n.startsWith("depth")||n.startsWith("stencil"),a=r==null?void 0:r.signed,l=r==null?void 0:r.integer,c=r==null?void 0:r.webgl;return t.render&&(t.render=!a),t.filter&&(t.filter=!i&&!a&&!l&&!c),t}class UP{}class BP{constructor(e=[],t){w(this,"features");w(this,"disabledFeatures");this.features=new Set(e),this.disabledFeatures=t||{}}*[Symbol.iterator](){yield*this.features}has(e){var t;return!((t=this.disabledFeatures)!=null&&t[e])&&this.features.has(e)}}const bf=class bf{constructor(e){w(this,"id");w(this,"props");w(this,"userData",{});w(this,"statsManager",gw);w(this,"timestamp",0);w(this,"_reused",!1);w(this,"_lumaData",{});this.props={...bf.defaultProps,...e},this.id=this.props.id||zf(this[Symbol.toStringTag].toLowerCase())}get[Symbol.toStringTag](){return"Device"}getTextureFormatCapabilities(e){const t=PP(e),r=l=>(typeof l=="string"?this.features.has(l):l)??!0,i=r(t.create),a={format:e,create:i,render:i&&r(t.render),filter:i&&r(t.filter),blend:i&&r(t.blend),store:i&&r(t.store)};return this._getDeviceSpecificTextureFormatCapabilities(a)}isTextureFormatSupported(e,t){return this.getTextureFormatCapabilities(e).create}isTextureFormatFilterable(e){return this.getTextureFormatCapabilities(e).filter}isTextureFormatRenderable(e){return this.getTextureFormatCapabilities(e).render}isTextureFormatCompressed(e){return yw(e)}loseDevice(){return!1}reportError(e){this.props.onError(e)}getDefaultCanvasContext(){if(!this.canvasContext)throw new Error("Device has no default CanvasContext. See props.createCanvasContext");return this.canvasContext}createCommandEncoder(e={}){throw new Error("not implemented")}incrementTimestamp(){return this.timestamp++}onError(e){this.props.onError(e)}getCanvasContext(){return this.getDefaultCanvasContext()}readPixelsToArrayWebGL(e,t){throw new Error("not implemented")}readPixelsToBufferWebGL(e,t){throw new Error("not implemented")}setParametersWebGL(e){throw new Error("not implemented")}getParametersWebGL(e){throw new Error("not implemented")}withParametersWebGL(e,t){throw new Error("not implemented")}clearWebGL(e){throw new Error("not implemented")}resetWebGL(){throw new Error("not implemented")}static _getCanvasContextProps(e){return e.createCanvasContext===!0?{}:e.createCanvasContext}_normalizeBufferProps(e){(e instanceof ArrayBuffer||ArrayBuffer.isView(e))&&(e={data:e});const t={...e};return(e.usage||0)&rt.INDEX&&!e.indexType&&(e.data instanceof Uint32Array?t.indexType="uint32":e.data instanceof Uint16Array?t.indexType="uint16":le.warn("indices buffer content must be of integer type")()),t}};w(bf,"defaultProps",{id:null,powerPreference:"high-performance",failIfMajorPerformanceCaveat:!1,createCanvasContext:void 0,onError:e=>le.error(e.message)(),_reuseDevices:!1,_requestMaxLimits:!0,_factoryDestroyPolicy:"unused",_initializeFeatures:!0,_disabledFeatures:{"compilation-status-async-webgl":!0},_resourceDefaults:{},webgl:{},debug:le.get("debug")||void 0,debugShaders:le.get("debug-shaders")||void 0,debugFramebuffers:!!le.get("debug-framebuffers"),debugWebGL:!!le.get("debug-webgl"),debugSpectorJS:void 0,debugSpectorJSUrl:void 0,_handle:void 0});let pi=bf;const FP=as()&&typeof document<"u",LP=()=>FP&&document.readyState==="complete",zP="set luma.log.level=1 (or higher) to trace rendering",Y1="No matching device found. Ensure `@luma.gl/webgl` and/or `@luma.gl/webgpu` modules are imported.",ci=class ci{constructor(){w(this,"stats",gw);w(this,"log",le);w(this,"VERSION","9.1.9");w(this,"spector");w(this,"preregisteredAdapters",new Map);if(globalThis.luma){if(globalThis.luma.VERSION!==this.VERSION)throw le.error(`Found luma.gl ${globalThis.luma.VERSION} while initialzing ${this.VERSION}`)(),le.error("'yarn why @luma.gl/core' can help identify the source of the conflict")(),new Error("luma.gl - multiple versions detected: see console log");le.error("This version of luma.gl has already been initialized")()}le.log(1,`${this.VERSION} - ${zP}`)(),globalThis.luma=this}registerAdapters(e){for(const t of e)this.preregisteredAdapters.set(t.type,t)}getSupportedAdapters(e=[]){const t=this.getAdapterMap(e);return Array.from(t).map(([,r])=>r).filter(r=>{var i;return(i=r.isSupported)==null?void 0:i.call(r)}).map(r=>r.type)}getBestAvailableAdapter(e=[]){var r,i,a,l;const t=this.getAdapterMap(e);return(i=(r=t.get("webgpu"))==null?void 0:r.isSupported)!=null&&i.call(r)?"webgpu":(l=(a=t.get("webgl"))==null?void 0:a.isSupported)!=null&&l.call(a)?"webgl":null}setDefaultDeviceProps(e){Object.assign(ci.defaultProps,e)}async createDevice(e={}){var c;e={...ci.defaultProps,...e},e.waitForPageLoad&&await ci.pageLoaded;const t=this.getAdapterMap(e.adapters);let r=e.type||"";r==="best-available"&&(r=this.getBestAvailableAdapter(e.adapters)||r);const a=(this.getAdapterMap(e.adapters)||t).get(r),l=await((c=a==null?void 0:a.create)==null?void 0:c.call(a,e));if(l)return l;throw new Error(Y1)}async attachDevice(e){var l;const t=this.getAdapterMap(e.adapters);let r="";e.handle instanceof WebGL2RenderingContext&&(r="webgl"),e.createCanvasContext&&await ci.pageLoaded,e.handle===null&&(r="unknown");const i=t.get(r),a=await((l=i==null?void 0:i.attach)==null?void 0:l.call(i,null));if(a)return a;throw new Error(Y1)}enforceWebGL2(e=!0,t=[]){var a;const i=this.getAdapterMap(t).get("webgl");i||le.warn("enforceWebGL2: webgl adapter not found")(),(a=i==null?void 0:i.enforceWebGL2)==null||a.call(i,e)}getAdapterMap(e=[]){const t=new Map(this.preregisteredAdapters);for(const r of e)t.set(r.type,r);return t}registerDevices(e){le.warn("luma.registerDevices() is deprecated, use luma.registerAdapters() instead");for(const t of e){const r=t.adapter;r&&this.preregisteredAdapters.set(r.type,r)}}};w(ci,"defaultProps",{...pi.defaultProps,type:"best-available",adapters:void 0,waitForPageLoad:!0}),w(ci,"pageLoaded",VP().then(()=>{le.probe(2,"DOM is loaded")()}));let Bg=ci;const Fg=new Bg;function VP(){return LP()||typeof window>"u"?Promise.resolve():new Promise(n=>{window.addEventListener("load",()=>n())})}class HP{}const vf=class vf{constructor(e){w(this,"id");w(this,"props");w(this,"canvas");w(this,"htmlCanvas");w(this,"offscreenCanvas");w(this,"type");w(this,"width",1);w(this,"height",1);w(this,"resizeObserver");w(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});if(this.props={...vf.defaultProps,...e},e=this.props,!as()){this.id="node-canvas-context",this.type="node",this.width=this.props.width,this.height=this.props.height,this.canvas=null;return}if(e.canvas)typeof e.canvas=="string"?this.canvas=$P(e.canvas):this.canvas=e.canvas;else{const t=WP(e),r=jP((e==null?void 0:e.container)||null);r.insertBefore(t,r.firstChild),this.canvas=t,e!=null&&e.visible||(this.canvas.style.visibility="hidden")}this.canvas instanceof HTMLCanvasElement?(this.id=this.canvas.id,this.type="html-canvas",this.htmlCanvas=this.canvas):(this.id="offscreen-canvas",this.type="offscreen-canvas",this.offscreenCanvas=this.canvas),this.canvas instanceof HTMLCanvasElement&&e.autoResize&&(this.resizeObserver=new ResizeObserver(t=>{for(const r of t)r.target===this.canvas&&this.update()}),this.resizeObserver.observe(this.canvas))}toString(){return`${this[Symbol.toStringTag]}(${this.id})`}getDevicePixelRatio(e){return typeof OffscreenCanvas<"u"&&this.canvas instanceof OffscreenCanvas||(e=e===void 0?this.props.useDevicePixels:e,!e||e<=0)?1:e===!0?typeof window<"u"&&window.devicePixelRatio||1:e}getPixelSize(){switch(this.type){case"node":return[this.width,this.height];case"offscreen-canvas":return[this.canvas.width,this.canvas.height];case"html-canvas":const e=this.getDevicePixelRatio(),t=this.canvas;return t.parentElement?[t.clientWidth*e,t.clientHeight*e]:[this.canvas.width,this.canvas.height];default:throw new Error(this.type)}}getAspect(){const[e,t]=this.getPixelSize();return e/t}cssToDeviceRatio(){var e;try{const[t]=this.getDrawingBufferSize(),r=this._canvasSizeInfo.clientWidth||((e=this.htmlCanvas)==null?void 0:e.clientWidth);return r?t/r:1}catch{return 1}}cssToDevicePixels(e,t=!0){const r=this.cssToDeviceRatio(),[i,a]=this.getDrawingBufferSize();return XP(e,r,i,a,t)}setDevicePixelRatio(e,t={}){if(!this.htmlCanvas)return;let r="width"in t?t.width:this.htmlCanvas.clientWidth,i="height"in t?t.height:this.htmlCanvas.clientHeight;(!r||!i)&&(le.log(1,"Canvas clientWidth/clientHeight is 0")(),e=1,r=this.htmlCanvas.width||1,i=this.htmlCanvas.height||1);const a=this._canvasSizeInfo;if(a.clientWidth!==r||a.clientHeight!==i||a.devicePixelRatio!==e){let l=e;const c=Math.floor(r*l),f=Math.floor(i*l);if(this.htmlCanvas.width=c,this.htmlCanvas.height=f,this.device.gl){const[p,_]=this.getDrawingBufferSize();(p!==c||_!==f)&&(l=Math.min(p/r,_/i),this.htmlCanvas.width=Math.floor(r*l),this.htmlCanvas.height=Math.floor(i*l),le.warn("Device pixel ratio clamped")()),this._canvasSizeInfo.clientWidth=r,this._canvasSizeInfo.clientHeight=i,this._canvasSizeInfo.devicePixelRatio=e}}}getDrawingBufferSize(){const e=this.device.gl;return e?[e.drawingBufferWidth,e.drawingBufferHeight]:this.getPixelSize()}_setAutoCreatedCanvasId(e){var t;((t=this.htmlCanvas)==null?void 0:t.id)==="lumagl-auto-created-canvas"&&(this.htmlCanvas.id=e)}};w(vf,"defaultProps",{canvas:null,width:800,height:600,useDevicePixels:!0,autoResize:!0,container:null,visible:!0,alphaMode:"opaque",colorSpace:"srgb"});let Lg=vf;function jP(n){if(typeof n=="string"){const e=document.getElementById(n);if(!e)throw new Error(`${n} is not an HTML element`);return e}else if(n)return n;return document.body}function $P(n){const e=document.getElementById(n);if(!(e instanceof HTMLCanvasElement))throw new Error("Object is not a canvas element");return e}function WP(n){const{width:e,height:t}=n,r=document.createElement("canvas");return r.id=zf("lumagl-auto-created-canvas"),r.width=e||1,r.height=t||1,r.style.width=Number.isFinite(e)?`${e}px`:"100%",r.style.height=Number.isFinite(t)?`${t}px`:"100%",r}function XP(n,e,t,r,i){const a=n,l=q1(a[0],e,t);let c=K1(a[1],e,r,i),f=q1(a[0]+1,e,t);const d=f===t-1?f:f-1;f=K1(a[1]+1,e,r,i);let p;return i?(f=f===0?f:f+1,p=c,c=f):p=f===r-1?f:f-1,{x:l,y:c,width:Math.max(d-l+1,1),height:Math.max(p-c+1,1)}}function q1(n,e,t){return Math.min(Math.round(n*e),t-1)}function K1(n,e,t,r){return r?Math.max(0,t-1-Math.round(n*e)):Math.min(Math.round(n*e),t-1)}const Dt=class Dt extends Ze{constructor(t,r){r=Dt.normalizeProps(t,r);super(t,r,Dt.defaultProps);w(this,"dimension");w(this,"format");w(this,"width");w(this,"height");w(this,"depth");w(this,"mipLevels");w(this,"updateTimestamp");if(this.dimension=this.props.dimension,this.format=this.props.format,this.width=this.props.width,this.height=this.props.height,this.depth=this.props.depth,this.props.width===void 0||this.props.height===void 0){const i=Dt.getTextureDataSize(this.props.data);this.width=(i==null?void 0:i.width)||1,this.height=(i==null?void 0:i.height)||1}this.props.mipmaps&&this.props.mipLevels===void 0&&(this.props.mipLevels="pyramid"),this.mipLevels=this.props.mipLevels==="pyramid"?Dt.getMipLevelCount(this.width,this.height):this.props.mipLevels||1,this.updateTimestamp=t.incrementTimestamp()}get[Symbol.toStringTag](){return"Texture"}toString(){return`Texture(${this.id},${this.format},${this.width}x${this.height})`}clone(t){return this.device.createTexture({...this.props,...t})}static isExternalImage(t){return typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement||typeof VideoFrame<"u"&&t instanceof VideoFrame||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas}static getExternalImageSize(t){if(typeof ImageData<"u"&&t instanceof ImageData||typeof ImageBitmap<"u"&&t instanceof ImageBitmap||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas)return{width:t.width,height:t.height};if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement)return{width:t.naturalWidth,height:t.naturalHeight};if(typeof HTMLVideoElement<"u"&&t instanceof HTMLVideoElement)return{width:t.videoWidth,height:t.videoHeight};if(typeof VideoFrame<"u"&&t instanceof VideoFrame)return{width:t.displayWidth,height:t.displayHeight};throw new Error("Unknown image type")}static isTextureLevelData(t){const r=t==null?void 0:t.data;return ArrayBuffer.isView(r)}static getTextureDataSize(t){if(!t||ArrayBuffer.isView(t))return null;if(Array.isArray(t))return Dt.getTextureDataSize(t[0]);if(Dt.isExternalImage(t))return Dt.getExternalImageSize(t);if(t&&typeof t=="object"&&t.constructor===Object){const i=Object.values(t)[0];return{width:i.width,height:i.height}}throw new Error("texture size deduction failed")}static normalizeTextureData(t,r){let i;return ArrayBuffer.isView(t)?i=[{data:t,width:r.width,height:r.height}]:Array.isArray(t)?i=t:i=[t],i}static getMipLevelCount(t,r){return Math.floor(Math.log2(Math.max(t,r)))+1}static getCubeFaceDepth(t){switch(t){case"+X":return 0;case"-X":return 1;case"+Y":return 2;case"-Y":return 3;case"+Z":return 4;case"-Z":return 5;default:throw new Error(t)}}static normalizeProps(t,r){var f,d;const i={...r},a=((d=(f=t==null?void 0:t.props)==null?void 0:f._resourceDefaults)==null?void 0:d.texture)||{};Object.assign(i,a);const{width:l,height:c}=i;return typeof l=="number"&&(i.width=Math.max(1,Math.ceil(l))),typeof c=="number"&&(i.height=Math.max(1,Math.ceil(c))),i}};w(Dt,"COPY_SRC",1),w(Dt,"COPY_DST",2),w(Dt,"TEXTURE",4),w(Dt,"STORAGE",8),w(Dt,"RENDER_ATTACHMENT",16),w(Dt,"CubeFaces",["+X","-X","+Y","-Y","+Z","-Z"]),w(Dt,"defaultProps",{...Ze.defaultProps,data:null,dimension:"2d",format:"rgba8unorm",width:void 0,height:void 0,depth:1,mipmaps:!1,compressed:!1,usage:0,mipLevels:void 0,samples:void 0,sampler:{},view:void 0,flipY:void 0}),w(Dt,"defaultCopyExternalImageOptions",{image:void 0,sourceX:0,sourceY:0,width:void 0,height:void 0,depth:1,mipLevel:0,x:0,y:0,z:0,aspect:"all",colorSpace:"srgb",premultipliedAlpha:!1,flipY:!1});let ct=Dt;const Tf=class Tf extends Ze{get[Symbol.toStringTag](){return"TextureView"}constructor(e,t){super(e,t,Tf.defaultProps)}};w(Tf,"defaultProps",{...Ze.defaultProps,format:void 0,dimension:void 0,aspect:"all",baseMipLevel:0,mipLevelCount:void 0,baseArrayLayer:0,arrayLayerCount:void 0});let Ju=Tf;function YP(n,e,t){let r="";const i=e.split(/\r?\n/),a=n.slice().sort((l,c)=>l.lineNum-c.lineNum);switch((t==null?void 0:t.showSourceCode)||"no"){case"all":let l=0;for(let c=1;c<=i.length;c++)for(r+=bw(i[c-1],c,t);a.length>l&&a[l].lineNum===c;){const f=a[l++];r+=Z1(f,i,f.lineNum,{...t,inlineSource:!1})}return r;case"issues":case"no":for(const c of n)r+=Z1(c,i,c.lineNum,{inlineSource:(t==null?void 0:t.showSourceCode)!=="no"});return r}}function Z1(n,e,t,r){if(r!=null&&r.inlineSource){const a=qP(e,t),l=n.linePos>0?`${" ".repeat(n.linePos+5)}^^^
`:"";return`
${a}${l}${n.type.toUpperCase()}: ${n.message}

`}const i=n.type==="error"?"red":"#8B4000";return r!=null&&r.html?`<div class='luma-compiler-log-error' style="color:${i};"><b> ${n.type.toUpperCase()}: ${n.message}</b></div>`:`${n.type.toUpperCase()}: ${n.message}`}function qP(n,e,t){let r="";for(let i=e-2;i<=e;i++){const a=n[i-1];a!==void 0&&(r+=bw(a,e,t))}return r}function bw(n,e,t){const r=t!=null&&t.html?ZP(n):n;return`${KP(String(e),4)}: ${r}${t!=null&&t.html?"<br/>":`
`}`}function KP(n,e){let t="";for(let r=n.length;r<e;++r)t+=" ";return t+n}function ZP(n){return n.replaceAll("&","&amp;").replaceAll("<","&lt;").replaceAll(">","&gt;").replaceAll('"',"&quot;").replaceAll("'","&#039;")}const wf=class wf extends Ze{constructor(t,r){r={...r,debugShaders:r.debugShaders||t.props.debugShaders||"errors"};super(t,{id:QP(r),...r},wf.defaultProps);w(this,"stage");w(this,"source");w(this,"compilationStatus","pending");this.stage=this.props.stage,this.source=this.props.source}get[Symbol.toStringTag](){return"Shader"}getCompilationInfoSync(){return null}getTranslatedSource(){return null}async debugShader(){const t=this.props.debugShaders;switch(t){case"never":return;case"errors":if(this.compilationStatus==="success")return;break}const r=await this.getCompilationInfo();t==="warnings"&&(r==null?void 0:r.length)===0||this._displayShaderLog(r)}_displayShaderLog(t){var d;if(typeof document>"u"||!(document!=null&&document.createElement))return;const r=vw(this.source),i=`${this.stage} ${r}`;let a=YP(t,this.source,{showSourceCode:"all",html:!0});const l=this.getTranslatedSource();l&&(a+=`<br /><br /><h1>Translated Source</h1><br /><br /><code style="user-select:text;"><pre>${l}</pre></code>`);const c=document.createElement("Button");c.innerHTML=`
<h1>Shader Compilation Error in ${i}</h1><br /><br />
<code style="user-select:text;"><pre>
${a}
</pre></code>`,c.style.top="10px",c.style.left="10px",c.style.position="absolute",c.style.zIndex="9999",c.style.width="100%",c.style.textAlign="left",document.body.appendChild(c),(d=document.getElementsByClassName("luma-compiler-log-error")[0])==null||d.scrollIntoView(),c.onclick=()=>{const p=`data:text/plain,${encodeURIComponent(this.source)}`;navigator.clipboard.writeText(p)}}};w(wf,"defaultProps",{...Ze.defaultProps,language:"auto",stage:void 0,source:"",sourceMap:null,entryPoint:"main",debugShaders:void 0});let ef=wf;function QP(n){return vw(n.source)||n.id||zf(`unnamed ${n.stage}-shader`)}function vw(n,e="unnamed"){const r=/#define[\s*]SHADER_NAME[\s*]([A-Za-z0-9_-]+)[\s*]/.exec(n);return r?r[1]:e}const hl=class hl extends Ze{get[Symbol.toStringTag](){return"Sampler"}constructor(e,t){t=hl.normalizeProps(e,t),super(e,t,hl.defaultProps)}static normalizeProps(e,t){var a,l;const r=((l=(a=e==null?void 0:e.props)==null?void 0:a._resourceDefaults)==null?void 0:l.sampler)||{};return{...t,...r}}};w(hl,"defaultProps",{...Ze.defaultProps,type:"color-sampler",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge",addressModeW:"clamp-to-edge",magFilter:"nearest",minFilter:"nearest",mipmapFilter:"none",lodMinClamp:0,lodMaxClamp:32,compare:"less-equal",maxAnisotropy:1});let tf=hl;const xf=class xf extends Ze{constructor(t,r={}){super(t,r,xf.defaultProps);w(this,"width");w(this,"height");this.width=this.props.width,this.height=this.props.height}get[Symbol.toStringTag](){return"Framebuffer"}clone(t){const r=this.colorAttachments.map(a=>a.texture.clone(t)),i=this.depthStencilAttachment&&this.depthStencilAttachment.texture.clone(t);return this.device.createFramebuffer({...this.props,colorAttachments:r,depthStencilAttachment:i})}resize(t){let r=!t;if(t){const[i,a]=Array.isArray(t)?t:[t.width,t.height];r=r||a!==this.height||i!==this.width,this.width=i,this.height=a}r&&(le.log(2,`Resizing framebuffer ${this.id} to ${this.width}x${this.height}`)(),this.resizeAttachments(this.width,this.height))}autoCreateAttachmentTextures(){if(this.props.colorAttachments.length===0&&!this.props.depthStencilAttachment)throw new Error("Framebuffer has noattachments");this.colorAttachments=this.props.colorAttachments.map((r,i)=>{if(typeof r=="string"){const a=this.createColorTexture(r,i);return this.attachResource(a),a.view}return r instanceof ct?r.view:r});const t=this.props.depthStencilAttachment;if(t)if(typeof t=="string"){const r=this.createDepthStencilTexture(t);this.attachResource(r),this.depthStencilAttachment=r.view}else t instanceof ct?this.depthStencilAttachment=t.view:this.depthStencilAttachment=t}createColorTexture(t,r){return this.device.createTexture({id:`${this.id}-color-attachment-${r}`,usage:ct.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height,sampler:{magFilter:"linear",minFilter:"linear"}})}createDepthStencilTexture(t){return this.device.createTexture({id:`${this.id}-depth-stencil-attachment`,usage:ct.RENDER_ATTACHMENT,format:t,width:this.width,height:this.height,mipmaps:!1})}resizeAttachments(t,r){for(let i=0;i<this.colorAttachments.length;++i)if(this.colorAttachments[i]){const a=this.colorAttachments[i].texture.clone({width:t,height:r});this.destroyAttachedResource(this.colorAttachments[i]),this.colorAttachments[i]=a.view,this.attachResource(a.view)}if(this.depthStencilAttachment){const i=this.depthStencilAttachment.texture.clone({width:t,height:r});this.destroyAttachedResource(this.depthStencilAttachment),this.depthStencilAttachment=i.view,this.attachResource(i)}this.updateAttachments()}};w(xf,"defaultProps",{...Ze.defaultProps,width:1,height:1,colorAttachments:[],depthStencilAttachment:null});let nf=xf;const Sf=class Sf extends Ze{constructor(t,r){super(t,r,Sf.defaultProps);w(this,"shaderLayout");w(this,"bufferLayout");w(this,"linkStatus","pending");w(this,"hash","");this.shaderLayout=this.props.shaderLayout,this.bufferLayout=this.props.bufferLayout||[]}get[Symbol.toStringTag](){return"RenderPipeline"}setUniformsWebGL(t){throw new Error("Use uniform blocks")}};w(Sf,"defaultProps",{...Ze.defaultProps,vs:null,vertexEntryPoint:"vertexMain",vsConstants:{},fs:null,fragmentEntryPoint:"fragmentMain",fsConstants:{},shaderLayout:null,bufferLayout:[],topology:"triangle-list",parameters:{},bindings:{},uniforms:{}});let Aa=Sf;const Un=class Un extends Ze{get[Symbol.toStringTag](){return"RenderPass"}constructor(e,t){t=Un.normalizeProps(e,t),super(e,t,Un.defaultProps)}static normalizeProps(e,t){var a;return{...(a=e.props._resourceDefaults)==null?void 0:a.renderPass,...t}}};w(Un,"defaultClearColor",[0,0,0,1]),w(Un,"defaultClearDepth",1),w(Un,"defaultClearStencil",0),w(Un,"defaultProps",{...Ze.defaultProps,framebuffer:null,parameters:void 0,clearColor:Un.defaultClearColor,clearColors:void 0,clearDepth:Un.defaultClearDepth,clearStencil:Un.defaultClearStencil,depthReadOnly:!1,stencilReadOnly:!1,discard:!1,occlusionQuerySet:void 0,timestampQuerySet:void 0,beginTimestampIndex:void 0,endTimestampIndex:void 0});let zg=Un;const Af=class Af extends Ze{constructor(t,r){super(t,r,Af.defaultProps);w(this,"hash","");w(this,"shaderLayout");this.shaderLayout=r.shaderLayout}get[Symbol.toStringTag](){return"ComputePipeline"}};w(Af,"defaultProps",{...Ze.defaultProps,shader:void 0,entryPoint:void 0,constants:{},shaderLayout:void 0});let rf=Af;const Ef=class Ef extends Ze{get[Symbol.toStringTag](){return"CommandEncoder"}constructor(e,t){super(e,t,Ef.defaultProps)}};w(Ef,"defaultProps",{...Ze.defaultProps,measureExecutionTime:void 0});let Vg=Ef;const Rf=class Rf extends Ze{get[Symbol.toStringTag](){return"CommandBuffer"}constructor(e,t){super(e,t,Rf.defaultProps)}};w(Rf,"defaultProps",{...Ze.defaultProps});let Hg=Rf;function GP(n){const[e,t]=e6[n],r=e==="i32"||e==="u32",i=e!=="u32",a=t6[e]*t,l=JP(e,t);return{dataType:e,components:t,defaultVertexFormat:l,byteLength:a,integer:r,signed:i}}function JP(n,e){let t;switch(n){case"f32":t="float32";break;case"i32":t="sint32";break;case"u32":t="uint32";break;case"f16":return e<=2?"float16x2":"float16x4"}return e===1?t:`${t}x${e}`}const e6={f32:["f32",1],"vec2<f32>":["f32",2],"vec3<f32>":["f32",3],"vec4<f32>":["f32",4],f16:["f16",1],"vec2<f16>":["f16",2],"vec3<f16>":["f16",3],"vec4<f16>":["f16",4],i32:["i32",1],"vec2<i32>":["i32",2],"vec3<i32>":["i32",3],"vec4<i32>":["i32",4],u32:["u32",1],"vec2<u32>":["u32",2],"vec3<u32>":["u32",3],"vec4<u32>":["u32",4]},t6={f32:4,f16:2,i32:4,u32:4};function Tw(n){let e;n.endsWith("-webgl")&&(n.replace("-webgl",""),e=!0);const[t,r]=n.split("x"),i=t,a=r?parseInt(r):1,l=_w(i),c={type:i,components:a,byteLength:l.byteLength*a,integer:l.integer,signed:l.signed,normalized:l.normalized};return e&&(c.webglOnly=!0),c}function ww(n,e){const t={};for(const r of n.attributes){const i=r6(n,e,r.name);i&&(t[r.name]=i)}return t}function n6(n,e,t=16){const r=ww(n,e),i=new Array(t).fill(null);for(const a of Object.values(r))i[a.location]=a;return i}function r6(n,e,t){const r=i6(n,t),i=s6(e,t);if(!r)return null;const a=GP(r.type),l=(i==null?void 0:i.vertexFormat)||a.defaultVertexFormat,c=Tw(l);return{attributeName:(i==null?void 0:i.attributeName)||r.name,bufferName:(i==null?void 0:i.bufferName)||r.name,location:r.location,shaderType:r.type,shaderDataType:a.dataType,shaderComponents:a.components,vertexFormat:l,bufferDataType:c.type,bufferComponents:c.components,normalized:c.normalized,integer:a.integer,stepMode:(i==null?void 0:i.stepMode)||r.stepMode||"vertex",byteOffset:(i==null?void 0:i.byteOffset)||0,byteStride:(i==null?void 0:i.byteStride)||0}}function i6(n,e){const t=n.attributes.find(r=>r.name===e);return t||le.warn(`shader layout attribute "${e}" not present in shader`),t||null}function s6(n,e){a6(n);let t=o6(n,e);return t||(t=l6(n,e),t)?t:(le.warn(`layout for attribute "${e}" not present in buffer layout`),null)}function a6(n){for(const e of n)(e.attributes&&e.format||!e.attributes&&!e.format)&&le.warn(`BufferLayout ${name} must have either 'attributes' or 'format' field`)}function o6(n,e){for(const t of n)if(t.format&&t.name===e)return{attributeName:t.name,bufferName:e,stepMode:t.stepMode,vertexFormat:t.format,byteOffset:0,byteStride:t.byteStride||0};return null}function l6(n,e){var t;for(const r of n){let i=r.byteStride;if(typeof r.byteStride!="number")for(const l of r.attributes||[]){const c=Tw(l.format);i+=c.byteLength}const a=(t=r.attributes)==null?void 0:t.find(l=>l.attribute===e);if(a)return{attributeName:a.attribute,bufferName:r.name,stepMode:r.stepMode,vertexFormat:a.format,byteOffset:a.byteOffset,byteStride:i}}return null}const Cf=class Cf extends Ze{constructor(t,r){super(t,r,Cf.defaultProps);w(this,"maxVertexAttributes");w(this,"attributeInfos");w(this,"indexBuffer",null);w(this,"attributes");this.maxVertexAttributes=t.limits.maxVertexAttributes,this.attributes=new Array(this.maxVertexAttributes).fill(null);const{shaderLayout:i,bufferLayout:a}=r.renderPipeline||{};if(!i||!a)throw new Error("VertexArray");this.attributeInfos=n6(i,a,this.maxVertexAttributes)}get[Symbol.toStringTag](){return"VertexArray"}setConstantWebGL(t,r){this.device.reportError(new Error("constant attributes not supported"))}};w(Cf,"defaultProps",{...Ze.defaultProps,renderPipeline:null});let jg=Cf;const Mf=class Mf extends Ze{get[Symbol.toStringTag](){return"TransformFeedback"}constructor(e,t){super(e,t,Mf.defaultProps)}};w(Mf,"defaultProps",{...Ze.defaultProps,layout:void 0,buffers:{}});let $g=Mf;const Of=class Of extends Ze{get[Symbol.toStringTag](){return"QuerySet"}constructor(e,t){super(e,t,Of.defaultProps)}};w(Of,"defaultProps",{...Ze.defaultProps,type:void 0,count:void 0});let Wg=Of;const c6={f32:{type:"f32",components:1},i32:{type:"i32",components:1},u32:{type:"u32",components:1},"vec2<f32>":{type:"f32",components:2},"vec3<f32>":{type:"f32",components:3},"vec4<f32>":{type:"f32",components:4},"vec2<i32>":{type:"i32",components:2},"vec3<i32>":{type:"i32",components:3},"vec4<i32>":{type:"i32",components:4},"vec2<u32>":{type:"u32",components:2},"vec3<u32>":{type:"u32",components:3},"vec4<u32>":{type:"u32",components:4},"mat2x2<f32>":{type:"f32",components:4},"mat2x3<f32>":{type:"f32",components:6},"mat2x4<f32>":{type:"f32",components:8},"mat3x2<f32>":{type:"f32",components:6},"mat3x3<f32>":{type:"f32",components:9},"mat3x4<f32>":{type:"f32",components:12},"mat4x2<f32>":{type:"f32",components:8},"mat4x3<f32>":{type:"f32",components:12},"mat4x4<f32>":{type:"f32",components:16}};function u6(n){return c6[n]}function f6(n,e){switch(e){case 1:return n;case 2:return n+n%2;default:return n+(4-n%4)%4}}let ou;function xw(n){return(!ou||ou.byteLength<n)&&(ou=new ArrayBuffer(n)),ou}function h6(n,e){const t=xw(n.BYTES_PER_ELEMENT*e);return new n(t,0,e)}function d6(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function sf(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":d6(n)}const Q1=1024;class p6{constructor(e){w(this,"layout",{});w(this,"byteLength");let t=0;for(const[i,a]of Object.entries(e)){const l=u6(a),{type:c,components:f}=l;t=f6(t,f);const d=t;t+=f,this.layout[i]={type:c,size:f,offset:d}}t+=(4-t%4)%4;const r=t*4;this.byteLength=Math.max(r,Q1)}getData(e){const t=Math.max(this.byteLength,Q1),r=xw(t),i={i32:new Int32Array(r),u32:new Uint32Array(r),f32:new Float32Array(r),f16:new Uint16Array(r)};for(const[a,l]of Object.entries(e)){const c=this.layout[a];if(!c){le.warn(`Supplied uniform value ${a} not present in uniform block layout`)();continue}const{type:f,size:d,offset:p}=c,_=i[f];if(d===1){if(typeof l!="number"&&typeof l!="boolean"){le.warn(`Supplied value for single component uniform ${a} is not a number: ${l}`)();continue}_[p]=Number(l)}else{if(!sf(l)){le.warn(`Supplied value for multi component / array uniform ${a} is not a numeric array: ${l}`)();continue}_.set(l,p)}}return new Uint8Array(r)}has(e){return!!this.layout[e]}get(e){return this.layout[e]}}function g6(n,e,t=16){if(n!==e)return!1;const r=n,i=e;if(!sf(r))return!1;if(sf(i)&&r.length===i.length){for(let a=0;a<r.length;++a)if(i[a]!==r[a])return!1}return!0}function _6(n){return sf(n)?n.slice():n}class m6{constructor(e){w(this,"name");w(this,"uniforms",{});w(this,"modifiedUniforms",{});w(this,"modified",!0);w(this,"bindingLayout",{});w(this,"needsRedraw","initialized");var t;if(this.name=(e==null?void 0:e.name)||"unnamed",e!=null&&e.name&&(e!=null&&e.shaderLayout)){const r=(t=e==null?void 0:e.shaderLayout.bindings)==null?void 0:t.find(a=>a.type==="uniform"&&a.name===(e==null?void 0:e.name));if(!r)throw new Error(e==null?void 0:e.name);const i=r;for(const a of i.uniforms||[])this.bindingLayout[a.name]=a}}setUniforms(e){for(const[t,r]of Object.entries(e))this._setUniform(t,r),this.needsRedraw||this.setNeedsRedraw(`${this.name}.${t}=${r}`)}setNeedsRedraw(e){this.needsRedraw=this.needsRedraw||e}getAllUniforms(){return this.modifiedUniforms={},this.needsRedraw=!1,this.uniforms||{}}_setUniform(e,t){g6(this.uniforms[e],t)||(this.uniforms[e]=_6(t),this.modifiedUniforms[e]=!0,this.modified=!0)}}class y6{constructor(e){w(this,"uniformBlocks",new Map);w(this,"uniformBufferLayouts",new Map);w(this,"uniformBuffers",new Map);for(const[t,r]of Object.entries(e)){const i=t,a=new p6(r.uniformTypes||{});this.uniformBufferLayouts.set(i,a);const l=new m6({name:t});l.setUniforms(r.defaultUniforms||{}),this.uniformBlocks.set(i,l)}}destroy(){for(const e of this.uniformBuffers.values())e.destroy()}setUniforms(e){var t;for(const[r,i]of Object.entries(e))(t=this.uniformBlocks.get(r))==null||t.setUniforms(i);this.updateUniformBuffers()}getUniformBufferByteLength(e){var t;return((t=this.uniformBufferLayouts.get(e))==null?void 0:t.byteLength)||0}getUniformBufferData(e){var r,i;const t=((r=this.uniformBlocks.get(e))==null?void 0:r.getAllUniforms())||{};return(i=this.uniformBufferLayouts.get(e))==null?void 0:i.getData(t)}createUniformBuffer(e,t,r){r&&this.setUniforms(r);const i=this.getUniformBufferByteLength(t),a=e.createBuffer({usage:rt.UNIFORM|rt.COPY_DST,byteLength:i}),l=this.getUniformBufferData(t);return a.write(l),a}getManagedUniformBuffer(e,t){if(!this.uniformBuffers.get(t)){const r=this.getUniformBufferByteLength(t),i=e.createBuffer({usage:rt.UNIFORM|rt.COPY_DST,byteLength:r});this.uniformBuffers.set(t,i)}return this.uniformBuffers.get(t)}updateUniformBuffers(){let e=!1;for(const t of this.uniformBlocks.keys()){const r=this.updateUniformBuffer(t);e||(e=r)}return e&&le.log(3,`UniformStore.updateUniformBuffers(): ${e}`)(),e}updateUniformBuffer(e){var a;const t=this.uniformBlocks.get(e);let r=this.uniformBuffers.get(e),i=!1;if(r&&(t!=null&&t.needsRedraw)){i||(i=t.needsRedraw);const l=this.getUniformBufferData(e);r=this.uniformBuffers.get(e),r==null||r.write(l);const c=(a=this.uniformBlocks.get(e))==null?void 0:a.getAllUniforms();le.log(4,`Writing to uniform buffer ${String(e)}`,l,c)()}return i}}function Sw(n){const e=ArrayBuffer.isView(n)?n.constructor:n;switch(e){case Float32Array:return"float32";case Uint16Array:return"uint16";case Uint32Array:return"uint32";case Uint8Array:case Uint8ClampedArray:return"uint8";case Int8Array:return"sint8";case Int16Array:return"sint16";case Int32Array:return"sint32";default:throw new Error(e.constructor.name)}}function Aw(n){switch(n){case"float32":return Float32Array;case"uint32":return Uint32Array;case"sint32":return Int32Array;case"uint16":case"unorm16":return Uint16Array;case"sint16":case"snorm16":return Int16Array;case"uint8":case"unorm8":return Uint8Array;case"sint8":case"snorm8":return Int8Array;default:throw new Error(n)}}function b6(n,e,t){if(!e||e>4)throw new Error(`size ${e}`);const r=e;let i=Sw(n);if(i==="uint8"&&t&&r===1)return"unorm8-webgl";if(i==="uint8"&&t&&r===3)return"unorm8x3-webgl";if(i==="uint8"||i==="sint8"){if(r===1||r===3)throw new Error(`size: ${e}`);return t&&(i=i.replace("int","norm")),`${i}x${r}`}if(i==="uint16"||i==="sint16"){if(r===1||r===3)throw new Error(`size: ${e}`);return t&&(i=i.replace("int","norm")),`${i}x${r}`}return r===1?i:`${i}x${r}`}class Bp{constructor(e){w(this,"bufferLayouts");this.bufferLayouts=e}getBufferLayout(e){return this.bufferLayouts.find(t=>t.name===e)||null}getAttributeNamesForBuffer(e){var t;return e.attributes?(t=e.attributes)==null?void 0:t.map(r=>r.attribute):[e.name]}mergeBufferLayouts(e,t){const r=[...e];for(const i of t){const a=r.findIndex(l=>l.name===i.name);a<0?r.push(i):r[a]=i}return r}getBufferIndex(e){const t=this.bufferLayouts.findIndex(r=>r.name===e);return t===-1&&le.warn(`BufferLayout: Missing buffer for "${e}".`)(),t}}function v6(n,e){const t=Object.fromEntries(n.attributes.map(i=>[i.name,i.location])),r=e.slice();return r.sort((i,a)=>{const l=i.attributes?i.attributes.map(p=>p.attribute):[i.name],c=a.attributes?a.attributes.map(p=>p.attribute):[a.name],f=Math.min(...l.map(p=>t[p])),d=Math.min(...c.map(p=>t[p]));return f-d}),r}class En{constructor(e,t){this.name=e,this.attributes=t,this.size=0}get isArray(){return!1}get isStruct(){return!1}get isTemplate(){return!1}getTypeName(){return this.name}}class G1{constructor(e,t,r){this.name=e,this.type=t,this.attributes=r,this.offset=0,this.size=0}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class fi extends En{constructor(e,t){super(e,t),this.members=[],this.align=0,this.startLine=-1,this.endLine=-1,this.inUse=!1}get isStruct(){return!0}}class gi extends En{constructor(e,t){super(e,t),this.count=0,this.stride=0}get isArray(){return!0}}class es extends En{constructor(e,t,r,i){super(e,r),this.format=t,this.access=i}get isTemplate(){return!0}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}var oi;(n=>{n[n.Uniform=0]="Uniform",n[n.Storage=1]="Storage",n[n.Texture=2]="Texture",n[n.Sampler=3]="Sampler",n[n.StorageTexture=4]="StorageTexture"})(oi||(oi={}));class lu{constructor(e,t,r,i,a,l,c){this.name=e,this.type=t,this.group=r,this.binding=i,this.attributes=a,this.resourceType=l,this.access=c}get isArray(){return this.type.isArray}get isStruct(){return this.type.isStruct}get isTemplate(){return this.type.isTemplate}get size(){return this.type.size}get align(){return this.type.isStruct?this.type.align:0}get members(){return this.type.isStruct?this.type.members:null}get format(){return this.type.isArray||this.type.isTemplate?this.type.format:null}get count(){return this.type.isArray?this.type.count:0}get stride(){return this.type.isArray?this.type.stride:this.size}}class T6{constructor(e,t){this.name=e,this.type=t}}class w6{constructor(e,t,r,i){this.name=e,this.type=t,this.locationType=r,this.location=i,this.interpolation=null}}class J1{constructor(e,t,r,i){this.name=e,this.type=t,this.locationType=r,this.location=i}}class x6{constructor(e,t,r,i){this.name=e,this.type=t,this.attributes=r,this.id=i}}class S6{constructor(e,t,r){this.name=e,this.type=t,this.attributes=r}}class A6{constructor(e,t=null,r){this.stage=null,this.inputs=[],this.outputs=[],this.arguments=[],this.returnType=null,this.resources=[],this.overrides=[],this.startLine=-1,this.endLine=-1,this.inUse=!1,this.calls=new Set,this.name=e,this.stage=t,this.attributes=r}}class E6{constructor(){this.vertex=[],this.fragment=[],this.compute=[]}}const Ew=new Float32Array(1),R6=new Int32Array(Ew.buffer),Lt=new Uint16Array(1);function C6(n){Ew[0]=n;const e=R6[0],t=e>>31&1;let r=e>>23&255,i=8388607&e;if(r===255)return Lt[0]=t<<15|31744|(i!==0?512:0),Lt[0];if(r===0){if(i===0)return Lt[0]=t<<15,Lt[0];i|=8388608;let a=113;for(;!(8388608&i);)i<<=1,a--;return r=127-a,i&=8388607,r>0?(i=(i>>126-r)+(i>>127-r&1),Lt[0]=t<<15|r<<10|i>>13,Lt[0]):(Lt[0]=t<<15,Lt[0])}return r=r-127+15,r>=31?(Lt[0]=t<<15|31744,Lt[0]):r<=0?r<-10?(Lt[0]=t<<15,Lt[0]):(i=(8388608|i)>>1-r,Lt[0]=t<<15|i>>13,Lt[0]):(i>>=13,Lt[0]=t<<15|r<<10|i,Lt[0])}const X_=new Uint32Array(1),Rw=new Float32Array(X_.buffer,0,1);function eT(n){const e=112+(n>>6&31)<<23|(63&n)<<17;return X_[0]=e,Rw[0]}function M6(n,e,t,r,i,a,l,c,f){const d=r*(l>>=i)*(a>>=i)+t*l+e*c;switch(f){case"r8unorm":return[ze(n,d,"8unorm",1)[0]];case"r8snorm":return[ze(n,d,"8snorm",1)[0]];case"r8uint":return[ze(n,d,"8uint",1)[0]];case"r8sint":return[ze(n,d,"8sint",1)[0]];case"rg8unorm":{const p=ze(n,d,"8unorm",2);return[p[0],p[1]]}case"rg8snorm":{const p=ze(n,d,"8snorm",2);return[p[0],p[1]]}case"rg8uint":{const p=ze(n,d,"8uint",2);return[p[0],p[1]]}case"rg8sint":{const p=ze(n,d,"8sint",2);return[p[0],p[1]]}case"rgba8unorm-srgb":case"rgba8unorm":{const p=ze(n,d,"8unorm",4);return[p[0],p[1],p[2],p[3]]}case"rgba8snorm":{const p=ze(n,d,"8snorm",4);return[p[0],p[1],p[2],p[3]]}case"rgba8uint":{const p=ze(n,d,"8uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba8sint":{const p=ze(n,d,"8sint",4);return[p[0],p[1],p[2],p[3]]}case"bgra8unorm-srgb":case"bgra8unorm":{const p=ze(n,d,"8unorm",4);return[p[2],p[1],p[0],p[3]]}case"r16uint":return[ze(n,d,"16uint",1)[0]];case"r16sint":return[ze(n,d,"16sint",1)[0]];case"r16float":return[ze(n,d,"16float",1)[0]];case"rg16uint":{const p=ze(n,d,"16uint",2);return[p[0],p[1]]}case"rg16sint":{const p=ze(n,d,"16sint",2);return[p[0],p[1]]}case"rg16float":{const p=ze(n,d,"16float",2);return[p[0],p[1]]}case"rgba16uint":{const p=ze(n,d,"16uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba16sint":{const p=ze(n,d,"16sint",4);return[p[0],p[1],p[2],p[3]]}case"rgba16float":{const p=ze(n,d,"16float",4);return[p[0],p[1],p[2],p[3]]}case"r32uint":return[ze(n,d,"32uint",1)[0]];case"r32sint":return[ze(n,d,"32sint",1)[0]];case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return[ze(n,d,"32float",1)[0]];case"rg32uint":{const p=ze(n,d,"32uint",2);return[p[0],p[1]]}case"rg32sint":{const p=ze(n,d,"32sint",2);return[p[0],p[1]]}case"rg32float":{const p=ze(n,d,"32float",2);return[p[0],p[1]]}case"rgba32uint":{const p=ze(n,d,"32uint",4);return[p[0],p[1],p[2],p[3]]}case"rgba32sint":{const p=ze(n,d,"32sint",4);return[p[0],p[1],p[2],p[3]]}case"rgba32float":{const p=ze(n,d,"32float",4);return[p[0],p[1],p[2],p[3]]}case"rg11b10ufloat":{const p=new Uint32Array(n.buffer,d,1)[0],_=(4192256&p)>>11,y=(4290772992&p)>>22;return[eT(2047&p),eT(_),function(b){const T=112+(b>>5&31)<<23|(31&b)<<18;return X_[0]=T,Rw[0]}(y),1]}}return null}function ze(n,e,t,r){const i=[0,0,0,0];for(let d=0;d<r;++d)switch(t){case"8unorm":i[d]=n[e]/255,e++;break;case"8snorm":i[d]=n[e]/255*2-1,e++;break;case"8uint":i[d]=n[e],e++;break;case"8sint":i[d]=n[e]-127,e++;break;case"16uint":i[d]=n[e]|n[e+1]<<8,e+=2;break;case"16sint":i[d]=(n[e]|n[e+1]<<8)-32768,e+=2;break;case"16float":i[d]=(a=n[e]|n[e+1]<<8,l=void 0,c=void 0,f=void 0,l=(32768&a)>>15,f=1023&a,(c=(31744&a)>>10)==0?(l?-1:1)*Math.pow(2,-14)*(f/Math.pow(2,10)):c==31?f?NaN:1/0*(l?-1:1):(l?-1:1)*Math.pow(2,c-15)*(1+f/Math.pow(2,10))),e+=2;break;case"32uint":case"32sint":i[d]=n[e]|n[e+1]<<8|n[e+2]<<16|n[e+3]<<24,e+=4;break;case"32float":i[d]=new Float32Array(n.buffer,e,1)[0],e+=4}var a,l,c,f;return i}function je(n,e,t,r,i){for(let a=0;a<r;++a)switch(t){case"8unorm":n[e]=255*i[a],e++;break;case"8snorm":n[e]=.5*(i[a]+1)*255,e++;break;case"8uint":n[e]=i[a],e++;break;case"8sint":n[e]=i[a]+127,e++;break;case"16uint":new Uint16Array(n.buffer,e,1)[0]=i[a],e+=2;break;case"16sint":new Int16Array(n.buffer,e,1)[0]=i[a],e+=2;break;case"16float":{const l=C6(i[a]);new Uint16Array(n.buffer,e,1)[0]=l,e+=2;break}case"32uint":new Uint32Array(n.buffer,e,1)[0]=i[a],e+=4;break;case"32sint":new Int32Array(n.buffer,e,1)[0]=i[a],e+=4;break;case"32float":new Float32Array(n.buffer,e,1)[0]=i[a],e+=4}return i}const Fp={r8unorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8snorm:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8uint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r8sint:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg8unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8snorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg8sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"rgba8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8snorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba8sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},bgra8unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bgra8unorm-srgb":{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r16uint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16sint:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r16float:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg16uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg16float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba16uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba16float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},r32uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32sint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},r32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:1},rg32uint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32sint:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rg32float:{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,channels:2},rgba32uint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32sint:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgba32float:{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2uint:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rgb10a2unorm:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},rg11b10ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},stencil8:{bytesPerBlock:1,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!1,hasStencil:!0,channels:1},depth16unorm:{bytesPerBlock:2,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},depth24plus:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,depthOnlyFormat:"depth32float",channels:1},"depth24plus-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,depthOnlyFormat:"depth32float",channels:1},depth32float:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!1,channels:1},"depth32float-stencil8":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!1,isDepthStencil:!0,hasDepth:!0,hasStencil:!0,stencilOnlyFormat:"depth32float",channels:1},rgb9e5ufloat:{bytesPerBlock:4,blockWidth:1,blockHeight:1,isCompressed:!1,channels:4},"bc1-rgba-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc1-rgba-unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc2-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc3-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc4-r-unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc4-r-snorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:1},"bc5-rg-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc5-rg-snorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:2},"bc6h-rgb-ufloat":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc6h-rgb-float":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"bc7-rgba-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgb8a1unorm-srgb":{bytesPerBlock:8,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"etc2-rgba8unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"eac-r11unorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-r11snorm":{bytesPerBlock:8,blockWidth:1,blockHeight:1,isCompressed:!0,channels:1},"eac-rg11unorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"eac-rg11snorm":{bytesPerBlock:16,blockWidth:1,blockHeight:1,isCompressed:!0,channels:2},"astc-4x4-unorm":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-4x4-unorm-srgb":{bytesPerBlock:16,blockWidth:4,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x4-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:4,isCompressed:!0,channels:4},"astc-5x5-unorm":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-5x5-unorm-srgb":{bytesPerBlock:16,blockWidth:5,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x5-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:5,isCompressed:!0,channels:4},"astc-6x6-unorm":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-6x6-unorm-srgb":{bytesPerBlock:16,blockWidth:6,blockHeight:6,isCompressed:!0,channels:4},"astc-8x5-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x5-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:5,isCompressed:!0,channels:4},"astc-8x6-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x6-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:6,isCompressed:!0,channels:4},"astc-8x8-unorm":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-8x8-unorm-srgb":{bytesPerBlock:16,blockWidth:8,blockHeight:8,isCompressed:!0,channels:4},"astc-10x5-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x5-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:5,isCompressed:!0,channels:4},"astc-10x6-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x6-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:6,isCompressed:!0,channels:4},"astc-10x8-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x8-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:8,isCompressed:!0,channels:4},"astc-10x10-unorm":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-10x10-unorm-srgb":{bytesPerBlock:16,blockWidth:10,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x10-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:10,isCompressed:!0,channels:4},"astc-12x12-unorm":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4},"astc-12x12-unorm-srgb":{bytesPerBlock:16,blockWidth:12,blockHeight:12,isCompressed:!0,channels:4}};class On{constructor(){this.id=On._id++,this.line=0}get isAstNode(){return!0}get astNodeType(){return""}search(e){e(this)}searchBlock(e,t){if(e){t(af.instance);for(const r of e)r instanceof Array?this.searchBlock(r,t):r.search(t);t(of.instance)}}constEvaluate(e,t){throw new Error("Cannot evaluate node")}constEvaluateString(e){return this.constEvaluate(e).toString()}}On._id=0;class af extends On{}af.instance=new af;class of extends On{}of.instance=new of;const Cw=new Set(["all","all","any","select","arrayLength","abs","acos","acosh","asin","asinh","atan","atanh","atan2","ceil","clamp","cos","cosh","countLeadingZeros","countOneBits","countTrailingZeros","cross","degrees","determinant","distance","dot","dot4U8Packed","dot4I8Packed","exp","exp2","extractBits","faceForward","firstLeadingBit","firstTrailingBit","floor","fma","fract","frexp","insertBits","inverseSqrt","ldexp","length","log","log2","max","min","mix","modf","normalize","pow","quantizeToF16","radians","reflect","refract","reverseBits","round","saturate","sign","sin","sinh","smoothStep","sqrt","step","tan","tanh","transpose","trunc","dpdx","dpdxCoarse","dpdxFine","dpdy","dpdyCoarse","dpdyFine","fwidth","fwidthCoarse","fwidthFine","textureDimensions","textureGather","textureGatherCompare","textureLoad","textureNumLayers","textureNumLevels","textureNumSamples","textureSample","textureSampleBias","textureSampleCompare","textureSampleCompareLevel","textureSampleGrad","textureSampleLevel","textureSampleBaseClampToEdge","textureStore","atomicLoad","atomicStore","atomicAdd","atomicSub","atomicMax","atomicMin","atomicAnd","atomicOr","atomicXor","atomicExchange","atomicCompareExchangeWeak","pack4x8snorm","pack4x8unorm","pack4xI8","pack4xU8","pack4x8Clamp","pack4xU8Clamp","pack2x16snorm","pack2x16unorm","pack2x16float","unpack4x8snorm","unpack4x8unorm","unpack4xI8","unpack4xU8","unpack2x16snorm","unpack2x16unorm","unpack2x16float","storageBarrier","textureBarrier","workgroupBarrier","workgroupUniformLoad","subgroupAdd","subgroupExclusiveAdd","subgroupInclusiveAdd","subgroupAll","subgroupAnd","subgroupAny","subgroupBallot","subgroupBroadcast","subgroupBroadcastFirst","subgroupElect","subgroupMax","subgroupMin","subgroupMul","subgroupExclusiveMul","subgroupInclusiveMul","subgroupOr","subgroupShuffle","subgroupShuffleDown","subgroupShuffleUp","subgroupShuffleXor","subgroupXor","quadBroadcast","quadSwapDiagonal","quadSwapX","quadSwapY"]);class it extends On{constructor(){super()}}class wl extends it{constructor(e,t,r,i,a,l){super(),this.calls=new Set,this.name=e,this.args=t,this.returnType=r,this.body=i,this.startLine=a,this.endLine=l}get astNodeType(){return"function"}search(e){if(this.attributes)for(const t of this.attributes)e(t);e(this);for(const t of this.args)e(t);this.searchBlock(this.body,e)}}class O6 extends it{constructor(e){super(),this.expression=e}get astNodeType(){return"staticAssert"}search(e){this.expression.search(e)}}class Mw extends it{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"while"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class Xg extends it{constructor(e,t){super(),this.body=e,this.loopId=t}get astNodeType(){return"continuing"}search(e){this.searchBlock(this.body,e)}}class Ow extends it{constructor(e,t,r,i){super(),this.init=e,this.condition=t,this.increment=r,this.body=i}get astNodeType(){return"for"}search(e){var t,r,i;(t=this.init)===null||t===void 0||t.search(e),(r=this.condition)===null||r===void 0||r.search(e),(i=this.increment)===null||i===void 0||i.search(e),this.searchBlock(this.body,e)}}class Cr extends it{constructor(e,t,r,i,a){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=i,this.value=a}get astNodeType(){return"var"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class Y_ extends it{constructor(e,t,r){super(),this.attributes=null,this.name=e,this.type=t,this.value=r}get astNodeType(){return"override"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class ol extends it{constructor(e,t,r,i,a){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=i,this.value=a}get astNodeType(){return"let"}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}class wu extends it{constructor(e,t,r,i,a){super(),this.attributes=null,this.name=e,this.type=t,this.storage=r,this.access=i,this.value=a}get astNodeType(){return"const"}constEvaluate(e,t){return this.value.constEvaluate(e,t)}search(e){var t;e(this),(t=this.value)===null||t===void 0||t.search(e)}}var ca,el,H,B;(n=>{n.increment="++",n.decrement="--"})(ca||(ca={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for IncrementOperator");return n[t]}})(ca||(ca={}));class Iw extends it{constructor(e,t){super(),this.operator=e,this.variable=t}get astNodeType(){return"increment"}search(e){this.variable.search(e)}}(n=>{n.assign="=",n.addAssign="+=",n.subtractAssin="-=",n.multiplyAssign="*=",n.divideAssign="/=",n.moduloAssign="%=",n.andAssign="&=",n.orAssign="|=",n.xorAssign="^=",n.shiftLeftAssign="<<=",n.shiftRightAssign=">>="})(el||(el={})),(n=>{n.parse=function(e){const t=e;if(t=="parse")throw new Error("Invalid value for AssignOperator");return t}})(el||(el={}));class Nw extends it{constructor(e,t,r){super(),this.operator=e,this.variable=t,this.value=r}get astNodeType(){return"assign"}search(e){this.variable.search(e),this.value.search(e)}}class q_ extends it{constructor(e,t){super(),this.name=e,this.args=t}get astNodeType(){return"call"}isBuiltin(){return Cw.has(this.name)}search(e){for(const t of this.args)t.search(e);e(this)}}class kw extends it{constructor(e,t){super(),this.body=e,this.continuing=t}get astNodeType(){return"loop"}}class Dw extends it{constructor(e,t){super(),this.condition=e,this.cases=t}get astNodeType(){return"switch"}}class Pw extends it{constructor(e,t,r,i){super(),this.condition=e,this.body=t,this.elseif=r,this.else=i}get astNodeType(){return"if"}search(e){this.condition.search(e),this.searchBlock(this.body,e),this.searchBlock(this.elseif,e),this.searchBlock(this.else,e)}}class Uw extends it{constructor(e){super(),this.value=e}get astNodeType(){return"return"}search(e){var t;(t=this.value)===null||t===void 0||t.search(e)}}class I6 extends it{constructor(e){super(),this.name=e}get astNodeType(){return"enable"}}class N6 extends it{constructor(e){super(),this.extensions=e}get astNodeType(){return"requires"}}class Bw extends it{constructor(e,t){super(),this.severity=e,this.rule=t}get astNodeType(){return"diagnostic"}}class K_ extends it{constructor(e,t){super(),this.name=e,this.type=t}get astNodeType(){return"alias"}}class k6 extends it{constructor(){super()}get astNodeType(){return"discard"}}class Fw extends it{constructor(){super(),this.condition=null,this.loopId=-1}get astNodeType(){return"break"}}class Lw extends it{constructor(){super(),this.loopId=-1}get astNodeType(){return"continue"}}class J extends it{constructor(e){super(),this.attributes=null,this.name=e}get astNodeType(){return"type"}get isStruct(){return!1}get isArray(){return!1}static maxFormatType(e){let t=e[0];if(t.name==="f32")return t;for(let r=1;r<e.length;++r){const i=J._priority.get(t.name);J._priority.get(e[r].name)<i&&(t=e[r])}return t.name==="x32"?J.i32:t}getTypeName(){return this.name}}J.x32=new J("x32"),J.f32=new J("f32"),J.i32=new J("i32"),J.u32=new J("u32"),J.f16=new J("f16"),J.bool=new J("bool"),J.void=new J("void"),J._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class tT extends J{constructor(e){super(e)}}class Ar extends J{constructor(e,t,r,i){super(e),this.members=t,this.startLine=r,this.endLine=i}get astNodeType(){return"struct"}get isStruct(){return!0}getMemberIndex(e){for(let t=0;t<this.members.length;t++)if(this.members[t].name==e)return t;return-1}search(e){for(const t of this.members)e(t)}}class z extends J{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"template"}getTypeName(){let e=this.name;if(this.format!==null){if(e==="vec2"||e==="vec3"||e==="vec4"||e==="mat2x2"||e==="mat2x3"||e==="mat2x4"||e==="mat3x2"||e==="mat3x3"||e==="mat3x4"||e==="mat4x2"||e==="mat4x3"||e==="mat4x4"){if(this.format.name==="f32")return e+="f",e;if(this.format.name==="i32")return e+="i",e;if(this.format.name==="u32")return e+="u",e;if(this.format.name==="bool")return e+="b",e;if(this.format.name==="f16")return e+="h",e}e+=`<${this.format.name}>`}else if(e==="vec2"||e==="vec3"||e==="vec4")return e;return e}}z.vec2f=new z("vec2",J.f32,null),z.vec3f=new z("vec3",J.f32,null),z.vec4f=new z("vec4",J.f32,null),z.vec2i=new z("vec2",J.i32,null),z.vec3i=new z("vec3",J.i32,null),z.vec4i=new z("vec4",J.i32,null),z.vec2u=new z("vec2",J.u32,null),z.vec3u=new z("vec3",J.u32,null),z.vec4u=new z("vec4",J.u32,null),z.vec2h=new z("vec2",J.f16,null),z.vec3h=new z("vec3",J.f16,null),z.vec4h=new z("vec4",J.f16,null),z.vec2b=new z("vec2",J.bool,null),z.vec3b=new z("vec3",J.bool,null),z.vec4b=new z("vec4",J.bool,null),z.mat2x2f=new z("mat2x2",J.f32,null),z.mat2x3f=new z("mat2x3",J.f32,null),z.mat2x4f=new z("mat2x4",J.f32,null),z.mat3x2f=new z("mat3x2",J.f32,null),z.mat3x3f=new z("mat3x3",J.f32,null),z.mat3x4f=new z("mat3x4",J.f32,null),z.mat4x2f=new z("mat4x2",J.f32,null),z.mat4x3f=new z("mat4x3",J.f32,null),z.mat4x4f=new z("mat4x4",J.f32,null),z.mat2x2h=new z("mat2x2",J.f16,null),z.mat2x3h=new z("mat2x3",J.f16,null),z.mat2x4h=new z("mat2x4",J.f16,null),z.mat3x2h=new z("mat3x2",J.f16,null),z.mat3x3h=new z("mat3x3",J.f16,null),z.mat3x4h=new z("mat3x4",J.f16,null),z.mat4x2h=new z("mat4x2",J.f16,null),z.mat4x3h=new z("mat4x3",J.f16,null),z.mat4x4h=new z("mat4x4",J.f16,null),z.mat2x2i=new z("mat2x2",J.i32,null),z.mat2x3i=new z("mat2x3",J.i32,null),z.mat2x4i=new z("mat2x4",J.i32,null),z.mat3x2i=new z("mat3x2",J.i32,null),z.mat3x3i=new z("mat3x3",J.i32,null),z.mat3x4i=new z("mat3x4",J.i32,null),z.mat4x2i=new z("mat4x2",J.i32,null),z.mat4x3i=new z("mat4x3",J.i32,null),z.mat4x4i=new z("mat4x4",J.i32,null),z.mat2x2u=new z("mat2x2",J.u32,null),z.mat2x3u=new z("mat2x3",J.u32,null),z.mat2x4u=new z("mat2x4",J.u32,null),z.mat3x2u=new z("mat3x2",J.u32,null),z.mat3x3u=new z("mat3x3",J.u32,null),z.mat3x4u=new z("mat3x4",J.u32,null),z.mat4x2u=new z("mat4x2",J.u32,null),z.mat4x3u=new z("mat4x3",J.u32,null),z.mat4x4u=new z("mat4x4",J.u32,null);class Lp extends J{constructor(e,t,r,i){super(e),this.storage=t,this.type=r,this.access=i}get astNodeType(){return"pointer"}}class ll extends J{constructor(e,t,r,i){super(e),this.attributes=t,this.format=r,this.count=i}get astNodeType(){return"array"}get isArray(){return!0}}class tl extends J{constructor(e,t,r){super(e),this.format=t,this.access=r}get astNodeType(){return"sampler"}}class or extends On{constructor(){super(),this.postfix=null}}class ts extends or{constructor(e){super(),this.value=e}get astNodeType(){return"stringExpr"}toString(){return this.value}constEvaluateString(){return this.value}}class Qn extends or{constructor(e,t){super(),this.type=e,this.args=t}get astNodeType(){return"createExpr"}search(e){if(e(this),this.args)for(const t of this.args)t.search(e)}constEvaluate(e,t){return t&&(t[0]=this.type),e.evalExpression(this,e.context)}}class Z_ extends or{constructor(e,t){super(),this.cachedReturnValue=null,this.name=e,this.args=t}get astNodeType(){return"callExpr"}setCachedReturnValue(e){this.cachedReturnValue=e}get isBuiltin(){return Cw.has(this.name)}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){for(const t of this.args)t.search(e);e(this)}}class dn extends or{constructor(e){super(),this.name=e}get astNodeType(){return"varExpr"}search(e){e(this),this.postfix&&this.postfix.search(e)}constEvaluate(e,t){return e.evalExpression(this,e.context)}}class zw extends or{constructor(e,t){super(),this.name=e,this.initializer=t}get astNodeType(){return"constExpr"}constEvaluate(e,t){if(this.initializer){const r=e.evalExpression(this.initializer,e.context);return r!==null&&this.postfix?r.getSubData(e,this.postfix,e.context):r}return null}search(e){this.initializer.search(e)}}class vt extends or{constructor(e,t){super(),this.value=e,this.type=t}get astNodeType(){return"literalExpr"}constEvaluate(e,t){return t!==void 0&&(t[0]=this.type),this.value}get isScalar(){return this.value instanceof U}get isVector(){return this.value instanceof M||this.value instanceof xe}get scalarValue(){return this.value instanceof U?this.value.value:(console.error("Value is not scalar."),0)}get vectorValue(){return this.value instanceof M||this.value instanceof xe?this.value.data:(console.error("Value is not a vector or matrix."),new Float32Array(0))}}class Vw extends or{constructor(e,t){super(),this.type=e,this.value=t}get astNodeType(){return"bitcastExpr"}search(e){this.value.search(e)}}class Ea extends or{constructor(e){super(),this.index=e}search(e){this.index.search(e)}}class Hw extends or{constructor(){super()}}class _t extends Hw{constructor(e,t){super(),this.operator=e,this.right=t}get astNodeType(){return"unaryOp"}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.right.search(e)}}class Pn extends Hw{constructor(e,t,r){super(),this.operator=e,this.left=t,this.right=r}get astNodeType(){return"binaryOp"}_getPromotedType(e,t){return e.name===t.name?e:e.name==="f32"||t.name==="f32"?J.f32:e.name==="u32"||t.name==="u32"?J.u32:J.i32}constEvaluate(e,t){return e.evalExpression(this,e.context)}search(e){this.left.search(e),this.right.search(e)}}class jw extends On{constructor(e){super(),this.body=e}}class xu extends or{constructor(){super()}get astNodeType(){return"default"}}class $w extends jw{constructor(e,t){super(t),this.selectors=e}get astNodeType(){return"case"}search(e){this.searchBlock(this.body,e)}}class Ww extends jw{constructor(e){super(e)}get astNodeType(){return"default"}search(e){this.searchBlock(this.body,e)}}class nT extends On{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"argument"}}class D6 extends On{constructor(e,t){super(),this.condition=e,this.body=t}get astNodeType(){return"elseif"}search(e){this.condition.search(e),this.searchBlock(this.body,e)}}class rT extends On{constructor(e,t,r){super(),this.name=e,this.type=t,this.attributes=r}get astNodeType(){return"member"}}class Xw extends On{constructor(e,t){super(),this.name=e,this.value=t}get astNodeType(){return"attribute"}}class Mn{constructor(e,t){this.parent=null,this.typeInfo=e,this.parent=t,this.id=Mn._id++}clone(){throw`Clone: Not implemented for ${this.constructor.name}`}setDataValue(e,t,r,i){console.error(`SetDataValue: Not implemented for ${this.constructor.name}`)}getSubData(e,t,r){return console.error(`GetDataValue: Not implemented for ${this.constructor.name}`),null}toString(){return`<${this.typeInfo.name}>`}}Mn._id=0;class Yg extends Mn{constructor(){super(new En("void",null),null)}toString(){return"void"}}Yg.void=new Yg;class ra extends Mn{constructor(e){super(new En("pointer",null),null),this.reference=e}clone(){return this}setDataValue(e,t,r,i){this.reference.setDataValue(e,t,r,i)}getSubData(e,t,r){return t?this.reference.getSubData(e,t,r):this}}class U extends Mn{constructor(e,t,r=null){super(t,r),e instanceof Int32Array||e instanceof Uint32Array||e instanceof Float32Array?this.data=e:this.typeInfo.name==="x32"?e-Math.floor(e)!=0?this.data=new Float32Array([e]):this.data=e>=0?new Uint32Array([e]):new Int32Array([e]):this.typeInfo.name==="i32"||this.typeInfo.name==="bool"?this.data=new Int32Array([e]):this.typeInfo.name==="u32"?this.data=new Uint32Array([e]):this.typeInfo.name==="f32"||this.typeInfo.name==="f16"?this.data=new Float32Array([e]):console.error("ScalarData2: Invalid type",t)}clone(){if(this.data instanceof Float32Array)return new U(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new U(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new U(new Uint32Array(this.data),this.typeInfo,null);throw"ScalarData: Invalid data type"}get value(){return this.data[0]}set value(e){this.data[0]=e}setDataValue(e,t,r,i){if(r)return void console.error("SetDataValue: Scalar data does not support postfix",r);if(!(t instanceof U))return void console.error("SetDataValue: Invalid value",t);let a=t.data[0];this.typeInfo.name==="i32"||this.typeInfo.name==="u32"?a=Math.floor(a):this.typeInfo.name==="bool"&&(a=a?1:0),this.data[0]=a}getSubData(e,t,r){return t?(console.error("getSubData: Scalar data does not support postfix",t),null):this}toString(){return`${this.value}`}}function P6(n,e,t){const r=e.length;return r===2?t==="f32"?new M(new Float32Array(e),n.getTypeInfo("vec2f")):t==="i32"||t==="bool"?new M(new Int32Array(e),n.getTypeInfo("vec2i")):t==="u32"?new M(new Uint32Array(e),n.getTypeInfo("vec2u")):t==="f16"?new M(new Float32Array(e),n.getTypeInfo("vec2h")):(console.error(`getSubData: Unknown format ${t}`),null):r===3?t==="f32"?new M(new Float32Array(e),n.getTypeInfo("vec3f")):t==="i32"||t==="bool"?new M(new Int32Array(e),n.getTypeInfo("vec3i")):t==="u32"?new M(new Uint32Array(e),n.getTypeInfo("vec3u")):t==="f16"?new M(new Float32Array(e),n.getTypeInfo("vec3h")):(console.error(`getSubData: Unknown format ${t}`),null):r===4?t==="f32"?new M(new Float32Array(e),n.getTypeInfo("vec4f")):t==="i32"||t==="bool"?new M(new Int32Array(e),n.getTypeInfo("vec4i")):t==="u32"?new M(new Uint32Array(e),n.getTypeInfo("vec4u")):t==="f16"?new M(new Float32Array(e),n.getTypeInfo("vec4h")):(console.error(`getSubData: Unknown format ${t}`),null):(console.error(`getSubData: Invalid vector size ${e.length}`),null)}class M extends Mn{constructor(e,t,r=null){if(super(t,r),e instanceof Float32Array||e instanceof Uint32Array||e instanceof Int32Array)this.data=e;else{const i=this.typeInfo.name;i==="vec2f"||i==="vec3f"||i==="vec4f"?this.data=new Float32Array(e):i==="vec2i"||i==="vec3i"||i==="vec4i"?this.data=new Int32Array(e):i==="vec2u"||i==="vec3u"||i==="vec4u"?this.data=new Uint32Array(e):i==="vec2h"||i==="vec3h"||i==="vec4h"?this.data=new Float32Array(e):i==="vec2b"||i==="vec3b"||i==="vec4b"?this.data=new Int32Array(e):i==="vec2"||i==="vec3"||i==="vec4"?this.data=new Float32Array(e):console.error(`VectorData: Invalid type ${i}`)}}clone(){if(this.data instanceof Float32Array)return new M(new Float32Array(this.data),this.typeInfo,null);if(this.data instanceof Int32Array)return new M(new Int32Array(this.data),this.typeInfo,null);if(this.data instanceof Uint32Array)return new M(new Uint32Array(this.data),this.typeInfo,null);throw"VectorData: Invalid data type"}setDataValue(e,t,r,i){r instanceof ts?console.error("TODO: Set vector postfix"):t instanceof M?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,r){if(t===null)return this;let i=e.getTypeInfo("f32");if(this.typeInfo instanceof es)i=this.typeInfo.format||i;else{const l=this.typeInfo.name;l==="vec2f"||l==="vec3f"||l==="vec4f"?i=e.getTypeInfo("f32"):l==="vec2i"||l==="vec3i"||l==="vec4i"?i=e.getTypeInfo("i32"):l==="vec2b"||l==="vec3b"||l==="vec4b"?i=e.getTypeInfo("bool"):l==="vec2u"||l==="vec3u"||l==="vec4u"?i=e.getTypeInfo("u32"):l==="vec2h"||l==="vec3h"||l==="vec4h"?i=e.getTypeInfo("f16"):console.error(`GetSubData: Unknown type ${l}`)}let a=this;for(;t!==null&&a!==null;){if(t instanceof Ea){const l=t.index;let c=-1;if(l instanceof vt){if(!(l.value instanceof U))return console.error(`GetSubData: Invalid array index ${l.value}`),null;c=l.value.value}else{const f=e.evalExpression(l,r);if(!(f instanceof U))return console.error("GetSubData: Unknown index type",l),null;c=f.value}if(c<0||c>=a.data.length)return console.error("GetSubData: Index out of range",c),null;if(a.data instanceof Float32Array){const f=new Float32Array(a.data.buffer,a.data.byteOffset+4*c,1);return new U(f,i)}if(a.data instanceof Int32Array){const f=new Int32Array(a.data.buffer,a.data.byteOffset+4*c,1);return new U(f,i)}if(a.data instanceof Uint32Array){const f=new Uint32Array(a.data.buffer,a.data.byteOffset+4*c,1);return new U(f,i)}throw"GetSubData: Invalid data type"}if(!(t instanceof ts))return console.error("GetSubData: Unknown postfix",t),null;{const l=t.value.toLowerCase();if(l.length===1){let f=0;if(l==="x"||l==="r")f=0;else if(l==="y"||l==="g")f=1;else if(l==="z"||l==="b")f=2;else{if(l!=="w"&&l!=="a")return console.error(`GetSubData: Unknown member ${l}`),null;f=3}if(this.data instanceof Float32Array){let d=new Float32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new U(d,i,this)}if(this.data instanceof Int32Array){let d=new Int32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new U(d,i,this)}if(this.data instanceof Uint32Array){let d=new Uint32Array(this.data.buffer,this.data.byteOffset+4*f,1);return new U(d,i,this)}}const c=[];for(const f of l)f==="x"||f==="r"?c.push(this.data[0]):f==="y"||f==="g"?c.push(this.data[1]):f==="z"||f==="b"?c.push(this.data[2]):f==="w"||f==="a"?c.push(this.data[3]):console.error(`GetDataValue: Unknown member ${f}`);a=P6(e,c,i.name)}t=t.postfix}return a}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class xe extends Mn{constructor(e,t,r=null){super(t,r),e instanceof Float32Array?this.data=e:this.data=new Float32Array(e)}clone(){return new xe(new Float32Array(this.data),this.typeInfo,null)}setDataValue(e,t,r,i){r instanceof ts?console.error("TODO: Set matrix postfix"):t instanceof xe?this.data=t.data:console.error("SetDataValue: Invalid value",t)}getSubData(e,t,r){if(t===null)return this;const i=this.typeInfo.name;if(e.getTypeInfo("f32"),this.typeInfo instanceof es)this.typeInfo.format;else if(i.endsWith("f"))e.getTypeInfo("f32");else if(i.endsWith("i"))e.getTypeInfo("i32");else if(i.endsWith("u"))e.getTypeInfo("u32");else{if(!i.endsWith("h"))return console.error(`GetDataValue: Unknown type ${i}`),null;e.getTypeInfo("f16")}if(t instanceof Ea){const a=t.index;let l=-1;if(a instanceof vt){if(!(a.value instanceof U))return console.error(`GetDataValue: Invalid array index ${a.value}`),null;l=a.value.value}else{const d=e.evalExpression(a,r);if(!(d instanceof U))return console.error("GetDataValue: Unknown index type",a),null;l=d.value}if(l<0||l>=this.data.length)return console.error("GetDataValue: Index out of range",l),null;const c=i.endsWith("h")?"h":"f";let f;if(i==="mat2x2"||i==="mat2x2f"||i==="mat2x2h"||i==="mat3x2"||i==="mat3x2f"||i==="mat3x2h"||i==="mat4x2"||i==="mat4x2f"||i==="mat4x2h")f=new M(new Float32Array(this.data.buffer,this.data.byteOffset+2*l*4,2),e.getTypeInfo(`vec2${c}`));else if(i==="mat2x3"||i==="mat2x3f"||i==="mat2x3h"||i==="mat3x3"||i==="mat3x3f"||i==="mat3x3h"||i==="mat4x3"||i==="mat4x3f"||i==="mat4x3h")f=new M(new Float32Array(this.data.buffer,this.data.byteOffset+3*l*4,3),e.getTypeInfo(`vec3${c}`));else{if(i!=="mat2x4"&&i!=="mat2x4f"&&i!=="mat2x4h"&&i!=="mat3x4"&&i!=="mat3x4f"&&i!=="mat3x4h"&&i!=="mat4x4"&&i!=="mat4x4f"&&i!=="mat4x4h")return console.error(`GetDataValue: Unknown type ${i}`),null;f=new M(new Float32Array(this.data.buffer,this.data.byteOffset+4*l*4,4),e.getTypeInfo(`vec4${c}`))}return t.postfix?f.getSubData(e,t.postfix,r):f}return console.error("GetDataValue: Invalid postfix",t),null}toString(){let e=`${this.data[0]}`;for(let t=1;t<this.data.length;++t)e+=`, ${this.data[t]}`;return e}}class ut extends Mn{constructor(e,t,r=0,i=null){super(t,i),this.buffer=e instanceof ArrayBuffer?e:e.buffer,this.offset=r}clone(){const e=new Uint8Array(new Uint8Array(this.buffer,this.offset,this.typeInfo.size));return new ut(e.buffer,this.typeInfo,0,null)}setDataValue(e,t,r,i){if(t===null)return void console.log("setDataValue: NULL data.");let a=this.offset,l=this.typeInfo;for(;r;){if(r instanceof Ea)if(l instanceof gi){const c=r.index;if(c instanceof vt){if(!(c.value instanceof U))return void console.error(`SetDataValue: Invalid index type ${c.value}`);a+=c.value.value*l.stride}else{const f=e.evalExpression(c,i);if(!(f instanceof U))return void console.error("SetDataValue: Unknown index type",c);a+=f.value*l.stride}l=l.format}else console.error(`SetDataValue: Type ${l.getTypeName()} is not an array`);else{if(!(r instanceof ts))return void console.error("SetDataValue: Unknown postfix type",r);{const c=r.value;if(l instanceof fi){let f=!1;for(const d of l.members)if(d.name===c){a+=d.offset,l=d.type,f=!0;break}if(!f)return void console.error(`SetDataValue: Member ${c} not found`)}else if(l instanceof En){const f=l.getTypeName();let d=0;if(c==="x"||c==="r")d=0;else if(c==="y"||c==="g")d=1;else if(c==="z"||c==="b")d=2;else{if(c!=="w"&&c!=="a")return void console.error(`SetDataValue: Unknown member ${c}`);d=3}if(!(t instanceof U))return void console.error("SetDataValue: Invalid value",t);const p=t.value;return f==="vec2f"?void(new Float32Array(this.buffer,a,2)[d]=p):f==="vec3f"?void(new Float32Array(this.buffer,a,3)[d]=p):f==="vec4f"?void(new Float32Array(this.buffer,a,4)[d]=p):f==="vec2i"?void(new Int32Array(this.buffer,a,2)[d]=p):f==="vec3i"?void(new Int32Array(this.buffer,a,3)[d]=p):f==="vec4i"?void(new Int32Array(this.buffer,a,4)[d]=p):f==="vec2u"?void(new Uint32Array(this.buffer,a,2)[d]=p):f==="vec3u"?void(new Uint32Array(this.buffer,a,3)[d]=p):f==="vec4u"?void(new Uint32Array(this.buffer,a,4)[d]=p):void console.error(`SetDataValue: Type ${f} is not a struct`)}}}r=r.postfix}this.setData(e,t,l,a,i)}setData(e,t,r,i,a){const l=r.getTypeName();if(l!=="f32"&&l!=="f16")if(l!=="i32"&&l!=="atomic<i32>"&&l!=="x32")if(l!=="u32"&&l!=="atomic<u32>")if(l!=="bool")if(l!=="vec2f"&&l!=="vec2h")if(l!=="vec3f"&&l!=="vec3h")if(l!=="vec4f"&&l!=="vec4h")if(l!=="vec2i")if(l!=="vec3i")if(l!=="vec4i")if(l!=="vec2u")if(l!=="vec3u")if(l!=="vec4u")if(l!=="vec2b")if(l!=="vec3b")if(l!=="vec4b")if(l!=="mat2x2f"&&l!=="mat2x2h")if(l!=="mat2x3f"&&l!=="mat2x3h")if(l!=="mat2x4f"&&l!=="mat2x4h")if(l!=="mat3x2f"&&l!=="mat3x2h")if(l!=="mat3x3f"&&l!=="mat3x3h")if(l!=="mat3x4f"&&l!=="mat3x4h")if(l!=="mat4x2f"&&l!=="mat4x2h")if(l!=="mat4x3f"&&l!=="mat4x3h")if(l!=="mat4x4f"&&l!=="mat4x4h")if(t instanceof ut){if(r===t.typeInfo)return void new Uint8Array(this.buffer,i,t.buffer.byteLength).set(new Uint8Array(t.buffer));console.error("SetDataValue: Type mismatch",l,t.typeInfo.getTypeName())}else console.error(`SetData: Unknown type ${l}`);else{const c=new Float32Array(this.buffer,i,16);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11],c[12]=t.data[12],c[13]=t.data[13],c[14]=t.data[14],c[15]=t.data[15]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11],c[12]=t[12],c[13]=t[13],c[14]=t[14],c[15]=t[15])}else{const c=new Float32Array(this.buffer,i,12);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11])}else{const c=new Float32Array(this.buffer,i,8);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7])}else{const c=new Float32Array(this.buffer,i,12);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8],c[9]=t.data[9],c[10]=t.data[10],c[11]=t.data[11]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8],c[9]=t[9],c[10]=t[10],c[11]=t[11])}else{const c=new Float32Array(this.buffer,i,9);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7],c[8]=t.data[8]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7],c[8]=t[8])}else{const c=new Float32Array(this.buffer,i,6);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5])}else{const c=new Float32Array(this.buffer,i,8);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5],c[6]=t.data[6],c[7]=t.data[7]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5],c[6]=t[6],c[7]=t[7])}else{const c=new Float32Array(this.buffer,i,6);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3],c[4]=t.data[4],c[5]=t.data[5]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3],c[4]=t[4],c[5]=t[5])}else{const c=new Float32Array(this.buffer,i,4);t instanceof xe?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3])}else{const c=new Uint32Array(this.buffer,i,4);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3])}else{const c=new Uint32Array(this.buffer,i,3);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2])}else{const c=new Uint32Array(this.buffer,i,2);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1])}else{const c=new Uint32Array(this.buffer,i,4);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3])}else{const c=new Uint32Array(this.buffer,i,3);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2])}else{const c=new Uint32Array(this.buffer,i,2);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1])}else{const c=new Int32Array(this.buffer,i,4);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3])}else{const c=new Int32Array(this.buffer,i,3);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2])}else{const c=new Int32Array(this.buffer,i,2);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1])}else{const c=new Float32Array(this.buffer,i,4);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2],c[3]=t.data[3]):(c[0]=t[0],c[1]=t[1],c[2]=t[2],c[3]=t[3])}else{const c=new Float32Array(this.buffer,i,3);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1],c[2]=t.data[2]):(c[0]=t[0],c[1]=t[1],c[2]=t[2])}else{const c=new Float32Array(this.buffer,i,2);t instanceof M?(c[0]=t.data[0],c[1]=t.data[1]):(c[0]=t[0],c[1]=t[1])}else t instanceof U&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof U&&(new Uint32Array(this.buffer,i,1)[0]=t.value);else t instanceof U&&(new Int32Array(this.buffer,i,1)[0]=t.value);else t instanceof U&&(new Float32Array(this.buffer,i,1)[0]=t.value)}getSubData(e,t,r){var i,a,l;if(t===null)return this;let c=this.offset,f=this.typeInfo;for(;t;){if(t instanceof Ea){const p=t.index,_=e.evalExpression(p,r);let y=0;if(_ instanceof U?y=_.value:console.error("GetDataValue: Invalid index type",p),f instanceof gi)c+=y*f.stride,f=f.format;else{const b=f.getTypeName();b==="mat4x4"||b==="mat4x4f"||b==="mat4x4h"?(c+=16*y,f=e.getTypeInfo("vec4f")):console.error(`getDataValue: Type ${f.getTypeName()} is not an array`)}}else{if(!(t instanceof ts))return console.error("GetDataValue: Unknown postfix type",t),null;{const p=t.value;if(f instanceof fi){let _=!1;for(const y of f.members)if(y.name===p){c+=y.offset,f=y.type,_=!0;break}if(!_)return console.error(`GetDataValue: Member ${p} not found`),null}else if(f instanceof En){const _=f.getTypeName();if(_==="vec2f"||_==="vec3f"||_==="vec4f"||_==="vec2i"||_==="vec3i"||_==="vec4i"||_==="vec2u"||_==="vec3u"||_==="vec4u"||_==="vec2b"||_==="vec3b"||_==="vec4b"||_==="vec2h"||_==="vec3h"||_==="vec4h"||_==="vec2"||_==="vec3"||_==="vec4"){if(p.length>0&&p.length<5){let y="f";const b=[];for(let T=0;T<p.length;++T){const A=p[T].toLowerCase();let C=0;if(A==="x"||A==="r")C=0;else if(A==="y"||A==="g")C=1;else if(A==="z"||A==="b")C=2;else{if(A!=="w"&&A!=="a")return console.error(`Unknown member ${p}`),null;C=3}if(p.length===1){if(_.endsWith("f"))return this.buffer.byteLength<c+4*C+4?(console.log("Insufficient buffer data"),null):new U(new Float32Array(this.buffer,c+4*C,1),e.getTypeInfo("f32"),this);if(_.endsWith("h"))return new U(new Float32Array(this.buffer,c+4*C,1),e.getTypeInfo("f16"),this);if(_.endsWith("i"))return new U(new Int32Array(this.buffer,c+4*C,1),e.getTypeInfo("i32"),this);if(_.endsWith("b"))return new U(new Int32Array(this.buffer,c+4*C,1),e.getTypeInfo("bool"),this);if(_.endsWith("u"))return new U(new Uint32Array(this.buffer,c+4*C,1),e.getTypeInfo("i32"),this)}if(_==="vec2f")b.push(new Float32Array(this.buffer,c,2)[C]);else if(_==="vec3f"){if(c+12>=this.buffer.byteLength)return console.log("Insufficient buffer data"),null;const N=new Float32Array(this.buffer,c,3);b.push(N[C])}else if(_==="vec4f")b.push(new Float32Array(this.buffer,c,4)[C]);else if(_==="vec2i")y="i",b.push(new Int32Array(this.buffer,c,2)[C]);else if(_==="vec3i")y="i",b.push(new Int32Array(this.buffer,c,3)[C]);else if(_==="vec4i")y="i",b.push(new Int32Array(this.buffer,c,4)[C]);else if(_==="vec2u"){y="u";const N=new Uint32Array(this.buffer,c,2);b.push(N[C])}else _==="vec3u"?(y="u",b.push(new Uint32Array(this.buffer,c,3)[C])):_==="vec4u"&&(y="u",b.push(new Uint32Array(this.buffer,c,4)[C]))}return b.length===2?f=e.getTypeInfo(`vec2${y}`):b.length===3?f=e.getTypeInfo(`vec3${y}`):b.length===4?f=e.getTypeInfo(`vec4${y}`):console.error(`GetDataValue: Invalid vector length ${b.length}`),new M(b,f,null)}return console.error(`GetDataValue: Unknown member ${p}`),null}return console.error(`GetDataValue: Type ${_} is not a struct`),null}}}t=t.postfix}const d=f.getTypeName();return d==="f32"?new U(new Float32Array(this.buffer,c,1),f,this):d==="i32"?new U(new Int32Array(this.buffer,c,1),f,this):d==="u32"?new U(new Uint32Array(this.buffer,c,1),f,this):d==="vec2f"?new M(new Float32Array(this.buffer,c,2),f,this):d==="vec3f"?new M(new Float32Array(this.buffer,c,3),f,this):d==="vec4f"?new M(new Float32Array(this.buffer,c,4),f,this):d==="vec2i"?new M(new Int32Array(this.buffer,c,2),f,this):d==="vec3i"?new M(new Int32Array(this.buffer,c,3),f,this):d==="vec4i"?new M(new Int32Array(this.buffer,c,4),f,this):d==="vec2u"?new M(new Uint32Array(this.buffer,c,2),f,this):d==="vec3u"?new M(new Uint32Array(this.buffer,c,3),f,this):d==="vec4u"?new M(new Uint32Array(this.buffer,c,4),f,this):f instanceof es&&f.name==="atomic"?((i=f.format)===null||i===void 0?void 0:i.name)==="u32"?new U(new Uint32Array(this.buffer,c,1)[0],f.format,this):((a=f.format)===null||a===void 0?void 0:a.name)==="i32"?new U(new Int32Array(this.buffer,c,1)[0],f.format,this):(console.error(`GetDataValue: Invalid atomic format ${(l=f.format)===null||l===void 0?void 0:l.name}`),null):new ut(this.buffer,f,c,this)}toString(){let e="";if(this.typeInfo instanceof gi)if(this.typeInfo.format.name==="f32"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="i32"){const t=new Int32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="u32"){const t=new Uint32Array(this.buffer,this.offset);e=`[${t[0]}`;for(let r=1;r<t.length;++r)e+=`, ${t[r]}`}else if(this.typeInfo.format.name==="vec2f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}]`;for(let r=1;r<t.length/2;++r)e+=`, [${t[2*r]}, ${t[2*r+1]}]`}else if(this.typeInfo.format.name==="vec3f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}]`;for(let r=4;r<t.length;r+=4)e+=`, [${t[r]}, ${t[r+1]}, ${t[r+2]}]`}else if(this.typeInfo.format.name==="vec4f"){const t=new Float32Array(this.buffer,this.offset);e=`[${t[0]}, ${t[1]}, ${t[2]}, ${t[3]}]`;for(let r=4;r<t.length;r+=4)e+=`, [${t[r]}, ${t[r+1]}, ${t[r+2]}, ${t[r+3]}]`}else e="[...]";else this.typeInfo instanceof fi?e+="{...}":e="[...]";return e}}class Er extends Mn{constructor(e,t,r,i){super(t,null),this.data=e,this.descriptor=r,this.view=i}clone(){return new Er(this.data,this.typeInfo,this.descriptor,this.view)}get width(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>0?(e=r[0])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.width)!==null&&t!==void 0?t:0}get height(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>1?(e=r[1])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.height)!==null&&t!==void 0?t:0}get depthOrArrayLayers(){var e,t;const r=this.descriptor.size;return r instanceof Array&&r.length>2?(e=r[2])!==null&&e!==void 0?e:0:r instanceof Object&&(t=r.depthOrArrayLayers)!==null&&t!==void 0?t:0}get format(){var e;return this.descriptor&&(e=this.descriptor.format)!==null&&e!==void 0?e:"rgba8unorm"}get sampleCount(){var e;return this.descriptor&&(e=this.descriptor.sampleCount)!==null&&e!==void 0?e:1}get mipLevelCount(){var e;return this.descriptor&&(e=this.descriptor.mipLevelCount)!==null&&e!==void 0?e:1}get dimension(){var e;return this.descriptor&&(e=this.descriptor.dimension)!==null&&e!==void 0?e:"2d"}getMipLevelSize(e){if(e>=this.mipLevelCount)return[0,0,0];const t=[this.width,this.height,this.depthOrArrayLayers];for(let r=0;r<t.length;++r)t[r]=Math.max(1,t[r]>>e);return t}get texelByteSize(){const e=this.format,t=Fp[e];return t?t.isDepthStencil?4:t.bytesPerBlock:0}get bytesPerRow(){return this.width*this.texelByteSize}get isDepthStencil(){const e=this.format,t=Fp[e];return!!t&&t.isDepthStencil}getGpuSize(){const e=this.format,t=Fp[e],r=this.width;if(!e||r<=0||!t)return-1;const i=this.height,a=this.depthOrArrayLayers,l=this.dimension;return r/t.blockWidth*(l==="1d"?1:i/t.blockHeight)*t.bytesPerBlock*a}getPixel(e,t,r=0,i=0){const a=this.texelByteSize,l=this.bytesPerRow,c=this.height,f=this.data[i];return M6(new Uint8Array(f),e,t,r,i,c,l,a,this.format)}setPixel(e,t,r,i,a){const l=this.texelByteSize,c=this.bytesPerRow,f=this.height,d=this.data[i];(function(p,_,y,b,T,A,C,N,O,R){const E=b*(C>>=T)*(A>>=T)+y*C+_*N;switch(O){case"r8unorm":return void je(p,E,"8unorm",1,R);case"r8snorm":return void je(p,E,"8snorm",1,R);case"r8uint":return void je(p,E,"8uint",1,R);case"r8sint":return void je(p,E,"8sint",1,R);case"rg8unorm":return void je(p,E,"8unorm",2,R);case"rg8snorm":return void je(p,E,"8snorm",2,R);case"rg8uint":return void je(p,E,"8uint",2,R);case"rg8sint":return void je(p,E,"8sint",2,R);case"rgba8unorm-srgb":case"rgba8unorm":case"bgra8unorm-srgb":case"bgra8unorm":return void je(p,E,"8unorm",4,R);case"rgba8snorm":return void je(p,E,"8snorm",4,R);case"rgba8uint":return void je(p,E,"8uint",4,R);case"rgba8sint":return void je(p,E,"8sint",4,R);case"r16uint":return void je(p,E,"16uint",1,R);case"r16sint":return void je(p,E,"16sint",1,R);case"r16float":return void je(p,E,"16float",1,R);case"rg16uint":return void je(p,E,"16uint",2,R);case"rg16sint":return void je(p,E,"16sint",2,R);case"rg16float":return void je(p,E,"16float",2,R);case"rgba16uint":return void je(p,E,"16uint",4,R);case"rgba16sint":return void je(p,E,"16sint",4,R);case"rgba16float":return void je(p,E,"16float",4,R);case"r32uint":return void je(p,E,"32uint",1,R);case"r32sint":return void je(p,E,"32sint",1,R);case"depth16unorm":case"depth24plus":case"depth24plus-stencil8":case"depth32float":case"depth32float-stencil8":case"r32float":return void je(p,E,"32float",1,R);case"rg32uint":return void je(p,E,"32uint",2,R);case"rg32sint":return void je(p,E,"32sint",2,R);case"rg32float":return void je(p,E,"32float",2,R);case"rgba32uint":return void je(p,E,"32uint",4,R);case"rgba32sint":return void je(p,E,"32sint",4,R);case"rgba32float":return void je(p,E,"32float",4,R);case"rg11b10ufloat":console.error("TODO: rg11b10ufloat not supported for writing")}})(new Uint8Array(d),e,t,r,i,f,c,l,this.format,a)}}(n=>{n[n.token=0]="token",n[n.keyword=1]="keyword",n[n.reserved=2]="reserved"})(B||(B={}));class F{constructor(e,t,r){this.name=e,this.type=t,this.rule=r}toString(){return this.name}}class S{}H=S,S.none=new F("",B.reserved,""),S.eof=new F("EOF",B.token,""),S.reserved={asm:new F("asm",B.reserved,"asm"),bf16:new F("bf16",B.reserved,"bf16"),do:new F("do",B.reserved,"do"),enum:new F("enum",B.reserved,"enum"),f16:new F("f16",B.reserved,"f16"),f64:new F("f64",B.reserved,"f64"),handle:new F("handle",B.reserved,"handle"),i8:new F("i8",B.reserved,"i8"),i16:new F("i16",B.reserved,"i16"),i64:new F("i64",B.reserved,"i64"),mat:new F("mat",B.reserved,"mat"),premerge:new F("premerge",B.reserved,"premerge"),regardless:new F("regardless",B.reserved,"regardless"),typedef:new F("typedef",B.reserved,"typedef"),u8:new F("u8",B.reserved,"u8"),u16:new F("u16",B.reserved,"u16"),u64:new F("u64",B.reserved,"u64"),unless:new F("unless",B.reserved,"unless"),using:new F("using",B.reserved,"using"),vec:new F("vec",B.reserved,"vec"),void:new F("void",B.reserved,"void")},S.keywords={array:new F("array",B.keyword,"array"),atomic:new F("atomic",B.keyword,"atomic"),bool:new F("bool",B.keyword,"bool"),f32:new F("f32",B.keyword,"f32"),i32:new F("i32",B.keyword,"i32"),mat2x2:new F("mat2x2",B.keyword,"mat2x2"),mat2x3:new F("mat2x3",B.keyword,"mat2x3"),mat2x4:new F("mat2x4",B.keyword,"mat2x4"),mat3x2:new F("mat3x2",B.keyword,"mat3x2"),mat3x3:new F("mat3x3",B.keyword,"mat3x3"),mat3x4:new F("mat3x4",B.keyword,"mat3x4"),mat4x2:new F("mat4x2",B.keyword,"mat4x2"),mat4x3:new F("mat4x3",B.keyword,"mat4x3"),mat4x4:new F("mat4x4",B.keyword,"mat4x4"),ptr:new F("ptr",B.keyword,"ptr"),sampler:new F("sampler",B.keyword,"sampler"),sampler_comparison:new F("sampler_comparison",B.keyword,"sampler_comparison"),struct:new F("struct",B.keyword,"struct"),texture_1d:new F("texture_1d",B.keyword,"texture_1d"),texture_2d:new F("texture_2d",B.keyword,"texture_2d"),texture_2d_array:new F("texture_2d_array",B.keyword,"texture_2d_array"),texture_3d:new F("texture_3d",B.keyword,"texture_3d"),texture_cube:new F("texture_cube",B.keyword,"texture_cube"),texture_cube_array:new F("texture_cube_array",B.keyword,"texture_cube_array"),texture_multisampled_2d:new F("texture_multisampled_2d",B.keyword,"texture_multisampled_2d"),texture_storage_1d:new F("texture_storage_1d",B.keyword,"texture_storage_1d"),texture_storage_2d:new F("texture_storage_2d",B.keyword,"texture_storage_2d"),texture_storage_2d_array:new F("texture_storage_2d_array",B.keyword,"texture_storage_2d_array"),texture_storage_3d:new F("texture_storage_3d",B.keyword,"texture_storage_3d"),texture_depth_2d:new F("texture_depth_2d",B.keyword,"texture_depth_2d"),texture_depth_2d_array:new F("texture_depth_2d_array",B.keyword,"texture_depth_2d_array"),texture_depth_cube:new F("texture_depth_cube",B.keyword,"texture_depth_cube"),texture_depth_cube_array:new F("texture_depth_cube_array",B.keyword,"texture_depth_cube_array"),texture_depth_multisampled_2d:new F("texture_depth_multisampled_2d",B.keyword,"texture_depth_multisampled_2d"),texture_external:new F("texture_external",B.keyword,"texture_external"),u32:new F("u32",B.keyword,"u32"),vec2:new F("vec2",B.keyword,"vec2"),vec3:new F("vec3",B.keyword,"vec3"),vec4:new F("vec4",B.keyword,"vec4"),bitcast:new F("bitcast",B.keyword,"bitcast"),block:new F("block",B.keyword,"block"),break:new F("break",B.keyword,"break"),case:new F("case",B.keyword,"case"),continue:new F("continue",B.keyword,"continue"),continuing:new F("continuing",B.keyword,"continuing"),default:new F("default",B.keyword,"default"),diagnostic:new F("diagnostic",B.keyword,"diagnostic"),discard:new F("discard",B.keyword,"discard"),else:new F("else",B.keyword,"else"),enable:new F("enable",B.keyword,"enable"),fallthrough:new F("fallthrough",B.keyword,"fallthrough"),false:new F("false",B.keyword,"false"),fn:new F("fn",B.keyword,"fn"),for:new F("for",B.keyword,"for"),function:new F("function",B.keyword,"function"),if:new F("if",B.keyword,"if"),let:new F("let",B.keyword,"let"),const:new F("const",B.keyword,"const"),loop:new F("loop",B.keyword,"loop"),while:new F("while",B.keyword,"while"),private:new F("private",B.keyword,"private"),read:new F("read",B.keyword,"read"),read_write:new F("read_write",B.keyword,"read_write"),return:new F("return",B.keyword,"return"),requires:new F("requires",B.keyword,"requires"),storage:new F("storage",B.keyword,"storage"),switch:new F("switch",B.keyword,"switch"),true:new F("true",B.keyword,"true"),alias:new F("alias",B.keyword,"alias"),type:new F("type",B.keyword,"type"),uniform:new F("uniform",B.keyword,"uniform"),var:new F("var",B.keyword,"var"),override:new F("override",B.keyword,"override"),workgroup:new F("workgroup",B.keyword,"workgroup"),write:new F("write",B.keyword,"write"),r8unorm:new F("r8unorm",B.keyword,"r8unorm"),r8snorm:new F("r8snorm",B.keyword,"r8snorm"),r8uint:new F("r8uint",B.keyword,"r8uint"),r8sint:new F("r8sint",B.keyword,"r8sint"),r16uint:new F("r16uint",B.keyword,"r16uint"),r16sint:new F("r16sint",B.keyword,"r16sint"),r16float:new F("r16float",B.keyword,"r16float"),rg8unorm:new F("rg8unorm",B.keyword,"rg8unorm"),rg8snorm:new F("rg8snorm",B.keyword,"rg8snorm"),rg8uint:new F("rg8uint",B.keyword,"rg8uint"),rg8sint:new F("rg8sint",B.keyword,"rg8sint"),r32uint:new F("r32uint",B.keyword,"r32uint"),r32sint:new F("r32sint",B.keyword,"r32sint"),r32float:new F("r32float",B.keyword,"r32float"),rg16uint:new F("rg16uint",B.keyword,"rg16uint"),rg16sint:new F("rg16sint",B.keyword,"rg16sint"),rg16float:new F("rg16float",B.keyword,"rg16float"),rgba8unorm:new F("rgba8unorm",B.keyword,"rgba8unorm"),rgba8unorm_srgb:new F("rgba8unorm_srgb",B.keyword,"rgba8unorm_srgb"),rgba8snorm:new F("rgba8snorm",B.keyword,"rgba8snorm"),rgba8uint:new F("rgba8uint",B.keyword,"rgba8uint"),rgba8sint:new F("rgba8sint",B.keyword,"rgba8sint"),bgra8unorm:new F("bgra8unorm",B.keyword,"bgra8unorm"),bgra8unorm_srgb:new F("bgra8unorm_srgb",B.keyword,"bgra8unorm_srgb"),rgb10a2unorm:new F("rgb10a2unorm",B.keyword,"rgb10a2unorm"),rg11b10float:new F("rg11b10float",B.keyword,"rg11b10float"),rg32uint:new F("rg32uint",B.keyword,"rg32uint"),rg32sint:new F("rg32sint",B.keyword,"rg32sint"),rg32float:new F("rg32float",B.keyword,"rg32float"),rgba16uint:new F("rgba16uint",B.keyword,"rgba16uint"),rgba16sint:new F("rgba16sint",B.keyword,"rgba16sint"),rgba16float:new F("rgba16float",B.keyword,"rgba16float"),rgba32uint:new F("rgba32uint",B.keyword,"rgba32uint"),rgba32sint:new F("rgba32sint",B.keyword,"rgba32sint"),rgba32float:new F("rgba32float",B.keyword,"rgba32float"),static_assert:new F("static_assert",B.keyword,"static_assert")},S.tokens={decimal_float_literal:new F("decimal_float_literal",B.token,/((-?[0-9]*\.[0-9]+|-?[0-9]+\.[0-9]*)((e|E)(\+|-)?[0-9]+)?[fh]?)|(-?[0-9]+(e|E)(\+|-)?[0-9]+[fh]?)|(-?[0-9]+[fh])/),hex_float_literal:new F("hex_float_literal",B.token,/-?0x((([0-9a-fA-F]*\.[0-9a-fA-F]+|[0-9a-fA-F]+\.[0-9a-fA-F]*)((p|P)(\+|-)?[0-9]+[fh]?)?)|([0-9a-fA-F]+(p|P)(\+|-)?[0-9]+[fh]?))/),int_literal:new F("int_literal",B.token,/-?0x[0-9a-fA-F]+|0i?|-?[1-9][0-9]*i?/),uint_literal:new F("uint_literal",B.token,/0x[0-9a-fA-F]+u|0u|[1-9][0-9]*u/),name:new F("name",B.token,/([_\p{XID_Start}][\p{XID_Continue}]+)|([\p{XID_Start}])/u),ident:new F("ident",B.token,/[_a-zA-Z][0-9a-zA-Z_]*/),and:new F("and",B.token,"&"),and_and:new F("and_and",B.token,"&&"),arrow:new F("arrow ",B.token,"->"),attr:new F("attr",B.token,"@"),forward_slash:new F("forward_slash",B.token,"/"),bang:new F("bang",B.token,"!"),bracket_left:new F("bracket_left",B.token,"["),bracket_right:new F("bracket_right",B.token,"]"),brace_left:new F("brace_left",B.token,"{"),brace_right:new F("brace_right",B.token,"}"),colon:new F("colon",B.token,":"),comma:new F("comma",B.token,","),equal:new F("equal",B.token,"="),equal_equal:new F("equal_equal",B.token,"=="),not_equal:new F("not_equal",B.token,"!="),greater_than:new F("greater_than",B.token,">"),greater_than_equal:new F("greater_than_equal",B.token,">="),shift_right:new F("shift_right",B.token,">>"),less_than:new F("less_than",B.token,"<"),less_than_equal:new F("less_than_equal",B.token,"<="),shift_left:new F("shift_left",B.token,"<<"),modulo:new F("modulo",B.token,"%"),minus:new F("minus",B.token,"-"),minus_minus:new F("minus_minus",B.token,"--"),period:new F("period",B.token,"."),plus:new F("plus",B.token,"+"),plus_plus:new F("plus_plus",B.token,"++"),or:new F("or",B.token,"|"),or_or:new F("or_or",B.token,"||"),paren_left:new F("paren_left",B.token,"("),paren_right:new F("paren_right",B.token,")"),semicolon:new F("semicolon",B.token,";"),star:new F("star",B.token,"*"),tilde:new F("tilde",B.token,"~"),underscore:new F("underscore",B.token,"_"),xor:new F("xor",B.token,"^"),plus_equal:new F("plus_equal",B.token,"+="),minus_equal:new F("minus_equal",B.token,"-="),times_equal:new F("times_equal",B.token,"*="),division_equal:new F("division_equal",B.token,"/="),modulo_equal:new F("modulo_equal",B.token,"%="),and_equal:new F("and_equal",B.token,"&="),or_equal:new F("or_equal",B.token,"|="),xor_equal:new F("xor_equal",B.token,"^="),shift_right_equal:new F("shift_right_equal",B.token,">>="),shift_left_equal:new F("shift_left_equal",B.token,"<<=")},S.simpleTokens={"@":H.tokens.attr,"{":H.tokens.brace_left,"}":H.tokens.brace_right,":":H.tokens.colon,",":H.tokens.comma,"(":H.tokens.paren_left,")":H.tokens.paren_right,";":H.tokens.semicolon},S.literalTokens={"&":H.tokens.and,"&&":H.tokens.and_and,"->":H.tokens.arrow,"/":H.tokens.forward_slash,"!":H.tokens.bang,"[":H.tokens.bracket_left,"]":H.tokens.bracket_right,"=":H.tokens.equal,"==":H.tokens.equal_equal,"!=":H.tokens.not_equal,">":H.tokens.greater_than,">=":H.tokens.greater_than_equal,">>":H.tokens.shift_right,"<":H.tokens.less_than,"<=":H.tokens.less_than_equal,"<<":H.tokens.shift_left,"%":H.tokens.modulo,"-":H.tokens.minus,"--":H.tokens.minus_minus,".":H.tokens.period,"+":H.tokens.plus,"++":H.tokens.plus_plus,"|":H.tokens.or,"||":H.tokens.or_or,"*":H.tokens.star,"~":H.tokens.tilde,_:H.tokens.underscore,"^":H.tokens.xor,"+=":H.tokens.plus_equal,"-=":H.tokens.minus_equal,"*=":H.tokens.times_equal,"/=":H.tokens.division_equal,"%=":H.tokens.modulo_equal,"&=":H.tokens.and_equal,"|=":H.tokens.or_equal,"^=":H.tokens.xor_equal,">>=":H.tokens.shift_right_equal,"<<=":H.tokens.shift_left_equal},S.regexTokens={decimal_float_literal:H.tokens.decimal_float_literal,hex_float_literal:H.tokens.hex_float_literal,int_literal:H.tokens.int_literal,uint_literal:H.tokens.uint_literal,ident:H.tokens.ident},S.storage_class=[H.keywords.function,H.keywords.private,H.keywords.workgroup,H.keywords.uniform,H.keywords.storage],S.access_mode=[H.keywords.read,H.keywords.write,H.keywords.read_write],S.sampler_type=[H.keywords.sampler,H.keywords.sampler_comparison],S.sampled_texture_type=[H.keywords.texture_1d,H.keywords.texture_2d,H.keywords.texture_2d_array,H.keywords.texture_3d,H.keywords.texture_cube,H.keywords.texture_cube_array],S.multisampled_texture_type=[H.keywords.texture_multisampled_2d],S.storage_texture_type=[H.keywords.texture_storage_1d,H.keywords.texture_storage_2d,H.keywords.texture_storage_2d_array,H.keywords.texture_storage_3d],S.depth_texture_type=[H.keywords.texture_depth_2d,H.keywords.texture_depth_2d_array,H.keywords.texture_depth_cube,H.keywords.texture_depth_cube_array,H.keywords.texture_depth_multisampled_2d],S.texture_external_type=[H.keywords.texture_external],S.any_texture_type=[...H.sampled_texture_type,...H.multisampled_texture_type,...H.storage_texture_type,...H.depth_texture_type,...H.texture_external_type],S.texel_format=[H.keywords.r8unorm,H.keywords.r8snorm,H.keywords.r8uint,H.keywords.r8sint,H.keywords.r16uint,H.keywords.r16sint,H.keywords.r16float,H.keywords.rg8unorm,H.keywords.rg8snorm,H.keywords.rg8uint,H.keywords.rg8sint,H.keywords.r32uint,H.keywords.r32sint,H.keywords.r32float,H.keywords.rg16uint,H.keywords.rg16sint,H.keywords.rg16float,H.keywords.rgba8unorm,H.keywords.rgba8unorm_srgb,H.keywords.rgba8snorm,H.keywords.rgba8uint,H.keywords.rgba8sint,H.keywords.bgra8unorm,H.keywords.bgra8unorm_srgb,H.keywords.rgb10a2unorm,H.keywords.rg11b10float,H.keywords.rg32uint,H.keywords.rg32sint,H.keywords.rg32float,H.keywords.rgba16uint,H.keywords.rgba16sint,H.keywords.rgba16float,H.keywords.rgba32uint,H.keywords.rgba32sint,H.keywords.rgba32float],S.const_literal=[H.tokens.int_literal,H.tokens.uint_literal,H.tokens.decimal_float_literal,H.tokens.hex_float_literal,H.keywords.true,H.keywords.false],S.literal_or_ident=[H.tokens.ident,H.tokens.int_literal,H.tokens.uint_literal,H.tokens.decimal_float_literal,H.tokens.hex_float_literal,H.tokens.name],S.element_count_expression=[H.tokens.int_literal,H.tokens.uint_literal,H.tokens.ident],S.template_types=[H.keywords.vec2,H.keywords.vec3,H.keywords.vec4,H.keywords.mat2x2,H.keywords.mat2x3,H.keywords.mat2x4,H.keywords.mat3x2,H.keywords.mat3x3,H.keywords.mat3x4,H.keywords.mat4x2,H.keywords.mat4x3,H.keywords.mat4x4,H.keywords.atomic,H.keywords.bitcast,...H.any_texture_type],S.attribute_name=[H.tokens.ident,H.keywords.block,H.keywords.diagnostic],S.assignment_operators=[H.tokens.equal,H.tokens.plus_equal,H.tokens.minus_equal,H.tokens.times_equal,H.tokens.division_equal,H.tokens.modulo_equal,H.tokens.and_equal,H.tokens.or_equal,H.tokens.xor_equal,H.tokens.shift_right_equal,H.tokens.shift_left_equal],S.increment_operators=[H.tokens.plus_plus,H.tokens.minus_minus];class iT{constructor(e,t,r,i,a){this.type=e,this.lexeme=t,this.line=r,this.start=i,this.end=a}toString(){return this.lexeme}isTemplateType(){return S.template_types.indexOf(this.type)!=-1}isArrayType(){return this.type==S.keywords.array}isArrayOrTemplateType(){return this.isArrayType()||this.isTemplateType()}}class U6{constructor(e){this._tokens=[],this._start=0,this._current=0,this._line=1,this._source=e??""}scanTokens(){for(;!this._isAtEnd();)if(this._start=this._current,!this.scanToken())throw`Invalid syntax at line ${this._line}`;return this._tokens.push(new iT(S.eof,"",this._line,this._current,this._current)),this._tokens}scanToken(){let e=this._advance();if(e==`
`)return this._line++,!0;if(this._isWhitespace(e))return!0;if(e=="/"){if(this._peekAhead()=="/"){for(;e!=`
`;){if(this._isAtEnd())return!0;e=this._advance()}return this._line++,!0}if(this._peekAhead()=="*"){this._advance();let l=1;for(;l>0;){if(this._isAtEnd())return!0;if(e=this._advance(),e==`
`)this._line++;else if(e=="*"){if(this._peekAhead()=="/"&&(this._advance(),l--,l==0))return!0}else e=="/"&&this._peekAhead()=="*"&&(this._advance(),l++)}return!0}}const t=S.simpleTokens[e];if(t)return this._addToken(t),!0;let r=S.none;const i=this._isAlpha(e),a=e==="_";if(this._isAlphaNumeric(e)){let l=this._peekAhead();for(;this._isAlphaNumeric(l);)e+=this._advance(),l=this._peekAhead()}if(i){const l=S.keywords[e];if(l)return this._addToken(l),!0}if(i||a)return this._addToken(S.tokens.ident),!0;for(;;){let l=this._findType(e);const c=this._peekAhead();if(e=="-"&&this._tokens.length>0){if(c=="=")return this._current++,e+=c,this._addToken(S.tokens.minus_equal),!0;if(c=="-")return this._current++,e+=c,this._addToken(S.tokens.minus_minus),!0;const f=this._tokens.length-1;if((S.literal_or_ident.indexOf(this._tokens[f].type)!=-1||this._tokens[f].type==S.tokens.paren_right)&&c!=">")return this._addToken(l),!0}if(e==">"&&(c==">"||c=="=")){let f=!1,d=this._tokens.length-1;for(let p=0;p<5&&d>=0&&S.assignment_operators.indexOf(this._tokens[d].type)===-1;++p,--d)if(this._tokens[d].type===S.tokens.less_than){d>0&&this._tokens[d-1].isArrayOrTemplateType()&&(f=!0);break}if(f)return this._addToken(l),!0}if(l===S.none){let f=e,d=0;const p=2;for(let _=0;_<p;++_)if(f+=this._peekAhead(_),l=this._findType(f),l!==S.none){d=_;break}if(l===S.none)return r!==S.none&&(this._current--,this._addToken(r),!0);e=f,this._current+=d+1}if(r=l,this._isAtEnd())break;e+=this._advance()}return r!==S.none&&(this._addToken(r),!0)}_findType(e){for(const r in S.regexTokens){const i=S.regexTokens[r];if(this._match(e,i.rule))return i}return S.literalTokens[e]||S.none}_match(e,t){const r=t.exec(e);return r&&r.index==0&&r[0]==e}_isAtEnd(){return this._current>=this._source.length}_isAlpha(e){return!this._isNumeric(e)&&!this._isWhitespace(e)&&e!=="_"&&e!=="."&&e!=="("&&e!==")"&&e!=="["&&e!=="]"&&e!=="{"&&e!=="}"&&e!==","&&e!==";"&&e!==":"&&e!=="="&&e!=="!"&&e!=="<"&&e!==">"&&e!=="+"&&e!=="-"&&e!=="*"&&e!=="/"&&e!=="%"&&e!=="&"&&e!=="|"&&e!=="^"&&e!=="~"&&e!=="@"&&e!=="#"&&e!=="?"&&e!=="'"&&e!=="`"&&e!=='"'&&e!=="\\"&&e!==`
`&&e!=="\r"&&e!=="	"&&e!=="\0"}_isNumeric(e){return e>="0"&&e<="9"}_isAlphaNumeric(e){return this._isAlpha(e)||this._isNumeric(e)||e==="_"}_isWhitespace(e){return e==" "||e=="	"||e=="\r"}_advance(e=0){let t=this._source[this._current];return e=e||0,e++,this._current+=e,t}_peekAhead(e=0){return e=e||0,this._current+e>=this._source.length?"\0":this._source[this._current+e]}_addToken(e){const t=this._source.substring(this._start,this._current);this._tokens.push(new iT(e,t,this._line,this._start,this._current))}}function ue(n){return Array.isArray(n)||(n==null?void 0:n.buffer)instanceof ArrayBuffer}const lf=new Float32Array(1),B6=new Uint32Array(lf.buffer),F6=new Uint32Array(lf.buffer),cf=new Int32Array(1),L6=new Float32Array(cf.buffer),z6=new Uint32Array(cf.buffer),uf=new Uint32Array(1),V6=new Float32Array(uf.buffer),H6=new Int32Array(uf.buffer);function sT(n,e,t){if(e===t)return n;if(e==="f32"){if(t==="i32"||t==="x32")return lf[0]=n,B6[0];if(t==="u32")return lf[0]=n,F6[0]}else if(e==="i32"||e==="x32"){if(t==="f32")return cf[0]=n,L6[0];if(t==="u32")return cf[0]=n,z6[0]}else if(e==="u32"){if(t==="f32")return uf[0]=n,V6[0];if(t==="i32"||t==="x32")return uf[0]=n,H6[0]}return console.error(`Unsupported cast from ${e} to ${t}`),n}class j6{constructor(e){this.resources=null,this.inUse=!1,this.info=null,this.node=e}}class cu{constructor(e,t){this.align=e,this.size=t}}class tr{constructor(){this.uniforms=[],this.storage=[],this.textures=[],this.samplers=[],this.aliases=[],this.overrides=[],this.structs=[],this.entry=new E6,this.functions=[],this._types=new Map,this._functions=new Map}_isStorageTexture(e){return e.name=="texture_storage_1d"||e.name=="texture_storage_2d"||e.name=="texture_storage_2d_array"||e.name=="texture_storage_3d"}updateAST(e){for(const t of e)t instanceof wl&&this._functions.set(t.name,new j6(t));for(const t of e)if(t instanceof Ar){const r=this.getTypeInfo(t,null);r instanceof fi&&this.structs.push(r)}for(const t of e)if(t instanceof K_)this.aliases.push(this._getAliasInfo(t));else if(t instanceof Y_){const r=t,i=this._getAttributeNum(r.attributes,"id",0),a=r.type!=null?this.getTypeInfo(r.type,r.attributes):null;this.overrides.push(new x6(r.name,a,r.attributes,i))}else if(this._isUniformVar(t)){const r=t,i=this._getAttributeNum(r.attributes,"group",0),a=this._getAttributeNum(r.attributes,"binding",0),l=this.getTypeInfo(r.type,r.attributes),c=new lu(r.name,l,i,a,r.attributes,oi.Uniform,r.access);c.access||(c.access="read"),this.uniforms.push(c)}else if(this._isStorageVar(t)){const r=t,i=this._getAttributeNum(r.attributes,"group",0),a=this._getAttributeNum(r.attributes,"binding",0),l=this.getTypeInfo(r.type,r.attributes),c=this._isStorageTexture(l),f=new lu(r.name,l,i,a,r.attributes,c?oi.StorageTexture:oi.Storage,r.access);f.access||(f.access="read"),this.storage.push(f)}else if(this._isTextureVar(t)){const r=t,i=this._getAttributeNum(r.attributes,"group",0),a=this._getAttributeNum(r.attributes,"binding",0),l=this.getTypeInfo(r.type,r.attributes),c=this._isStorageTexture(l),f=new lu(r.name,l,i,a,r.attributes,c?oi.StorageTexture:oi.Texture,r.access);f.access||(f.access="read"),c?this.storage.push(f):this.textures.push(f)}else if(this._isSamplerVar(t)){const r=t,i=this._getAttributeNum(r.attributes,"group",0),a=this._getAttributeNum(r.attributes,"binding",0),l=this.getTypeInfo(r.type,r.attributes),c=new lu(r.name,l,i,a,r.attributes,oi.Sampler,r.access);this.samplers.push(c)}else if(t instanceof wl){const r=this._getAttribute(t,"vertex"),i=this._getAttribute(t,"fragment"),a=this._getAttribute(t,"compute"),l=r||i||a,c=new A6(t.name,l==null?void 0:l.name,t.attributes);c.attributes=t.attributes,c.startLine=t.startLine,c.endLine=t.endLine,this.functions.push(c),this._functions.get(t.name).info=c,l&&(this._functions.get(t.name).inUse=!0,c.inUse=!0,c.resources=this._findResources(t,!!l),c.inputs=this._getInputs(t.args),c.outputs=this._getOutputs(t.returnType),this.entry[l.name].push(c)),c.arguments=t.args.map(f=>new S6(f.name,this.getTypeInfo(f.type,f.attributes),f.attributes)),c.returnType=t.returnType?this.getTypeInfo(t.returnType,t.attributes):null}for(const t of this._functions.values())t.info&&(t.info.inUse=t.inUse,this._addCalls(t.node,t.info.calls));for(const t of this._functions.values())t.node.search(r=>{var i,a,l;if(r instanceof Xw){if(r.value)if(ue(r.value))for(const c of r.value)for(const f of this.overrides)c===f.name&&((i=t.info)===null||i===void 0||i.overrides.push(f));else for(const c of this.overrides)r.value===c.name&&((a=t.info)===null||a===void 0||a.overrides.push(c))}else if(r instanceof dn)for(const c of this.overrides)r.name===c.name&&((l=t.info)===null||l===void 0||l.overrides.push(c))});for(const t of this.uniforms)this._markStructsInUse(t.type);for(const t of this.storage)this._markStructsInUse(t.type)}getStructInfo(e){for(const t of this.structs)if(t.name==e)return t;return null}getOverrideInfo(e){for(const t of this.overrides)if(t.name==e)return t;return null}_markStructsInUse(e){if(e)if(e.isStruct){if(e.inUse=!0,e.members)for(const t of e.members)this._markStructsInUse(t.type)}else if(e.isArray)this._markStructsInUse(e.format);else if(e.isTemplate)e.format&&this._markStructsInUse(e.format);else{const t=this._getAlias(e.name);t&&this._markStructsInUse(t)}}_addCalls(e,t){var r;for(const i of e.calls){const a=(r=this._functions.get(i.name))===null||r===void 0?void 0:r.info;a&&t.add(a)}}findResource(e,t,r){if(r){for(const i of this.entry.compute)if(i.name===r){for(const a of i.resources)if(a.group==e&&a.binding==t)return a}for(const i of this.entry.vertex)if(i.name===r){for(const a of i.resources)if(a.group==e&&a.binding==t)return a}for(const i of this.entry.fragment)if(i.name===r){for(const a of i.resources)if(a.group==e&&a.binding==t)return a}}for(const i of this.uniforms)if(i.group==e&&i.binding==t)return i;for(const i of this.storage)if(i.group==e&&i.binding==t)return i;for(const i of this.textures)if(i.group==e&&i.binding==t)return i;for(const i of this.samplers)if(i.group==e&&i.binding==t)return i;return null}_findResource(e){for(const t of this.uniforms)if(t.name==e)return t;for(const t of this.storage)if(t.name==e)return t;for(const t of this.textures)if(t.name==e)return t;for(const t of this.samplers)if(t.name==e)return t;return null}_markStructsFromAST(e){const t=this.getTypeInfo(e,null);this._markStructsInUse(t)}_findResources(e,t){const r=[],i=this,a=[];return e.search(l=>{if(l instanceof af)a.push({});else if(l instanceof of)a.pop();else if(l instanceof Cr){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type),a.length>0&&(a[a.length-1][c.name]=c)}else if(l instanceof Qn){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type)}else if(l instanceof ol){const c=l;t&&c.type!==null&&this._markStructsFromAST(c.type),a.length>0&&(a[a.length-1][c.name]=c)}else if(l instanceof dn){const c=l;if(a.length>0&&a[a.length-1][c.name])return;const f=i._findResource(c.name);f&&r.push(f)}else if(l instanceof Z_){const c=l,f=i._functions.get(c.name);f&&(t&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=i._findResources(f.node,t)),r.push(...f.resources))}else if(l instanceof q_){const c=l,f=i._functions.get(c.name);f&&(t&&(f.inUse=!0),e.calls.add(f.node),f.resources===null&&(f.resources=i._findResources(f.node,t)),r.push(...f.resources))}}),[...new Map(r.map(l=>[l.name,l])).values()]}getBindGroups(){const e=[];function t(r,i){r>=e.length&&(e.length=r+1),e[r]===void 0&&(e[r]=[]),i>=e[r].length&&(e[r].length=i+1)}for(const r of this.uniforms)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.storage)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.textures)t(r.group,r.binding),e[r.group][r.binding]=r;for(const r of this.samplers)t(r.group,r.binding),e[r.group][r.binding]=r;return e}_getOutputs(e,t=void 0){if(t===void 0&&(t=[]),e instanceof Ar)this._getStructOutputs(e,t);else{const r=this._getOutputInfo(e);r!==null&&t.push(r)}return t}_getStructOutputs(e,t){for(const r of e.members)if(r.type instanceof Ar)this._getStructOutputs(r.type,t);else{const i=this._getAttribute(r,"location")||this._getAttribute(r,"builtin");if(i!==null){const a=this.getTypeInfo(r.type,r.type.attributes),l=this._parseInt(i.value),c=new J1(r.name,a,i.name,l);t.push(c)}}}_getOutputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const r=this.getTypeInfo(e,e.attributes),i=this._parseInt(t.value);return new J1("",r,t.name,i)}return null}_getInputs(e,t=void 0){t===void 0&&(t=[]);for(const r of e)if(r.type instanceof Ar)this._getStructInputs(r.type,t);else{const i=this._getInputInfo(r);i!==null&&t.push(i)}return t}_getStructInputs(e,t){for(const r of e.members)if(r.type instanceof Ar)this._getStructInputs(r.type,t);else{const i=this._getInputInfo(r);i!==null&&t.push(i)}}_getInputInfo(e){const t=this._getAttribute(e,"location")||this._getAttribute(e,"builtin");if(t!==null){const r=this._getAttribute(e,"interpolation"),i=this.getTypeInfo(e.type,e.attributes),a=this._parseInt(t.value),l=new w6(e.name,i,t.name,a);return r!==null&&(l.interpolation=this._parseString(r.value)),l}return null}_parseString(e){return e instanceof Array&&(e=e[0]),e}_parseInt(e){e instanceof Array&&(e=e[0]);const t=parseInt(e);return isNaN(t)?e:t}_getAlias(e){for(const t of this.aliases)if(t.name==e)return t.type;return null}_getAliasInfo(e){return new T6(e.name,this.getTypeInfo(e.type,null))}getTypeInfoByName(e){for(const t of this.structs)if(t.name==e)return t;for(const t of this.aliases)if(t.name==e)return t.type;return null}getTypeInfo(e,t=null){if(this._types.has(e))return this._types.get(e);if(e instanceof ll){const i=e,a=i.format?this.getTypeInfo(i.format,i.attributes):null,l=new gi(i.name,t);return l.format=a,l.count=i.count,this._types.set(e,l),this._updateTypeInfo(l),l}if(e instanceof Ar){const i=e,a=new fi(i.name,t);a.startLine=i.startLine,a.endLine=i.endLine;for(const l of i.members){const c=this.getTypeInfo(l.type,l.attributes);a.members.push(new G1(l.name,c,l.attributes))}return this._types.set(e,a),this._updateTypeInfo(a),a}if(e instanceof tl){const i=e,a=i.format instanceof J,l=i.format?a?this.getTypeInfo(i.format,null):new En(i.format,null):null,c=new es(i.name,l,t,i.access);return this._types.set(e,c),this._updateTypeInfo(c),c}if(e instanceof z){const i=e,a=i.format?this.getTypeInfo(i.format,null):null,l=new es(i.name,a,t,i.access);return this._types.set(e,l),this._updateTypeInfo(l),l}const r=new En(e.name,t);return this._types.set(e,r),this._updateTypeInfo(r),r}_updateTypeInfo(e){var t,r,i;const a=this._getTypeSize(e);if(e.size=(t=a==null?void 0:a.size)!==null&&t!==void 0?t:0,e instanceof gi&&e.format){const l=this._getTypeSize(e.format);e.stride=Math.max((r=l==null?void 0:l.size)!==null&&r!==void 0?r:0,(i=l==null?void 0:l.align)!==null&&i!==void 0?i:0),this._updateTypeInfo(e.format)}e instanceof fi&&this._updateStructInfo(e)}_updateStructInfo(e){var t;let r=0,i=0,a=0,l=0;for(let c=0,f=e.members.length;c<f;++c){const d=e.members[c],p=this._getTypeSize(d);if(!p)continue;(t=this._getAlias(d.type.name))!==null&&t!==void 0||d.type;const _=p.align,y=p.size;r=this._roundUp(_,r+i),i=y,a=r,l=Math.max(l,_),d.offset=r,d.size=y,this._updateTypeInfo(d.type)}e.size=this._roundUp(l,a+i),e.align=l}_getTypeSize(e){var t,r;if(e==null)return null;const i=this._getAttributeNum(e.attributes,"size",0),a=this._getAttributeNum(e.attributes,"align",0);if(e instanceof G1&&(e=e.type),e instanceof En){const l=this._getAlias(e.name);l!==null&&(e=l)}{const l=tr._typeInfo[e.name];if(l!==void 0){const c=((t=e.format)===null||t===void 0?void 0:t.name)==="f16"?2:1;return new cu(Math.max(a,l.align/c),Math.max(i,l.size/c))}}{const l=tr._typeInfo[e.name.substring(0,e.name.length-1)];if(l){const c=e.name[e.name.length-1]==="h"?2:1;return new cu(Math.max(a,l.align/c),Math.max(i,l.size/c))}}if(e instanceof gi){let l=e,c=8,f=8;const d=this._getTypeSize(l.format);return d!==null&&(f=d.size,c=d.align),f=l.count*this._getAttributeNum((r=e==null?void 0:e.attributes)!==null&&r!==void 0?r:null,"stride",this._roundUp(c,f)),i&&(f=i),new cu(Math.max(a,c),Math.max(i,f))}if(e instanceof fi){let l=0,c=0,f=0,d=0,p=0;for(const _ of e.members){const y=this._getTypeSize(_.type);y!==null&&(l=Math.max(y.align,l),f=this._roundUp(y.align,f+d),d=y.size,p=f)}return c=this._roundUp(l,p+d),new cu(Math.max(a,l),Math.max(i,c))}return null}_isUniformVar(e){return e instanceof Cr&&e.storage=="uniform"}_isStorageVar(e){return e instanceof Cr&&e.storage=="storage"}_isTextureVar(e){return e instanceof Cr&&e.type!==null&&tr._textureTypes.indexOf(e.type.name)!=-1}_isSamplerVar(e){return e instanceof Cr&&e.type!==null&&tr._samplerTypes.indexOf(e.type.name)!=-1}_getAttribute(e,t){const r=e;if(!r||!r.attributes)return null;const i=r.attributes;for(let a of i)if(a.name==t)return a;return null}_getAttributeNum(e,t,r){if(e===null)return r;for(let i of e)if(i.name==t){let a=i!==null&&i.value!==null?i.value:r;return a instanceof Array&&(a=a[0]),typeof a=="number"?a:typeof a=="string"?parseInt(a):r}return r}_roundUp(e,t){return Math.ceil(t/e)*e}}tr._typeInfo={f16:{align:2,size:2},i32:{align:4,size:4},u32:{align:4,size:4},f32:{align:4,size:4},atomic:{align:4,size:4},vec2:{align:8,size:8},vec3:{align:16,size:12},vec4:{align:16,size:16},mat2x2:{align:8,size:16},mat3x2:{align:8,size:24},mat4x2:{align:8,size:32},mat2x3:{align:16,size:32},mat3x3:{align:16,size:48},mat4x3:{align:16,size:64},mat2x4:{align:16,size:32},mat3x4:{align:16,size:48},mat4x4:{align:16,size:64}},tr._textureTypes=S.any_texture_type.map(n=>n.name),tr._samplerTypes=S.sampler_type.map(n=>n.name);class Q_{constructor(e,t,r){this.name=e,this.value=t,this.node=r}clone(){return new Q_(this.name,this.value,this.node)}}class G_{constructor(e){this.name=e.name,this.node=e}clone(){return new G_(this.node)}}class J_{constructor(e){this.parent=null,this.variables=new Map,this.functions=new Map,this.currentFunctionName="",e&&(this.parent=e,this.currentFunctionName=e.currentFunctionName)}getVariable(e){var t;return this.variables.has(e)?(t=this.variables.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getVariable(e):null}getFunction(e){var t;return this.functions.has(e)?(t=this.functions.get(e))!==null&&t!==void 0?t:null:this.parent?this.parent.getFunction(e):null}createVariable(e,t,r){this.variables.set(e,new Q_(e,t,r??null))}setVariable(e,t,r){const i=this.getVariable(e);i!==null?i.value=t:this.createVariable(e,t,r)}getVariableValue(e){var t;const r=this.getVariable(e);return(t=r==null?void 0:r.value)!==null&&t!==void 0?t:null}clone(){return new J_(this)}}class $6{evalExpression(e,t){return null}getTypeInfo(e){return null}getVariableName(e,t){return""}}class W6{constructor(e){this.exec=e}getTypeInfo(e){return this.exec.getTypeInfo(e)}All(e,t){const r=this.exec.evalExpression(e.args[0],t);let i=!0;if(r instanceof M)return r.data.forEach(a=>{a||(i=!1)}),new U(i?1:0,this.getTypeInfo("bool"));throw new Error(`All() expects a vector argument. Line ${e.line}`)}Any(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M){const i=r.data.some(a=>a);return new U(i?1:0,this.getTypeInfo("bool"))}throw new Error(`Any() expects a vector argument. Line ${e.line}`)}Select(e,t){const r=this.exec.evalExpression(e.args[2],t);if(!(r instanceof U))throw new Error(`Select() expects a bool condition. Line ${e.line}`);return r.value?this.exec.evalExpression(e.args[1],t):this.exec.evalExpression(e.args[0],t)}ArrayLength(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.evalExpression(r,t);if(i instanceof ut&&i.typeInfo.size===0){const a=i.typeInfo,l=i.buffer.byteLength/a.stride;return new U(l,this.getTypeInfo("u32"))}return new U(i.typeInfo.size,this.getTypeInfo("u32"))}Abs(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.abs(a)),r.typeInfo);const i=r;return new U(Math.abs(i.value),i.typeInfo)}Acos(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.acos(a)),r.typeInfo);const i=r;return new U(Math.acos(i.value),r.typeInfo)}Acosh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.acosh(a)),r.typeInfo);const i=r;return new U(Math.acosh(i.value),r.typeInfo)}Asin(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.asin(a)),r.typeInfo);const i=r;return new U(Math.asin(i.value),r.typeInfo)}Asinh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.asinh(a)),r.typeInfo);const i=r;return new U(Math.asinh(i.value),r.typeInfo)}Atan(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.atan(a)),r.typeInfo);const i=r;return new U(Math.atan(i.value),r.typeInfo)}Atanh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.atanh(a)),r.typeInfo);const i=r;return new U(Math.atanh(i.value),r.typeInfo)}Atan2(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M)return new M(r.data.map((c,f)=>Math.atan2(c,i.data[f])),r.typeInfo);const a=r,l=i;return new U(Math.atan2(a.value,l.value),r.typeInfo)}Ceil(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.ceil(a)),r.typeInfo);const i=r;return new U(Math.ceil(i.value),r.typeInfo)}_clamp(e,t,r){return Math.min(Math.max(e,t),r)}Clamp(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(r instanceof M&&i instanceof M&&a instanceof M)return new M(r.data.map((d,p)=>this._clamp(d,i.data[p],a.data[p])),r.typeInfo);const l=r,c=i,f=a;return new U(this._clamp(l.value,c.value,f.value),r.typeInfo)}Cos(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.cos(a)),r.typeInfo);const i=r;return new U(Math.cos(i.value),r.typeInfo)}Cosh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.cosh(a)),r.typeInfo);const i=r;return new U(Math.cos(i.value),r.typeInfo)}CountLeadingZeros(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.clz32(a)),r.typeInfo);const i=r;return new U(Math.clz32(i.value),r.typeInfo)}_countOneBits(e){let t=0;for(;e!==0;)1&e&&t++,e>>=1;return t}CountOneBits(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>this._countOneBits(a)),r.typeInfo);const i=r;return new U(this._countOneBits(i.value),r.typeInfo)}_countTrailingZeros(e){if(e===0)return 32;let t=0;for(;!(1&e);)e>>=1,t++;return t}CountTrailingZeros(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>this._countTrailingZeros(a)),r.typeInfo);const i=r;return new U(this._countTrailingZeros(i.value),r.typeInfo)}Cross(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M){if(r.data.length!==3||i.data.length!==3)return console.error(`Cross() expects 3D vectors. Line ${e.line}`),null;const a=r.data,l=i.data;return new M([a[1]*l[2]-l[1]*a[2],a[2]*l[0]-l[2]*a[0],a[0]*l[1]-l[0]*a[1]],r.typeInfo)}return console.error(`Cross() expects vector arguments. Line ${e.line}`),null}Degrees(e,t){const r=this.exec.evalExpression(e.args[0],t),i=180/Math.PI;return r instanceof M?new M(r.data.map(a=>a*i),r.typeInfo):new U(r.value*i,this.getTypeInfo("f32"))}Determinant(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof xe){const i=r.data,a=r.typeInfo.getTypeName(),l=a.endsWith("h")?this.getTypeInfo("f16"):this.getTypeInfo("f32");if(a==="mat2x2"||a==="mat2x2f"||a==="mat2x2h")return new U(i[0]*i[3]-i[1]*i[2],l);if(a==="mat2x3"||a==="mat2x3f"||a==="mat2x3h")return new U(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),l);if(a==="mat2x4"||a==="mat2x4f"||a==="mat2x4h")console.error(`TODO: Determinant for ${a}`);else if(a==="mat3x2"||a==="mat3x2f"||a==="mat3x2h")console.error(`TODO: Determinant for ${a}`);else{if(a==="mat3x3"||a==="mat3x3f"||a==="mat3x3h")return new U(i[0]*(i[4]*i[8]-i[5]*i[7])-i[1]*(i[3]*i[8]-i[5]*i[6])+i[2]*(i[3]*i[7]-i[4]*i[6]),l);a==="mat3x4"||a==="mat3x4f"||a==="mat3x4h"||a==="mat4x2"||a==="mat4x2f"||a==="mat4x2h"||a==="mat4x3"||a==="mat4x3f"||a==="mat4x3h"?console.error(`TODO: Determinant for ${a}`):a!=="mat4x4"&&a!=="mat4x4f"&&a!=="mat4x4h"||console.error(`TODO: Determinant for ${a}`)}}return console.error(`Determinant expects a matrix argument. Line ${e.line}`),null}Distance(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M){let c=0;for(let f=0;f<r.data.length;++f)c+=(r.data[f]-i.data[f])*(r.data[f]-i.data[f]);return new U(Math.sqrt(c),this.getTypeInfo("f32"))}const a=r,l=i;return new U(Math.abs(a.value-l.value),r.typeInfo)}_dot(e,t){let r=0;for(let i=0;i<e.length;++i)r+=t[i]*e[i];return r}Dot(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);return r instanceof M&&i instanceof M?new U(this._dot(r.data,i.data),this.getTypeInfo("f32")):(console.error(`Dot() expects vector arguments. Line ${e.line}`),null)}Dot4U8Packed(e,t){return console.error(`TODO: dot4U8Packed. Line ${e.line}`),null}Dot4I8Packed(e,t){return console.error(`TODO: dot4I8Packed. Line ${e.line}`),null}Exp(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.exp(a)),r.typeInfo);const i=r;return new U(Math.exp(i.value),r.typeInfo)}Exp2(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.pow(2,a)),r.typeInfo);const i=r;return new U(Math.pow(2,i.value),r.typeInfo)}ExtractBits(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(i.typeInfo.name!=="u32"&&i.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 offset argument. Line ${e.line}`),null;if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 count argument. Line ${e.line}`),null;const l=i.value,c=a.value;if(r instanceof M)return new M(r.data.map(d=>d>>l&(1<<c)-1),r.typeInfo);if(r.typeInfo.name!=="i32"&&r.typeInfo.name!=="x32")return console.error(`ExtractBits() expects an i32 argument. Line ${e.line}`),null;const f=r.value;return new U(f>>l&(1<<c)-1,this.getTypeInfo("i32"))}FaceForward(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(r instanceof M&&i instanceof M&&a instanceof M){const l=this._dot(i.data,a.data);return new M(l<0?Array.from(r.data):r.data.map(c=>-c),r.typeInfo)}return console.error(`FaceForward() expects vector arguments. Line ${e.line}`),null}_firstLeadingBit(e){return e===0?-1:31-Math.clz32(e)}FirstLeadingBit(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>this._firstLeadingBit(a)),r.typeInfo);const i=r;return new U(this._firstLeadingBit(i.value),r.typeInfo)}_firstTrailingBit(e){return e===0?-1:Math.log2(e&-e)}FirstTrailingBit(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>this._firstTrailingBit(a)),r.typeInfo);const i=r;return new U(this._firstTrailingBit(i.value),r.typeInfo)}Floor(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.floor(a)),r.typeInfo);const i=r;return new U(Math.floor(i.value),r.typeInfo)}Fma(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(r instanceof M&&i instanceof M&&a instanceof M)return r.data.length!==i.data.length||r.data.length!==a.data.length?(console.error(`Fma() expects vectors of the same length. Line ${e.line}`),null):new M(r.data.map((d,p)=>d*i.data[p]+a.data[p]),r.typeInfo);const l=r,c=i,f=a;return new U(l.value*c.value+f.value,l.typeInfo)}Fract(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>a-Math.floor(a)),r.typeInfo);const i=r;return new U(i.value-Math.floor(i.value),r.typeInfo)}Frexp(e,t){return console.error(`TODO: frexp. Line ${e.line}`),null}InsertBits(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t),l=this.exec.evalExpression(e.args[3],t);if(a.typeInfo.name!=="u32"&&a.typeInfo.name!=="x32")return console.error(`InsertBits() expects an i32 offset argument. Line ${e.line}`),null;const c=a.value,f=(1<<l.value)-1<<c,d=~f;if(r instanceof M&&i instanceof M)return new M(r.data.map((y,b)=>y&d|i.data[b]<<c&f),r.typeInfo);const p=r.value,_=i.value;return new U(p&d|_<<c&f,r.typeInfo)}InverseSqrt(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>1/Math.sqrt(a)),r.typeInfo);const i=r;return new U(1/Math.sqrt(i.value),r.typeInfo)}Ldexp(e,t){return console.error(`TODO: ldexp. Line ${e.line}`),null}Length(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M){let a=0;return r.data.forEach(l=>{a+=l*l}),new U(Math.sqrt(a),this.getTypeInfo("f32"))}const i=r;return new U(Math.abs(i.value),r.typeInfo)}Log(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.log(a)),r.typeInfo);const i=r;return new U(Math.log(i.value),r.typeInfo)}Log2(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.log2(a)),r.typeInfo);const i=r;return new U(Math.log2(i.value),r.typeInfo)}Max(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M)return new M(r.data.map((c,f)=>Math.max(c,i.data[f])),r.typeInfo);const a=r,l=i;return new U(Math.max(a.value,l.value),r.typeInfo)}Min(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M)return new M(r.data.map((c,f)=>Math.min(c,i.data[f])),r.typeInfo);const a=r,l=i;return new U(Math.min(a.value,l.value),r.typeInfo)}Mix(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(r instanceof M&&i instanceof M&&a instanceof M)return new M(r.data.map((f,d)=>r.data[d]*(1-a.data[d])+i.data[d]*a.data[d]),r.typeInfo);const l=i,c=a;return new U(r.value*(1-c.value)+l.value*c.value,r.typeInfo)}Modf(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M)return new M(r.data.map((l,c)=>l%i.data[c]),r.typeInfo);const a=i;return new U(r.value%a.value,r.typeInfo)}Normalize(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M){const i=this.Length(e,t).value;return new M(r.data.map(a=>a/i),r.typeInfo)}return console.error(`Normalize() expects a vector argument. Line ${e.line}`),null}Pow(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M)return new M(r.data.map((c,f)=>Math.pow(c,i.data[f])),r.typeInfo);const a=r,l=i;return new U(Math.pow(a.value,l.value),r.typeInfo)}QuantizeToF16(e,t){const r=this.exec.evalExpression(e.args[0],t);return r instanceof M?new M(r.data.map(i=>i),r.typeInfo):new U(r.value,r.typeInfo)}Radians(e,t){const r=this.exec.evalExpression(e.args[0],t);return r instanceof M?new M(r.data.map(i=>i*Math.PI/180),r.typeInfo):new U(r.value*Math.PI/180,this.getTypeInfo("f32"))}Reflect(e,t){let r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(r instanceof M&&i instanceof M){const a=this._dot(r.data,i.data);return new M(r.data.map((l,c)=>l-2*a*i.data[c]),r.typeInfo)}return console.error(`Reflect() expects vector arguments. Line ${e.line}`),null}Refract(e,t){let r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(r instanceof M&&i instanceof M&&a instanceof U){const l=this._dot(i.data,r.data);return new M(r.data.map((c,f)=>{const d=1-a.value*a.value*(1-l*l);if(d<0)return 0;const p=Math.sqrt(d);return a.value*c-(a.value*l+p)*i.data[f]}),r.typeInfo)}return console.error(`Refract() expects vector arguments and a scalar argument. Line ${e.line}`),null}ReverseBits(e,t){return console.error(`TODO: reverseBits. Line ${e.line}`),null}Round(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.round(a)),r.typeInfo);const i=r;return new U(Math.round(i.value),r.typeInfo)}Saturate(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.min(Math.max(a,0),1)),r.typeInfo);const i=r;return new U(Math.min(Math.max(i.value,0),1),r.typeInfo)}Sign(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.sign(a)),r.typeInfo);const i=r;return new U(Math.sign(i.value),r.typeInfo)}Sin(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.sin(a)),r.typeInfo);const i=r;return new U(Math.sin(i.value),r.typeInfo)}Sinh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.sinh(a)),r.typeInfo);const i=r;return new U(Math.sinh(i.value),r.typeInfo)}_smoothstep(e,t,r){const i=Math.min(Math.max((r-e)/(t-e),0),1);return i*i*(3-2*i)}SmoothStep(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t),a=this.exec.evalExpression(e.args[2],t);if(a instanceof M&&r instanceof M&&i instanceof M)return new M(a.data.map((d,p)=>this._smoothstep(r.data[p],i.data[p],d)),a.typeInfo);const l=r,c=i,f=a;return new U(this._smoothstep(l.value,c.value,f.value),a.typeInfo)}Sqrt(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.sqrt(a)),r.typeInfo);const i=r;return new U(Math.sqrt(i.value),r.typeInfo)}Step(e,t){const r=this.exec.evalExpression(e.args[0],t),i=this.exec.evalExpression(e.args[1],t);if(i instanceof M&&r instanceof M)return new M(i.data.map((l,c)=>l<r.data[c]?0:1),i.typeInfo);const a=r;return new U(i.value<a.value?0:1,a.typeInfo)}Tan(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.tan(a)),r.typeInfo);const i=r;return new U(Math.tan(i.value),r.typeInfo)}Tanh(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.tanh(a)),r.typeInfo);const i=r;return new U(Math.tanh(i.value),r.typeInfo)}_getTransposeType(e){const t=e.getTypeName();return t==="mat2x2f"||t==="mat2x2h"?e:t==="mat2x3f"?this.getTypeInfo("mat3x2f"):t==="mat2x3h"?this.getTypeInfo("mat3x2h"):t==="mat2x4f"?this.getTypeInfo("mat4x2f"):t==="mat2x4h"?this.getTypeInfo("mat4x2h"):t==="mat3x2f"?this.getTypeInfo("mat2x3f"):t==="mat3x2h"?this.getTypeInfo("mat2x3h"):t==="mat3x3f"||t==="mat3x3h"?e:t==="mat3x4f"?this.getTypeInfo("mat4x3f"):t==="mat3x4h"?this.getTypeInfo("mat4x3h"):t==="mat4x2f"?this.getTypeInfo("mat2x4f"):t==="mat4x2h"?this.getTypeInfo("mat2x4h"):t==="mat4x3f"?this.getTypeInfo("mat3x4f"):t==="mat4x3h"?this.getTypeInfo("mat3x4h"):(t==="mat4x4f"||t==="mat4x4h"||console.error(`Invalid matrix type ${t}`),e)}Transpose(e,t){const r=this.exec.evalExpression(e.args[0],t);if(!(r instanceof xe))return console.error(`Transpose() expects a matrix argument. Line ${e.line}`),null;const i=this._getTransposeType(r.typeInfo);if(r.typeInfo.name==="mat2x2"||r.typeInfo.name==="mat2x2f"||r.typeInfo.name==="mat2x2h"){const a=r.data;return new xe([a[0],a[2],a[1],a[3]],i)}if(r.typeInfo.name==="mat2x3"||r.typeInfo.name==="mat2x3f"||r.typeInfo.name==="mat2x3h"){const a=r.data;return new xe([a[0],a[3],a[6],a[1],a[4],a[7]],i)}if(r.typeInfo.name==="mat2x4"||r.typeInfo.name==="mat2x4f"||r.typeInfo.name==="mat2x4h"){const a=r.data;return new xe([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13]],i)}if(r.typeInfo.name==="mat3x2"||r.typeInfo.name==="mat3x2f"||r.typeInfo.name==="mat3x2h"){const a=r.data;return new xe([a[0],a[3],a[1],a[4],a[2],a[5]],i)}if(r.typeInfo.name==="mat3x3"||r.typeInfo.name==="mat3x3f"||r.typeInfo.name==="mat3x3h"){const a=r.data;return new xe([a[0],a[3],a[6],a[1],a[4],a[7],a[2],a[5],a[8]],i)}if(r.typeInfo.name==="mat3x4"||r.typeInfo.name==="mat3x4f"||r.typeInfo.name==="mat3x4h"){const a=r.data;return new xe([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14]],i)}if(r.typeInfo.name==="mat4x2"||r.typeInfo.name==="mat4x2f"||r.typeInfo.name==="mat4x2h"){const a=r.data;return new xe([a[0],a[4],a[1],a[5],a[2],a[6]],i)}if(r.typeInfo.name==="mat4x3"||r.typeInfo.name==="mat4x3f"||r.typeInfo.name==="mat4x3h"){const a=r.data;return new xe([a[0],a[4],a[8],a[1],a[5],a[9],a[2],a[6],a[10]],i)}if(r.typeInfo.name==="mat4x4"||r.typeInfo.name==="mat4x4f"||r.typeInfo.name==="mat4x4h"){const a=r.data;return new xe([a[0],a[4],a[8],a[12],a[1],a[5],a[9],a[13],a[2],a[6],a[10],a[14],a[3],a[7],a[11],a[15]],i)}return console.error(`Invalid matrix type ${r.typeInfo.name}`),null}Trunc(e,t){const r=this.exec.evalExpression(e.args[0],t);if(r instanceof M)return new M(r.data.map(a=>Math.trunc(a)),r.typeInfo);const i=r;return new U(Math.trunc(i.value),r.typeInfo)}Dpdx(e,t){return console.error(`TODO: dpdx. Line ${e.line}`),null}DpdxCoarse(e,t){return console.error(`TODO: dpdxCoarse. Line ${e.line}`),null}DpdxFine(e,t){return console.error("TODO: dpdxFine"),null}Dpdy(e,t){return console.error("TODO: dpdy"),null}DpdyCoarse(e,t){return console.error("TODO: dpdyCoarse"),null}DpdyFine(e,t){return console.error("TODO: dpdyFine"),null}Fwidth(e,t){return console.error("TODO: fwidth"),null}FwidthCoarse(e,t){return console.error("TODO: fwidthCoarse"),null}FwidthFine(e,t){return console.error("TODO: fwidthFine"),null}TextureDimensions(e,t){const r=e.args[0],i=e.args.length>1?this.exec.evalExpression(e.args[1],t).value:0;if(r instanceof dn){const a=r.name,l=t.getVariableValue(a);if(l instanceof Er){if(i<0||i>=l.mipLevelCount)return console.error(`Invalid mip level for textureDimensions. Line ${e.line}`),null;const c=l.getMipLevelSize(i),f=l.dimension;return f==="1d"?new U(c[0],this.getTypeInfo("u32")):f==="3d"?new M(c,this.getTypeInfo("vec3u")):f==="2d"?new M(c.slice(0,2),this.getTypeInfo("vec2u")):(console.error(`Invalid texture dimension ${f} not found. Line ${e.line}`),null)}return console.error(`Texture ${a} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureDimensions. Line ${e.line}`),null}TextureGather(e,t){return console.error("TODO: textureGather"),null}TextureGatherCompare(e,t){return console.error("TODO: textureGatherCompare"),null}TextureLoad(e,t){const r=e.args[0],i=this.exec.evalExpression(e.args[1],t),a=e.args.length>2?this.exec.evalExpression(e.args[2],t).value:0;if(!(i instanceof M)||i.data.length!==2)return console.error(`Invalid UV argument for textureLoad. Line ${e.line}`),null;if(r instanceof dn){const l=r.name,c=t.getVariableValue(l);if(c instanceof Er){const f=Math.floor(i.data[0]),d=Math.floor(i.data[1]);if(f<0||f>=c.width||d<0||d>=c.height)return console.error(`Texture ${l} out of bounds. Line ${e.line}`),null;const p=c.getPixel(f,d,0,a);return p===null?(console.error(`Invalid texture format for textureLoad. Line ${e.line}`),null):new M(p,this.getTypeInfo("vec4f"))}return console.error(`Texture ${l} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureLoad. Line ${e.line}`),null}TextureNumLayers(e,t){const r=e.args[0];if(r instanceof dn){const i=r.name,a=t.getVariableValue(i);return a instanceof Er?new U(a.depthOrArrayLayers,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLayers. Line ${e.line}`),null}TextureNumLevels(e,t){const r=e.args[0];if(r instanceof dn){const i=r.name,a=t.getVariableValue(i);return a instanceof Er?new U(a.mipLevelCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumLevels. Line ${e.line}`),null}TextureNumSamples(e,t){const r=e.args[0];if(r instanceof dn){const i=r.name,a=t.getVariableValue(i);return a instanceof Er?new U(a.sampleCount,this.getTypeInfo("u32")):(console.error(`Texture ${i} not found. Line ${e.line}`),null)}return console.error(`Invalid texture argument for textureNumSamples. Line ${e.line}`),null}TextureSample(e,t){return console.error("TODO: textureSample"),null}TextureSampleBias(e,t){return console.error("TODO: textureSampleBias"),null}TextureSampleCompare(e,t){return console.error("TODO: textureSampleCompare"),null}TextureSampleCompareLevel(e,t){return console.error("TODO: textureSampleCompareLevel"),null}TextureSampleGrad(e,t){return console.error("TODO: textureSampleGrad"),null}TextureSampleLevel(e,t){return console.error("TODO: textureSampleLevel"),null}TextureSampleBaseClampToEdge(e,t){return console.error("TODO: textureSampleBaseClampToEdge"),null}TextureStore(e,t){const r=e.args[0],i=this.exec.evalExpression(e.args[1],t),a=e.args.length===4?this.exec.evalExpression(e.args[2],t).value:0,l=e.args.length===4?this.exec.evalExpression(e.args[3],t).data:this.exec.evalExpression(e.args[2],t).data;if(l.length!==4)return console.error(`Invalid value argument for textureStore. Line ${e.line}`),null;if(!(i instanceof M)||i.data.length!==2)return console.error(`Invalid UV argument for textureStore. Line ${e.line}`),null;if(r instanceof dn){const c=r.name,f=t.getVariableValue(c);if(f instanceof Er){const d=f.getMipLevelSize(0),p=Math.floor(i.data[0]),_=Math.floor(i.data[1]);return p<0||p>=d[0]||_<0||_>=d[1]?(console.error(`Texture ${c} out of bounds. Line ${e.line}`),null):(f.setPixel(p,_,0,a,Array.from(l)),null)}return console.error(`Texture ${c} not found. Line ${e.line}`),null}return console.error(`Invalid texture argument for textureStore. Line ${e.line}`),null}AtomicLoad(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t);return t.getVariable(i).value.getSubData(this.exec,r.postfix,t)}AtomicStore(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t);return f instanceof U&&c instanceof U&&(f.value=c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),null}AtomicAdd(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value+=c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicSub(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value-=c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicMax(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=Math.max(f.value,c.value)),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicMin(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=Math.min(f.value,c.value)),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicAnd(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=f.value&c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicOr(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=f.value|c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicXor(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=f.value^c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicExchange(e,t){let r=e.args[0];r instanceof _t&&(r=r.right);const i=this.exec.getVariableName(r,t),a=t.getVariable(i);let l=e.args[1];const c=this.exec.evalExpression(l,t),f=a.value.getSubData(this.exec,r.postfix,t),d=new U(f.value,f.typeInfo);return f instanceof U&&c instanceof U&&(f.value=c.value),a.value instanceof ut&&a.value.setDataValue(this.exec,f,r.postfix,t),d}AtomicCompareExchangeWeak(e,t){return console.error("TODO: atomicCompareExchangeWeak"),null}Pack4x8snorm(e,t){return console.error("TODO: pack4x8snorm"),null}Pack4x8unorm(e,t){return console.error("TODO: pack4x8unorm"),null}Pack4xI8(e,t){return console.error("TODO: pack4xI8"),null}Pack4xU8(e,t){return console.error("TODO: pack4xU8"),null}Pack4x8Clamp(e,t){return console.error("TODO: pack4x8Clamp"),null}Pack4xU8Clamp(e,t){return console.error("TODO: pack4xU8Clamp"),null}Pack2x16snorm(e,t){return console.error("TODO: pack2x16snorm"),null}Pack2x16unorm(e,t){return console.error("TODO: pack2x16unorm"),null}Pack2x16float(e,t){return console.error("TODO: pack2x16float"),null}Unpack4x8snorm(e,t){return console.error("TODO: unpack4x8snorm"),null}Unpack4x8unorm(e,t){return console.error("TODO: unpack4x8unorm"),null}Unpack4xI8(e,t){return console.error("TODO: unpack4xI8"),null}Unpack4xU8(e,t){return console.error("TODO: unpack4xU8"),null}Unpack2x16snorm(e,t){return console.error("TODO: unpack2x16snorm"),null}Unpack2x16unorm(e,t){return console.error("TODO: unpack2x16unorm"),null}Unpack2x16float(e,t){return console.error("TODO: unpack2x16float"),null}StorageBarrier(e,t){return null}TextureBarrier(e,t){return null}WorkgroupBarrier(e,t){return null}WorkgroupUniformLoad(e,t){return null}SubgroupAdd(e,t){return console.error("TODO: subgroupAdd"),null}SubgroupExclusiveAdd(e,t){return console.error("TODO: subgroupExclusiveAdd"),null}SubgroupInclusiveAdd(e,t){return console.error("TODO: subgroupInclusiveAdd"),null}SubgroupAll(e,t){return console.error("TODO: subgroupAll"),null}SubgroupAnd(e,t){return console.error("TODO: subgroupAnd"),null}SubgroupAny(e,t){return console.error("TODO: subgroupAny"),null}SubgroupBallot(e,t){return console.error("TODO: subgroupBallot"),null}SubgroupBroadcast(e,t){return console.error("TODO: subgroupBroadcast"),null}SubgroupBroadcastFirst(e,t){return console.error("TODO: subgroupBroadcastFirst"),null}SubgroupElect(e,t){return console.error("TODO: subgroupElect"),null}SubgroupMax(e,t){return console.error("TODO: subgroupMax"),null}SubgroupMin(e,t){return console.error("TODO: subgroupMin"),null}SubgroupMul(e,t){return console.error("TODO: subgroupMul"),null}SubgroupExclusiveMul(e,t){return console.error("TODO: subgroupExclusiveMul"),null}SubgroupInclusiveMul(e,t){return console.error("TODO: subgroupInclusiveMul"),null}SubgroupOr(e,t){return console.error("TODO: subgroupOr"),null}SubgroupShuffle(e,t){return console.error("TODO: subgroupShuffle"),null}SubgroupShuffleDown(e,t){return console.error("TODO: subgroupShuffleDown"),null}SubgroupShuffleUp(e,t){return console.error("TODO: subgroupShuffleUp"),null}SubgroupShuffleXor(e,t){return console.error("TODO: subgroupShuffleXor"),null}SubgroupXor(e,t){return console.error("TODO: subgroupXor"),null}QuadBroadcast(e,t){return console.error("TODO: quadBroadcast"),null}QuadSwapDiagonal(e,t){return console.error("TODO: quadSwapDiagonal"),null}QuadSwapX(e,t){return console.error("TODO: quadSwapX"),null}QuadSwapY(e,t){return console.error("TODO: quadSwapY"),null}}const zp={vec2:2,vec2f:2,vec2i:2,vec2u:2,vec2b:2,vec2h:2,vec3:3,vec3f:3,vec3i:3,vec3u:3,vec3b:3,vec3h:3,vec4:4,vec4f:4,vec4i:4,vec4u:4,vec4b:4,vec4h:4},Xt={mat2x2:[2,2,4],mat2x2f:[2,2,4],mat2x2h:[2,2,4],mat2x3:[2,3,6],mat2x3f:[2,3,6],mat2x3h:[2,3,6],mat2x4:[2,4,8],mat2x4f:[2,4,8],mat2x4h:[2,4,8],mat3x2:[3,2,6],mat3x2f:[3,2,6],mat3x2h:[3,2,6],mat3x3:[3,3,9],mat3x3f:[3,3,9],mat3x3h:[3,3,9],mat3x4:[3,4,12],mat3x4f:[3,4,12],mat3x4h:[3,4,12],mat4x2:[4,2,8],mat4x2f:[4,2,8],mat4x2h:[4,2,8],mat4x3:[4,3,12],mat4x3f:[4,3,12],mat4x3h:[4,3,12],mat4x4:[4,4,16],mat4x4f:[4,4,16],mat4x4h:[4,4,16]};class zt extends $6{constructor(e,t){var r;super(),this.ast=e??[],this.reflection=new tr,this.reflection.updateAST(this.ast),this.context=(r=t==null?void 0:t.clone())!==null&&r!==void 0?r:new J_,this.builtins=new W6(this),this.typeInfo={bool:this.getTypeInfo(J.bool),i32:this.getTypeInfo(J.i32),u32:this.getTypeInfo(J.u32),f32:this.getTypeInfo(J.f32),f16:this.getTypeInfo(J.f16),vec2f:this.getTypeInfo(z.vec2f),vec2u:this.getTypeInfo(z.vec2u),vec2i:this.getTypeInfo(z.vec2i),vec2h:this.getTypeInfo(z.vec2h),vec3f:this.getTypeInfo(z.vec3f),vec3u:this.getTypeInfo(z.vec3u),vec3i:this.getTypeInfo(z.vec3i),vec3h:this.getTypeInfo(z.vec3h),vec4f:this.getTypeInfo(z.vec4f),vec4u:this.getTypeInfo(z.vec4u),vec4i:this.getTypeInfo(z.vec4i),vec4h:this.getTypeInfo(z.vec4h),mat2x2f:this.getTypeInfo(z.mat2x2f),mat2x3f:this.getTypeInfo(z.mat2x3f),mat2x4f:this.getTypeInfo(z.mat2x4f),mat3x2f:this.getTypeInfo(z.mat3x2f),mat3x3f:this.getTypeInfo(z.mat3x3f),mat3x4f:this.getTypeInfo(z.mat3x4f),mat4x2f:this.getTypeInfo(z.mat4x2f),mat4x3f:this.getTypeInfo(z.mat4x3f),mat4x4f:this.getTypeInfo(z.mat4x4f)}}getVariableValue(e){var t,r;const i=(r=(t=this.context.getVariable(e))===null||t===void 0?void 0:t.value)!==null&&r!==void 0?r:null;if(i===null)return null;if(i instanceof U)return i.value;if(i instanceof M||i instanceof xe)return Array.from(i.data);if(i instanceof ut&&i.typeInfo instanceof gi){if(i.typeInfo.format.name==="u32")return Array.from(new Uint32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="i32")return Array.from(new Int32Array(i.buffer,i.offset,i.typeInfo.count));if(i.typeInfo.format.name==="f32")return Array.from(new Float32Array(i.buffer,i.offset,i.typeInfo.count))}return console.error(`Unsupported return variable type ${i.typeInfo.name}`),null}execute(e){(e=e??{}).constants&&this._setOverrides(e.constants,this.context),this._execStatements(this.ast,this.context)}dispatchWorkgroups(e,t,r,i){const a=this.context.clone();(i=i??{}).constants&&this._setOverrides(i.constants,a),this._execStatements(this.ast,a);const l=a.getFunction(e);if(!l)return void console.error(`Function ${e} not found`);if(typeof t=="number")t=[t,1,1];else{if(t.length===0)return void console.error("Invalid dispatch count");t.length===1?t=[t[0],1,1]:t.length===2?t=[t[0],t[1],1]:t.length>3&&(t=[t[0],t[1],t[2]])}const c=t[0],f=t[1],d=t[2],p=this.getTypeInfo("vec3u");a.setVariable("@num_workgroups",new M(t,p));for(const _ in r)for(const y in r[_]){const b=r[_][y];a.variables.forEach(T=>{var A;const C=T.node;if(C!=null&&C.attributes){let N=null,O=null;for(const R of C.attributes)R.name==="binding"?N=R.value:R.name==="group"&&(O=R.value);if(y==N&&_==O)if(b.texture!==void 0&&b.descriptor!==void 0){const R=new Er(b.texture,this.getTypeInfo(C.type),b.descriptor,(A=b.texture.view)!==null&&A!==void 0?A:null);T.value=R}else b.uniform!==void 0?T.value=new ut(b.uniform,this.getTypeInfo(C.type)):T.value=new ut(b,this.getTypeInfo(C.type))}})}for(let _=0;_<d;++_)for(let y=0;y<f;++y)for(let b=0;b<c;++b)a.setVariable("@workgroup_id",new M([b,y,_],this.getTypeInfo("vec3u"))),this._dispatchWorkgroup(l,[b,y,_],a)}execStatement(e,t){if(e instanceof Uw)return this.evalExpression(e.value,t);if(e instanceof Fw){if(e.condition){const r=this.evalExpression(e.condition,t);if(!(r instanceof U))throw new Error("Invalid break-if condition");if(!r.value)return null}return zt._breakObj}if(e instanceof Lw)return zt._continueObj;if(e instanceof ol)this._let(e,t);else if(e instanceof Cr)this._var(e,t);else if(e instanceof wu)this._const(e,t);else if(e instanceof wl)this._function(e,t);else{if(e instanceof Pw)return this._if(e,t);if(e instanceof Dw)return this._switch(e,t);if(e instanceof Ow)return this._for(e,t);if(e instanceof Mw)return this._while(e,t);if(e instanceof kw)return this._loop(e,t);if(e instanceof Xg){const r=t.clone();return r.currentFunctionName=t.currentFunctionName,this._execStatements(e.body,r)}if(e instanceof Nw)this._assign(e,t);else if(e instanceof Iw)this._increment(e,t);else{if(e instanceof Ar)return null;if(e instanceof Y_){const r=e.name;t.getVariable(r)===null&&t.setVariable(r,new U(0,this.getTypeInfo("u32")))}else if(e instanceof q_)this._call(e,t);else{if(e instanceof Bw||e instanceof K_)return null;console.error("Invalid statement type.",e,`Line ${e.line}`)}}}return null}evalExpression(e,t){return e instanceof Pn?this._evalBinaryOp(e,t):e instanceof vt?this._evalLiteral(e,t):e instanceof dn?this._evalVariable(e,t):e instanceof Z_?this._evalCall(e,t):e instanceof Qn?this._evalCreate(e,t):e instanceof zw?this._evalConst(e,t):e instanceof Vw?this._evalBitcast(e,t):e instanceof _t?this._evalUnaryOp(e,t):(console.error("Invalid expression type",e,`Line ${e.line}`),null)}getTypeInfo(e){var t;if(e instanceof J){const i=this.reflection.getTypeInfo(e);if(i!==null)return i}let r=(t=this.typeInfo[e])!==null&&t!==void 0?t:null;return r!==null||(r=this.reflection.getTypeInfoByName(e)),r}_setOverrides(e,t){for(const r in e){const i=e[r],a=this.reflection.getOverrideInfo(r);a!==null?(a.type===null&&(a.type=this.getTypeInfo("u32")),a.type.name==="u32"||a.type.name==="i32"||a.type.name==="f32"||a.type.name==="f16"?t.setVariable(r,new U(i,a.type)):a.type.name==="bool"?t.setVariable(r,new U(i?1:0,a.type)):a.type.name==="vec2"||a.type.name==="vec3"||a.type.name==="vec4"||a.type.name==="vec2f"||a.type.name==="vec3f"||a.type.name==="vec4f"||a.type.name==="vec2i"||a.type.name==="vec3i"||a.type.name==="vec4i"||a.type.name==="vec2u"||a.type.name==="vec3u"||a.type.name==="vec4u"||a.type.name==="vec2h"||a.type.name==="vec3h"||a.type.name==="vec4h"?t.setVariable(r,new M(i,a.type)):console.error(`Invalid constant type for ${r}`)):console.error(`Override ${r} does not exist in the shader.`)}}_dispatchWorkgroup(e,t,r){const i=[1,1,1];for(const p of e.node.attributes)if(p.name==="workgroup_size"){if(p.value.length>0){const _=r.getVariableValue(p.value[0]);i[0]=_ instanceof U?_.value:parseInt(p.value[0])}if(p.value.length>1){const _=r.getVariableValue(p.value[1]);i[1]=_ instanceof U?_.value:parseInt(p.value[1])}if(p.value.length>2){const _=r.getVariableValue(p.value[2]);i[2]=_ instanceof U?_.value:parseInt(p.value[2])}}const a=this.getTypeInfo("vec3u"),l=this.getTypeInfo("u32");r.setVariable("@workgroup_size",new M(i,a));const c=i[0],f=i[1],d=i[2];for(let p=0,_=0;p<d;++p)for(let y=0;y<f;++y)for(let b=0;b<c;++b,++_){const T=[b,y,p],A=[b+t[0]*i[0],y+t[1]*i[1],p+t[2]*i[2]];r.setVariable("@local_invocation_id",new M(T,a)),r.setVariable("@global_invocation_id",new M(A,a)),r.setVariable("@local_invocation_index",new U(_,l)),this._dispatchExec(e,r)}}_dispatchExec(e,t){for(const r of e.node.args)for(const i of r.attributes)if(i.name==="builtin"){const a=`@${i.value}`,l=t.getVariable(a);l!==void 0&&t.variables.set(r.name,l)}this._execStatements(e.node.body,t)}getVariableName(e,t){for(;e instanceof _t;)e=e.right;return e instanceof dn?e.name:(console.error("Unknown variable type",e,"Line",e.line),null)}_execStatements(e,t){for(const r of e){if(r instanceof Array){const a=t.clone(),l=this._execStatements(r,a);if(l)return l;continue}const i=this.execStatement(r,t);if(i)return i}return null}_call(e,t){const r=t.clone();r.currentFunctionName=e.name;const i=t.getFunction(e.name);if(i){for(let a=0;a<i.node.args.length;++a){const l=i.node.args[a],c=this.evalExpression(e.args[a],r);r.setVariable(l.name,c,l)}this._execStatements(i.node.body,r)}else e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)&&this._evalCreate(e,t)}_increment(e,t){const r=this.getVariableName(e.variable,t),i=t.getVariable(r);i?e.operator==="++"?i.value instanceof U?i.value.value++:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):e.operator==="--"?i.value instanceof U?i.value.value--:console.error(`Variable ${r} is not a scalar. Line ${e.line}`):console.error(`Unknown increment operator ${e.operator}. Line ${e.line}`):console.error(`Variable ${r} not found. Line ${e.line}`)}_getVariableData(e,t){if(e instanceof dn){const r=this.getVariableName(e,t),i=t.getVariable(r);return i===null?(console.error(`Variable ${r} not found. Line ${e.line}`),null):i.value.getSubData(this,e.postfix,t)}if(e instanceof _t){if(e.operator==="*"){const r=this._getVariableData(e.right,t);return r instanceof ra?r.reference.getSubData(this,e.postfix,t):(console.error(`Variable ${e.right} is not a pointer. Line ${e.line}`),null)}if(e.operator==="&"){const r=this._getVariableData(e.right,t);return new ra(r)}}return null}_assign(e,t){let r=null,i="<var>",a=null;if(e.variable instanceof _t){const f=this._getVariableData(e.variable,t),d=this.evalExpression(e.value,t),p=e.operator;if(p==="="){if(f instanceof U||f instanceof M||f instanceof xe){if(d instanceof U||d instanceof M||d instanceof xe&&f.data.length===d.data.length)return void f.data.set(d.data);console.error(`Invalid assignment. Line ${e.line}`)}else if(f instanceof ut&&d instanceof ut&&f.buffer.byteLength-f.offset>=d.buffer.byteLength-d.offset)return void(f.buffer.byteLength%4==0?new Uint32Array(f.buffer,f.offset,f.typeInfo.size/4).set(new Uint32Array(d.buffer,d.offset,d.typeInfo.size/4)):new Uint8Array(f.buffer,f.offset,f.typeInfo.size).set(new Uint8Array(d.buffer,d.offset,d.typeInfo.size)));return console.error(`Invalid assignment. Line ${e.line}`),null}if(p==="+=")return f instanceof U||f instanceof M||f instanceof xe?d instanceof U||d instanceof M||d instanceof xe?void f.data.set(d.data.map((_,y)=>f.data[y]+_)):void console.error(`Invalid assignment . Line ${e.line}`):void console.error(`Invalid assignment. Line ${e.line}`);if(p==="-=")return(f instanceof U||f instanceof M||f instanceof xe)&&(d instanceof U||d instanceof M||d instanceof xe)?void f.data.set(d.data.map((_,y)=>f.data[y]-_)):void console.error(`Invalid assignment. Line ${e.line}`)}if(e.variable instanceof _t){if(e.variable.operator==="*"){i=this.getVariableName(e.variable.right,t);const f=t.getVariable(i);if(!(f&&f.value instanceof ra))return void console.error(`Variable ${i} is not a pointer. Line ${e.line}`);r=f.value.reference;let d=e.variable.postfix;if(!d){let p=e.variable.right;for(;p instanceof _t;){if(p.postfix){d=p.postfix;break}p=p.right}}d&&(r=r.getSubData(this,d,t))}}else{a=e.variable.postfix,i=this.getVariableName(e.variable,t);const f=t.getVariable(i);if(f===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);r=f.value}if(r instanceof ra&&(r=r.reference),r===null)return void console.error(`Variable ${i} not found. Line ${e.line}`);const l=this.evalExpression(e.value,t),c=e.operator;if(c==="=")if(r instanceof ut)r.setDataValue(this,l,a,t);else if(a){if(!(r instanceof M||r instanceof xe))return void console.error(`Variable ${i} is not a vector or matrix. Line ${e.line}`);if(a instanceof Ea){const f=this.evalExpression(a.index,t).value;if(r instanceof M){if(!(l instanceof U))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[f]=l.value}else{if(!(r instanceof xe))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const d=this.evalExpression(a.index,t).value;if(d<0)return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(l instanceof M))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);{const p=r.typeInfo.getTypeName();if(p==="mat2x2"||p==="mat2x2f"||p==="mat2x2h"){if(!(d<2&&l.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*d]=l.data[0],r.data[2*d+1]=l.data[1]}else if(p==="mat2x3"||p==="mat2x3f"||p==="mat2x3h"){if(!(d<2&&l.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*d]=l.data[0],r.data[3*d+1]=l.data[1],r.data[3*d+2]=l.data[2]}else if(p==="mat2x4"||p==="mat2x4f"||p==="mat2x4h"){if(!(d<2&&l.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*d]=l.data[0],r.data[4*d+1]=l.data[1],r.data[4*d+2]=l.data[2],r.data[4*d+3]=l.data[3]}else if(p==="mat3x2"||p==="mat3x2f"||p==="mat3x2h"){if(!(d<3&&l.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*d]=l.data[0],r.data[2*d+1]=l.data[1]}else if(p==="mat3x3"||p==="mat3x3f"||p==="mat3x3h"){if(!(d<3&&l.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*d]=l.data[0],r.data[3*d+1]=l.data[1],r.data[3*d+2]=l.data[2]}else if(p==="mat3x4"||p==="mat3x4f"||p==="mat3x4h"){if(!(d<3&&l.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*d]=l.data[0],r.data[4*d+1]=l.data[1],r.data[4*d+2]=l.data[2],r.data[4*d+3]=l.data[3]}else if(p==="mat4x2"||p==="mat4x2f"||p==="mat4x2h"){if(!(d<4&&l.data.length===2))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[2*d]=l.data[0],r.data[2*d+1]=l.data[1]}else if(p==="mat4x3"||p==="mat4x3f"||p==="mat4x3h"){if(!(d<4&&l.data.length===3))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[3*d]=l.data[0],r.data[3*d+1]=l.data[1],r.data[3*d+2]=l.data[2]}else{if(p!=="mat4x4"&&p!=="mat4x4f"&&p!=="mat4x4h")return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(!(d<4&&l.data.length===4))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);r.data[4*d]=l.data[0],r.data[4*d+1]=l.data[1],r.data[4*d+2]=l.data[2],r.data[4*d+3]=l.data[3]}}}}}else if(a instanceof ts){const f=a.value;if(!(r instanceof M))return void console.error(`Invalid assignment to ${f}. Variable ${i} is not a vector. Line ${e.line}`);if(l instanceof U){if(f.length>1)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);if(f==="x")r.data[0]=l.value;else if(f==="y"){if(r.data.length<2)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[1]=l.value}else if(f==="z"){if(r.data.length<3)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[2]=l.value}else if(f==="w"){if(r.data.length<4)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);r.data[3]=l.value}}else{if(!(l instanceof M))return void console.error(`Invalid assignment to ${i}. Line ${e.line}`);if(f.length!==l.data.length)return void console.error(`Invalid assignment to ${f} for variable ${i}. Line ${e.line}`);for(let d=0;d<f.length;++d){const p=f[d];if(p==="x"||p==="r")r.data[0]=l.data[d];else if(p==="y"||p==="g"){if(l.data.length<2)return void console.error(`Invalid assignment to ${p} for variable ${i}. Line ${e.line}`);r.data[1]=l.data[d]}else if(p==="z"||p==="b"){if(l.data.length<3)return void console.error(`Invalid assignment to ${p} for variable ${i}. Line ${e.line}`);r.data[2]=l.data[d]}else{if(p!=="w"&&p!=="a")return void console.error(`Invalid assignment to ${p} for variable ${i}. Line ${e.line}`);if(l.data.length<4)return void console.error(`Invalid assignment to ${p} for variable ${i}. Line ${e.line}`);r.data[3]=l.data[d]}}}}}else r instanceof U&&l instanceof U?r.value=l.value:r instanceof M&&l instanceof M||r instanceof xe&&l instanceof xe?r.data.set(l.data):console.error(`Invalid assignment to ${i}. Line ${e.line}`);else{const f=r.getSubData(this,a,t);if(f instanceof M&&l instanceof U){const d=f.data,p=l.value;if(c==="+=")for(let _=0;_<d.length;++_)d[_]+=p;else if(c==="-=")for(let _=0;_<d.length;++_)d[_]-=p;else if(c==="*=")for(let _=0;_<d.length;++_)d[_]*=p;else if(c==="/=")for(let _=0;_<d.length;++_)d[_]/=p;else if(c==="%=")for(let _=0;_<d.length;++_)d[_]%=p;else if(c==="&=")for(let _=0;_<d.length;++_)d[_]&=p;else if(c==="|=")for(let _=0;_<d.length;++_)d[_]|=p;else if(c==="^=")for(let _=0;_<d.length;++_)d[_]^=p;else if(c==="<<=")for(let _=0;_<d.length;++_)d[_]<<=p;else if(c===">>=")for(let _=0;_<d.length;++_)d[_]>>=p;else console.error(`Invalid operator ${c}. Line ${e.line}`)}else if(f instanceof M&&l instanceof M){const d=f.data,p=l.data;if(d.length!==p.length)return void console.error(`Vector length mismatch. Line ${e.line}`);if(c==="+=")for(let _=0;_<d.length;++_)d[_]+=p[_];else if(c==="-=")for(let _=0;_<d.length;++_)d[_]-=p[_];else if(c==="*=")for(let _=0;_<d.length;++_)d[_]*=p[_];else if(c==="/=")for(let _=0;_<d.length;++_)d[_]/=p[_];else if(c==="%=")for(let _=0;_<d.length;++_)d[_]%=p[_];else if(c==="&=")for(let _=0;_<d.length;++_)d[_]&=p[_];else if(c==="|=")for(let _=0;_<d.length;++_)d[_]|=p[_];else if(c==="^=")for(let _=0;_<d.length;++_)d[_]^=p[_];else if(c==="<<=")for(let _=0;_<d.length;++_)d[_]<<=p[_];else if(c===">>=")for(let _=0;_<d.length;++_)d[_]>>=p[_];else console.error(`Invalid operator ${c}. Line ${e.line}`)}else{if(!(f instanceof U&&l instanceof U))return void console.error(`Invalid type for ${e.operator} operator. Line ${e.line}`);c==="+="?f.value+=l.value:c==="-="?f.value-=l.value:c==="*="?f.value*=l.value:c==="/="?f.value/=l.value:c==="%="?f.value%=l.value:c==="&="?f.value&=l.value:c==="|="?f.value|=l.value:c==="^="?f.value^=l.value:c==="<<="?f.value<<=l.value:c===">>="?f.value>>=l.value:console.error(`Invalid operator ${c}. Line ${e.line}`)}r instanceof ut&&r.setDataValue(this,f,a,t)}}_function(e,t){const r=new G_(e);t.functions.set(e.name,r)}_const(e,t){let r=null;e.value!==null&&(r=this.evalExpression(e.value,t)),t.createVariable(e.name,r,e)}_let(e,t){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,t),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof _t||(r=r.clone())}else{const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||i==="array"){const a=new Qn(e.type,[]);r=this._evalCreate(a,t)}}t.createVariable(e.name,r,e)}_var(e,t){let r=null;if(e.value!==null){if(r=this.evalExpression(e.value,t),r===null)return void console.error(`Invalid value for variable ${e.name}. Line ${e.line}`);e.value instanceof _t||(r=r.clone())}else{if(e.type===null)return void console.error(`Variable ${e.name} has no type. Line ${e.line}`);const i=e.type.name;if(i==="f32"||i==="i32"||i==="u32"||i==="bool"||i==="f16"||i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2b"||i==="vec3b"||i==="vec4b"||i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"||e.type instanceof ll||e.type instanceof Ar||e.type instanceof z){const a=new Qn(e.type,[]);r=this._evalCreate(a,t)}}t.createVariable(e.name,r,e)}_switch(e,t){t=t.clone();const r=this.evalExpression(e.condition,t);if(!(r instanceof U))return console.error(`Invalid if condition. Line ${e.line}`),null;let i=null;for(const a of e.cases)if(a instanceof $w)for(const l of a.selectors){if(l instanceof xu){i=a;continue}const c=this.evalExpression(l,t);if(!(c instanceof U))return console.error(`Invalid case selector. Line ${e.line}`),null;if(c.value===r.value)return this._execStatements(a.body,t)}else a instanceof Ww&&(i=a);return i?this._execStatements(i.body,t):null}_if(e,t){t=t.clone();const r=this.evalExpression(e.condition,t);if(!(r instanceof U))return console.error(`Invalid if condition. Line ${e.line}`),null;if(r.value)return this._execStatements(e.body,t);for(const i of e.elseif){const a=this.evalExpression(i.condition,t);if(!(a instanceof U))return console.error(`Invalid if condition. Line ${e.line}`),null;if(a.value)return this._execStatements(i.body,t)}return e.else?this._execStatements(e.else,t):null}_getScalarValue(e){return e instanceof U?e.value:(console.error("Expected scalar value.",e),0)}_for(e,t){for(t=t.clone(),this.execStatement(e.init,t);this._getScalarValue(this.evalExpression(e.condition,t));){const r=this._execStatements(e.body,t);if(r===zt._breakObj)break;if(r!==null&&r!==zt._continueObj)return r;this.execStatement(e.increment,t)}return null}_loop(e,t){for(t=t.clone();;){const r=this._execStatements(e.body,t);if(r===zt._breakObj)break;if(r===zt._continueObj){if(e.continuing&&this._execStatements(e.continuing.body,t)===zt._breakObj)break}else if(r!==null)return r}return null}_while(e,t){for(t=t.clone();this._getScalarValue(this.evalExpression(e.condition,t));){const r=this._execStatements(e.body,t);if(r===zt._breakObj)break;if(r!==zt._continueObj&&r!==null)return r}return null}_evalBitcast(e,t){const r=this.evalExpression(e.value,t),i=e.type;if(r instanceof U){const a=sT(r.value,r.typeInfo.name,i.name);return new U(a,this.getTypeInfo(i))}if(r instanceof M){const a=r.typeInfo.getTypeName();let l="";if(a.endsWith("f"))l="f32";else if(a.endsWith("i"))l="i32";else if(a.endsWith("u"))l="u32";else if(a.endsWith("b"))l="bool";else{if(!a.endsWith("h"))return console.error(`Unknown vector type ${a}. Line ${e.line}`),null;l="f16"}const c=i.getTypeName();let f="";if(c.endsWith("f"))f="f32";else if(c.endsWith("i"))f="i32";else if(c.endsWith("u"))f="u32";else if(c.endsWith("b"))f="bool";else{if(!c.endsWith("h"))return console.error(`Unknown vector type ${f}. Line ${e.line}`),null;f="f16"}const d=function(p,_,y){if(_===y)return p;const b=new Array(p.length);for(let T=0;T<p.length;T++)b[T]=sT(p[T],_,y);return b}(Array.from(r.data),l,f);return new M(d,this.getTypeInfo(i))}return console.error(`TODO: bitcast for ${r.typeInfo.name}. Line ${e.line}`),null}_evalConst(e,t){return t.getVariableValue(e.name).clone().getSubData(this,e.postfix,t)}_evalCreate(e,t){var r;if(e instanceof Qn){if(e.type===null)return Yg.void;switch(e.type.getTypeName()){case"bool":case"i32":case"u32":case"f32":case"f16":return this._callConstructorValue(e,t);case"vec2":case"vec3":case"vec4":case"vec2f":case"vec3f":case"vec4f":case"vec2h":case"vec3h":case"vec4h":case"vec2i":case"vec3i":case"vec4i":case"vec2u":case"vec3u":case"vec4u":case"vec2b":case"vec3b":case"vec4b":return this._callConstructorVec(e,t);case"mat2x2":case"mat2x2f":case"mat2x2h":case"mat2x3":case"mat2x3f":case"mat2x3h":case"mat2x4":case"mat2x4f":case"mat2x4h":case"mat3x2":case"mat3x2f":case"mat3x2h":case"mat3x3":case"mat3x3f":case"mat3x3h":case"mat3x4":case"mat3x4f":case"mat3x4h":case"mat4x2":case"mat4x2f":case"mat4x2h":case"mat4x3":case"mat4x3f":case"mat4x3h":case"mat4x4":case"mat4x4f":case"mat4x4h":return this._callConstructorMatrix(e,t)}}const i=e instanceof Qn?e.type.name:e.name,a=e instanceof Qn?this.getTypeInfo(e.type):this.getTypeInfo(e.name);if(a===null)return console.error(`Unknown type ${i}. Line ${e.line}`),null;if(a.size===0)return null;const l=new ut(new ArrayBuffer(a.size),a,0);if(a instanceof fi){if(e.args)for(let c=0;c<e.args.length;++c){const f=a.members[c],d=e.args[c],p=this.evalExpression(d,t);l.setData(this,p,f.type,f.offset,t)}}else if(a instanceof gi){let c=0;if(e.args)for(let f=0;f<e.args.length;++f){const d=e.args[f],p=this.evalExpression(d,t);a.format===null&&(((r=p.typeInfo)===null||r===void 0?void 0:r.name)==="x32"?a.format=this.getTypeInfo("i32"):a.format=p.typeInfo),l.setData(this,p,a.format,c,t),c+=a.stride}}else console.error(`Unknown type "${i}". Line ${e.line}`);return e instanceof Qn?l.getSubData(this,e.postfix,t):l}_evalLiteral(e,t){const r=this.getTypeInfo(e.type),i=r.name;return i==="x32"||i==="u32"||i==="f32"||i==="f16"||i==="i32"||i==="bool"?new U(e.scalarValue,r):i==="vec2"||i==="vec3"||i==="vec4"||i==="vec2f"||i==="vec3f"||i==="vec4f"||i==="vec2h"||i==="vec3h"||i==="vec4h"||i==="vec2i"||i==="vec3i"||i==="vec4i"||i==="vec2u"||i==="vec3u"||i==="vec4u"?this._callConstructorVec(e,t):i==="mat2x2"||i==="mat2x3"||i==="mat2x4"||i==="mat3x2"||i==="mat3x3"||i==="mat3x4"||i==="mat4x2"||i==="mat4x3"||i==="mat4x4"||i==="mat2x2f"||i==="mat2x3f"||i==="mat2x4f"||i==="mat3x2f"||i==="mat3x3f"||i==="mat3x4f"||i==="mat4x2f"||i==="mat4x3f"||i==="mat4x4f"||i==="mat2x2h"||i==="mat2x3h"||i==="mat2x4h"||i==="mat3x2h"||i==="mat3x3h"||i==="mat3x4h"||i==="mat4x2h"||i==="mat4x3h"||i==="mat4x4h"?this._callConstructorMatrix(e,t):e.value}_evalVariable(e,t){const r=t.getVariableValue(e.name);return r===null?r:r.getSubData(this,e.postfix,t)}_maxFormatTypeInfo(e){let t=e[0];if(t.name==="f32")return t;for(let r=1;r<e.length;++r){const i=zt._priority.get(t.name);zt._priority.get(e[r].name)<i&&(t=e[r])}return t.name==="x32"?this.getTypeInfo("i32"):t}_evalUnaryOp(e,t){const r=this.evalExpression(e.right,t);if(e.operator==="&")return new ra(r);if(e.operator==="*")return r instanceof ra?r.reference.getSubData(this,e.postfix,t):(console.error(`Invalid dereference. Line ${e.line}`),null);const i=r instanceof U?r.value:r instanceof M?Array.from(r.data):null;switch(e.operator){case"+":{if(ue(i)){const c=i.map((f,d)=>+f);return new M(c,r.typeInfo)}const a=i,l=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new U(+a,l)}case"-":{if(ue(i)){const c=i.map((f,d)=>-f);return new M(c,r.typeInfo)}const a=i,l=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new U(-a,l)}case"!":{if(ue(i)){const c=i.map((f,d)=>f?0:1);return new M(c,r.typeInfo)}const a=i,l=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new U(a?0:1,l)}case"~":{if(ue(i)){const c=i.map((f,d)=>~f);return new M(c,r.typeInfo)}const a=i,l=this._maxFormatTypeInfo([r.typeInfo,r.typeInfo]);return new U(~a,l)}}return console.error(`Invalid unary operator ${e.operator}. Line ${e.line}`),null}_evalBinaryOp(e,t){const r=this.evalExpression(e.left,t),i=this.evalExpression(e.right,t),a=r instanceof U?r.value:r instanceof M||r instanceof xe?Array.from(r.data):null,l=i instanceof U?i.value:i instanceof M||i instanceof xe?Array.from(i.data):null;switch(e.operator){case"+":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b+_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y+p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p+y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c+f,d)}case"-":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b-_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y-p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p-y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c-f,d)}case"*":{if(ue(a)&&ue(l)){const p=a,_=l;if(r instanceof xe&&i instanceof xe){const y=function(C,N,O,R){if(Xt[N.name]===void 0||Xt[R.name]===void 0)return null;const E=Xt[N.name][0],k=Xt[N.name][1],V=Xt[R.name][0];if(E!==Xt[R.name][1])return null;const ne=new Array(V*k);for(let G=0;G<k;G++)for(let se=0;se<V;se++){let re=0;for(let q=0;q<E;q++)re+=C[q*k+G]*O[se*E+q];ne[G*V+se]=re}return ne}(p,r.typeInfo,_,i.typeInfo);if(y===null)return console.error(`Matrix multiplication failed. Line ${e.line}.`),null;const b=Xt[i.typeInfo.name][0],T=Xt[r.typeInfo.name][1],A=this.getTypeInfo(`mat${b}x${T}f`);return new xe(y,A)}if(r instanceof xe&&i instanceof M){const y=function(b,T,A,C){if(Xt[T.name]===void 0||zp[C.name]===void 0)return null;const N=Xt[T.name][0],O=Xt[T.name][1];if(N!==A.length)return null;const R=new Array(O);for(let E=0;E<O;E++){let k=0;for(let V=0;V<N;V++)k+=b[V*O+E]*A[V];R[E]=k}return R}(p,r.typeInfo,_,i.typeInfo);return y===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new M(y,i.typeInfo)}if(r instanceof M&&i instanceof xe){const y=function(b,T,A,C){if(zp[T.name]===void 0||Xt[C.name]===void 0)return null;const N=Xt[C.name][0],O=Xt[C.name][1];if(O!==b.length)return null;const R=[];for(let E=0;E<N;E++){let k=0;for(let V=0;V<O;V++)k+=b[V]*A[V*N+E];R[E]=k}return R}(p,r.typeInfo,_,i.typeInfo);return y===null?(console.error(`Matrix vector multiplication failed. Line ${e.line}.`),null):new M(y,r.typeInfo)}{if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b*_[T]);return new M(y,r.typeInfo)}}if(ue(a)){const p=l,_=a.map((y,b)=>y*p);return r instanceof xe?new xe(_,r.typeInfo):new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p*y);return i instanceof xe?new xe(_,i.typeInfo):new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c*f,d)}case"%":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b%_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y%p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p%y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c%f,d)}case"/":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b/_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y/p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p/y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c/f,d)}case"&":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b&_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y&p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p&y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c&f,d)}case"|":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b|_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y|p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p|y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c|f,d)}case"^":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b^_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y^p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p^y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c^f,d)}case"<<":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b<<_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y<<p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p<<y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c<<f,d)}case">>":{if(ue(a)&&ue(l)){const p=a,_=l;if(p.length!==_.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const y=p.map((b,T)=>b>>_[T]);return new M(y,r.typeInfo)}if(ue(a)){const p=l,_=a.map((y,b)=>y>>p);return new M(_,r.typeInfo)}if(ue(l)){const p=a,_=l.map((y,b)=>p>>y);return new M(_,i.typeInfo)}const c=a,f=l,d=this._maxFormatTypeInfo([r.typeInfo,i.typeInfo]);return new U(c>>f,d)}case">":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p>f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d>c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c>d?1:0);return new M(f,i.typeInfo)}return new U(a>l?1:0,this.getTypeInfo("bool"));case"<":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p<f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d<c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c<d?1:0);return new M(f,i.typeInfo)}return new U(a<l?1:0,this.getTypeInfo("bool"));case"==":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p===f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d==c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c==d?1:0);return new M(f,i.typeInfo)}return new U(a===l?1:0,this.getTypeInfo("bool"));case"!=":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p!==f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d!==c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c!==d?1:0);return new M(f,i.typeInfo)}return new U(a!==l?1:0,this.getTypeInfo("bool"));case">=":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p>=f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d>=c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c>=d?1:0);return new M(f,i.typeInfo)}return new U(a>=l?1:0,this.getTypeInfo("bool"));case"<=":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p<=f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d<=c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c<=d?1:0);return new M(f,i.typeInfo)}return new U(a<=l?1:0,this.getTypeInfo("bool"));case"&&":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p&&f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d&&c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c&&d?1:0);return new M(f,i.typeInfo)}return new U(a&&l?1:0,this.getTypeInfo("bool"));case"||":if(ue(a)&&ue(l)){const c=a,f=l;if(c.length!==f.length)return console.error(`Vector length mismatch. Line ${e.line}.`),null;const d=c.map((p,_)=>p||f[_]?1:0);return new M(d,r.typeInfo)}if(ue(a)){const c=l,f=a.map((d,p)=>d||c?1:0);return new M(f,r.typeInfo)}if(ue(l)){const c=a,f=l.map((d,p)=>c||d?1:0);return new M(f,i.typeInfo)}return new U(a||l?1:0,this.getTypeInfo("bool"))}return console.error(`Unknown operator ${e.operator}. Line ${e.line}`),null}_evalCall(e,t){if(e.cachedReturnValue!==null)return e.cachedReturnValue;const r=t.clone();r.currentFunctionName=e.name;const i=t.getFunction(e.name);if(!i)return e.isBuiltin?this._callBuiltinFunction(e,r):this.getTypeInfo(e.name)?this._evalCreate(e,t):(console.error(`Unknown function "${e.name}". Line ${e.line}`),null);for(let a=0;a<i.node.args.length;++a){const l=i.node.args[a],c=this.evalExpression(e.args[a],r);r.createVariable(l.name,c,l)}return this._execStatements(i.node.body,r)}_callBuiltinFunction(e,t){switch(e.name){case"all":return this.builtins.All(e,t);case"any":return this.builtins.Any(e,t);case"select":return this.builtins.Select(e,t);case"arrayLength":return this.builtins.ArrayLength(e,t);case"abs":return this.builtins.Abs(e,t);case"acos":return this.builtins.Acos(e,t);case"acosh":return this.builtins.Acosh(e,t);case"asin":return this.builtins.Asin(e,t);case"asinh":return this.builtins.Asinh(e,t);case"atan":return this.builtins.Atan(e,t);case"atanh":return this.builtins.Atanh(e,t);case"atan2":return this.builtins.Atan2(e,t);case"ceil":return this.builtins.Ceil(e,t);case"clamp":return this.builtins.Clamp(e,t);case"cos":return this.builtins.Cos(e,t);case"cosh":return this.builtins.Cosh(e,t);case"countLeadingZeros":return this.builtins.CountLeadingZeros(e,t);case"countOneBits":return this.builtins.CountOneBits(e,t);case"countTrailingZeros":return this.builtins.CountTrailingZeros(e,t);case"cross":return this.builtins.Cross(e,t);case"degrees":return this.builtins.Degrees(e,t);case"determinant":return this.builtins.Determinant(e,t);case"distance":return this.builtins.Distance(e,t);case"dot":return this.builtins.Dot(e,t);case"dot4U8Packed":return this.builtins.Dot4U8Packed(e,t);case"dot4I8Packed":return this.builtins.Dot4I8Packed(e,t);case"exp":return this.builtins.Exp(e,t);case"exp2":return this.builtins.Exp2(e,t);case"extractBits":return this.builtins.ExtractBits(e,t);case"faceForward":return this.builtins.FaceForward(e,t);case"firstLeadingBit":return this.builtins.FirstLeadingBit(e,t);case"firstTrailingBit":return this.builtins.FirstTrailingBit(e,t);case"floor":return this.builtins.Floor(e,t);case"fma":return this.builtins.Fma(e,t);case"fract":return this.builtins.Fract(e,t);case"frexp":return this.builtins.Frexp(e,t);case"insertBits":return this.builtins.InsertBits(e,t);case"inverseSqrt":return this.builtins.InverseSqrt(e,t);case"ldexp":return this.builtins.Ldexp(e,t);case"length":return this.builtins.Length(e,t);case"log":return this.builtins.Log(e,t);case"log2":return this.builtins.Log2(e,t);case"max":return this.builtins.Max(e,t);case"min":return this.builtins.Min(e,t);case"mix":return this.builtins.Mix(e,t);case"modf":return this.builtins.Modf(e,t);case"normalize":return this.builtins.Normalize(e,t);case"pow":return this.builtins.Pow(e,t);case"quantizeToF16":return this.builtins.QuantizeToF16(e,t);case"radians":return this.builtins.Radians(e,t);case"reflect":return this.builtins.Reflect(e,t);case"refract":return this.builtins.Refract(e,t);case"reverseBits":return this.builtins.ReverseBits(e,t);case"round":return this.builtins.Round(e,t);case"saturate":return this.builtins.Saturate(e,t);case"sign":return this.builtins.Sign(e,t);case"sin":return this.builtins.Sin(e,t);case"sinh":return this.builtins.Sinh(e,t);case"smoothStep":return this.builtins.SmoothStep(e,t);case"sqrt":return this.builtins.Sqrt(e,t);case"step":return this.builtins.Step(e,t);case"tan":return this.builtins.Tan(e,t);case"tanh":return this.builtins.Tanh(e,t);case"transpose":return this.builtins.Transpose(e,t);case"trunc":return this.builtins.Trunc(e,t);case"dpdx":return this.builtins.Dpdx(e,t);case"dpdxCoarse":return this.builtins.DpdxCoarse(e,t);case"dpdxFine":return this.builtins.DpdxFine(e,t);case"dpdy":return this.builtins.Dpdy(e,t);case"dpdyCoarse":return this.builtins.DpdyCoarse(e,t);case"dpdyFine":return this.builtins.DpdyFine(e,t);case"fwidth":return this.builtins.Fwidth(e,t);case"fwidthCoarse":return this.builtins.FwidthCoarse(e,t);case"fwidthFine":return this.builtins.FwidthFine(e,t);case"textureDimensions":return this.builtins.TextureDimensions(e,t);case"textureGather":return this.builtins.TextureGather(e,t);case"textureGatherCompare":return this.builtins.TextureGatherCompare(e,t);case"textureLoad":return this.builtins.TextureLoad(e,t);case"textureNumLayers":return this.builtins.TextureNumLayers(e,t);case"textureNumLevels":return this.builtins.TextureNumLevels(e,t);case"textureNumSamples":return this.builtins.TextureNumSamples(e,t);case"textureSample":return this.builtins.TextureSample(e,t);case"textureSampleBias":return this.builtins.TextureSampleBias(e,t);case"textureSampleCompare":return this.builtins.TextureSampleCompare(e,t);case"textureSampleCompareLevel":return this.builtins.TextureSampleCompareLevel(e,t);case"textureSampleGrad":return this.builtins.TextureSampleGrad(e,t);case"textureSampleLevel":return this.builtins.TextureSampleLevel(e,t);case"textureSampleBaseClampToEdge":return this.builtins.TextureSampleBaseClampToEdge(e,t);case"textureStore":return this.builtins.TextureStore(e,t);case"atomicLoad":return this.builtins.AtomicLoad(e,t);case"atomicStore":return this.builtins.AtomicStore(e,t);case"atomicAdd":return this.builtins.AtomicAdd(e,t);case"atomicSub":return this.builtins.AtomicSub(e,t);case"atomicMax":return this.builtins.AtomicMax(e,t);case"atomicMin":return this.builtins.AtomicMin(e,t);case"atomicAnd":return this.builtins.AtomicAnd(e,t);case"atomicOr":return this.builtins.AtomicOr(e,t);case"atomicXor":return this.builtins.AtomicXor(e,t);case"atomicExchange":return this.builtins.AtomicExchange(e,t);case"atomicCompareExchangeWeak":return this.builtins.AtomicCompareExchangeWeak(e,t);case"pack4x8snorm":return this.builtins.Pack4x8snorm(e,t);case"pack4x8unorm":return this.builtins.Pack4x8unorm(e,t);case"pack4xI8":return this.builtins.Pack4xI8(e,t);case"pack4xU8":return this.builtins.Pack4xU8(e,t);case"pack4x8Clamp":return this.builtins.Pack4x8Clamp(e,t);case"pack4xU8Clamp":return this.builtins.Pack4xU8Clamp(e,t);case"pack2x16snorm":return this.builtins.Pack2x16snorm(e,t);case"pack2x16unorm":return this.builtins.Pack2x16unorm(e,t);case"pack2x16float":return this.builtins.Pack2x16float(e,t);case"unpack4x8snorm":return this.builtins.Unpack4x8snorm(e,t);case"unpack4x8unorm":return this.builtins.Unpack4x8unorm(e,t);case"unpack4xI8":return this.builtins.Unpack4xI8(e,t);case"unpack4xU8":return this.builtins.Unpack4xU8(e,t);case"unpack2x16snorm":return this.builtins.Unpack2x16snorm(e,t);case"unpack2x16unorm":return this.builtins.Unpack2x16unorm(e,t);case"unpack2x16float":return this.builtins.Unpack2x16float(e,t);case"storageBarrier":return this.builtins.StorageBarrier(e,t);case"textureBarrier":return this.builtins.TextureBarrier(e,t);case"workgroupBarrier":return this.builtins.WorkgroupBarrier(e,t);case"workgroupUniformLoad":return this.builtins.WorkgroupUniformLoad(e,t);case"subgroupAdd":return this.builtins.SubgroupAdd(e,t);case"subgroupExclusiveAdd":return this.builtins.SubgroupExclusiveAdd(e,t);case"subgroupInclusiveAdd":return this.builtins.SubgroupInclusiveAdd(e,t);case"subgroupAll":return this.builtins.SubgroupAll(e,t);case"subgroupAnd":return this.builtins.SubgroupAnd(e,t);case"subgroupAny":return this.builtins.SubgroupAny(e,t);case"subgroupBallot":return this.builtins.SubgroupBallot(e,t);case"subgroupBroadcast":return this.builtins.SubgroupBroadcast(e,t);case"subgroupBroadcastFirst":return this.builtins.SubgroupBroadcastFirst(e,t);case"subgroupElect":return this.builtins.SubgroupElect(e,t);case"subgroupMax":return this.builtins.SubgroupMax(e,t);case"subgroupMin":return this.builtins.SubgroupMin(e,t);case"subgroupMul":return this.builtins.SubgroupMul(e,t);case"subgroupExclusiveMul":return this.builtins.SubgroupExclusiveMul(e,t);case"subgroupInclusiveMul":return this.builtins.SubgroupInclusiveMul(e,t);case"subgroupOr":return this.builtins.SubgroupOr(e,t);case"subgroupShuffle":return this.builtins.SubgroupShuffle(e,t);case"subgroupShuffleDown":return this.builtins.SubgroupShuffleDown(e,t);case"subgroupShuffleUp":return this.builtins.SubgroupShuffleUp(e,t);case"subgroupShuffleXor":return this.builtins.SubgroupShuffleXor(e,t);case"subgroupXor":return this.builtins.SubgroupXor(e,t);case"quadBroadcast":return this.builtins.QuadBroadcast(e,t);case"quadSwapDiagonal":return this.builtins.QuadSwapDiagonal(e,t);case"quadSwapX":return this.builtins.QuadSwapX(e,t);case"quadSwapY":return this.builtins.QuadSwapY(e,t)}const r=t.getFunction(e.name);if(r){const i=t.clone();for(let a=0;a<r.node.args.length;++a){const l=r.node.args[a],c=this.evalExpression(e.args[a],i);i.setVariable(l.name,c,l)}return this._execStatements(r.node.body,i)}return null}_callConstructorValue(e,t){if(!e.args||e.args.length===0)return new U(0,this.getTypeInfo(e.type));const r=this.evalExpression(e.args[0],t);return r.typeInfo=this.getTypeInfo(e.type),r.getSubData(this,e.postfix,t).clone()}_callConstructorVec(e,t){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=zp[i];if(a===void 0)return console.error(`Invalid vec constructor ${i}. Line ${e.line}`),null;const l=[];if(e instanceof vt)if(e.isVector){const c=e.vectorValue;for(const f of c)l.push(f)}else l.push(e.scalarValue);else if(e.args)for(const c of e.args){const f=this.evalExpression(c,t);if(f instanceof M){const d=f.data;for(let p=0;p<d.length;++p){let _=d[p];l.push(_)}}else if(f instanceof U){let d=f.value;l.push(d)}}if(e.type instanceof z&&e.type.format===null&&(e.type.format=z.f32),l.length===0){const c=new Array(a).fill(0);return new M(c,r).getSubData(this,e.postfix,t)}if(l.length===1)for(;l.length<a;)l.push(l[0]);return l.length<a?(console.error(`Invalid vec constructor. Line ${e.line}`),null):new M(l.length>a?l.slice(0,a):l,r).getSubData(this,e.postfix,t)}_callConstructorMatrix(e,t){const r=this.getTypeInfo(e.type),i=e.type.getTypeName(),a=Xt[i];if(a===void 0)return console.error(`Invalid matrix constructor ${i}. Line ${e.line}`),null;const l=[];if(e instanceof vt)if(e.isVector){const c=e.vectorValue;for(const f of c)l.push(f)}else l.push(e.scalarValue);else if(e.args)for(const c of e.args){const f=this.evalExpression(c,t);f instanceof M?l.push(...f.data):f instanceof U?l.push(f.value):f instanceof xe&&l.push(...f.data)}if(r instanceof es&&r.format===null&&(r.format=this.getTypeInfo("f32")),l.length===0){const c=new Array(a[2]).fill(0);return new xe(c,r).getSubData(this,e.postfix,t)}return l.length!==a[2]?(console.error(`Invalid matrix constructor. Line ${e.line}`),null):new xe(l,r).getSubData(this,e.postfix,t)}}zt._breakObj=new Mn(new En("BREAK",null),null),zt._continueObj=new Mn(new En("CONTINUE",null),null),zt._priority=new Map([["f32",0],["f16",1],["u32",2],["i32",3],["x32",3]]);class X6{constructor(){this.constants=new Map,this.aliases=new Map,this.structs=new Map}}class Y6{constructor(){this._tokens=[],this._current=0,this._currentLine=1,this._deferArrayCountEval=[],this._currentLoop=[],this._context=new X6,this._exec=new zt,this._forwardTypeCount=0}parse(e){this._initialize(e),this._deferArrayCountEval.length=0;const t=[];for(;!this._isAtEnd();){const r=this._global_decl_or_directive();if(!r)break;t.push(r)}if(this._deferArrayCountEval.length>0){for(const r of this._deferArrayCountEval){const i=r.arrayType,a=r.countNode;if(a instanceof dn){const l=a.name,c=this._context.constants.get(l);if(c)try{const f=c.constEvaluate(this._exec);i.count=f}catch{}}}this._deferArrayCountEval.length=0}if(this._forwardTypeCount>0)for(const r of t)r.search(i=>{i instanceof rT||i instanceof Lp?i.type=this._forwardType(i.type):i instanceof ll?i.format=this._forwardType(i.format):i instanceof Cr||i instanceof ol||i instanceof wu?i.type=this._forwardType(i.type):i instanceof wl?i.returnType=this._forwardType(i.returnType):i instanceof nT&&(i.type=this._forwardType(i.type))});return t}_forwardType(e){if(e instanceof tT){const t=this._getType(e.name);if(t)return t}else e instanceof Lp?e.type=this._forwardType(e.type):e instanceof ll&&(e.format=this._forwardType(e.format));return e}_initialize(e){if(e)if(typeof e=="string"){const t=new U6(e);this._tokens=t.scanTokens()}else this._tokens=e;else this._tokens=[];this._current=0}_updateNode(e,t){return e.line=t??this._currentLine,e}_error(e,t){return{token:e,message:t,toString:()=>`${t}`}}_isAtEnd(){return this._current>=this._tokens.length||this._peek().type==S.eof}_match(e){if(e instanceof F)return!!this._check(e)&&(this._advance(),!0);for(let t=0,r=e.length;t<r;++t){const i=e[t];if(this._check(i))return this._advance(),!0}return!1}_consume(e,t){if(this._check(e))return this._advance();throw this._error(this._peek(),`${t}. Line:${this._currentLine}`)}_check(e){if(this._isAtEnd())return!1;const t=this._peek();if(e instanceof Array){const r=t.type;let i=!1;for(const a of e){if(r===a)return!0;a===S.tokens.name&&(i=!0)}if(i){const a=S.tokens.name.rule.exec(t.lexeme);if(a&&a.index==0&&a[0]==t.lexeme)return!0}return!1}if(t.type===e)return!0;if(e===S.tokens.name){const r=S.tokens.name.rule.exec(t.lexeme);return r&&r.index==0&&r[0]==t.lexeme}return!1}_advance(){var e,t;return this._currentLine=(t=(e=this._peek())===null||e===void 0?void 0:e.line)!==null&&t!==void 0?t:-1,this._isAtEnd()||this._current++,this._previous()}_peek(){return this._tokens[this._current]}_previous(){return this._tokens[this._current-1]}_global_decl_or_directive(){for(;this._match(S.tokens.semicolon)&&!this._isAtEnd(););if(this._match(S.keywords.alias)){const t=this._type_alias();return this._consume(S.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(S.keywords.diagnostic)){const t=this._diagnostic();return this._consume(S.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(S.keywords.requires)){const t=this._requires_directive();return this._consume(S.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}if(this._match(S.keywords.enable)){const t=this._enable_directive();return this._consume(S.tokens.semicolon,"Expected ';'"),this._exec.reflection.updateAST([t]),t}const e=this._attribute();if(this._check(S.keywords.var)){const t=this._global_variable_decl();return t!=null&&(t.attributes=e),this._consume(S.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(S.keywords.override)){const t=this._override_variable_decl();return t!=null&&(t.attributes=e),this._consume(S.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(S.keywords.let)){const t=this._global_let_decl();return t!=null&&(t.attributes=e),this._consume(S.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(S.keywords.const)){const t=this._global_const_decl();return t!=null&&(t.attributes=e),this._consume(S.tokens.semicolon,"Expected ';'."),this._exec.reflection.updateAST([t]),t}if(this._check(S.keywords.struct)){const t=this._struct_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}if(this._check(S.keywords.fn)){const t=this._function_decl();return t!=null&&(t.attributes=e),this._exec.reflection.updateAST([t]),t}return null}_function_decl(){if(!this._match(S.keywords.fn))return null;const e=this._currentLine,t=this._consume(S.tokens.ident,"Expected function name.").toString();this._consume(S.tokens.paren_left,"Expected '(' for function arguments.");const r=[];if(!this._check(S.tokens.paren_right))do{if(this._check(S.tokens.paren_right))break;const c=this._attribute(),f=this._consume(S.tokens.name,"Expected argument name.").toString();this._consume(S.tokens.colon,"Expected ':' for argument type.");const d=this._attribute(),p=this._type_decl();p!=null&&(p.attributes=d,r.push(this._updateNode(new nT(f,p,c))))}while(this._match(S.tokens.comma));this._consume(S.tokens.paren_right,"Expected ')' after function arguments.");let i=null;if(this._match(S.tokens.arrow)){const c=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=c)}const a=this._compound_statement(),l=this._currentLine;return this._updateNode(new wl(t,r,i,a,e,l),e)}_compound_statement(){const e=[];for(this._consume(S.tokens.brace_left,"Expected '{' for block.");!this._check(S.tokens.brace_right);){const t=this._statement();t!==null&&e.push(t)}return this._consume(S.tokens.brace_right,"Expected '}' for block."),e}_statement(){for(;this._match(S.tokens.semicolon)&&!this._isAtEnd(););if(this._check(S.tokens.attr)&&this._attribute(),this._check(S.keywords.if))return this._if_statement();if(this._check(S.keywords.switch))return this._switch_statement();if(this._check(S.keywords.loop))return this._loop_statement();if(this._check(S.keywords.for))return this._for_statement();if(this._check(S.keywords.while))return this._while_statement();if(this._check(S.keywords.continuing))return this._continuing_statement();if(this._check(S.keywords.static_assert))return this._static_assert_statement();if(this._check(S.tokens.brace_left))return this._compound_statement();let e=null;if(this._check(S.keywords.return))e=this._return_statement();else if(this._check([S.keywords.var,S.keywords.let,S.keywords.const]))e=this._variable_statement();else if(this._match(S.keywords.discard))e=this._updateNode(new k6);else if(this._match(S.keywords.break)){const t=this._updateNode(new Fw);if(this._currentLoop.length>0){const r=this._currentLoop[this._currentLoop.length-1];t.loopId=r.id}e=t,this._check(S.keywords.if)&&(this._advance(),t.condition=this._optional_paren_expression())}else if(this._match(S.keywords.continue)){const t=this._updateNode(new Lw);if(!(this._currentLoop.length>0))throw this._error(this._peek(),`Continue statement must be inside a loop. Line: ${t.line}`);{const r=this._currentLoop[this._currentLoop.length-1];t.loopId=r.id}e=t}else e=this._increment_decrement_statement()||this._func_call_statement()||this._assignment_statement();return e!=null&&this._consume(S.tokens.semicolon,"Expected ';' after statement."),e}_static_assert_statement(){if(!this._match(S.keywords.static_assert))return null;const e=this._currentLine,t=this._optional_paren_expression();return this._updateNode(new O6(t),e)}_while_statement(){if(!this._match(S.keywords.while))return null;const e=this._updateNode(new Mw(null,null));return this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(S.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_continuing_statement(){const e=this._currentLoop.length>0?this._currentLoop[this._currentLoop.length-1].id:-1;if(!this._match(S.keywords.continuing))return null;const t=this._currentLine,r=this._compound_statement();return this._updateNode(new Xg(r,e),t)}_for_statement(){if(!this._match(S.keywords.for))return null;this._consume(S.tokens.paren_left,"Expected '('.");const e=this._updateNode(new Ow(null,null,null,null));return this._currentLoop.push(e),e.init=this._check(S.tokens.semicolon)?null:this._for_init(),this._consume(S.tokens.semicolon,"Expected ';'."),e.condition=this._check(S.tokens.semicolon)?null:this._short_circuit_or_expression(),this._consume(S.tokens.semicolon,"Expected ';'."),e.increment=this._check(S.tokens.paren_right)?null:this._for_increment(),this._consume(S.tokens.paren_right,"Expected ')'."),this._check(S.tokens.attr)&&this._attribute(),e.body=this._compound_statement(),this._currentLoop.pop(),e}_for_init(){return this._variable_statement()||this._func_call_statement()||this._assignment_statement()}_for_increment(){return this._func_call_statement()||this._increment_decrement_statement()||this._assignment_statement()}_variable_statement(){if(this._check(S.keywords.var)){const e=this._variable_decl();if(e===null)throw this._error(this._peek(),"Variable declaration expected.");let t=null;return this._match(S.tokens.equal)&&(t=this._short_circuit_or_expression()),this._updateNode(new Cr(e.name,e.type,e.storage,e.access,t),e.line)}if(this._match(S.keywords.let)){const e=this._currentLine,t=this._consume(S.tokens.name,"Expected name for let.").toString();let r=null;if(this._match(S.tokens.colon)){const a=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=a)}this._consume(S.tokens.equal,"Expected '=' for let.");const i=this._short_circuit_or_expression();return this._updateNode(new ol(t,r,null,null,i),e)}if(this._match(S.keywords.const)){const e=this._currentLine,t=this._consume(S.tokens.name,"Expected name for const.").toString();let r=null;if(this._match(S.tokens.colon)){const a=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=a)}this._consume(S.tokens.equal,"Expected '=' for const.");const i=this._short_circuit_or_expression();return r===null&&i instanceof vt&&(r=i.type),this._updateNode(new wu(t,r,null,null,i),e)}return null}_increment_decrement_statement(){const e=this._current,t=this._unary_expression();if(t==null)return null;if(!this._check(S.increment_operators))return this._current=e,null;const r=this._consume(S.increment_operators,"Expected increment operator");return this._updateNode(new Iw(r.type===S.tokens.plus_plus?ca.increment:ca.decrement,t))}_assignment_statement(){let e=null;const t=this._currentLine;if(this._check(S.tokens.brace_right))return null;let r=this._match(S.tokens.underscore);if(r||(e=this._unary_expression()),!r&&e==null)return null;const i=this._consume(S.assignment_operators,"Expected assignment operator."),a=this._short_circuit_or_expression();return this._updateNode(new Nw(el.parse(i.lexeme),e,a),t)}_func_call_statement(){if(!this._check(S.tokens.ident))return null;const e=this._currentLine,t=this._current,r=this._consume(S.tokens.ident,"Expected function name."),i=this._argument_expression_list();return i===null?(this._current=t,null):this._updateNode(new q_(r.lexeme,i),e)}_loop_statement(){if(!this._match(S.keywords.loop))return null;this._check(S.tokens.attr)&&this._attribute(),this._consume(S.tokens.brace_left,"Expected '{' for loop.");const e=this._updateNode(new kw([],null));this._currentLoop.push(e);let t=this._statement();for(;t!==null;){if(Array.isArray(t))for(let r of t)e.body.push(r);else e.body.push(t);if(t instanceof Xg){e.continuing=t;break}t=this._statement()}return this._currentLoop.pop(),this._consume(S.tokens.brace_right,"Expected '}' for loop."),e}_switch_statement(){if(!this._match(S.keywords.switch))return null;const e=this._updateNode(new Dw(null,[]));if(this._currentLoop.push(e),e.condition=this._optional_paren_expression(),this._check(S.tokens.attr)&&this._attribute(),this._consume(S.tokens.brace_left,"Expected '{' for switch."),e.cases=this._switch_body(),e.cases==null||e.cases.length==0)throw this._error(this._previous(),"Expected 'case' or 'default'.");return this._consume(S.tokens.brace_right,"Expected '}' for switch."),this._currentLoop.pop(),e}_switch_body(){const e=[];let t=!1;for(;this._check([S.keywords.default,S.keywords.case]);){if(this._match(S.keywords.case)){const r=this._case_selectors();for(const a of r)if(a instanceof xu){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");t=!0;break}this._match(S.tokens.colon),this._check(S.tokens.attr)&&this._attribute(),this._consume(S.tokens.brace_left,"Exected '{' for switch case.");const i=this._case_body();this._consume(S.tokens.brace_right,"Exected '}' for switch case."),e.push(this._updateNode(new $w(r,i)))}if(this._match(S.keywords.default)){if(t)throw this._error(this._previous(),"Multiple default cases in switch statement.");this._match(S.tokens.colon),this._check(S.tokens.attr)&&this._attribute(),this._consume(S.tokens.brace_left,"Exected '{' for switch default.");const r=this._case_body();this._consume(S.tokens.brace_right,"Exected '}' for switch default."),e.push(this._updateNode(new Ww(r)))}}return e}_case_selectors(){const e=[];for(this._match(S.keywords.default)?e.push(this._updateNode(new xu)):e.push(this._shift_expression());this._match(S.tokens.comma);)this._match(S.keywords.default)?e.push(this._updateNode(new xu)):e.push(this._shift_expression());return e}_case_body(){if(this._match(S.keywords.fallthrough))return this._consume(S.tokens.semicolon,"Expected ';'"),[];let e=this._statement();if(e==null)return[];e instanceof Array||(e=[e]);const t=this._case_body();return t.length==0?e:[...e,t[0]]}_if_statement(){if(!this._match(S.keywords.if))return null;const e=this._currentLine,t=this._optional_paren_expression();this._check(S.tokens.attr)&&this._attribute();const r=this._compound_statement();let i=[];this._match_elseif()&&(this._check(S.tokens.attr)&&this._attribute(),i=this._elseif_statement(i));let a=null;return this._match(S.keywords.else)&&(this._check(S.tokens.attr)&&this._attribute(),a=this._compound_statement()),this._updateNode(new Pw(t,r,i,a),e)}_match_elseif(){return this._tokens[this._current].type===S.keywords.else&&this._tokens[this._current+1].type===S.keywords.if&&(this._advance(),this._advance(),!0)}_elseif_statement(e=[]){const t=this._optional_paren_expression(),r=this._compound_statement();return e.push(this._updateNode(new D6(t,r))),this._match_elseif()&&(this._check(S.tokens.attr)&&this._attribute(),this._elseif_statement(e)),e}_return_statement(){if(!this._match(S.keywords.return))return null;const e=this._short_circuit_or_expression();return this._updateNode(new Uw(e))}_short_circuit_or_expression(){let e=this._short_circuit_and_expr();for(;this._match(S.tokens.or_or);)e=this._updateNode(new Pn(this._previous().toString(),e,this._short_circuit_and_expr()));return e}_short_circuit_and_expr(){let e=this._inclusive_or_expression();for(;this._match(S.tokens.and_and);)e=this._updateNode(new Pn(this._previous().toString(),e,this._inclusive_or_expression()));return e}_inclusive_or_expression(){let e=this._exclusive_or_expression();for(;this._match(S.tokens.or);)e=this._updateNode(new Pn(this._previous().toString(),e,this._exclusive_or_expression()));return e}_exclusive_or_expression(){let e=this._and_expression();for(;this._match(S.tokens.xor);)e=this._updateNode(new Pn(this._previous().toString(),e,this._and_expression()));return e}_and_expression(){let e=this._equality_expression();for(;this._match(S.tokens.and);)e=this._updateNode(new Pn(this._previous().toString(),e,this._equality_expression()));return e}_equality_expression(){const e=this._relational_expression();return this._match([S.tokens.equal_equal,S.tokens.not_equal])?this._updateNode(new Pn(this._previous().toString(),e,this._relational_expression())):e}_relational_expression(){let e=this._shift_expression();for(;this._match([S.tokens.less_than,S.tokens.greater_than,S.tokens.less_than_equal,S.tokens.greater_than_equal]);)e=this._updateNode(new Pn(this._previous().toString(),e,this._shift_expression()));return e}_shift_expression(){let e=this._additive_expression();for(;this._match([S.tokens.shift_left,S.tokens.shift_right]);)e=this._updateNode(new Pn(this._previous().toString(),e,this._additive_expression()));return e}_additive_expression(){let e=this._multiplicative_expression();for(;this._match([S.tokens.plus,S.tokens.minus]);)e=this._updateNode(new Pn(this._previous().toString(),e,this._multiplicative_expression()));return e}_multiplicative_expression(){let e=this._unary_expression();for(;this._match([S.tokens.star,S.tokens.forward_slash,S.tokens.modulo]);)e=this._updateNode(new Pn(this._previous().toString(),e,this._unary_expression()));return e}_unary_expression(){return this._match([S.tokens.minus,S.tokens.bang,S.tokens.tilde,S.tokens.star,S.tokens.and])?this._updateNode(new _t(this._previous().toString(),this._unary_expression())):this._singular_expression()}_singular_expression(){const e=this._primary_expression(),t=this._postfix_expression();return t&&(e.postfix=t),e}_postfix_expression(){if(this._match(S.tokens.bracket_left)){const e=this._short_circuit_or_expression();this._consume(S.tokens.bracket_right,"Expected ']'.");const t=this._updateNode(new Ea(e)),r=this._postfix_expression();return r&&(t.postfix=r),t}if(this._match(S.tokens.period)){const e=this._consume(S.tokens.name,"Expected member name."),t=this._postfix_expression(),r=this._updateNode(new ts(e.lexeme));return t&&(r.postfix=t),r}return null}_getStruct(e){return this._context.aliases.has(e)?this._context.aliases.get(e).type:this._context.structs.has(e)?this._context.structs.get(e):null}_getType(e){const t=this._getStruct(e);if(t!==null)return t;switch(e){case"void":return J.void;case"bool":return J.bool;case"i32":return J.i32;case"u32":return J.u32;case"f32":return J.f32;case"f16":return J.f16;case"vec2f":return z.vec2f;case"vec3f":return z.vec3f;case"vec4f":return z.vec4f;case"vec2i":return z.vec2i;case"vec3i":return z.vec3i;case"vec4i":return z.vec4i;case"vec2u":return z.vec2u;case"vec3u":return z.vec3u;case"vec4u":return z.vec4u;case"vec2h":return z.vec2h;case"vec3h":return z.vec3h;case"vec4h":return z.vec4h;case"mat2x2f":return z.mat2x2f;case"mat2x3f":return z.mat2x3f;case"mat2x4f":return z.mat2x4f;case"mat3x2f":return z.mat3x2f;case"mat3x3f":return z.mat3x3f;case"mat3x4f":return z.mat3x4f;case"mat4x2f":return z.mat4x2f;case"mat4x3f":return z.mat4x3f;case"mat4x4f":return z.mat4x4f;case"mat2x2h":return z.mat2x2h;case"mat2x3h":return z.mat2x3h;case"mat2x4h":return z.mat2x4h;case"mat3x2h":return z.mat3x2h;case"mat3x3h":return z.mat3x3h;case"mat3x4h":return z.mat3x4h;case"mat4x2h":return z.mat4x2h;case"mat4x3h":return z.mat4x3h;case"mat4x4h":return z.mat4x4h;case"mat2x2i":return z.mat2x2i;case"mat2x3i":return z.mat2x3i;case"mat2x4i":return z.mat2x4i;case"mat3x2i":return z.mat3x2i;case"mat3x3i":return z.mat3x3i;case"mat3x4i":return z.mat3x4i;case"mat4x2i":return z.mat4x2i;case"mat4x3i":return z.mat4x3i;case"mat4x4i":return z.mat4x4i;case"mat2x2u":return z.mat2x2u;case"mat2x3u":return z.mat2x3u;case"mat2x4u":return z.mat2x4u;case"mat3x2u":return z.mat3x2u;case"mat3x3u":return z.mat3x3u;case"mat3x4u":return z.mat3x4u;case"mat4x2u":return z.mat4x2u;case"mat4x3u":return z.mat4x3u;case"mat4x4u":return z.mat4x4u}return null}_validateTypeRange(e,t){if(t.name==="i32"){if(e<-2147483648||e>2147483647)throw this._error(this._previous(),`Value out of range for i32: ${e}. Line: ${this._currentLine}.`)}else if(t.name==="u32"&&(e<0||e>4294967295))throw this._error(this._previous(),`Value out of range for u32: ${e}. Line: ${this._currentLine}.`)}_primary_expression(){if(this._match(S.tokens.ident)){const r=this._previous().toString();if(this._check(S.tokens.paren_left)){const i=this._argument_expression_list(),a=this._getType(r);return a!==null?this._updateNode(new Qn(a,i)):this._updateNode(new Z_(r,i))}if(this._context.constants.has(r)){const i=this._context.constants.get(r);return this._updateNode(new zw(r,i.value))}return this._updateNode(new dn(r))}if(this._match(S.tokens.int_literal)){const r=this._previous().toString();let i=r.endsWith("i")||r.endsWith("i")?J.i32:r.endsWith("u")||r.endsWith("U")?J.u32:J.x32;const a=parseInt(r);return this._validateTypeRange(a,i),this._updateNode(new vt(new U(a,this._exec.getTypeInfo(i)),i))}if(this._match(S.tokens.uint_literal)){const r=parseInt(this._previous().toString());return this._validateTypeRange(r,J.u32),this._updateNode(new vt(new U(r,this._exec.getTypeInfo(J.u32)),J.u32))}if(this._match([S.tokens.decimal_float_literal,S.tokens.hex_float_literal])){let r=this._previous().toString(),i=r.endsWith("h");i&&(r=r.substring(0,r.length-1));const a=parseFloat(r);this._validateTypeRange(a,i?J.f16:J.f32);const l=i?J.f16:J.f32;return this._updateNode(new vt(new U(a,this._exec.getTypeInfo(l)),l))}if(this._match([S.keywords.true,S.keywords.false])){let r=this._previous().toString()===S.keywords.true.rule;return this._updateNode(new vt(new U(r?1:0,this._exec.getTypeInfo(J.bool)),J.bool))}if(this._check(S.tokens.paren_left))return this._paren_expression();if(this._match(S.keywords.bitcast)){this._consume(S.tokens.less_than,"Expected '<'.");const r=this._type_decl();this._consume(S.tokens.greater_than,"Expected '>'.");const i=this._paren_expression();return this._updateNode(new Vw(r,i))}const e=this._type_decl(),t=this._argument_expression_list();return this._updateNode(new Qn(e,t))}_argument_expression_list(){if(!this._match(S.tokens.paren_left))return null;const e=[];do{if(this._check(S.tokens.paren_right))break;const t=this._short_circuit_or_expression();e.push(t)}while(this._match(S.tokens.comma));return this._consume(S.tokens.paren_right,"Expected ')' for agument list"),e}_optional_paren_expression(){this._match(S.tokens.paren_left);const e=this._short_circuit_or_expression();return this._match(S.tokens.paren_right),e}_paren_expression(){this._consume(S.tokens.paren_left,"Expected '('.");const e=this._short_circuit_or_expression();return this._consume(S.tokens.paren_right,"Expected ')'."),e}_struct_decl(){if(!this._match(S.keywords.struct))return null;const e=this._currentLine,t=this._consume(S.tokens.ident,"Expected name for struct.").toString();this._consume(S.tokens.brace_left,"Expected '{' for struct body.");const r=[];for(;!this._check(S.tokens.brace_right);){const l=this._attribute(),c=this._consume(S.tokens.name,"Expected variable name.").toString();this._consume(S.tokens.colon,"Expected ':' for struct member type.");const f=this._attribute(),d=this._type_decl();d!=null&&(d.attributes=f),this._check(S.tokens.brace_right)?this._match(S.tokens.comma):this._consume(S.tokens.comma,"Expected ',' for struct member."),r.push(this._updateNode(new rT(c,d,l)))}this._consume(S.tokens.brace_right,"Expected '}' after struct body.");const i=this._currentLine,a=this._updateNode(new Ar(t,r,e,i),e);return this._context.structs.set(t,a),a}_global_variable_decl(){const e=this._variable_decl();if(!e)return null;if(this._match(S.tokens.equal)){const t=this._const_expression();e.value=t}if(e.type!==null&&e.value instanceof vt){if(e.value.type.name!=="x32"&&e.type.getTypeName()!==e.value.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${e.value.type.name} to ${e.type.name}. Line:${this._currentLine}`);e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type),e.value.type=e.type}else e.type===null&&e.value instanceof vt&&(e.type=e.value.type.name==="x32"?J.i32:e.value.type,e.value.isScalar&&this._validateTypeRange(e.value.scalarValue,e.type));return e}_override_variable_decl(){const e=this._override_decl();return e&&this._match(S.tokens.equal)&&(e.value=this._const_expression()),e}_global_const_decl(){var e;if(!this._match(S.keywords.const))return null;const t=this._consume(S.tokens.name,"Expected variable name"),r=this._currentLine;let i=null;if(this._match(S.tokens.colon)){const f=this._attribute();i=this._type_decl(),i!=null&&(i.attributes=f)}let a=null;this._consume(S.tokens.equal,"const declarations require an assignment");const l=this._short_circuit_or_expression();try{let f=[J.f32],d=l.constEvaluate(this._exec,f);d instanceof U&&this._validateTypeRange(d.value,f[0]),f[0]instanceof z&&f[0].format===null&&d.typeInfo instanceof es&&d.typeInfo.format!==null&&(d.typeInfo.format.name==="f16"?f[0].format=J.f16:d.typeInfo.format.name==="f32"?f[0].format=J.f32:d.typeInfo.format.name==="i32"?f[0].format=J.i32:d.typeInfo.format.name==="u32"?f[0].format=J.u32:d.typeInfo.format.name==="bool"?f[0].format=J.bool:console.error(`TODO: impelement template format type ${d.typeInfo.format.name}`)),a=this._updateNode(new vt(d,f[0])),this._exec.context.setVariable(t.toString(),d)}catch{a=l}if(i!==null&&a instanceof vt){if(a.type.name!=="x32"&&i.getTypeName()!==a.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${a.type.name} to ${i.name}. Line:${this._currentLine}`);a.type=i,a.isScalar&&this._validateTypeRange(a.scalarValue,a.type)}else i===null&&a instanceof vt&&(i=(e=a==null?void 0:a.type)!==null&&e!==void 0?e:J.f32,i===J.x32&&(i=J.i32));const c=this._updateNode(new wu(t.toString(),i,"","",a),r);return this._context.constants.set(c.name,c),c}_global_let_decl(){if(!this._match(S.keywords.let))return null;const e=this._currentLine,t=this._consume(S.tokens.name,"Expected variable name");let r=null;if(this._match(S.tokens.colon)){const a=this._attribute();r=this._type_decl(),r!=null&&(r.attributes=a)}let i=null;if(this._match(S.tokens.equal)&&(i=this._const_expression()),r!==null&&i instanceof vt){if(i.type.name!=="x32"&&r.getTypeName()!==i.type.getTypeName())throw this._error(this._peek(),`Invalid cast from ${i.type.name} to ${r.name}. Line:${this._currentLine}`);i.type=r}else r===null&&i instanceof vt&&(r=i.type.name==="x32"?J.i32:i.type);return i instanceof vt&&i.isScalar&&this._validateTypeRange(i.scalarValue,r),this._updateNode(new ol(t.toString(),r,"","",i),e)}_const_expression(){return this._short_circuit_or_expression()}_variable_decl(){if(!this._match(S.keywords.var))return null;const e=this._currentLine;let t="",r="";this._match(S.tokens.less_than)&&(t=this._consume(S.storage_class,"Expected storage_class.").toString(),this._match(S.tokens.comma)&&(r=this._consume(S.access_mode,"Expected access_mode.").toString()),this._consume(S.tokens.greater_than,"Expected '>'."));const i=this._consume(S.tokens.name,"Expected variable name");let a=null;if(this._match(S.tokens.colon)){const l=this._attribute();a=this._type_decl(),a!=null&&(a.attributes=l)}return this._updateNode(new Cr(i.toString(),a,t,r,null),e)}_override_decl(){if(!this._match(S.keywords.override))return null;const e=this._consume(S.tokens.name,"Expected variable name");let t=null;if(this._match(S.tokens.colon)){const r=this._attribute();t=this._type_decl(),t!=null&&(t.attributes=r)}return this._updateNode(new Y_(e.toString(),t,null))}_diagnostic(){this._consume(S.tokens.paren_left,"Expected '('");const e=this._consume(S.tokens.ident,"Expected severity control name.");this._consume(S.tokens.comma,"Expected ','");let t=this._consume(S.tokens.ident,"Expected diagnostic rule name.").toString();return this._match(S.tokens.period)&&(t+=`.${this._consume(S.tokens.ident,"Expected diagnostic message.").toString()}`),this._consume(S.tokens.paren_right,"Expected ')'"),this._updateNode(new Bw(e.toString(),t))}_enable_directive(){const e=this._consume(S.tokens.ident,"identity expected.");return this._updateNode(new I6(e.toString()))}_requires_directive(){const e=[this._consume(S.tokens.ident,"identity expected.").toString()];for(;this._match(S.tokens.comma);){const t=this._consume(S.tokens.ident,"identity expected.");e.push(t.toString())}return this._updateNode(new N6(e))}_type_alias(){const e=this._consume(S.tokens.ident,"identity expected.");this._consume(S.tokens.equal,"Expected '=' for type alias.");let t=this._type_decl();if(t===null)throw this._error(this._peek(),"Expected Type for Alias.");this._context.aliases.has(t.name)&&(t=this._context.aliases.get(t.name).type);const r=this._updateNode(new K_(e.toString(),t));return this._context.aliases.set(r.name,r),r}_type_decl(){if(this._check([S.tokens.ident,...S.texel_format,S.keywords.bool,S.keywords.f32,S.keywords.i32,S.keywords.u32])){const r=this._advance().toString();if(this._context.structs.has(r))return this._context.structs.get(r);if(this._context.aliases.has(r))return this._context.aliases.get(r).type;if(!this._getType(r)){const i=this._updateNode(new tT(r));return this._forwardTypeCount++,i}return this._updateNode(new J(r))}let e=this._texture_sampler_types();if(e)return e;if(this._check(S.template_types)){let r=this._advance().toString(),i=null,a=null;return this._match(S.tokens.less_than)&&(i=this._type_decl(),a=null,this._match(S.tokens.comma)&&(a=this._consume(S.access_mode,"Expected access_mode for pointer").toString()),this._consume(S.tokens.greater_than,"Expected '>' for type.")),this._updateNode(new z(r,i,a))}if(this._match(S.keywords.ptr)){let r=this._previous().toString();this._consume(S.tokens.less_than,"Expected '<' for pointer.");const i=this._consume(S.storage_class,"Expected storage_class for pointer");this._consume(S.tokens.comma,"Expected ',' for pointer.");const a=this._type_decl();let l=null;return this._match(S.tokens.comma)&&(l=this._consume(S.access_mode,"Expected access_mode for pointer").toString()),this._consume(S.tokens.greater_than,"Expected '>' for pointer."),this._updateNode(new Lp(r,i.toString(),a,l))}const t=this._attribute();if(this._match(S.keywords.array)){let r=null,i=-1;const a=this._previous();let l=null;if(this._match(S.tokens.less_than)){r=this._type_decl(),this._context.aliases.has(r.name)&&(r=this._context.aliases.get(r.name).type);let f="";if(this._match(S.tokens.comma)){l=this._shift_expression();try{f=l.constEvaluate(this._exec).toString(),l=null}catch{f="1"}}this._consume(S.tokens.greater_than,"Expected '>' for array."),i=f?parseInt(f):0}const c=this._updateNode(new ll(a.toString(),t,r,i));return l&&this._deferArrayCountEval.push({arrayType:c,countNode:l}),c}return null}_texture_sampler_types(){if(this._match(S.sampler_type))return this._updateNode(new tl(this._previous().toString(),null,null));if(this._match(S.depth_texture_type))return this._updateNode(new tl(this._previous().toString(),null,null));if(this._match(S.sampled_texture_type)||this._match(S.multisampled_texture_type)){const e=this._previous();this._consume(S.tokens.less_than,"Expected '<' for sampler type.");const t=this._type_decl();return this._consume(S.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new tl(e.toString(),t,null))}if(this._match(S.storage_texture_type)){const e=this._previous();this._consume(S.tokens.less_than,"Expected '<' for sampler type.");const t=this._consume(S.texel_format,"Invalid texel format.").toString();this._consume(S.tokens.comma,"Expected ',' after texel format.");const r=this._consume(S.access_mode,"Expected access mode for storage texture type.").toString();return this._consume(S.tokens.greater_than,"Expected '>' for sampler type."),this._updateNode(new tl(e.toString(),t,r))}return null}_attribute(){let e=[];for(;this._match(S.tokens.attr);){const t=this._consume(S.attribute_name,"Expected attribute name"),r=this._updateNode(new Xw(t.toString(),null));if(this._match(S.tokens.paren_left)){if(r.value=this._consume(S.literal_or_ident,"Expected attribute value").toString(),this._check(S.tokens.comma)){this._advance();do{const i=this._consume(S.literal_or_ident,"Expected attribute value").toString();r.value instanceof Array||(r.value=[r.value]),r.value.push(i)}while(this._match(S.tokens.comma))}this._consume(S.tokens.paren_right,"Expected ')'")}e.push(r)}return e.length==0?null:e}}class q6 extends tr{constructor(e){super(),e&&this.update(e)}update(e){const t=new Y6().parse(e);this.updateAST(t)}}function K6(n){var a;const e={attributes:[],bindings:[]};let t;try{t=Z6(n)}catch(l){return le.error(l.message)(),e}for(const l of t.uniforms){const c=[];for(const f of((a=l.type)==null?void 0:a.members)||[])c.push({name:f.name,type:aT(f.type)});e.bindings.push({type:"uniform",name:l.name,group:l.group,location:l.binding,members:c})}for(const l of t.textures)e.bindings.push({type:"texture",name:l.name,group:l.group,location:l.binding});for(const l of t.samplers)e.bindings.push({type:"sampler",name:l.name,group:l.group,location:l.binding});const r=t.entry.vertex[0],i=(r==null?void 0:r.inputs.length)||0;for(let l=0;l<i;l++){const c=r.inputs[l];if(c.locationType==="location"){const f=aT(c.type);e.attributes.push({name:c.name,location:Number(c.location),type:f})}}return e}function aT(n){return n.format?`${n.name}<${n.format.name}>`:n.name}function Z6(n){try{return new q6(n)}catch(e){if(e instanceof Error)throw e;let t="WGSL parse error";throw typeof e=="object"&&(e!=null&&e.message)&&(t+=`: ${e.message} `),typeof e=="object"&&(e!=null&&e.token)&&(t+=e.token.line||""),new Error(t,{cause:e})}}const Q6={EPSILON:1e-12,debug:!1,precision:4,printTypes:!1,printDegrees:!1,printRowMajor:!0,_cartographicRadians:!1};globalThis.mathgl=globalThis.mathgl||{config:{...Q6}};const Rn=globalThis.mathgl.config;function G6(n,{precision:e=Rn.precision}={}){return n=J6(n),`${parseFloat(n.toPrecision(e))}`}function Ra(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}function hi(n,e,t){return tU(n,r=>Math.max(e,Math.min(t,r)))}function xl(n,e,t){return Ra(n)?n.map((r,i)=>xl(r,e[i],t)):t*e+(1-t)*n}function Sl(n,e,t){const r=Rn.EPSILON;try{if(n===e)return!0;if(Ra(n)&&Ra(e)){if(n.length!==e.length)return!1;for(let i=0;i<n.length;++i)if(!Sl(n[i],e[i]))return!1;return!0}return n&&n.equals?n.equals(e):e&&e.equals?e.equals(n):typeof n=="number"&&typeof e=="number"?Math.abs(n-e)<=Rn.EPSILON*Math.max(1,Math.abs(n),Math.abs(e)):!1}finally{Rn.EPSILON=r}}function J6(n){return Math.round(n/Rn.EPSILON)*Rn.EPSILON}function eU(n){return n.clone?n.clone():new Array(n.length)}function tU(n,e,t){if(Ra(n)){const r=n;t=t||eU(r);for(let i=0;i<t.length&&i<r.length;++i){const a=typeof n=="number"?n:n[i];t[i]=e(a,i,t)}return t}return e(n)}class Yw extends Array{clone(){return new this.constructor().copy(this)}fromArray(e,t=0){for(let r=0;r<this.ELEMENTS;++r)this[r]=e[r+t];return this.check()}toArray(e=[],t=0){for(let r=0;r<this.ELEMENTS;++r)e[t+r]=this[r];return e}toObject(e){return e}from(e){return Array.isArray(e)?this.copy(e):this.fromObject(e)}to(e){return e===this?this:Ra(e)?this.toArray(e):this.toObject(e)}toTarget(e){return e?this.to(e):this}toFloat32Array(){return new Float32Array(this)}toString(){return this.formatString(Rn)}formatString(e){let t="";for(let r=0;r<this.ELEMENTS;++r)t+=(r>0?", ":"")+G6(this[r],e);return`${e.printTypes?this.constructor.name:""}[${t}]`}equals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(!Sl(this[t],e[t]))return!1;return!0}exactEquals(e){if(!e||this.length!==e.length)return!1;for(let t=0;t<this.ELEMENTS;++t)if(this[t]!==e[t])return!1;return!0}negate(){for(let e=0;e<this.ELEMENTS;++e)this[e]=-this[e];return this.check()}lerp(e,t,r){if(r===void 0)return this.lerp(this,e,t);for(let i=0;i<this.ELEMENTS;++i){const a=e[i],l=typeof t=="number"?t:t[i];this[i]=a+r*(l-a)}return this.check()}min(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.min(e[t],this[t]);return this.check()}max(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=Math.max(e[t],this[t]);return this.check()}clamp(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e[r]),t[r]);return this.check()}add(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]+=t[r];return this.check()}subtract(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]-=t[r];return this.check()}scale(e){if(typeof e=="number")for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;else for(let t=0;t<this.ELEMENTS&&t<e.length;++t)this[t]*=e[t];return this.check()}multiplyByScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}check(){if(Rn.debug&&!this.validate())throw new Error(`math.gl: ${this.constructor.name} some fields set to invalid numbers'`);return this}validate(){let e=this.length===this.ELEMENTS;for(let t=0;t<this.ELEMENTS;++t)e=e&&Number.isFinite(this[t]);return e}sub(e){return this.subtract(e)}setScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]=e;return this.check()}addScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]+=e;return this.check()}subScalar(e){return this.addScalar(-e)}multiplyScalar(e){for(let t=0;t<this.ELEMENTS;++t)this[t]*=e;return this.check()}divideScalar(e){return this.multiplyByScalar(1/e)}clampScalar(e,t){for(let r=0;r<this.ELEMENTS;++r)this[r]=Math.min(Math.max(this[r],e),t);return this.check()}get elements(){return this}}function nU(n,e){if(n.length!==e)return!1;for(let t=0;t<n.length;++t)if(!Number.isFinite(n[t]))return!1;return!0}function hn(n){if(!Number.isFinite(n))throw new Error(`Invalid number ${JSON.stringify(n)}`);return n}function Vp(n,e,t=""){if(Rn.debug&&!nU(n,e))throw new Error(`math.gl: ${t} some fields set to invalid numbers'`);return n}function oT(n,e){if(!n)throw new Error(`math.gl assertion ${e}`)}class rU extends Yw{get x(){return this[0]}set x(e){this[0]=hn(e)}get y(){return this[1]}set y(e){this[1]=hn(e)}len(){return Math.sqrt(this.lengthSquared())}magnitude(){return this.len()}lengthSquared(){let e=0;for(let t=0;t<this.ELEMENTS;++t)e+=this[t]*this[t];return e}magnitudeSquared(){return this.lengthSquared()}distance(e){return Math.sqrt(this.distanceSquared(e))}distanceSquared(e){let t=0;for(let r=0;r<this.ELEMENTS;++r){const i=this[r]-e[r];t+=i*i}return hn(t)}dot(e){let t=0;for(let r=0;r<this.ELEMENTS;++r)t+=this[r]*e[r];return hn(t)}normalize(){const e=this.magnitude();if(e!==0)for(let t=0;t<this.ELEMENTS;++t)this[t]/=e;return this.check()}multiply(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]*=t[r];return this.check()}divide(...e){for(const t of e)for(let r=0;r<this.ELEMENTS;++r)this[r]/=t[r];return this.check()}lengthSq(){return this.lengthSquared()}distanceTo(e){return this.distance(e)}distanceToSquared(e){return this.distanceSquared(e)}getComponent(e){return oT(e>=0&&e<this.ELEMENTS,"index is out of range"),hn(this[e])}setComponent(e,t){return oT(e>=0&&e<this.ELEMENTS,"index is out of range"),this[e]=t,this.check()}addVectors(e,t){return this.copy(e).add(t)}subVectors(e,t){return this.copy(e).subtract(t)}multiplyVectors(e,t){return this.copy(e).multiply(t)}addScaledVector(e,t){return this.add(new this.constructor(e).multiplyScalar(t))}}const Su=1e-6;let Ca=typeof Float32Array<"u"?Float32Array:Array;function iU(){const n=new Ca(2);return Ca!=Float32Array&&(n[0]=0,n[1]=0),n}function qg(n,e,t){return n[0]=e[0]+t[0],n[1]=e[1]+t[1],n}function sU(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n}function aU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n}function oU(n){const e=n[0],t=n[1];return Math.sqrt(e*e+t*t)}function lU(n,e){return n[0]=-e[0],n[1]=-e[1],n}function qw(n,e,t,r){const i=e[0],a=e[1];return n[0]=i+r*(t[0]-i),n[1]=a+r*(t[1]-a),n}function cU(n,e,t){const r=e[0],i=e[1];return n[0]=t[0]*r+t[4]*i+t[12],n[1]=t[1]*r+t[5]*i+t[13],n}const uU=sU;(function(){const n=iU();return function(e,t,r,i,a,l){let c,f;for(t||(t=2),r||(r=0),i?f=Math.min(i*t+r,e.length):f=e.length,c=r;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],a(n,n,l),e[c]=n[0],e[c+1]=n[1];return e}})();function fU(n,e,t){const r=e[0],i=e[1],a=t[3]*r+t[7]*i||1;return n[0]=(t[0]*r+t[4]*i)/a,n[1]=(t[1]*r+t[5]*i)/a,n}function Kw(n,e,t){const r=e[0],i=e[1],a=e[2],l=t[3]*r+t[7]*i+t[11]*a||1;return n[0]=(t[0]*r+t[4]*i+t[8]*a)/l,n[1]=(t[1]*r+t[5]*i+t[9]*a)/l,n[2]=(t[2]*r+t[6]*i+t[10]*a)/l,n}function hU(n,e,t){const r=e[0],i=e[1];return n[0]=t[0]*r+t[2]*i,n[1]=t[1]*r+t[3]*i,n[2]=e[2],n}function dU(){const n=new Ca(3);return Ca!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0),n}function pU(n,e,t){return n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n}function gU(n,e){return n[0]=-e[0],n[1]=-e[1],n[2]=-e[2],n}function _U(n,e){return n[0]*e[0]+n[1]*e[1]+n[2]*e[2]}function mU(n,e,t){const r=e[0],i=e[1],a=e[2],l=t[0],c=t[1],f=t[2];return n[0]=i*f-a*c,n[1]=a*l-r*f,n[2]=r*c-i*l,n}function Zw(n,e,t){const r=e[0],i=e[1],a=e[2];let l=t[3]*r+t[7]*i+t[11]*a+t[15];return l=l||1,n[0]=(t[0]*r+t[4]*i+t[8]*a+t[12])/l,n[1]=(t[1]*r+t[5]*i+t[9]*a+t[13])/l,n[2]=(t[2]*r+t[6]*i+t[10]*a+t[14])/l,n}function yU(n,e,t){const r=e[0],i=e[1],a=e[2];return n[0]=r*t[0]+i*t[3]+a*t[6],n[1]=r*t[1]+i*t[4]+a*t[7],n[2]=r*t[2]+i*t[5]+a*t[8],n}function bU(n,e,t){const r=t[0],i=t[1],a=t[2],l=t[3],c=e[0],f=e[1],d=e[2];let p=i*d-a*f,_=a*c-r*d,y=r*f-i*c,b=i*y-a*_,T=a*p-r*y,A=r*_-i*p;const C=l*2;return p*=C,_*=C,y*=C,b*=2,T*=2,A*=2,n[0]=c+p+b,n[1]=f+_+T,n[2]=d+y+A,n}function vU(n,e,t,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),n[0]=a[0]+t[0],n[1]=a[1]+t[1],n[2]=a[2]+t[2],n}function TU(n,e,t,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),n[0]=a[0]+t[0],n[1]=a[1]+t[1],n[2]=a[2]+t[2],n}function wU(n,e,t,r){const i=[],a=[];return i[0]=e[0]-t[0],i[1]=e[1]-t[1],i[2]=e[2]-t[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],n[0]=a[0]+t[0],n[1]=a[1]+t[1],n[2]=a[2]+t[2],n}function xU(n,e){const t=n[0],r=n[1],i=n[2],a=e[0],l=e[1],c=e[2],f=Math.sqrt((t*t+r*r+i*i)*(a*a+l*l+c*c)),d=f&&_U(n,e)/f;return Math.acos(Math.min(Math.max(d,-1),1))}const SU=pU;(function(){const n=dU();return function(e,t,r,i,a,l){let c,f;for(t||(t=3),r||(r=0),i?f=Math.min(i*t+r,e.length):f=e.length,c=r;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],n[2]=e[c+2],a(n,n,l),e[c]=n[0],e[c+1]=n[1],e[c+2]=n[2];return e}})();const Hp=[0,0,0];let uu;class rr extends rU{static get ZERO(){return uu||(uu=new rr(0,0,0),Object.freeze(uu)),uu}constructor(e=0,t=0,r=0){super(-0,-0,-0),arguments.length===1&&Ra(e)?this.copy(e):(Rn.debug&&(hn(e),hn(t),hn(r)),this[0]=e,this[1]=t,this[2]=r)}set(e,t,r){return this[0]=e,this[1]=t,this[2]=r,this.check()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this.check()}fromObject(e){return Rn.debug&&(hn(e.x),hn(e.y),hn(e.z)),this[0]=e.x,this[1]=e.y,this[2]=e.z,this.check()}toObject(e){return e.x=this[0],e.y=this[1],e.z=this[2],e}get ELEMENTS(){return 3}get z(){return this[2]}set z(e){this[2]=hn(e)}angle(e){return xU(this,e)}cross(e){return mU(this,this,e),this.check()}rotateX({radians:e,origin:t=Hp}){return vU(this,this,t,e),this.check()}rotateY({radians:e,origin:t=Hp}){return TU(this,this,t,e),this.check()}rotateZ({radians:e,origin:t=Hp}){return wU(this,this,t,e),this.check()}transform(e){return this.transformAsPoint(e)}transformAsPoint(e){return Zw(this,this,e),this.check()}transformAsVector(e){return Kw(this,this,e),this.check()}transformByMatrix3(e){return yU(this,this,e),this.check()}transformByMatrix2(e){return hU(this,this,e),this.check()}transformByQuaternion(e){return bU(this,this,e),this.check()}}class AU extends Yw{toString(){let e="[";if(Rn.printRowMajor){e+="row-major:";for(let t=0;t<this.RANK;++t)for(let r=0;r<this.RANK;++r)e+=` ${this[r*this.RANK+t]}`}else{e+="column-major:";for(let t=0;t<this.ELEMENTS;++t)e+=` ${this[t]}`}return e+="]",e}getElementIndex(e,t){return t*this.RANK+e}getElement(e,t){return this[t*this.RANK+e]}setElement(e,t,r){return this[t*this.RANK+e]=hn(r),this}getColumn(e,t=new Array(this.RANK).fill(-0)){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)t[i]=this[r+i];return t}setColumn(e,t){const r=e*this.RANK;for(let i=0;i<this.RANK;++i)this[r+i]=t[i];return this}}function EU(n){return n[0]=1,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=1,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=1,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function RU(n,e){if(n===e){const t=e[1],r=e[2],i=e[3],a=e[6],l=e[7],c=e[11];n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=t,n[6]=e[9],n[7]=e[13],n[8]=r,n[9]=a,n[11]=e[14],n[12]=i,n[13]=l,n[14]=c}else n[0]=e[0],n[1]=e[4],n[2]=e[8],n[3]=e[12],n[4]=e[1],n[5]=e[5],n[6]=e[9],n[7]=e[13],n[8]=e[2],n[9]=e[6],n[10]=e[10],n[11]=e[14],n[12]=e[3],n[13]=e[7],n[14]=e[11],n[15]=e[15];return n}function Kg(n,e){const t=e[0],r=e[1],i=e[2],a=e[3],l=e[4],c=e[5],f=e[6],d=e[7],p=e[8],_=e[9],y=e[10],b=e[11],T=e[12],A=e[13],C=e[14],N=e[15],O=t*c-r*l,R=t*f-i*l,E=t*d-a*l,k=r*f-i*c,V=r*d-a*c,ne=i*d-a*f,G=p*A-_*T,se=p*C-y*T,re=p*N-b*T,q=_*C-y*A,ce=_*N-b*A,me=y*N-b*C;let de=O*me-R*ce+E*q+k*re-V*se+ne*G;return de?(de=1/de,n[0]=(c*me-f*ce+d*q)*de,n[1]=(i*ce-r*me-a*q)*de,n[2]=(A*ne-C*V+N*k)*de,n[3]=(y*V-_*ne-b*k)*de,n[4]=(f*re-l*me-d*se)*de,n[5]=(t*me-i*re+a*se)*de,n[6]=(C*E-T*ne-N*R)*de,n[7]=(p*ne-y*E+b*R)*de,n[8]=(l*ce-c*re+d*G)*de,n[9]=(r*re-t*ce-a*G)*de,n[10]=(T*V-A*E+N*O)*de,n[11]=(_*E-p*V-b*O)*de,n[12]=(c*se-l*q-f*G)*de,n[13]=(t*q-r*se+i*G)*de,n[14]=(A*R-T*k-C*O)*de,n[15]=(p*k-_*R+y*O)*de,n):null}function CU(n){const e=n[0],t=n[1],r=n[2],i=n[3],a=n[4],l=n[5],c=n[6],f=n[7],d=n[8],p=n[9],_=n[10],y=n[11],b=n[12],T=n[13],A=n[14],C=n[15],N=e*l-t*a,O=e*c-r*a,R=t*c-r*l,E=d*T-p*b,k=d*A-_*b,V=p*A-_*T,ne=e*V-t*k+r*E,G=a*V-l*k+c*E,se=d*R-p*O+_*N,re=b*R-T*O+A*N;return f*ne-i*G+C*se-y*re}function Wi(n,e,t){const r=e[0],i=e[1],a=e[2],l=e[3],c=e[4],f=e[5],d=e[6],p=e[7],_=e[8],y=e[9],b=e[10],T=e[11],A=e[12],C=e[13],N=e[14],O=e[15];let R=t[0],E=t[1],k=t[2],V=t[3];return n[0]=R*r+E*c+k*_+V*A,n[1]=R*i+E*f+k*y+V*C,n[2]=R*a+E*d+k*b+V*N,n[3]=R*l+E*p+k*T+V*O,R=t[4],E=t[5],k=t[6],V=t[7],n[4]=R*r+E*c+k*_+V*A,n[5]=R*i+E*f+k*y+V*C,n[6]=R*a+E*d+k*b+V*N,n[7]=R*l+E*p+k*T+V*O,R=t[8],E=t[9],k=t[10],V=t[11],n[8]=R*r+E*c+k*_+V*A,n[9]=R*i+E*f+k*y+V*C,n[10]=R*a+E*d+k*b+V*N,n[11]=R*l+E*p+k*T+V*O,R=t[12],E=t[13],k=t[14],V=t[15],n[12]=R*r+E*c+k*_+V*A,n[13]=R*i+E*f+k*y+V*C,n[14]=R*a+E*d+k*b+V*N,n[15]=R*l+E*p+k*T+V*O,n}function ff(n,e,t){const r=t[0],i=t[1],a=t[2];let l,c,f,d,p,_,y,b,T,A,C,N;return e===n?(n[12]=e[0]*r+e[4]*i+e[8]*a+e[12],n[13]=e[1]*r+e[5]*i+e[9]*a+e[13],n[14]=e[2]*r+e[6]*i+e[10]*a+e[14],n[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(l=e[0],c=e[1],f=e[2],d=e[3],p=e[4],_=e[5],y=e[6],b=e[7],T=e[8],A=e[9],C=e[10],N=e[11],n[0]=l,n[1]=c,n[2]=f,n[3]=d,n[4]=p,n[5]=_,n[6]=y,n[7]=b,n[8]=T,n[9]=A,n[10]=C,n[11]=N,n[12]=l*r+p*i+T*a+e[12],n[13]=c*r+_*i+A*a+e[13],n[14]=f*r+y*i+C*a+e[14],n[15]=d*r+b*i+N*a+e[15]),n}function em(n,e,t){const r=t[0],i=t[1],a=t[2];return n[0]=e[0]*r,n[1]=e[1]*r,n[2]=e[2]*r,n[3]=e[3]*r,n[4]=e[4]*i,n[5]=e[5]*i,n[6]=e[6]*i,n[7]=e[7]*i,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n}function MU(n,e,t,r){let i=r[0],a=r[1],l=r[2],c=Math.sqrt(i*i+a*a+l*l),f,d,p,_,y,b,T,A,C,N,O,R,E,k,V,ne,G,se,re,q,ce,me,de,_e;return c<Su?null:(c=1/c,i*=c,a*=c,l*=c,d=Math.sin(t),f=Math.cos(t),p=1-f,_=e[0],y=e[1],b=e[2],T=e[3],A=e[4],C=e[5],N=e[6],O=e[7],R=e[8],E=e[9],k=e[10],V=e[11],ne=i*i*p+f,G=a*i*p+l*d,se=l*i*p-a*d,re=i*a*p-l*d,q=a*a*p+f,ce=l*a*p+i*d,me=i*l*p+a*d,de=a*l*p-i*d,_e=l*l*p+f,n[0]=_*ne+A*G+R*se,n[1]=y*ne+C*G+E*se,n[2]=b*ne+N*G+k*se,n[3]=T*ne+O*G+V*se,n[4]=_*re+A*q+R*ce,n[5]=y*re+C*q+E*ce,n[6]=b*re+N*q+k*ce,n[7]=T*re+O*q+V*ce,n[8]=_*me+A*de+R*_e,n[9]=y*me+C*de+E*_e,n[10]=b*me+N*de+k*_e,n[11]=T*me+O*de+V*_e,e!==n&&(n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n)}function Qw(n,e,t){const r=Math.sin(t),i=Math.cos(t),a=e[4],l=e[5],c=e[6],f=e[7],d=e[8],p=e[9],_=e[10],y=e[11];return e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[4]=a*i+d*r,n[5]=l*i+p*r,n[6]=c*i+_*r,n[7]=f*i+y*r,n[8]=d*i-a*r,n[9]=p*i-l*r,n[10]=_*i-c*r,n[11]=y*i-f*r,n}function OU(n,e,t){const r=Math.sin(t),i=Math.cos(t),a=e[0],l=e[1],c=e[2],f=e[3],d=e[8],p=e[9],_=e[10],y=e[11];return e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i-d*r,n[1]=l*i-p*r,n[2]=c*i-_*r,n[3]=f*i-y*r,n[8]=a*r+d*i,n[9]=l*r+p*i,n[10]=c*r+_*i,n[11]=f*r+y*i,n}function Gw(n,e,t){const r=Math.sin(t),i=Math.cos(t),a=e[0],l=e[1],c=e[2],f=e[3],d=e[4],p=e[5],_=e[6],y=e[7];return e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]),n[0]=a*i+d*r,n[1]=l*i+p*r,n[2]=c*i+_*r,n[3]=f*i+y*r,n[4]=d*i-a*r,n[5]=p*i-l*r,n[6]=_*i-c*r,n[7]=y*i-f*r,n}function IU(n,e){const t=e[0],r=e[1],i=e[2],a=e[3],l=t+t,c=r+r,f=i+i,d=t*l,p=r*l,_=r*c,y=i*l,b=i*c,T=i*f,A=a*l,C=a*c,N=a*f;return n[0]=1-_-T,n[1]=p+N,n[2]=y-C,n[3]=0,n[4]=p-N,n[5]=1-d-T,n[6]=b+A,n[7]=0,n[8]=y+C,n[9]=b-A,n[10]=1-d-_,n[11]=0,n[12]=0,n[13]=0,n[14]=0,n[15]=1,n}function NU(n,e,t,r,i,a,l){const c=1/(t-e),f=1/(i-r),d=1/(a-l);return n[0]=a*2*c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a*2*f,n[6]=0,n[7]=0,n[8]=(t+e)*c,n[9]=(i+r)*f,n[10]=(l+a)*d,n[11]=-1,n[12]=0,n[13]=0,n[14]=l*a*2*d,n[15]=0,n}function kU(n,e,t,r,i){const a=1/Math.tan(e/2);if(n[0]=a/t,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=a,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[11]=-1,n[12]=0,n[13]=0,n[15]=0,i!=null&&i!==1/0){const l=1/(r-i);n[10]=(i+r)*l,n[14]=2*i*r*l}else n[10]=-1,n[14]=-2*r;return n}const DU=kU;function PU(n,e,t,r,i,a,l){const c=1/(e-t),f=1/(r-i),d=1/(a-l);return n[0]=-2*c,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=-2*f,n[6]=0,n[7]=0,n[8]=0,n[9]=0,n[10]=2*d,n[11]=0,n[12]=(e+t)*c,n[13]=(i+r)*f,n[14]=(l+a)*d,n[15]=1,n}const UU=PU;function BU(n,e,t,r){let i,a,l,c,f,d,p,_,y,b;const T=e[0],A=e[1],C=e[2],N=r[0],O=r[1],R=r[2],E=t[0],k=t[1],V=t[2];return Math.abs(T-E)<Su&&Math.abs(A-k)<Su&&Math.abs(C-V)<Su?EU(n):(_=T-E,y=A-k,b=C-V,i=1/Math.sqrt(_*_+y*y+b*b),_*=i,y*=i,b*=i,a=O*b-R*y,l=R*_-N*b,c=N*y-O*_,i=Math.sqrt(a*a+l*l+c*c),i?(i=1/i,a*=i,l*=i,c*=i):(a=0,l=0,c=0),f=y*c-b*l,d=b*a-_*c,p=_*l-y*a,i=Math.sqrt(f*f+d*d+p*p),i?(i=1/i,f*=i,d*=i,p*=i):(f=0,d=0,p=0),n[0]=a,n[1]=f,n[2]=_,n[3]=0,n[4]=l,n[5]=d,n[6]=y,n[7]=0,n[8]=c,n[9]=p,n[10]=b,n[11]=0,n[12]=-(a*T+l*A+c*C),n[13]=-(f*T+d*A+p*C),n[14]=-(_*T+y*A+b*C),n[15]=1,n)}function FU(){const n=new Ca(4);return Ca!=Float32Array&&(n[0]=0,n[1]=0,n[2]=0,n[3]=0),n}function LU(n,e,t){return n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n}function kl(n,e,t){const r=e[0],i=e[1],a=e[2],l=e[3];return n[0]=t[0]*r+t[4]*i+t[8]*a+t[12]*l,n[1]=t[1]*r+t[5]*i+t[9]*a+t[13]*l,n[2]=t[2]*r+t[6]*i+t[10]*a+t[14]*l,n[3]=t[3]*r+t[7]*i+t[11]*a+t[15]*l,n}(function(){const n=FU();return function(e,t,r,i,a,l){let c,f;for(t||(t=4),r||(r=0),i?f=Math.min(i*t+r,e.length):f=e.length,c=r;c<f;c+=t)n[0]=e[c],n[1]=e[c+1],n[2]=e[c+2],n[3]=e[c+3],a(n,n,l),e[c]=n[0],e[c+1]=n[1],e[c+2]=n[2],e[c+3]=n[3];return e}})();var Zg;(function(n){n[n.COL0ROW0=0]="COL0ROW0",n[n.COL0ROW1=1]="COL0ROW1",n[n.COL0ROW2=2]="COL0ROW2",n[n.COL0ROW3=3]="COL0ROW3",n[n.COL1ROW0=4]="COL1ROW0",n[n.COL1ROW1=5]="COL1ROW1",n[n.COL1ROW2=6]="COL1ROW2",n[n.COL1ROW3=7]="COL1ROW3",n[n.COL2ROW0=8]="COL2ROW0",n[n.COL2ROW1=9]="COL2ROW1",n[n.COL2ROW2=10]="COL2ROW2",n[n.COL2ROW3=11]="COL2ROW3",n[n.COL3ROW0=12]="COL3ROW0",n[n.COL3ROW1=13]="COL3ROW1",n[n.COL3ROW2=14]="COL3ROW2",n[n.COL3ROW3=15]="COL3ROW3"})(Zg||(Zg={}));const zU=45*Math.PI/180,VU=1,jp=.1,$p=500,HU=Object.freeze([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]);class ir extends AU{static get IDENTITY(){return $U()}static get ZERO(){return jU()}get ELEMENTS(){return 16}get RANK(){return 4}get INDICES(){return Zg}constructor(e){super(-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0),arguments.length===1&&Array.isArray(e)?this.copy(e):this.identity()}copy(e){return this[0]=e[0],this[1]=e[1],this[2]=e[2],this[3]=e[3],this[4]=e[4],this[5]=e[5],this[6]=e[6],this[7]=e[7],this[8]=e[8],this[9]=e[9],this[10]=e[10],this[11]=e[11],this[12]=e[12],this[13]=e[13],this[14]=e[14],this[15]=e[15],this.check()}set(e,t,r,i,a,l,c,f,d,p,_,y,b,T,A,C){return this[0]=e,this[1]=t,this[2]=r,this[3]=i,this[4]=a,this[5]=l,this[6]=c,this[7]=f,this[8]=d,this[9]=p,this[10]=_,this[11]=y,this[12]=b,this[13]=T,this[14]=A,this[15]=C,this.check()}setRowMajor(e,t,r,i,a,l,c,f,d,p,_,y,b,T,A,C){return this[0]=e,this[1]=a,this[2]=d,this[3]=b,this[4]=t,this[5]=l,this[6]=p,this[7]=T,this[8]=r,this[9]=c,this[10]=_,this[11]=A,this[12]=i,this[13]=f,this[14]=y,this[15]=C,this.check()}toRowMajor(e){return e[0]=this[0],e[1]=this[4],e[2]=this[8],e[3]=this[12],e[4]=this[1],e[5]=this[5],e[6]=this[9],e[7]=this[13],e[8]=this[2],e[9]=this[6],e[10]=this[10],e[11]=this[14],e[12]=this[3],e[13]=this[7],e[14]=this[11],e[15]=this[15],e}identity(){return this.copy(HU)}fromObject(e){return this.check()}fromQuaternion(e){return IU(this,e),this.check()}frustum(e){const{left:t,right:r,bottom:i,top:a,near:l=jp,far:c=$p}=e;return c===1/0?WU(this,t,r,i,a,l):NU(this,t,r,i,a,l,c),this.check()}lookAt(e){const{eye:t,center:r=[0,0,0],up:i=[0,1,0]}=e;return BU(this,t,r,i),this.check()}ortho(e){const{left:t,right:r,bottom:i,top:a,near:l=jp,far:c=$p}=e;return UU(this,t,r,i,a,l,c),this.check()}orthographic(e){const{fovy:t=zU,aspect:r=VU,focalDistance:i=1,near:a=jp,far:l=$p}=e;lT(t);const c=t/2,f=i*Math.tan(c),d=f*r;return this.ortho({left:-d,right:d,bottom:-f,top:f,near:a,far:l})}perspective(e){const{fovy:t=45*Math.PI/180,aspect:r=1,near:i=.1,far:a=500}=e;return lT(t),DU(this,t,r,i,a),this.check()}determinant(){return CU(this)}getScale(e=[-0,-0,-0]){return e[0]=Math.sqrt(this[0]*this[0]+this[1]*this[1]+this[2]*this[2]),e[1]=Math.sqrt(this[4]*this[4]+this[5]*this[5]+this[6]*this[6]),e[2]=Math.sqrt(this[8]*this[8]+this[9]*this[9]+this[10]*this[10]),e}getTranslation(e=[-0,-0,-0]){return e[0]=this[12],e[1]=this[13],e[2]=this[14],e}getRotation(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),i=1/r[0],a=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*l,e[3]=0,e[4]=this[4]*i,e[5]=this[5]*a,e[6]=this[6]*l,e[7]=0,e[8]=this[8]*i,e[9]=this[9]*a,e[10]=this[10]*l,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e}getRotationMatrix3(e,t){e=e||[-0,-0,-0,-0,-0,-0,-0,-0,-0],t=t||[-0,-0,-0];const r=this.getScale(t),i=1/r[0],a=1/r[1],l=1/r[2];return e[0]=this[0]*i,e[1]=this[1]*a,e[2]=this[2]*l,e[3]=this[4]*i,e[4]=this[5]*a,e[5]=this[6]*l,e[6]=this[8]*i,e[7]=this[9]*a,e[8]=this[10]*l,e}transpose(){return RU(this,this),this.check()}invert(){return Kg(this,this),this.check()}multiplyLeft(e){return Wi(this,e,this),this.check()}multiplyRight(e){return Wi(this,this,e),this.check()}rotateX(e){return Qw(this,this,e),this.check()}rotateY(e){return OU(this,this,e),this.check()}rotateZ(e){return Gw(this,this,e),this.check()}rotateXYZ(e){return this.rotateX(e[0]).rotateY(e[1]).rotateZ(e[2])}rotateAxis(e,t){return MU(this,this,e,t),this.check()}scale(e){return em(this,this,Array.isArray(e)?e:[e,e,e]),this.check()}translate(e){return ff(this,this,e),this.check()}transform(e,t){return e.length===4?(t=kl(t||[-0,-0,-0,-0],e,this),Vp(t,4),t):this.transformAsPoint(e,t)}transformAsPoint(e,t){const{length:r}=e;let i;switch(r){case 2:i=cU(t||[-0,-0],e,this);break;case 3:i=Zw(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Vp(i,e.length),i}transformAsVector(e,t){let r;switch(e.length){case 2:r=fU(t||[-0,-0],e,this);break;case 3:r=Kw(t||[-0,-0,-0],e,this);break;default:throw new Error("Illegal vector")}return Vp(r,e.length),r}transformPoint(e,t){return this.transformAsPoint(e,t)}transformVector(e,t){return this.transformAsPoint(e,t)}transformDirection(e,t){return this.transformAsVector(e,t)}makeRotationX(e){return this.identity().rotateX(e)}makeTranslation(e,t,r){return this.identity().translate([e,t,r])}}let fu,hu;function jU(){return fu||(fu=new ir([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),Object.freeze(fu)),fu}function $U(){return hu||(hu=new ir,Object.freeze(hu)),hu}function lT(n){if(n>Math.PI*2)throw Error("expected radians")}function WU(n,e,t,r,i,a){const l=2*a/(t-e),c=2*a/(i-r),f=(t+e)/(t-e),d=(i+r)/(i-r),p=-1,_=-1,y=-2*a;return n[0]=l,n[1]=0,n[2]=0,n[3]=0,n[4]=0,n[5]=c,n[6]=0,n[7]=0,n[8]=f,n[9]=d,n[10]=p,n[11]=_,n[12]=0,n[13]=0,n[14]=y,n[15]=0,n}function Jw(n,e=[],t=0){const r=Math.fround(n),i=n-r;return e[t]=r,e[t+1]=i,e}function XU(n){return n-Math.fround(n)}function YU(n){const e=new Float32Array(32);for(let t=0;t<4;++t)for(let r=0;r<4;++r){const i=t*4+r;Jw(n[r*4+t],e,i*2)}return e}const qU=`#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND

// All these functions are for substituting tan() function from Intel GPU only
const float TWO_PI = 6.2831854820251465;
const float PI_2 = 1.5707963705062866;
const float PI_16 = 0.1963495463132858;

const float SIN_TABLE_0 = 0.19509032368659973;
const float SIN_TABLE_1 = 0.3826834261417389;
const float SIN_TABLE_2 = 0.5555702447891235;
const float SIN_TABLE_3 = 0.7071067690849304;

const float COS_TABLE_0 = 0.9807852506637573;
const float COS_TABLE_1 = 0.9238795042037964;
const float COS_TABLE_2 = 0.8314695954322815;
const float COS_TABLE_3 = 0.7071067690849304;

const float INVERSE_FACTORIAL_3 = 1.666666716337204e-01; // 1/3!
const float INVERSE_FACTORIAL_5 = 8.333333767950535e-03; // 1/5!
const float INVERSE_FACTORIAL_7 = 1.9841270113829523e-04; // 1/7!
const float INVERSE_FACTORIAL_9 = 2.75573188446287533e-06; // 1/9!

float sin_taylor_fp32(float a) {
  float r, s, t, x;

  if (a == 0.0) {
    return 0.0;
  }

  x = -a * a;
  s = a;
  r = a;

  r = r * x;
  t = r * INVERSE_FACTORIAL_3;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_5;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_7;
  s = s + t;

  r = r * x;
  t = r * INVERSE_FACTORIAL_9;
  s = s + t;

  return s;
}

void sincos_taylor_fp32(float a, out float sin_t, out float cos_t) {
  if (a == 0.0) {
    sin_t = 0.0;
    cos_t = 1.0;
  }
  sin_t = sin_taylor_fp32(a);
  cos_t = sqrt(1.0 - sin_t * sin_t);
}

float tan_taylor_fp32(float a) {
    float sin_a;
    float cos_a;

    if (a == 0.0) {
        return 0.0;
    }

    // 2pi range reduction
    float z = floor(a / TWO_PI);
    float r = a - TWO_PI * z;

    float t;
    float q = floor(r / PI_2 + 0.5);
    int j = int(q);

    if (j < -2 || j > 2) {
        return 1.0 / 0.0;
    }

    t = r - PI_2 * q;

    q = floor(t / PI_16 + 0.5);
    int k = int(q);
    int abs_k = int(abs(float(k)));

    if (abs_k > 4) {
        return 1.0 / 0.0;
    } else {
        t = t - PI_16 * q;
    }

    float u = 0.0;
    float v = 0.0;

    float sin_t, cos_t;
    float s, c;
    sincos_taylor_fp32(t, sin_t, cos_t);

    if (k == 0) {
        s = sin_t;
        c = cos_t;
    } else {
        if (abs(float(abs_k) - 1.0) < 0.5) {
            u = COS_TABLE_0;
            v = SIN_TABLE_0;
        } else if (abs(float(abs_k) - 2.0) < 0.5) {
            u = COS_TABLE_1;
            v = SIN_TABLE_1;
        } else if (abs(float(abs_k) - 3.0) < 0.5) {
            u = COS_TABLE_2;
            v = SIN_TABLE_2;
        } else if (abs(float(abs_k) - 4.0) < 0.5) {
            u = COS_TABLE_3;
            v = SIN_TABLE_3;
        }
        if (k > 0) {
            s = u * sin_t + v * cos_t;
            c = u * cos_t - v * sin_t;
        } else {
            s = u * sin_t - v * cos_t;
            c = u * cos_t + v * sin_t;
        }
    }

    if (j == 0) {
        sin_a = s;
        cos_a = c;
    } else if (j == 1) {
        sin_a = c;
        cos_a = -s;
    } else if (j == -1) {
        sin_a = -c;
        cos_a = s;
    } else {
        sin_a = -s;
        cos_a = -c;
    }
    return sin_a / cos_a;
}
#endif

float tan_fp32(float a) {
#ifdef LUMA_FP32_TAN_PRECISION_WORKAROUND
  return tan_taylor_fp32(a);
#else
  return tan(a);
#endif
}
`,KU={name:"fp32",vs:qU},ZU=`
uniform fp64arithmeticUniforms {
  uniform float ONE;
} fp64;

/*
About LUMA_FP64_CODE_ELIMINATION_WORKAROUND

The purpose of this workaround is to prevent shader compilers from
optimizing away necessary arithmetic operations by swapping their sequences
or transform the equation to some 'equivalent' form.

The method is to multiply an artifical variable, ONE, which will be known to
the compiler to be 1 only at runtime. The whole expression is then represented
as a polynomial with respective to ONE. In the coefficients of all terms, only one a
and one b should appear

err = (a + b) * ONE^6 - a * ONE^5 - (a + b) * ONE^4 + a * ONE^3 - b - (a + b) * ONE^2 + a * ONE
*/

// Divide float number to high and low floats to extend fraction bits
vec2 split(float a) {
  const float SPLIT = 4097.0;
  float t = a * SPLIT;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float a_hi = t * fp64.ONE - (t - a);
  float a_lo = a * fp64.ONE - a_hi;
#else
  float a_hi = t - (t - a);
  float a_lo = a - a_hi;
#endif
  return vec2(a_hi, a_lo);
}

// Divide float number again when high float uses too many fraction bits
vec2 split2(vec2 a) {
  vec2 b = split(a.x);
  b.y += a.y;
  return b;
}

// Special sum operation when a > b
vec2 quickTwoSum(float a, float b) {
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float sum = (a + b) * fp64.ONE;
  float err = b - (sum - a) * fp64.ONE;
#else
  float sum = a + b;
  float err = b - (sum - a);
#endif
  return vec2(sum, err);
}

// General sum operation
vec2 twoSum(float a, float b) {
  float s = (a + b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE + (b - v);
#else
  float v = s - a;
  float err = (a - (s - v)) + (b - v);
#endif
  return vec2(s, err);
}

vec2 twoSub(float a, float b) {
  float s = (a - b);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float v = (s * fp64.ONE - a) * fp64.ONE;
  float err = (a - (s - v) * fp64.ONE) * fp64.ONE * fp64.ONE * fp64.ONE - (b + v);
#else
  float v = s - a;
  float err = (a - (s - v)) - (b + v);
#endif
  return vec2(s, err);
}

vec2 twoSqr(float a) {
  float prod = a * a;
  vec2 a_fp64 = split(a);
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  float err = ((a_fp64.x * a_fp64.x - prod) * fp64.ONE + 2.0 * a_fp64.x *
    a_fp64.y * fp64.ONE * fp64.ONE) + a_fp64.y * a_fp64.y * fp64.ONE * fp64.ONE * fp64.ONE;
#else
  float err = ((a_fp64.x * a_fp64.x - prod) + 2.0 * a_fp64.x * a_fp64.y) + a_fp64.y * a_fp64.y;
#endif
  return vec2(prod, err);
}

vec2 twoProd(float a, float b) {
  float prod = a * b;
  vec2 a_fp64 = split(a);
  vec2 b_fp64 = split(b);
  float err = ((a_fp64.x * b_fp64.x - prod) + a_fp64.x * b_fp64.y +
    a_fp64.y * b_fp64.x) + a_fp64.y * b_fp64.y;
  return vec2(prod, err);
}

vec2 sum_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSum(a.x, b.x);
  t = twoSum(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 sub_fp64(vec2 a, vec2 b) {
  vec2 s, t;
  s = twoSub(a.x, b.x);
  t = twoSub(a.y, b.y);
  s.y += t.x;
  s = quickTwoSum(s.x, s.y);
  s.y += t.y;
  s = quickTwoSum(s.x, s.y);
  return s;
}

vec2 mul_fp64(vec2 a, vec2 b) {
  vec2 prod = twoProd(a.x, b.x);
  // y component is for the error
  prod.y += a.x * b.y;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  prod.y += a.y * b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  prod = split2(prod);
#endif
  prod = quickTwoSum(prod.x, prod.y);
  return prod;
}

vec2 div_fp64(vec2 a, vec2 b) {
  float xn = 1.0 / b.x;
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  vec2 yn = mul_fp64(a, vec2(xn, 0));
#else
  vec2 yn = a * xn;
#endif
  float diff = (sub_fp64(a, mul_fp64(b, yn))).x;
  vec2 prod = twoProd(xn, diff);
  return sum_fp64(yn, prod);
}

vec2 sqrt_fp64(vec2 a) {
  if (a.x == 0.0 && a.y == 0.0) return vec2(0.0, 0.0);
  if (a.x < 0.0) return vec2(0.0 / 0.0, 0.0 / 0.0);

  float x = 1.0 / sqrt(a.x);
  float yn = a.x * x;
#if defined(LUMA_FP64_CODE_ELIMINATION_WORKAROUND)
  vec2 yn_sqr = twoSqr(yn) * fp64.ONE;
#else
  vec2 yn_sqr = twoSqr(yn);
#endif
  float diff = sub_fp64(a, yn_sqr).x;
  vec2 prod = twoProd(x * 0.5, diff);
#if defined(LUMA_FP64_HIGH_BITS_OVERFLOW_WORKAROUND)
  return sum_fp64(split(yn), prod);
#else
  return sum_fp64(vec2(yn, 0.0), prod);
#endif
}
`,QU={ONE:1},GU={name:"fp64arithmetic",vs:ZU,defaultUniforms:QU,uniformTypes:{ONE:"f32"},fp64ify:Jw,fp64LowPart:XU,fp64ifyMatrix4:YU},JU=[0,1,1,1],eB=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

out vec4 picking_vRGBcolor_Avalid;

// Normalize unsigned byte color to 0-1 range
vec3 picking_normalizeColor(vec3 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

// Normalize unsigned byte color to 0-1 range
vec4 picking_normalizeColor(vec4 color) {
  return picking.useFloatColors > 0.5 ? color : color / 255.0;
}

bool picking_isColorZero(vec3 color) {
  return dot(color, vec3(1.0)) < 0.00001;
}

bool picking_isColorValid(vec3 color) {
  return dot(color, vec3(1.0)) > 0.00001;
}

// Check if this vertex is highlighted 
bool isVertexHighlighted(vec3 vertexColor) {
  vec3 highlightedObjectColor = picking_normalizeColor(picking.highlightedObjectColor);
  return
    bool(picking.isHighlightActive) && picking_isColorZero(abs(vertexColor - highlightedObjectColor));
}

// Set the current picking color
void picking_setPickingColor(vec3 pickingColor) {
  pickingColor = picking_normalizeColor(pickingColor);

  if (bool(picking.isActive)) {
    // Use alpha as the validity flag. If pickingColor is [0, 0, 0] fragment is non-pickable
    picking_vRGBcolor_Avalid.a = float(picking_isColorValid(pickingColor));

    if (!bool(picking.isAttribute)) {
      // Stores the picking color so that the fragment shader can render it during picking
      picking_vRGBcolor_Avalid.rgb = pickingColor;
    }
  } else {
    // Do the comparison with selected item color in vertex shader as it should mean fewer compares
    picking_vRGBcolor_Avalid.a = float(isVertexHighlighted(pickingColor));
  }
}

void picking_setPickingAttribute(float value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.r = value;
  }
}

void picking_setPickingAttribute(vec2 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rg = value;
  }
}

void picking_setPickingAttribute(vec3 value) {
  if (bool(picking.isAttribute)) {
    picking_vRGBcolor_Avalid.rgb = value;
  }
}
`,tB=`uniform pickingUniforms {
  float isActive;
  float isAttribute;
  float isHighlightActive;
  float useFloatColors;
  vec3 highlightedObjectColor;
  vec4 highlightColor;
} picking;

in vec4 picking_vRGBcolor_Avalid;

/*
 * Returns highlight color if this item is selected.
 */
vec4 picking_filterHighlightColor(vec4 color) {
  // If we are still picking, we don't highlight
  if (picking.isActive > 0.5) {
    return color;
  }

  bool selected = bool(picking_vRGBcolor_Avalid.a);

  if (selected) {
    // Blend in highlight color based on its alpha value
    float highLightAlpha = picking.highlightColor.a;
    float blendedAlpha = highLightAlpha + color.a * (1.0 - highLightAlpha);
    float highLightRatio = highLightAlpha / blendedAlpha;

    vec3 blendedRGB = mix(color.rgb, picking.highlightColor.rgb, highLightRatio);
    return vec4(blendedRGB, blendedAlpha);
  } else {
    return color;
  }
}

/*
 * Returns picking color if picking enabled else unmodified argument.
 */
vec4 picking_filterPickingColor(vec4 color) {
  if (bool(picking.isActive)) {
    if (picking_vRGBcolor_Avalid.a == 0.0) {
      discard;
    }
    return picking_vRGBcolor_Avalid;
  }
  return color;
}

/*
 * Returns picking color if picking is enabled if not
 * highlight color if this item is selected, otherwise unmodified argument.
 */
vec4 picking_filterColor(vec4 color) {
  vec4 highlightColor = picking_filterHighlightColor(color);
  return picking_filterPickingColor(highlightColor);
}
`,cT={props:{},uniforms:{},name:"picking",uniformTypes:{isActive:"f32",isAttribute:"f32",isHighlightActive:"f32",useFloatColors:"f32",highlightedObjectColor:"vec3<f32>",highlightColor:"vec4<f32>"},defaultUniforms:{isActive:!1,isAttribute:!1,isHighlightActive:!1,useFloatColors:!0,highlightedObjectColor:[0,0,0],highlightColor:JU},vs:eB,fs:tB,getUniforms:nB};function nB(n={},e){const t={};if(n.highlightedObjectColor!==void 0)if(n.highlightedObjectColor===null)t.isHighlightActive=!1;else{t.isHighlightActive=!0;const r=n.highlightedObjectColor.slice(0,3);t.highlightedObjectColor=r}if(n.highlightColor){const r=Array.from(n.highlightColor,i=>i/255);Number.isFinite(r[3])||(r[3]=1),t.highlightColor=r}return n.isActive!==void 0&&(t.isActive=!!n.isActive,t.isAttribute=!!n.isAttribute),n.useFloatColors!==void 0&&(t.useFloatColors=!!n.useFloatColors),t}const uT=`uniform layerUniforms {
  uniform float opacity;
} layer;
`,rB={name:"layer",vs:uT,fs:uT,getUniforms:n=>({opacity:Math.pow(n.opacity,1/2.2)}),uniformTypes:{opacity:"f32"}},iB=`const SMOOTH_EDGE_RADIUS: f32 = 0.5;

struct VertexGeometry {
  position: vec4<f32>,
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  normal: vec3<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

var<private> geometry_: VertexGeometry = VertexGeometry(
  vec4<f32>(0.0, 0.0, 1.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0),
  vec2<f32>(0.0, 0.0),
  vec3<f32>(0.0, 0.0, 0.0)
);

struct FragmentGeometry {
  uv: vec2<f32>,
};

var<private> fragmentGeometry: FragmentGeometry;

fn smoothedge(edge: f32, x: f32) -> f32 {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,ex="#define SMOOTH_EDGE_RADIUS 0.5",sB=`${ex}

struct VertexGeometry {
  vec4 position;
  vec3 worldPosition;
  vec3 worldPositionAlt;
  vec3 normal;
  vec2 uv;
  vec3 pickingColor;
} geometry = VertexGeometry(
  vec4(0.0, 0.0, 1.0, 0.0),
  vec3(0.0),
  vec3(0.0),
  vec3(0.0),
  vec2(0.0),
  vec3(0.0)
);
`,aB=`${ex}

struct FragmentGeometry {
  vec2 uv;
} geometry;

float smoothedge(float edge, float x) {
  return smoothstep(edge - SMOOTH_EDGE_RADIUS, edge + SMOOTH_EDGE_RADIUS, x);
}
`,tx={name:"geometry",source:iB,vs:sB,fs:aB},oB=25;var mt;(function(n){n[n.Start=1]="Start",n[n.Move=2]="Move",n[n.End=4]="End",n[n.Cancel=8]="Cancel"})(mt||(mt={}));var Tt;(function(n){n[n.None=0]="None",n[n.Left=1]="Left",n[n.Right=2]="Right",n[n.Up=4]="Up",n[n.Down=8]="Down",n[n.Horizontal=3]="Horizontal",n[n.Vertical=12]="Vertical",n[n.All=15]="All"})(Tt||(Tt={}));var Ee;(function(n){n[n.Possible=1]="Possible",n[n.Began=2]="Began",n[n.Changed=4]="Changed",n[n.Ended=8]="Ended",n[n.Recognized=8]="Recognized",n[n.Cancelled=16]="Cancelled",n[n.Failed=32]="Failed"})(Ee||(Ee={}));const lB="compute",cB="auto",Qg="manipulation",Au="none",Gg="pan-x",Jg="pan-y";function uB(n){if(n.includes(Au))return Au;const e=n.includes(Gg),t=n.includes(Jg);return e&&t?Au:e||t?e?Gg:Jg:n.includes(Qg)?Qg:cB}class fB{constructor(e,t){this.actions="",this.manager=e,this.set(t)}set(e){e===lB&&(e=this.compute()),this.manager.element&&(this.manager.element.style.touchAction=e,this.actions=e)}update(){this.set(this.manager.options.touchAction)}compute(){let e=[];for(const t of this.manager.recognizers)t.options.enable&&(e=e.concat(t.getTouchAction()));return uB(e.join(" "))}}function hf(n){return n.trim().split(/\s+/g)}function Wp(n,e,t){if(n)for(const r of hf(e))n.addEventListener(r,t,!1)}function Xp(n,e,t){if(n)for(const r of hf(e))n.removeEventListener(r,t,!1)}function fT(n){return(n.ownerDocument||n).defaultView}function hB(n,e){let t=n;for(;t;){if(t===e)return!0;t=t.parentNode}return!1}function nx(n){const e=n.length;if(e===1)return{x:Math.round(n[0].clientX),y:Math.round(n[0].clientY)};let t=0,r=0,i=0;for(;i<e;)t+=n[i].clientX,r+=n[i].clientY,i++;return{x:Math.round(t/e),y:Math.round(r/e)}}function hT(n){const e=[];let t=0;for(;t<n.pointers.length;)e[t]={clientX:Math.round(n.pointers[t].clientX),clientY:Math.round(n.pointers[t].clientY)},t++;return{timeStamp:Date.now(),pointers:e,center:nx(e),deltaX:n.deltaX,deltaY:n.deltaY}}function rx(n,e){const t=e.x-n.x,r=e.y-n.y;return Math.sqrt(t*t+r*r)}function dT(n,e){const t=e.clientX-n.clientX,r=e.clientY-n.clientY;return Math.sqrt(t*t+r*r)}function dB(n,e){const t=e.x-n.x,r=e.y-n.y;return Math.atan2(r,t)*180/Math.PI}function pT(n,e){const t=e.clientX-n.clientX,r=e.clientY-n.clientY;return Math.atan2(r,t)*180/Math.PI}function ix(n,e){return n===e?Tt.None:Math.abs(n)>=Math.abs(e)?n<0?Tt.Left:Tt.Right:e<0?Tt.Up:Tt.Down}function pB(n,e){const t=e.center;let r=n.offsetDelta,i=n.prevDelta;const a=n.prevInput;return(e.eventType===mt.Start||(a==null?void 0:a.eventType)===mt.End)&&(i=n.prevDelta={x:(a==null?void 0:a.deltaX)||0,y:(a==null?void 0:a.deltaY)||0},r=n.offsetDelta={x:t.x,y:t.y}),{deltaX:i.x+(t.x-r.x),deltaY:i.y+(t.y-r.y)}}function sx(n,e,t){return{x:e/n||0,y:t/n||0}}function gB(n,e){return dT(e[0],e[1])/dT(n[0],n[1])}function _B(n,e){return pT(e[1],e[0])-pT(n[1],n[0])}function mB(n,e){const t=n.lastInterval||e,r=e.timeStamp-t.timeStamp;let i,a,l,c;if(e.eventType!==mt.Cancel&&(r>oB||t.velocity===void 0)){const f=e.deltaX-t.deltaX,d=e.deltaY-t.deltaY,p=sx(r,f,d);a=p.x,l=p.y,i=Math.abs(p.x)>Math.abs(p.y)?p.x:p.y,c=ix(f,d),n.lastInterval=e}else i=t.velocity,a=t.velocityX,l=t.velocityY,c=t.direction;e.velocity=i,e.velocityX=a,e.velocityY=l,e.direction=c}function yB(n,e){const{session:t}=n,{pointers:r}=e,{length:i}=r;t.firstInput||(t.firstInput=hT(e)),i>1&&!t.firstMultiple?t.firstMultiple=hT(e):i===1&&(t.firstMultiple=!1);const{firstInput:a,firstMultiple:l}=t,c=l?l.center:a.center,f=e.center=nx(r);e.timeStamp=Date.now(),e.deltaTime=e.timeStamp-a.timeStamp,e.angle=dB(c,f),e.distance=rx(c,f);const{deltaX:d,deltaY:p}=pB(t,e);e.deltaX=d,e.deltaY=p,e.offsetDirection=ix(e.deltaX,e.deltaY);const _=sx(e.deltaTime,e.deltaX,e.deltaY);e.overallVelocityX=_.x,e.overallVelocityY=_.y,e.overallVelocity=Math.abs(_.x)>Math.abs(_.y)?_.x:_.y,e.scale=l?gB(l.pointers,r):1,e.rotation=l?_B(l.pointers,r):0,e.maxPointers=t.prevInput?e.pointers.length>t.prevInput.maxPointers?e.pointers.length:t.prevInput.maxPointers:e.pointers.length;let y=n.element;return hB(e.srcEvent.target,y)&&(y=e.srcEvent.target),e.target=y,mB(t,e),e}function bB(n,e,t){const r=t.pointers.length,i=t.changedPointers.length,a=e&mt.Start&&r-i===0,l=e&(mt.End|mt.Cancel)&&r-i===0;t.isFirst=!!a,t.isFinal=!!l,a&&(n.session={}),t.eventType=e;const c=yB(n,t);n.emit("hammer.input",c),n.recognize(c),n.session.prevInput=c}let vB=class{constructor(e){this.evEl="",this.evWin="",this.evTarget="",this.domHandler=t=>{this.manager.options.enable&&this.handler(t)},this.manager=e,this.element=e.element,this.target=e.options.inputTarget||e.element}callback(e,t){bB(this.manager,e,t)}init(){Wp(this.element,this.evEl,this.domHandler),Wp(this.target,this.evTarget,this.domHandler),Wp(fT(this.element),this.evWin,this.domHandler)}destroy(){Xp(this.element,this.evEl,this.domHandler),Xp(this.target,this.evTarget,this.domHandler),Xp(fT(this.element),this.evWin,this.domHandler)}};const TB={pointerdown:mt.Start,pointermove:mt.Move,pointerup:mt.End,pointercancel:mt.Cancel,pointerout:mt.Cancel},wB="pointerdown",xB="pointermove pointerup pointercancel";class SB extends vB{constructor(e){super(e),this.evEl=wB,this.evWin=xB,this.store=this.manager.session.pointerEvents=[],this.init()}handler(e){const{store:t}=this;let r=!1;const i=TB[e.type],a=e.pointerType,l=a==="touch";let c=t.findIndex(f=>f.pointerId===e.pointerId);i&mt.Start&&(e.buttons||l)?c<0&&(t.push(e),c=t.length-1):i&(mt.End|mt.Cancel)&&(r=!0),!(c<0)&&(t[c]=e,this.callback(i,{pointers:t,changedPointers:[e],eventType:i,pointerType:a,srcEvent:e}),r&&t.splice(c,1))}}const AB=["","webkit","Moz","MS","ms","o"];function EB(n,e){const t=e[0].toUpperCase()+e.slice(1);for(const r of AB){const i=r?r+t:e;if(i in n)return i}}const RB=1,gT=2,_T={touchAction:"compute",enable:!0,inputTarget:null,cssProps:{userSelect:"none",userDrag:"none",touchCallout:"none",tapHighlightColor:"rgba(0,0,0,0)"}};class CB{constructor(e,t){this.options={..._T,...t,cssProps:{..._T.cssProps,...t.cssProps},inputTarget:t.inputTarget||e},this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new SB(this),this.touchAction=new fB(this,this.options.touchAction),this.toggleCssProps(!0)}set(e){return Object.assign(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this}stop(e){this.session.stopped=e?gT:RB}recognize(e){const{session:t}=this;if(t.stopped)return;this.session.prevented&&e.srcEvent.preventDefault();let r;const{recognizers:i}=this;let{curRecognizer:a}=t;(!a||a&&a.state&Ee.Recognized)&&(a=t.curRecognizer=null);let l=0;for(;l<i.length;)r=i[l],t.stopped!==gT&&(!a||r===a||r.canRecognizeWith(a))?r.recognize(e):r.reset(),!a&&r.state&(Ee.Began|Ee.Changed|Ee.Ended)&&(a=t.curRecognizer=r),l++}get(e){const{recognizers:t}=this;for(let r=0;r<t.length;r++)if(t[r].options.event===e)return t[r];return null}add(e){if(Array.isArray(e)){for(const r of e)this.add(r);return this}const t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e}remove(e){if(Array.isArray(e)){for(const r of e)this.remove(r);return this}const t=typeof e=="string"?this.get(e):e;if(t){const{recognizers:r}=this,i=r.indexOf(t);i!==-1&&(r.splice(i,1),this.touchAction.update())}return this}on(e,t){if(!e||!t)return;const{handlers:r}=this;for(const i of hf(e))r[i]=r[i]||[],r[i].push(t)}off(e,t){if(!e)return;const{handlers:r}=this;for(const i of hf(e))t?r[i]&&r[i].splice(r[i].indexOf(t),1):delete r[i]}emit(e,t){const r=this.handlers[e]&&this.handlers[e].slice();if(!r||!r.length)return;const i=t;i.type=e,i.preventDefault=function(){t.srcEvent.preventDefault()};let a=0;for(;a<r.length;)r[a](i),a++}destroy(){this.toggleCssProps(!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}toggleCssProps(e){const{element:t}=this;if(t){for(const[r,i]of Object.entries(this.options.cssProps)){const a=EB(t.style,r);e?(this.oldCssProps[a]=t.style[a],t.style[a]=i):t.style[a]=this.oldCssProps[a]||""}e||(this.oldCssProps={})}}}let MB=1;function OB(){return MB++}function mT(n){return n&Ee.Cancelled?"cancel":n&Ee.Ended?"end":n&Ee.Changed?"move":n&Ee.Began?"start":""}class ax{constructor(e){this.options=e,this.id=OB(),this.state=Ee.Possible,this.simultaneous={},this.requireFail=[]}set(e){return Object.assign(this.options,e),this.manager.touchAction.update(),this}recognizeWith(e){if(Array.isArray(e)){for(const i of e)this.recognizeWith(i);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{simultaneous:r}=this;return r[t.id]||(r[t.id]=t,t.recognizeWith(this)),this}dropRecognizeWith(e){if(Array.isArray(e)){for(const r of e)this.dropRecognizeWith(r);return this}let t;return typeof e=="string"?t=this.manager.get(e):t=e,t&&delete this.simultaneous[t.id],this}requireFailure(e){if(Array.isArray(e)){for(const i of e)this.requireFailure(i);return this}let t;if(typeof e=="string"){if(t=this.manager.get(e),!t)throw new Error(`Cannot find recognizer ${e}`)}else t=e;const{requireFail:r}=this;return r.indexOf(t)===-1&&(r.push(t),t.requireFailure(this)),this}dropRequireFailure(e){if(Array.isArray(e)){for(const r of e)this.dropRequireFailure(r);return this}let t;if(typeof e=="string"?t=this.manager.get(e):t=e,t){const r=this.requireFail.indexOf(t);r>-1&&this.requireFail.splice(r,1)}return this}hasRequireFailures(){return!!this.requireFail.find(e=>e.options.enable)}canRecognizeWith(e){return!!this.simultaneous[e.id]}emit(e){if(!e)return;const{state:t}=this;t<Ee.Ended&&this.manager.emit(this.options.event+mT(t),e),this.manager.emit(this.options.event,e),e.additionalEvent&&this.manager.emit(e.additionalEvent,e),t>=Ee.Ended&&this.manager.emit(this.options.event+mT(t),e)}tryEmit(e){this.canEmit()?this.emit(e):this.state=Ee.Failed}canEmit(){let e=0;for(;e<this.requireFail.length;){if(!(this.requireFail[e].state&(Ee.Failed|Ee.Possible)))return!1;e++}return!0}recognize(e){const t={...e};if(!this.options.enable){this.reset(),this.state=Ee.Failed;return}this.state&(Ee.Recognized|Ee.Cancelled|Ee.Failed)&&(this.state=Ee.Possible),this.state=this.process(t),this.state&(Ee.Began|Ee.Changed|Ee.Ended|Ee.Cancelled)&&this.tryEmit(t)}getEventNames(){return[this.options.event]}reset(){}}class ox extends ax{attrTest(e){const t=this.options.pointers;return t===0||e.pointers.length===t}process(e){const{state:t}=this,{eventType:r}=e,i=t&(Ee.Began|Ee.Changed),a=this.attrTest(e);return i&&(r&mt.Cancel||!a)?t|Ee.Cancelled:i||a?r&mt.End?t|Ee.Ended:t&Ee.Began?t|Ee.Changed:Ee.Began:Ee.Failed}}class yT extends ax{constructor(e={}){super({enable:!0,event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10,...e}),this.pTime=null,this.pCenter=null,this._timer=null,this._input=null,this.count=0}getTouchAction(){return[Qg]}process(e){const{options:t}=this,r=e.pointers.length===t.pointers,i=e.distance<t.threshold,a=e.deltaTime<t.time;if(this.reset(),e.eventType&mt.Start&&this.count===0)return this.failTimeout();if(i&&a&&r){if(e.eventType!==mt.End)return this.failTimeout();const l=this.pTime?e.timeStamp-this.pTime<t.interval:!0,c=!this.pCenter||rx(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,!c||!l?this.count=1:this.count+=1,this._input=e,this.count%t.taps===0)return this.hasRequireFailures()?(this._timer=setTimeout(()=>{this.state=Ee.Recognized,this.tryEmit(this._input)},t.interval),Ee.Began):Ee.Recognized}return Ee.Failed}failTimeout(){return this._timer=setTimeout(()=>{this.state=Ee.Failed},this.options.interval),Ee.Failed}reset(){clearTimeout(this._timer)}emit(e){this.state===Ee.Recognized&&(e.tapCount=this.count,this.manager.emit(this.options.event,e))}}const IB=["","start","move","end","cancel","up","down","left","right"];class bT extends ox{constructor(e={}){super({enable:!0,pointers:1,event:"pan",threshold:10,direction:Tt.All,...e}),this.pX=null,this.pY=null}getTouchAction(){const{options:{direction:e}}=this,t=[];return e&Tt.Horizontal&&t.push(Jg),e&Tt.Vertical&&t.push(Gg),t}getEventNames(){return IB.map(e=>this.options.event+e)}directionTest(e){const{options:t}=this;let r=!0,{distance:i}=e,{direction:a}=e;const l=e.deltaX,c=e.deltaY;return a&t.direction||(t.direction&Tt.Horizontal?(a=l===0?Tt.None:l<0?Tt.Left:Tt.Right,r=l!==this.pX,i=Math.abs(e.deltaX)):(a=c===0?Tt.None:c<0?Tt.Up:Tt.Down,r=c!==this.pY,i=Math.abs(e.deltaY))),e.direction=a,r&&i>t.threshold&&!!(a&t.direction)}attrTest(e){return super.attrTest(e)&&(!!(this.state&Ee.Began)||!(this.state&Ee.Began)&&this.directionTest(e))}emit(e){this.pX=e.deltaX,this.pY=e.deltaY;const t=Tt[e.direction].toLowerCase();t&&(e.additionalEvent=this.options.event+t),super.emit(e)}}const NB=["","start","move","end","cancel","in","out"];class kB extends ox{constructor(e={}){super({enable:!0,event:"pinch",threshold:0,pointers:2,...e})}getTouchAction(){return[Au]}getEventNames(){return NB.map(e=>this.options.event+e)}attrTest(e){return super.attrTest(e)&&(Math.abs(e.scale-1)>this.options.threshold||!!(this.state&Ee.Began))}emit(e){if(e.scale!==1){const t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}super.emit(e)}}class Vf{constructor(e,t,r){this.element=e,this.callback=t,this.options=r}}const DB=typeof navigator<"u"&&navigator.userAgent?navigator.userAgent.toLowerCase():"",PB=DB.indexOf("firefox")!==-1,vT=4.000244140625,UB=40,BB=.25;class FB extends Vf{constructor(e,t,r){super(e,t,{enable:!0,...r}),this.handleEvent=i=>{if(!this.options.enable)return;let a=i.deltaY;globalThis.WheelEvent&&(PB&&i.deltaMode===globalThis.WheelEvent.DOM_DELTA_PIXEL&&(a/=globalThis.devicePixelRatio),i.deltaMode===globalThis.WheelEvent.DOM_DELTA_LINE&&(a*=UB)),a!==0&&a%vT===0&&(a=Math.floor(a/vT)),i.shiftKey&&a&&(a=a*BB),this.callback({type:"wheel",center:{x:i.clientX,y:i.clientY},delta:-a,srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("wheel",this.handleEvent,{passive:!1})}destroy(){this.element.removeEventListener("wheel",this.handleEvent)}enableEventType(e,t){e==="wheel"&&(this.options.enable=t)}}const TT=["mousedown","mousemove","mouseup","mouseover","mouseout","mouseleave"];class LB extends Vf{constructor(e,t,r){super(e,t,{enable:!0,...r}),this.handleEvent=a=>{this.handleOverEvent(a),this.handleOutEvent(a),this.handleEnterEvent(a),this.handleLeaveEvent(a),this.handleMoveEvent(a)},this.pressed=!1;const{enable:i}=this.options;this.enableMoveEvent=i,this.enableLeaveEvent=i,this.enableEnterEvent=i,this.enableOutEvent=i,this.enableOverEvent=i,TT.forEach(a=>e.addEventListener(a,this.handleEvent))}destroy(){TT.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){switch(e){case"pointermove":this.enableMoveEvent=t;break;case"pointerover":this.enableOverEvent=t;break;case"pointerout":this.enableOutEvent=t;break;case"pointerenter":this.enableEnterEvent=t;break;case"pointerleave":this.enableLeaveEvent=t;break}}handleOverEvent(e){this.enableOverEvent&&e.type==="mouseover"&&this._emit("pointerover",e)}handleOutEvent(e){this.enableOutEvent&&e.type==="mouseout"&&this._emit("pointerout",e)}handleEnterEvent(e){this.enableEnterEvent&&e.type==="mouseenter"&&this._emit("pointerenter",e)}handleLeaveEvent(e){this.enableLeaveEvent&&e.type==="mouseleave"&&this._emit("pointerleave",e)}handleMoveEvent(e){if(this.enableMoveEvent)switch(e.type){case"mousedown":e.button>=0&&(this.pressed=!0);break;case"mousemove":e.buttons===0&&(this.pressed=!1),this.pressed||this._emit("pointermove",e);break;case"mouseup":this.pressed=!1;break}}_emit(e,t){this.callback({type:e,center:{x:t.clientX,y:t.clientY},srcEvent:t,pointerType:"mouse",target:t.target})}}const wT=["keydown","keyup"];class zB extends Vf{constructor(e,t,r){super(e,t,{enable:!0,tabIndex:0,...r}),this.handleEvent=i=>{const a=i.target||i.srcElement;a.tagName==="INPUT"&&a.type==="text"||a.tagName==="TEXTAREA"||(this.enableDownEvent&&i.type==="keydown"&&this.callback({type:"keydown",srcEvent:i,key:i.key,target:i.target}),this.enableUpEvent&&i.type==="keyup"&&this.callback({type:"keyup",srcEvent:i,key:i.key,target:i.target}))},this.enableDownEvent=this.options.enable,this.enableUpEvent=this.options.enable,e.tabIndex=this.options.tabIndex,e.style.outline="none",wT.forEach(i=>e.addEventListener(i,this.handleEvent))}destroy(){wT.forEach(e=>this.element.removeEventListener(e,this.handleEvent))}enableEventType(e,t){e==="keydown"&&(this.enableDownEvent=t),e==="keyup"&&(this.enableUpEvent=t)}}class VB extends Vf{constructor(e,t,r){super(e,t,r),this.handleEvent=i=>{this.options.enable&&this.callback({type:"contextmenu",center:{x:i.clientX,y:i.clientY},srcEvent:i,pointerType:"mouse",target:i.target})},e.addEventListener("contextmenu",this.handleEvent)}destroy(){this.element.removeEventListener("contextmenu",this.handleEvent)}enableEventType(e,t){e==="contextmenu"&&(this.options.enable=t)}}const xT=1,e_=2,ST=4,HB={pointerdown:xT,pointermove:e_,pointerup:ST,mousedown:xT,mousemove:e_,mouseup:ST},jB=0,$B=1,WB=2,XB=1,YB=2,qB=4;function KB(n){const e=HB[n.srcEvent.type];if(!e)return null;const{buttons:t,button:r}=n.srcEvent;let i=!1,a=!1,l=!1;return e===e_?(i=!!(t&XB),a=!!(t&qB),l=!!(t&YB)):(i=r===jB,a=r===$B,l=r===WB),{leftButton:i,middleButton:a,rightButton:l}}function ZB(n,e){const t=n.center;if(!t)return null;const r=e.getBoundingClientRect(),i=r.width/e.offsetWidth||1,a=r.height/e.offsetHeight||1,l={x:(t.x-r.left-e.clientLeft)/i,y:(t.y-r.top-e.clientTop)/a};return{center:t,offsetCenter:l}}const QB={srcElement:"root",priority:0};class GB{constructor(e,t){this.handleEvent=r=>{if(this.isEmpty())return;const i=this._normalizeEvent(r);let a=r.srcEvent.target;for(;a&&a!==i.rootElement;){if(this._emit(i,a),i.handled)return;a=a.parentNode}this._emit(i,"root")},this.eventManager=e,this.recognizerName=t,this.handlers=[],this.handlersByElement=new Map,this._active=!1}isEmpty(){return!this._active}add(e,t,r,i=!1,a=!1){const{handlers:l,handlersByElement:c}=this,f={...QB,...r};let d=c.get(f.srcElement);d||(d=[],c.set(f.srcElement,d));const p={type:e,handler:t,srcElement:f.srcElement,priority:f.priority};i&&(p.once=!0),a&&(p.passive=!0),l.push(p),this._active=this._active||!p.passive;let _=d.length-1;for(;_>=0&&!(d[_].priority>=p.priority);)_--;d.splice(_+1,0,p)}remove(e,t){const{handlers:r,handlersByElement:i}=this;for(let a=r.length-1;a>=0;a--){const l=r[a];if(l.type===e&&l.handler===t){r.splice(a,1);const c=i.get(l.srcElement);c.splice(c.indexOf(l),1),c.length===0&&i.delete(l.srcElement)}}this._active=r.some(a=>!a.passive)}_emit(e,t){const r=this.handlersByElement.get(t);if(r){let i=!1;const a=()=>{e.handled=!0},l=()=>{e.handled=!0,i=!0},c=[];for(let f=0;f<r.length;f++){const{type:d,handler:p,once:_}=r[f];if(p({...e,type:d,stopPropagation:a,stopImmediatePropagation:l}),_&&c.push(r[f]),i)break}for(let f=0;f<c.length;f++){const{type:d,handler:p}=c[f];this.remove(d,p)}}}_normalizeEvent(e){const t=this.eventManager.getElement();return{...e,...KB(e),...ZB(e,t),preventDefault:()=>{e.srcEvent.preventDefault()},stopImmediatePropagation:null,stopPropagation:null,handled:!1,rootElement:t}}}function JB(n){if("recognizer"in n)return n;let e;const t=Array.isArray(n)?[...n]:[n];if(typeof t[0]=="function"){const r=t.shift(),i=t.shift()||{};e=new r(i)}else e=t.shift();return{recognizer:e,recognizeWith:typeof t[0]=="string"?[t[0]]:t[0],requireFailure:typeof t[1]=="string"?[t[1]]:t[1]}}class e8{constructor(e=null,t={}){if(this._onBasicInput=r=>{this.manager.emit(r.srcEvent.type,r)},this._onOtherEvent=r=>{this.manager.emit(r.type,r)},this.options={recognizers:[],events:{},touchAction:"compute",tabIndex:0,cssProps:{},...t},this.events=new Map,this.element=e,!!e){this.manager=new CB(e,this.options);for(const r of this.options.recognizers){const{recognizer:i,recognizeWith:a,requireFailure:l}=JB(r);this.manager.add(i),a&&i.recognizeWith(a),l&&i.requireFailure(l)}this.manager.on("hammer.input",this._onBasicInput),this.wheelInput=new FB(e,this._onOtherEvent,{enable:!1}),this.moveInput=new LB(e,this._onOtherEvent,{enable:!1}),this.keyInput=new zB(e,this._onOtherEvent,{enable:!1,tabIndex:t.tabIndex}),this.contextmenuInput=new VB(e,this._onOtherEvent,{enable:!1}),this.on(this.options.events)}}getElement(){return this.element}destroy(){this.element&&(this.wheelInput.destroy(),this.moveInput.destroy(),this.keyInput.destroy(),this.contextmenuInput.destroy(),this.manager.destroy())}on(e,t,r){this._addEventHandler(e,t,r,!1)}once(e,t,r){this._addEventHandler(e,t,r,!0)}watch(e,t,r){this._addEventHandler(e,t,r,!1,!0)}off(e,t){this._removeEventHandler(e,t)}_toggleRecognizer(e,t){var a,l,c,f;const{manager:r}=this;if(!r)return;const i=r.get(e);i&&(i.set({enable:t}),r.touchAction.update()),(a=this.wheelInput)==null||a.enableEventType(e,t),(l=this.moveInput)==null||l.enableEventType(e,t),(c=this.keyInput)==null||c.enableEventType(e,t),(f=this.contextmenuInput)==null||f.enableEventType(e,t)}_addEventHandler(e,t,r,i,a){if(typeof e!="string"){r=t;for(const[d,p]of Object.entries(e))this._addEventHandler(d,p,r,i,a);return}const{manager:l,events:c}=this;if(!l)return;let f=c.get(e);if(!f){const d=this._getRecognizerName(e)||e;f=new GB(this,d),c.set(e,f),l&&l.on(e,f.handleEvent)}f.add(e,t,r,i,a),f.isEmpty()||this._toggleRecognizer(f.recognizerName,!0)}_removeEventHandler(e,t){if(typeof e!="string"){for(const[a,l]of Object.entries(e))this._removeEventHandler(a,l);return}const{events:r}=this,i=r.get(e);if(i&&(i.remove(e,t),i.isEmpty())){const{recognizerName:a}=i;let l=!1;for(const c of r.values())if(c.recognizerName===a&&!c.isEmpty()){l=!0;break}l||this._toggleRecognizer(a,!1)}}_getRecognizerName(e){var t;return(t=this.manager.recognizers.find(r=>r.getEventNames().includes(e)))==null?void 0:t.options.event}}const Ve={DEFAULT:-1,LNGLAT:1,METER_OFFSETS:2,LNGLAT_OFFSETS:3,CARTESIAN:0};Object.defineProperty(Ve,"IDENTITY",{get:()=>(tt.deprecated("COORDINATE_SYSTEM.IDENTITY","COORDINATE_SYSTEM.CARTESIAN")(),0)});const An={WEB_MERCATOR:1,GLOBE:2,WEB_MERCATOR_AUTO_OFFSET:4,IDENTITY:0},Ma={common:0,meters:1,pixels:2},t_={click:"onClick",panstart:"onDragStart",panmove:"onDrag",panend:"onDragEnd"},AT={multipan:[bT,{threshold:10,direction:Tt.Vertical,pointers:2}],pinch:[kB,{},null,["multipan"]],pan:[bT,{threshold:1},["pinch"],["multipan"]],dblclick:[yT,{event:"dblclick",taps:2}],click:[yT,{event:"click"},null,["dblclick"]]};function t8(n,e){if(n===e)return!0;if(Array.isArray(n)){const t=n.length;if(!e||e.length!==t)return!1;for(let r=0;r<t;r++)if(n[r]!==e[r])return!1;return!0}return!1}function Dl(n){let e={},t;return r=>{for(const i in r)if(!t8(r[i],e[i])){t=n(r),e=r;break}return t}}const ET=[0,0,0,0],n8=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0],lx=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],r8=[0,0,0],cx=[0,0,0],i8=Dl(o8);function ux(n,e,t=cx){t.length<3&&(t=[t[0],t[1],0]);let r=t,i,a=!0;switch(e===Ve.LNGLAT_OFFSETS||e===Ve.METER_OFFSETS?i=t:i=n.isGeospatial?[Math.fround(n.longitude),Math.fround(n.latitude),0]:null,n.projectionMode){case An.WEB_MERCATOR:(e===Ve.LNGLAT||e===Ve.CARTESIAN)&&(i=[0,0,0],a=!1);break;case An.WEB_MERCATOR_AUTO_OFFSET:e===Ve.LNGLAT?r=i:e===Ve.CARTESIAN&&(r=[Math.fround(n.center[0]),Math.fround(n.center[1]),0],i=n.unprojectPosition(r),r[0]-=t[0],r[1]-=t[1],r[2]-=t[2]);break;case An.IDENTITY:r=n.position.map(Math.fround),r[2]=r[2]||0;break;case An.GLOBE:a=!1,i=null;break;default:a=!1}return{geospatialOrigin:i,shaderCoordinateOrigin:r,offsetMode:a}}function s8(n,e,t){const{viewMatrixUncentered:r,projectionMatrix:i}=n;let{viewMatrix:a,viewProjectionMatrix:l}=n,c=ET,f=ET,d=n.cameraPosition;const{geospatialOrigin:p,shaderCoordinateOrigin:_,offsetMode:y}=ux(n,e,t);return y&&(f=n.projectPosition(p||_),d=[d[0]-f[0],d[1]-f[1],d[2]-f[2]],f[3]=1,c=kl([],f,l),a=r||a,l=Wi([],i,a),l=Wi([],l,n8)),{viewMatrix:a,viewProjectionMatrix:l,projectionCenter:c,originCommon:f,cameraPosCommon:d,shaderCoordinateOrigin:_,geospatialOrigin:p}}function a8({viewport:n,devicePixelRatio:e=1,modelMatrix:t=null,coordinateSystem:r=Ve.DEFAULT,coordinateOrigin:i=cx,autoWrapLongitude:a=!1}){r===Ve.DEFAULT&&(r=n.isGeospatial?Ve.LNGLAT:Ve.CARTESIAN);const l=i8({viewport:n,devicePixelRatio:e,coordinateSystem:r,coordinateOrigin:i});return l.wrapLongitude=a,l.modelMatrix=t||lx,l}function o8({viewport:n,devicePixelRatio:e,coordinateSystem:t,coordinateOrigin:r}){const{projectionCenter:i,viewProjectionMatrix:a,originCommon:l,cameraPosCommon:c,shaderCoordinateOrigin:f,geospatialOrigin:d}=s8(n,t,r),p=n.getDistanceScales(),_=[n.width*e,n.height*e],y=kl([],[0,0,-n.focalDistance,1],n.projectionMatrix)[3]||1,b={coordinateSystem:t,projectionMode:n.projectionMode,coordinateOrigin:f,commonOrigin:l.slice(0,3),center:i,pseudoMeters:!!n._pseudoMeters,viewportSize:_,devicePixelRatio:e,focalDistance:y,commonUnitsPerMeter:p.unitsPerMeter,commonUnitsPerWorldUnit:p.unitsPerMeter,commonUnitsPerWorldUnit2:r8,scale:n.scale,wrapLongitude:!1,viewProjectionMatrix:a,modelMatrix:lx,cameraPosition:c};if(d){const T=n.getDistanceScales(d);switch(t){case Ve.METER_OFFSETS:b.commonUnitsPerWorldUnit=T.unitsPerMeter,b.commonUnitsPerWorldUnit2=T.unitsPerMeter2;break;case Ve.LNGLAT:case Ve.LNGLAT_OFFSETS:n._pseudoMeters||(b.commonUnitsPerMeter=T.unitsPerMeter),b.commonUnitsPerWorldUnit=T.unitsPerDegree,b.commonUnitsPerWorldUnit2=T.unitsPerDegree2;break;case Ve.CARTESIAN:b.commonUnitsPerWorldUnit=[1,1,T.unitsPerMeter[2]],b.commonUnitsPerWorldUnit2=[0,0,T.unitsPerMeter2[2]];break}}return b}const l8=Object.keys(Ve).map(n=>`const COORDINATE_SYSTEM_${n}: i32 = ${Ve[n]};`).join(""),c8=Object.keys(An).map(n=>`const PROJECTION_MODE_${n}: i32 = ${An[n]};`).join(""),u8=Object.keys(Ma).map(n=>`const UNIT_${n.toUpperCase()}: i32 = ${Ma[n]};`).join(""),f8=`${l8}
${c8}
${u8}

const TILE_SIZE: f32 = 512.0;
const PI: f32 = 3.1415926536;
const WORLD_SCALE: f32 = TILE_SIZE / (PI * 2.0);
const ZERO_64_LOW: vec3<f32> = vec3<f32>(0.0, 0.0, 0.0);
const EARTH_RADIUS: f32 = 6370972.0; // meters
const GLOBE_RADIUS: f32 = 256.0;

// -----------------------------------------------------------------------------
// Uniform block (converted from GLSL uniform block)
// -----------------------------------------------------------------------------
struct ProjectUniforms {
  wrapLongitude: i32,
  coordinateSystem: i32,
  commonUnitsPerMeter: vec3<f32>,
  projectionMode: i32,
  scale: f32,
  commonUnitsPerWorldUnit: vec3<f32>,
  commonUnitsPerWorldUnit2: vec3<f32>,
  center: vec4<f32>,
  modelMatrix: mat4x4<f32>,
  viewProjectionMatrix: mat4x4<f32>,
  viewportSize: vec2<f32>,
  devicePixelRatio: f32,
  focalDistance: f32,
  cameraPosition: vec3<f32>,
  coordinateOrigin: vec3<f32>,
  commonOrigin: vec3<f32>,
  pseudoMeters: i32,
};

@group(0) @binding(0)
var<uniform> project: ProjectUniforms;

// -----------------------------------------------------------------------------
// Geometry data
// (In your GLSL code, "geometry" was assumed to be available globally. In WGSL,
// you might supply this via vertex attributes or a uniform. Here we define a
// uniform struct for demonstration.)
// -----------------------------------------------------------------------------

// Structure to carry additional geometry data used by deck.gl filters.
struct Geometry {
  worldPosition: vec3<f32>,
  worldPositionAlt: vec3<f32>,
  position: vec4<f32>,
  uv: vec2<f32>,
  pickingColor: vec3<f32>,
};

// @group(0) @binding(1)
var<private> geometry: Geometry;
`,h8=`${f8}

// -----------------------------------------------------------------------------
// Functions
// -----------------------------------------------------------------------------

// Returns an adjustment factor for commonUnitsPerMeter
fn _project_size_at_latitude(lat: f32) -> f32 {
  let y = clamp(lat, -89.9, 89.9);
  return 1.0 / cos(radians(y));
}

// Overloaded version: scales a value in meters at a given latitude.
fn _project_size_at_latitude_m(meters: f32, lat: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * _project_size_at_latitude(lat);
}

// Computes a non-linear scale factor based on geometry.
// (Note: This function relies on "geometry" being provided.)
fn project_size() -> f32 {
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
      project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
      project.pseudoMeters == 0) {
    if (geometry.position.w == 0.0) {
      return _project_size_at_latitude(geometry.worldPosition.y);
    }
    let y: f32 = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
    let y2 = y * y;
    let y4 = y2 * y2;
    let y6 = y4 * y2;
    return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
  }
  return 1.0;
}

// Overloads to scale offsets (meters to world units)
fn project_size_float(meters: f32) -> f32 {
  return meters * project.commonUnitsPerMeter.z * project_size();
}

fn project_size_vec2(meters: vec2<f32>) -> vec2<f32> {
  return meters * project.commonUnitsPerMeter.xy * project_size();
}

fn project_size_vec3(meters: vec3<f32>) -> vec3<f32> {
  return meters * project.commonUnitsPerMeter * project_size();
}

fn project_size_vec4(meters: vec4<f32>) -> vec4<f32> {
  return vec4<f32>(meters.xyz * project.commonUnitsPerMeter, meters.w);
}

// Returns a rotation matrix aligning the zaxis with the given up vector.
fn project_get_orientation_matrix(up: vec3<f32>) -> mat3x3<f32> {
  let uz = normalize(up);
  let ux = select(
    vec3<f32>(1.0, 0.0, 0.0),
    normalize(vec3<f32>(uz.y, -uz.x, 0.0)),
    abs(uz.z) == 1.0
  );
  let uy = cross(uz, ux);
  return mat3x3<f32>(ux, uy, uz);
}

// Since WGSL does not support "out" parameters, we return a struct.
struct RotationResult {
  needsRotation: bool,
  transform: mat3x3<f32>,
};

fn project_needs_rotation(commonPosition: vec3<f32>) -> RotationResult {
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    return RotationResult(true, project_get_orientation_matrix(commonPosition));
  } else {
    return RotationResult(false, mat3x3<f32>());  // identity alternative if needed
  };
}

// Projects a normal vector from the current coordinate system to world space.
fn project_normal(vector: vec3<f32>) -> vec3<f32> {
  let normal_modelspace = project.modelMatrix * vec4<f32>(vector, 0.0);
  var n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
  let rotResult = project_needs_rotation(geometry.position.xyz);
  if (rotResult.needsRotation) {
    n = rotResult.transform * n;
  }
  return n;
}

// Applies a scale offset based on y-offset (dy)
fn project_offset_(offset: vec4<f32>) -> vec4<f32> {
  let dy: f32 = offset.y;
  let commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
  return vec4<f32>(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}

// Projects lng/lat coordinates to a unit tile [0,1]
fn project_mercator_(lnglat: vec2<f32>) -> vec2<f32> {
  var x = lnglat.x;
  if (project.wrapLongitude != 0) {
    x = ((x + 180.0) % 360.0) - 180.0;
  }
  let y = clamp(lnglat.y, -89.9, 89.9);
  return vec2<f32>(
    radians(x) + PI,
    PI + log(tan(PI * 0.25 + radians(y) * 0.5))
  ) * WORLD_SCALE;
}

// Projects lng/lat/z coordinates for a globe projection.
fn project_globe_(lnglatz: vec3<f32>) -> vec3<f32> {
  let lambda = radians(lnglatz.x);
  let phi = radians(lnglatz.y);
  let cosPhi = cos(phi);
  let D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
  return vec3<f32>(
    sin(lambda) * cosPhi,
    -cos(lambda) * cosPhi,
    sin(phi)
  ) * D;
}

// Projects positions (with an optional 64-bit low part) from the input
// coordinate system to the common space.
fn project_position_vec4_f64(position: vec4<f32>, position64Low: vec3<f32>) -> vec4<f32> {
  var position_world = project.modelMatrix * position;

  // Work around for a Mac+NVIDIA bug:
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_mercator_(position_world.xy),
        _project_size_at_latitude_m(position_world.z, position_world.y),
        position_world.w
      );
    }
    if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
      position_world = vec4f(position_world.xyz + project.coordinateOrigin, position_world.w);
    }
  }
  if (project.projectionMode == PROJECTION_MODE_GLOBE) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      return vec4<f32>(
        project_globe_(position_world.xyz),
        position_world.w
      );
    }
  }
  if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
    if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
      if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
        return vec4<f32>(
          project_mercator_(position_world.xy) - project.commonOrigin.xy,
          project_size_float(position_world.z),
          position_world.w
        );
      }
    }
  }
  if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
      (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
       (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
        project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
    position_world = vec4f(position_world.xyz - project.coordinateOrigin, position_world.w);
  }

  return project_offset_(position_world) +
         project_offset_(project.modelMatrix * vec4<f32>(position64Low, 0.0));
}

// Overloaded versions for different input types.
fn project_position_vec4_f32(position: vec4<f32>) -> vec4<f32> {
  return project_position_vec4_f64(position, ZERO_64_LOW);
}

fn project_position_vec3_f64(position: vec3<f32>, position64Low: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), position64Low);
  return projected_position.xyz;
}

fn project_position_vec3_f32(position: vec3<f32>) -> vec3<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 1.0), ZERO_64_LOW);
  return projected_position.xyz;
}

fn project_position_vec2_f32(position: vec2<f32>) -> vec2<f32> {
  let projected_position = project_position_vec4_f64(vec4<f32>(position, 0.0, 1.0), ZERO_64_LOW);
  return projected_position.xy;
}

// Transforms a common space position to clip space.
fn project_common_position_to_clipspace_with_projection(position: vec4<f32>, viewProjectionMatrix: mat4x4<f32>, center: vec4<f32>) -> vec4<f32> {
  return viewProjectionMatrix * position + center;
}

// Uses the project viewProjectionMatrix and center.
fn project_common_position_to_clipspace(position: vec4<f32>) -> vec4<f32> {
  return project_common_position_to_clipspace_with_projection(position, project.viewProjectionMatrix, project.center);
}

// Returns a clip space offset corresponding to a given number of screen pixels.
fn project_pixel_size_to_clipspace(pixels: vec2<f32>) -> vec2<f32> {
  let offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
  return offset * project.focalDistance;
}

fn project_meter_size_to_pixel(meters: f32) -> f32 {
  return project_size_float(meters) * project.scale;
}

fn project_unit_size_to_pixel(size: f32, unit: i32) -> f32 {
  if (unit == UNIT_METERS) {
    return project_meter_size_to_pixel(size);
  } else if (unit == UNIT_COMMON) {
    return size * project.scale;
  }
  // UNIT_PIXELS: no scaling applied.
  return size;
}

fn project_pixel_size_float(pixels: f32) -> f32 {
  return pixels / project.scale;
}

fn project_pixel_size_vec2(pixels: vec2<f32>) -> vec2<f32> {
  return pixels / project.scale;
}
`,d8=Object.keys(Ve).map(n=>`const int COORDINATE_SYSTEM_${n} = ${Ve[n]};`).join(""),p8=Object.keys(An).map(n=>`const int PROJECTION_MODE_${n} = ${An[n]};`).join(""),g8=Object.keys(Ma).map(n=>`const int UNIT_${n.toUpperCase()} = ${Ma[n]};`).join(""),_8=`${d8}
${p8}
${g8}
uniform projectUniforms {
bool wrapLongitude;
int coordinateSystem;
vec3 commonUnitsPerMeter;
int projectionMode;
float scale;
vec3 commonUnitsPerWorldUnit;
vec3 commonUnitsPerWorldUnit2;
vec4 center;
mat4 modelMatrix;
mat4 viewProjectionMatrix;
vec2 viewportSize;
float devicePixelRatio;
float focalDistance;
vec3 cameraPosition;
vec3 coordinateOrigin;
vec3 commonOrigin;
bool pseudoMeters;
} project;
const float TILE_SIZE = 512.0;
const float PI = 3.1415926536;
const float WORLD_SCALE = TILE_SIZE / (PI * 2.0);
const vec3 ZERO_64_LOW = vec3(0.0);
const float EARTH_RADIUS = 6370972.0;
const float GLOBE_RADIUS = 256.0;
float project_size_at_latitude(float lat) {
float y = clamp(lat, -89.9, 89.9);
return 1.0 / cos(radians(y));
}
float project_size() {
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR &&
project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT &&
project.pseudoMeters == false) {
if (geometry.position.w == 0.0) {
return project_size_at_latitude(geometry.worldPosition.y);
}
float y = geometry.position.y / TILE_SIZE * 2.0 - 1.0;
float y2 = y * y;
float y4 = y2 * y2;
float y6 = y4 * y2;
return 1.0 + 4.9348 * y2 + 4.0587 * y4 + 1.5642 * y6;
}
return 1.0;
}
float project_size_at_latitude(float meters, float lat) {
return meters * project.commonUnitsPerMeter.z * project_size_at_latitude(lat);
}
float project_size(float meters) {
return meters * project.commonUnitsPerMeter.z * project_size();
}
vec2 project_size(vec2 meters) {
return meters * project.commonUnitsPerMeter.xy * project_size();
}
vec3 project_size(vec3 meters) {
return meters * project.commonUnitsPerMeter * project_size();
}
vec4 project_size(vec4 meters) {
return vec4(meters.xyz * project.commonUnitsPerMeter, meters.w);
}
mat3 project_get_orientation_matrix(vec3 up) {
vec3 uz = normalize(up);
vec3 ux = abs(uz.z) == 1.0 ? vec3(1.0, 0.0, 0.0) : normalize(vec3(uz.y, -uz.x, 0));
vec3 uy = cross(uz, ux);
return mat3(ux, uy, uz);
}
bool project_needs_rotation(vec3 commonPosition, out mat3 transform) {
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
transform = project_get_orientation_matrix(commonPosition);
return true;
}
return false;
}
vec3 project_normal(vec3 vector) {
vec4 normal_modelspace = project.modelMatrix * vec4(vector, 0.0);
vec3 n = normalize(normal_modelspace.xyz * project.commonUnitsPerMeter);
mat3 rotation;
if (project_needs_rotation(geometry.position.xyz, rotation)) {
n = rotation * n;
}
return n;
}
vec4 project_offset_(vec4 offset) {
float dy = offset.y;
vec3 commonUnitsPerWorldUnit = project.commonUnitsPerWorldUnit + project.commonUnitsPerWorldUnit2 * dy;
return vec4(offset.xyz * commonUnitsPerWorldUnit, offset.w);
}
vec2 project_mercator_(vec2 lnglat) {
float x = lnglat.x;
if (project.wrapLongitude) {
x = mod(x + 180., 360.0) - 180.;
}
float y = clamp(lnglat.y, -89.9, 89.9);
return vec2(
radians(x) + PI,
PI + log(tan_fp32(PI * 0.25 + radians(y) * 0.5))
) * WORLD_SCALE;
}
vec3 project_globe_(vec3 lnglatz) {
float lambda = radians(lnglatz.x);
float phi = radians(lnglatz.y);
float cosPhi = cos(phi);
float D = (lnglatz.z / EARTH_RADIUS + 1.0) * GLOBE_RADIUS;
return vec3(
sin(lambda) * cosPhi,
-cos(lambda) * cosPhi,
sin(phi)
) * D;
}
vec4 project_position(vec4 position, vec3 position64Low) {
vec4 position_world = project.modelMatrix * position;
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_mercator_(position_world.xy),
project_size_at_latitude(position_world.z, position_world.y),
position_world.w
);
}
if (project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN) {
position_world.xyz += project.coordinateOrigin;
}
}
if (project.projectionMode == PROJECTION_MODE_GLOBE) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
return vec4(
project_globe_(position_world.xyz),
position_world.w
);
}
}
if (project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET) {
if (project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT) {
if (abs(position_world.y - project.coordinateOrigin.y) > 0.25) {
return vec4(
project_mercator_(position_world.xy) - project.commonOrigin.xy,
project_size(position_world.z),
position_world.w
);
}
}
}
if (project.projectionMode == PROJECTION_MODE_IDENTITY ||
(project.projectionMode == PROJECTION_MODE_WEB_MERCATOR_AUTO_OFFSET &&
(project.coordinateSystem == COORDINATE_SYSTEM_LNGLAT ||
project.coordinateSystem == COORDINATE_SYSTEM_CARTESIAN))) {
position_world.xyz -= project.coordinateOrigin;
}
return project_offset_(position_world) + project_offset_(project.modelMatrix * vec4(position64Low, 0.0));
}
vec4 project_position(vec4 position) {
return project_position(position, ZERO_64_LOW);
}
vec3 project_position(vec3 position, vec3 position64Low) {
vec4 projected_position = project_position(vec4(position, 1.0), position64Low);
return projected_position.xyz;
}
vec3 project_position(vec3 position) {
vec4 projected_position = project_position(vec4(position, 1.0), ZERO_64_LOW);
return projected_position.xyz;
}
vec2 project_position(vec2 position) {
vec4 projected_position = project_position(vec4(position, 0.0, 1.0), ZERO_64_LOW);
return projected_position.xy;
}
vec4 project_common_position_to_clipspace(vec4 position, mat4 viewProjectionMatrix, vec4 center) {
return viewProjectionMatrix * position + center;
}
vec4 project_common_position_to_clipspace(vec4 position) {
return project_common_position_to_clipspace(position, project.viewProjectionMatrix, project.center);
}
vec2 project_pixel_size_to_clipspace(vec2 pixels) {
vec2 offset = pixels / project.viewportSize * project.devicePixelRatio * 2.0;
return offset * project.focalDistance;
}
float project_size_to_pixel(float meters) {
return project_size(meters) * project.scale;
}
float project_size_to_pixel(float size, int unit) {
if (unit == UNIT_METERS) return project_size_to_pixel(size);
if (unit == UNIT_COMMON) return size * project.scale;
return size;
}
float project_pixel_size(float pixels) {
return pixels / project.scale;
}
vec2 project_pixel_size(vec2 pixels) {
return pixels / project.scale;
}
`,m8={};function y8(n=m8){return"viewport"in n?a8(n):{}}const tm={name:"project",dependencies:[KU,tx],source:h8,vs:_8,getUniforms:y8,uniformTypes:{wrapLongitude:"f32",coordinateSystem:"i32",commonUnitsPerMeter:"vec3<f32>",projectionMode:"i32",scale:"f32",commonUnitsPerWorldUnit:"vec3<f32>",commonUnitsPerWorldUnit2:"vec3<f32>",center:"vec4<f32>",modelMatrix:"mat4x4<f32>",viewProjectionMatrix:"mat4x4<f32>",viewportSize:"vec2<f32>",devicePixelRatio:"f32",focalDistance:"f32",cameraPosition:"vec3<f32>",coordinateOrigin:"vec3<f32>",commonOrigin:"vec3<f32>",pseudoMeters:"f32"}},b8=`// Define a structure to hold both the clip-space position and the common position.
struct ProjectResult {
  clipPosition: vec4<f32>,
  commonPosition: vec4<f32>,
};

// This function mimics the GLSL version with the 'out' parameter by returning both values.
fn project_position_to_clipspace_and_commonspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> ProjectResult {
  // Compute the projected position.
  let projectedPosition: vec3<f32> = project_position_vec3_f64(position, position64Low);

  // Start with the provided offset.
  var finalOffset: vec3<f32> = offset;

  // Get whether a rotation is needed and the rotation matrix.
  let rotationResult = project_needs_rotation(projectedPosition);

  // If rotation is needed, update the offset.
  if (rotationResult.needsRotation) {
    finalOffset = rotationResult.transform * offset;
  }

  // Compute the common position.
  let commonPosition: vec4<f32> = vec4<f32>(projectedPosition + finalOffset, 1.0);

  // Convert to clip-space.
  let clipPosition: vec4<f32> = project_common_position_to_clipspace(commonPosition);

  return ProjectResult(clipPosition, commonPosition);
}

// A convenience overload that returns only the clip-space position.
fn project_position_to_clipspace(
    position: vec3<f32>,
    position64Low: vec3<f32>,
    offset: vec3<f32>
) -> vec4<f32> {
  return project_position_to_clipspace_and_commonspace(position, position64Low, offset).clipPosition;
}
`,v8=`vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset, out vec4 commonPosition
) {
  vec3 projectedPosition = project_position(position, position64Low);
  mat3 rotation;
  if (project_needs_rotation(projectedPosition, rotation)) {
    // offset is specified as ENU
    // when in globe projection, rotate offset so that the ground alighs with the surface of the globe
    offset = rotation * offset;
  }
  commonPosition = vec4(projectedPosition + offset, 1.0);
  return project_common_position_to_clipspace(commonPosition);
}

vec4 project_position_to_clipspace(
  vec3 position, vec3 position64Low, vec3 offset
) {
  vec4 commonPosition;
  return project_position_to_clipspace(position, position64Low, offset, commonPosition);
}
`,T8={name:"project32",dependencies:[tm],source:b8,vs:v8};function w8(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function _a(n,e){const t=kl([],e,n);return LU(t,t,1/t[3]),t}function RT(n,e){const t=n%e;return t<0?e+t:t}function x8(n,e,t){return t*e+(1-t)*n}function n_(n,e,t){return n<e?e:n>t?t:n}function S8(n){return Math.log(n)*Math.LOG2E}const nm=Math.log2||S8;function Ir(n,e){if(!n)throw new Error(e||"@math.gl/web-mercator: assertion failed.")}const zn=Math.PI,fx=zn/4,Cn=zn/180,r_=180/zn,Oa=512,df=4003e4,CT=85.051129,A8=1.5;function MT(n){return Math.pow(2,n)}function hx(n){return nm(n)}function Ia(n){const[e,t]=n;Ir(Number.isFinite(e)),Ir(Number.isFinite(t)&&t>=-90&&t<=90,"invalid latitude");const r=e*Cn,i=t*Cn,a=Oa*(r+zn)/(2*zn),l=Oa*(zn+Math.log(Math.tan(fx+i*.5)))/(2*zn);return[a,l]}function ns(n){const[e,t]=n,r=e/Oa*(2*zn)-zn,i=2*(Math.atan(Math.exp(t/Oa*(2*zn)-zn))-fx);return[r*r_,i*r_]}function E8(n){const{latitude:e}=n;Ir(Number.isFinite(e));const t=Math.cos(e*Cn);return hx(df*t)-9}function Yp(n){const e=Math.cos(n*Cn);return Oa/df/e}function i_(n){const{latitude:e,longitude:t,highPrecision:r=!1}=n;Ir(Number.isFinite(e)&&Number.isFinite(t));const i=Oa,a=Math.cos(e*Cn),l=i/360,c=l/a,f=i/df/a,d={unitsPerMeter:[f,f,f],metersPerUnit:[1/f,1/f,1/f],unitsPerDegree:[l,c,f],degreesPerUnit:[1/l,1/c,1/f]};if(r){const p=Cn*Math.tan(e*Cn)/a,_=l*p/2,y=i/df*p,b=y/c*f;d.unitsPerDegree2=[0,_,y],d.unitsPerMeter2=[b,0,b]}return d}function dx(n,e){const[t,r,i]=n,[a,l,c]=e,{unitsPerMeter:f,unitsPerMeter2:d}=i_({longitude:t,latitude:r,highPrecision:!0}),p=Ia(n);p[0]+=a*(f[0]+d[0]*l),p[1]+=l*(f[1]+d[1]*l);const _=ns(p),y=(i||0)+(c||0);return Number.isFinite(i)||Number.isFinite(c)?[_[0],_[1],y]:_}function R8(n){const{height:e,pitch:t,bearing:r,altitude:i,scale:a,center:l}=n,c=w8();ff(c,c,[0,0,-i]),Qw(c,c,-t*Cn),Gw(c,c,r*Cn);const f=a/e;return em(c,c,[f,f,f]),l&&ff(c,c,gU([],l)),c}function C8(n){const{width:e,height:t,altitude:r,pitch:i=0,offset:a,center:l,scale:c,nearZMultiplier:f=1,farZMultiplier:d=1}=n;let{fovy:p=pf(A8)}=n;r!==void 0&&(p=pf(r));const _=p*Cn,y=i*Cn,b=px(p);let T=b;l&&(T+=l[2]*c/Math.cos(y)/t);const A=_*(.5+(a?a[1]:0)/t),C=Math.sin(A)*T/Math.sin(n_(Math.PI/2-y-A,.01,Math.PI-.01)),N=Math.sin(y)*C+T,O=T*10,R=Math.min(N*d,O);return{fov:_,aspect:e/t,focalDistance:b,near:f,far:R}}function pf(n){return 2*Math.atan(.5/n)*r_}function px(n){return .5/Math.tan(.5*n*Cn)}function gx(n,e){const[t,r,i=0]=n;return Ir(Number.isFinite(t)&&Number.isFinite(r)&&Number.isFinite(i)),_a(e,[t,r,i,1])}function rm(n,e,t=0){const[r,i,a]=n;if(Ir(Number.isFinite(r)&&Number.isFinite(i),"invalid pixel coordinate"),Number.isFinite(a))return _a(e,[r,i,a,1]);const l=_a(e,[r,i,0,1]),c=_a(e,[r,i,1,1]),f=l[2],d=c[2],p=f===d?0:((t||0)-f)/(d-f);return qw([],l,c,p)}function M8(n){const{width:e,height:t,bounds:r,minExtent:i=0,maxZoom:a=24,offset:l=[0,0]}=n,[[c,f],[d,p]]=r,_=O8(n.padding),y=Ia([c,n_(p,-85.051129,CT)]),b=Ia([d,n_(f,-85.051129,CT)]),T=[Math.max(Math.abs(b[0]-y[0]),i),Math.max(Math.abs(b[1]-y[1]),i)],A=[e-_.left-_.right-Math.abs(l[0])*2,t-_.top-_.bottom-Math.abs(l[1])*2];Ir(A[0]>0&&A[1]>0);const C=A[0]/T[0],N=A[1]/T[1],O=(_.right-_.left)/2/C,R=(_.top-_.bottom)/2/N,E=[(b[0]+y[0])/2+O,(b[1]+y[1])/2+R],k=ns(E),V=Math.min(a,nm(Math.abs(Math.min(C,N))));return Ir(Number.isFinite(V)),{longitude:k[0],latitude:k[1],zoom:V}}function O8(n=0){return typeof n=="number"?{top:n,bottom:n,left:n,right:n}:(Ir(Number.isFinite(n.top)&&Number.isFinite(n.bottom)&&Number.isFinite(n.left)&&Number.isFinite(n.right)),n)}const OT=Math.PI/180;function I8(n,e=0){const{width:t,height:r,unproject:i}=n,a={targetZ:e},l=i([0,r],a),c=i([t,r],a);let f,d;const p=n.fovy?.5*n.fovy*OT:Math.atan(.5/n.altitude),_=(90-n.pitch)*OT;return p>_-.01?(f=IT(n,0,e),d=IT(n,t,e)):(f=i([0,0],a),d=i([t,0],a)),[l,c,d,f]}function IT(n,e,t){const{pixelUnprojectionMatrix:r}=n,i=_a(r,[e,0,1,1]),a=_a(r,[e,n.height,1,1]),c=(t*n.distanceScales.unitsPerMeter[2]-i[2])/(a[2]-i[2]),f=qw([],i,a,c),d=ns(f);return d.push(t),d}const NT=512;function N8(n){const{width:e,height:t,pitch:r=0}=n;let{longitude:i,latitude:a,zoom:l,bearing:c=0}=n;(i<-180||i>180)&&(i=RT(i+180,360)-180),(c<-180||c>180)&&(c=RT(c+180,360)-180);const f=nm(t/NT);if(l<=f)l=f,a=0;else{const d=t/2/Math.pow(2,l),p=ns([0,d])[1];if(a<p)a=p;else{const _=ns([0,NT-d])[1];a>_&&(a=_)}}return{width:e,height:t,longitude:i,latitude:a,zoom:l,pitch:r,bearing:c}}const _x=.01,k8=["longitude","latitude","zoom"],mx={curve:1.414,speed:1.2};function D8(n,e,t,r){const{startZoom:i,startCenterXY:a,uDelta:l,w0:c,u1:f,S:d,rho:p,rho2:_,r0:y}=yx(n,e,r);if(f<_x){const E={};for(const k of k8){const V=n[k],ne=e[k];E[k]=x8(V,ne,t)}return E}const b=t*d,T=Math.cosh(y)/Math.cosh(y+p*b),A=c*((Math.cosh(y)*Math.tanh(y+p*b)-Math.sinh(y))/_)/f,C=1/T,N=i+hx(C),O=aU([],l,A);qg(O,O,a);const R=ns(O);return{longitude:R[0],latitude:R[1],zoom:N}}function P8(n,e,t){const r={...mx,...t},{screenSpeed:i,speed:a,maxDuration:l}=r,{S:c,rho:f}=yx(n,e,r),d=1e3*c;let p;return Number.isFinite(i)?p=d/(i/f):p=d/a,Number.isFinite(l)&&p>l?0:p}function yx(n,e,t){t=Object.assign({},mx,t);const r=t.curve,i=n.zoom,a=[n.longitude,n.latitude],l=MT(i),c=e.zoom,f=[e.longitude,e.latitude],d=MT(c-i),p=Ia(a),_=Ia(f),y=uU([],_,p),b=Math.max(n.width,n.height),T=b/d,A=oU(y)*l,C=Math.max(A,_x),N=r*r,O=(T*T-b*b+N*N*C*C)/(2*b*N*C),R=(T*T-b*b-N*N*C*C)/(2*T*N*C),E=Math.log(Math.sqrt(O*O+1)-O),k=Math.log(Math.sqrt(R*R+1)-R),V=(k-E)/r;return{startZoom:i,startCenterXY:p,uDelta:y,w0:b,u1:A,S:V,rho:r,rho2:N,r0:E,r1:k}}const bx=`
uniform shadowUniforms {
  bool drawShadowMap;
  bool useShadowMap;
  vec4 color;
  highp int lightId;
  float lightCount;
  mat4 viewProjectionMatrix0;
  mat4 viewProjectionMatrix1;
  vec4 projectCenter0;
  vec4 projectCenter1;
} shadow;
`,U8=`
const int max_lights = 2;

out vec3 shadow_vPosition[max_lights];

vec4 shadow_setVertexPosition(vec4 position_commonspace) {
  mat4 viewProjectionMatrices[max_lights];
  viewProjectionMatrices[0] = shadow.viewProjectionMatrix0;
  viewProjectionMatrices[1] = shadow.viewProjectionMatrix1;
  vec4 projectCenters[max_lights];
  projectCenters[0] = shadow.projectCenter0;
  projectCenters[1] = shadow.projectCenter1;

  if (shadow.drawShadowMap) {
    return project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[shadow.lightId], projectCenters[shadow.lightId]);
  }
  if (shadow.useShadowMap) {
    for (int i = 0; i < max_lights; i++) {
      if(i < int(shadow.lightCount)) {
        vec4 shadowMap_position = project_common_position_to_clipspace(position_commonspace, viewProjectionMatrices[i], projectCenters[i]);
        shadow_vPosition[i] = (shadowMap_position.xyz / shadowMap_position.w + 1.0) / 2.0;
      }
    }
  }
  return gl_Position;
}
`,B8=`
${bx}
${U8}
`,F8=`
const int max_lights = 2;
uniform sampler2D shadow_uShadowMap0;
uniform sampler2D shadow_uShadowMap1;

in vec3 shadow_vPosition[max_lights];

const vec4 bitPackShift = vec4(1.0, 255.0, 65025.0, 16581375.0);
const vec4 bitUnpackShift = 1.0 / bitPackShift;
const vec4 bitMask = vec4(1.0 / 255.0, 1.0 / 255.0, 1.0 / 255.0,  0.0);

float shadow_getShadowWeight(vec3 position, sampler2D shadowMap) {
  vec4 rgbaDepth = texture(shadowMap, position.xy);

  float z = dot(rgbaDepth, bitUnpackShift);
  return smoothstep(0.001, 0.01, position.z - z);
}

vec4 shadow_filterShadowColor(vec4 color) {
  if (shadow.drawShadowMap) {
    vec4 rgbaDepth = fract(gl_FragCoord.z * bitPackShift);
    rgbaDepth -= rgbaDepth.gbaa * bitMask;
    return rgbaDepth;
  }
  if (shadow.useShadowMap) {
    float shadowAlpha = 0.0;
    shadowAlpha += shadow_getShadowWeight(shadow_vPosition[0], shadow_uShadowMap0);
    if(shadow.lightCount > 1.0) {
      shadowAlpha += shadow_getShadowWeight(shadow_vPosition[1], shadow_uShadowMap1);
    }
    shadowAlpha *= shadow.color.a / shadow.lightCount;
    float blendedAlpha = shadowAlpha + color.a * (1.0 - shadowAlpha);

    return vec4(
      mix(color.rgb, shadow.color.rgb, shadowAlpha / blendedAlpha),
      blendedAlpha
    );
  }
  return color;
}
`,L8=`
${bx}
${F8}
`,z8=Dl(W8),V8=Dl(X8),H8=[0,0,0,1],j8=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0];function $8(n,e){const[t,r,i]=n,a=rm([t,r,i],e);return Number.isFinite(i)?a:[a[0],a[1],0]}function W8({viewport:n,center:e}){return new ir(n.viewProjectionMatrix).invert().transform(e)}function X8({viewport:n,shadowMatrices:e}){const t=[],r=n.pixelUnprojectionMatrix,i=n.isGeospatial?void 0:1,a=[[0,0,i],[n.width,0,i],[0,n.height,i],[n.width,n.height,i],[0,0,-1],[n.width,0,-1],[0,n.height,-1],[n.width,n.height,-1]].map(l=>$8(l,r));for(const l of e){const c=l.clone().translate(new rr(n.center).negate()),f=a.map(p=>c.transform(p)),d=new ir().ortho({left:Math.min(...f.map(p=>p[0])),right:Math.max(...f.map(p=>p[0])),bottom:Math.min(...f.map(p=>p[1])),top:Math.max(...f.map(p=>p[1])),near:Math.min(...f.map(p=>-p[2])),far:Math.max(...f.map(p=>-p[2]))});t.push(d.multiplyRight(l))}return t}function Y8(n){const{shadowEnabled:e=!0,project:t}=n;if(!e||!t||!n.shadowMatrices||!n.shadowMatrices.length)return{drawShadowMap:!1,useShadowMap:!1,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};const r=tm.getUniforms(t),i=z8({viewport:t.viewport,center:r.center}),a=[],l=V8({shadowMatrices:n.shadowMatrices,viewport:t.viewport}).slice();for(let f=0;f<n.shadowMatrices.length;f++){const d=l[f],p=d.clone().translate(new rr(t.viewport.center).negate());r.coordinateSystem===Ve.LNGLAT&&r.projectionMode===An.WEB_MERCATOR?(l[f]=p,a[f]=i):(l[f]=d.clone().multiplyRight(j8),a[f]=p.transform(i))}const c={drawShadowMap:!!n.drawToShadowMap,useShadowMap:n.shadowMaps?n.shadowMaps.length>0:!1,color:n.shadowColor||H8,lightId:n.shadowLightId||0,lightCount:n.shadowMatrices.length,shadow_uShadowMap0:n.dummyShadowMap,shadow_uShadowMap1:n.dummyShadowMap};for(let f=0;f<l.length;f++)c[`viewProjectionMatrix${f}`]=l[f],c[`projectCenter${f}`]=a[f];for(let f=0;f<2;f++)c[`shadow_uShadowMap${f}`]=n.shadowMaps&&n.shadowMaps[f]||n.dummyShadowMap;return c}const kT={name:"shadow",dependencies:[tm],vs:B8,fs:L8,inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    position = shadow_setVertexPosition(geometry.position);
    `,"fs:DECKGL_FILTER_COLOR":`
    color = shadow_filterShadowColor(color);
    `},getUniforms:Y8,uniformTypes:{drawShadowMap:"f32",useShadowMap:"f32",color:"vec4<f32>",lightId:"i32",lightCount:"f32",viewProjectionMatrix0:"mat4x4<f32>",viewProjectionMatrix1:"mat4x4<f32>",projectCenter0:"vec4<f32>",projectCenter1:"vec4<f32>"}},q8={...cT,defaultUniforms:{...cT.defaultUniforms,useFloatColors:!1},inject:{"vs:DECKGL_FILTER_GL_POSITION":`
    // for picking depth values
    picking_setPickingAttribute(position.z / position.w);
  `,"vs:DECKGL_FILTER_COLOR":`
  picking_setPickingColor(geometry.pickingColor);
  `,"fs:DECKGL_FILTER_COLOR":{order:99,injection:`
  // use highlight color if this fragment belongs to the selected object.
  color = picking_filterHighlightColor(color);

  // use picking color if rendering to picking FBO.
  color = picking_filterPickingColor(color);
    `}}},K8=[tx],Z8=["vs:DECKGL_FILTER_SIZE(inout vec3 size, VertexGeometry geometry)","vs:DECKGL_FILTER_GL_POSITION(inout vec4 position, VertexGeometry geometry)","vs:DECKGL_FILTER_COLOR(inout vec4 color, VertexGeometry geometry)","fs:DECKGL_FILTER_COLOR(inout vec4 color, FragmentGeometry geometry)"],Q8=[];function G8(n){const e=Gu.getDefaultShaderAssembler();for(const r of K8)e.addDefaultModule(r);const t=n==="glsl"?Z8:Q8;for(const r of t)e.addShaderHook(r);return e}const J8=[255,255,255],eF=1;let tF=0;class nF{constructor(e={}){this.type="ambient";const{color:t=J8}=e,{intensity:r=eF}=e;this.id=e.id||`ambient-${tF++}`,this.color=t,this.intensity=r}}const rF=[255,255,255],iF=1,sF=[0,0,-1];let aF=0;class DT{constructor(e={}){this.type="directional";const{color:t=rF}=e,{intensity:r=iF}=e,{direction:i=sF}=e,{_shadow:a=!1}=e;this.id=e.id||`directional-${aF++}`,this.color=t,this.intensity=r,this.type="directional",this.direction=new rr(i).normalize().toArray(),this.shadow=a}getProjectedLight(e){return this}}class oF{constructor(e,t={id:"pass"}){const{id:r}=t;this.id=r,this.device=e,this.props={...t}}setProps(e){Object.assign(this.props,e)}render(e){}cleanup(){}}class im extends oF{constructor(){super(...arguments),this._lastRenderIndex=-1}render(e){const[t,r]=this.device.canvasContext.getDrawingBufferSize(),i=e.clearCanvas??!0,a=e.clearColor??(i?[0,0,0,0]:!1),l=i?1:!1,c=i?0:!1,f=e.colorMask??15,d={viewport:[0,0,t,r]};e.colorMask&&(d.colorMask=f),e.scissorRect&&(d.scissorRect=e.scissorRect);const p=this.device.beginRenderPass({framebuffer:e.target,parameters:d,clearColor:a,clearDepth:l,clearStencil:c});try{return this._drawLayers(p,e)}finally{p.end(),this.device.submit()}}_drawLayers(e,t){const{target:r,shaderModuleProps:i,viewports:a,views:l,onViewportActive:c,clearStack:f=!0}=t;t.pass=t.pass||"unknown",f&&(this._lastRenderIndex=-1);const d=[];for(const p of a){const _=l&&l[p.id];c==null||c(p);const y=this._getDrawLayerParams(p,t),b=p.subViewports||[p];for(const T of b){const A=this._drawLayersInViewport(e,{target:r,shaderModuleProps:i,viewport:T,view:_,pass:t.pass,layers:t.layers},y);d.push(A)}}return d}_getDrawLayerParams(e,{layers:t,pass:r,isPicking:i=!1,layerFilter:a,cullRect:l,effects:c,shaderModuleProps:f},d=!1){var T;const p=[],_=vx(this._lastRenderIndex+1),y={layer:t[0],viewport:e,isPicking:i,renderPass:r,cullRect:l},b={};for(let A=0;A<t.length;A++){const C=t[A],N=this._shouldDrawLayer(C,y,a,b),O={shouldDrawLayer:N};N&&!d&&(O.shouldDrawLayer=!0,O.layerRenderIndex=_(C,N),O.shaderModuleProps=this._getShaderModuleProps(C,c,r,f),O.layerParameters={...(T=C.context.deck)==null?void 0:T.props.parameters,...this.getLayerParameters(C,A,e)}),p[A]=O}return p}_drawLayersInViewport(e,{layers:t,shaderModuleProps:r,pass:i,target:a,viewport:l,view:c},f){const d=lF(this.device,{shaderModuleProps:r,target:a,viewport:l});if(c&&c.props.clear){const _=c.props.clear===!0?{color:!0,depth:!0}:c.props.clear;this.device.beginRenderPass({framebuffer:a,parameters:{viewport:d,scissorRect:d},clearColor:_.color?[0,0,0,0]:!1,clearDepth:_.depth?1:!1}).end()}const p={totalCount:t.length,visibleCount:0,compositeCount:0,pickableCount:0};e.setParameters({viewport:d});for(let _=0;_<t.length;_++){const y=t[_],b=f[_],{shouldDrawLayer:T}=b;if(T&&y.props.pickable&&p.pickableCount++,y.isComposite&&p.compositeCount++,y.isDrawable&&b.shouldDrawLayer){const{layerRenderIndex:A,shaderModuleProps:C,layerParameters:N}=b;p.visibleCount++,this._lastRenderIndex=Math.max(this._lastRenderIndex,A),C.project&&(C.project.viewport=l),y.context.renderPass=e;try{y._drawLayer({renderPass:e,shaderModuleProps:C,uniforms:{layerIndex:A},parameters:N})}catch(O){y.raiseError(O,`drawing ${y} to ${i}`)}}}return p}shouldDrawLayer(e){return!0}getShaderModuleProps(e,t,r){return null}getLayerParameters(e,t,r){return e.props.parameters}_shouldDrawLayer(e,t,r,i){if(!(e.props.visible&&this.shouldDrawLayer(e)))return!1;t.layer=e;let l=e.parent;for(;l;){if(!l.props.visible||!l.filterSubLayer(t))return!1;t.layer=l,l=l.parent}if(r){const c=t.layer.id;if(c in i||(i[c]=r(t)),!i[c])return!1}return e.activateViewport(t.viewport),!0}_getShaderModuleProps(e,t,r,i){var f,d;const a=this.device.canvasContext.cssToDeviceRatio(),l=((f=e.internalState)==null?void 0:f.propsInTransition)||e.props,c={layer:l,picking:{isActive:!1},project:{viewport:e.context.viewport,devicePixelRatio:a,modelMatrix:l.modelMatrix,coordinateSystem:l.coordinateSystem,coordinateOrigin:l.coordinateOrigin,autoWrapLongitude:e.wrapLongitude}};if(t)for(const p of t)PT(c,(d=p.getShaderModuleProps)==null?void 0:d.call(p,e,c));return PT(c,this.getShaderModuleProps(e,t,c),i)}}function vx(n=0,e={}){const t={},r=(i,a)=>{const l=i.props._offset,c=i.id,f=i.parent&&i.parent.id;let d;if(f&&!(f in e)&&r(i.parent,!1),f in t){const p=t[f]=t[f]||vx(e[f],e);d=p(i,a),t[c]=p}else Number.isFinite(l)?(d=l+(e[f]||0),t[c]=null):d=n;return a&&d>=n&&(n=d+1),e[c]=d,d};return r}function lF(n,{shaderModuleProps:e,target:t,viewport:r}){var f;const i=((f=e==null?void 0:e.project)==null?void 0:f.devicePixelRatio)??n.canvasContext.cssToDeviceRatio(),[,a]=n.canvasContext.getDrawingBufferSize(),l=t?t.height:a,c=r;return[c.x*i,l-(c.y+c.height)*i,c.width*i,c.height*i]}function PT(n,...e){for(const t of e)if(t)for(const r in t)n[r]?Object.assign(n[r],t[r]):n[r]=t[r];return n}class cF extends im{constructor(e,t){super(e,t);const r=e.createTexture({format:"rgba8unorm",width:1,height:1,sampler:{minFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},mipmaps:!0}),i=e.createTexture({format:"depth16unorm",width:1,height:1,mipmaps:!1});this.fbo=e.createFramebuffer({id:"shadowmap",width:1,height:1,colorAttachments:[r],depthStencilAttachment:i})}delete(){this.fbo&&(this.fbo.destroy(),this.fbo=null)}getShadowMap(){return this.fbo.colorAttachments[0].texture}render(e){const t=this.fbo,r=this.device.canvasContext.cssToDeviceRatio(),i=e.viewports[0],a=i.width*r,l=i.height*r,c=[1,1,1,1];(a!==t.width||l!==t.height)&&t.resize({width:a,height:l}),super.render({...e,clearColor:c,target:t,pass:"shadow"})}getLayerParameters(e,t,r){return{...e.props.parameters,blend:!1,depthWriteEnabled:!0,depthCompare:"less-equal"}}shouldDrawLayer(e){return e.props.shadowEnabled!==!1}getShaderModuleProps(e,t,r){return{shadow:{project:r.project,drawToShadowMap:!0}}}}const uF={color:[255,255,255],intensity:1},UT=[{color:[255,255,255],intensity:1,direction:[-1,3,-1]},{color:[255,255,255],intensity:.9,direction:[1,-8,-2.5]}],fF=[0,0,0,200/255];class Tx{constructor(e={}){this.id="lighting-effect",this.shadowColor=fF,this.shadow=!1,this.directionalLights=[],this.pointLights=[],this.shadowPasses=[],this.dummyShadowMap=null,this.setProps(e)}setup(e){this.context=e;const{device:t,deck:r}=e;this.shadow&&!this.dummyShadowMap&&(this._createShadowPasses(t),r._addDefaultShaderModule(kT),this.dummyShadowMap=t.createTexture({width:1,height:1}))}setProps(e){this.ambientLight=void 0,this.directionalLights=[],this.pointLights=[];for(const t in e){const r=e[t];switch(r.type){case"ambient":this.ambientLight=r;break;case"directional":this.directionalLights.push(r);break;case"point":this.pointLights.push(r);break}}this._applyDefaultLights(),this.shadow=this.directionalLights.some(t=>t.shadow),this.context&&this.setup(this.context),this.props=e}preRender({layers:e,layerFilter:t,viewports:r,onViewportActive:i,views:a}){if(this.shadow){this.shadowMatrices=this._calculateMatrices();for(let l=0;l<this.shadowPasses.length;l++)this.shadowPasses[l].render({layers:e,layerFilter:t,viewports:r,onViewportActive:i,views:a,shaderModuleProps:{shadow:{shadowLightId:l,dummyShadowMap:this.dummyShadowMap,shadowMatrices:this.shadowMatrices}}})}}getShaderModuleProps(e,t){const r=this.shadow?{project:t.project,shadowMaps:this.shadowPasses.map(l=>l.getShadowMap()),dummyShadowMap:this.dummyShadowMap,shadowColor:this.shadowColor,shadowMatrices:this.shadowMatrices}:{},i={enabled:!0,ambientLight:this.ambientLight,directionalLights:this.directionalLights.map(l=>l.getProjectedLight({layer:e})),pointLights:this.pointLights.map(l=>l.getProjectedLight({layer:e}))},a=e.props.material;return{shadow:r,lighting:i,phongMaterial:a,gouraudMaterial:a}}cleanup(e){for(const t of this.shadowPasses)t.delete();this.shadowPasses.length=0,this.dummyShadowMap&&(this.dummyShadowMap.destroy(),this.dummyShadowMap=null,e.deck._removeDefaultShaderModule(kT))}_calculateMatrices(){const e=[];for(const t of this.directionalLights){const r=new ir().lookAt({eye:new rr(t.direction).negate()});e.push(r)}return e}_createShadowPasses(e){for(let t=0;t<this.directionalLights.length;t++){const r=new cF(e);this.shadowPasses[t]=r}}_applyDefaultLights(){const{ambientLight:e,pointLights:t,directionalLights:r}=this;!e&&t.length===0&&r.length===0&&(this.ambientLight=new nF(uF),this.directionalLights.push(new DT(UT[0]),new DT(UT[1])))}}class hF{constructor(e={}){this._pool=[],this.opts={overAlloc:2,poolSize:100},this.setOptions(e)}setOptions(e){Object.assign(this.opts,e)}allocate(e,t,{size:r=1,type:i,padding:a=0,copy:l=!1,initialize:c=!1,maxCount:f}){const d=i||e&&e.constructor||Float32Array,p=t*r+a;if(ArrayBuffer.isView(e)){if(p<=e.length)return e;if(p*e.BYTES_PER_ELEMENT<=e.buffer.byteLength)return new d(e.buffer,0,p)}let _=1/0;f&&(_=f*r+a);const y=this._allocate(d,p,c,_);return e&&l?y.set(e):c||y.fill(0,0,4),this._release(e),y}release(e){this._release(e)}_allocate(e,t,r,i){let a=Math.max(Math.ceil(t*this.opts.overAlloc),1);a>i&&(a=i);const l=this._pool,c=e.BYTES_PER_ELEMENT*a,f=l.findIndex(d=>d.byteLength>=c);if(f>=0){const d=new e(l.splice(f,1)[0],0,a);return r&&d.fill(0),d}return new e(a)}_release(e){if(!ArrayBuffer.isView(e))return;const t=this._pool,{buffer:r}=e,{byteLength:i}=r,a=t.findIndex(l=>l.byteLength>=i);a<0?t.push(r):(a>0||t.length<this.opts.poolSize)&&t.splice(a,0,r),t.length>this.opts.poolSize&&t.shift()}}const Al=new hF;function nl(){return[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]}function dF(n){return[n[12],n[13],n[14]]}function pF(n){return{left:ia(n[3]+n[0],n[7]+n[4],n[11]+n[8],n[15]+n[12]),right:ia(n[3]-n[0],n[7]-n[4],n[11]-n[8],n[15]-n[12]),bottom:ia(n[3]+n[1],n[7]+n[5],n[11]+n[9],n[15]+n[13]),top:ia(n[3]-n[1],n[7]-n[5],n[11]-n[9],n[15]-n[13]),near:ia(n[3]+n[2],n[7]+n[6],n[11]+n[10],n[15]+n[14]),far:ia(n[3]-n[2],n[7]-n[6],n[11]-n[10],n[15]-n[14])}}const BT=new rr;function ia(n,e,t,r){BT.set(n,e,t);const i=BT.len();return{distance:r/i,normal:new rr(-n/i,-e/i,-t/i)}}function gF(n){return n-Math.fround(n)}let $o;function qp(n,e){const{size:t=1,startIndex:r=0}=e,i=e.endIndex!==void 0?e.endIndex:n.length,a=(i-r)/t;$o=Al.allocate($o,a,{type:Float32Array,size:t*2});let l=r,c=0;for(;l<i;){for(let f=0;f<t;f++){const d=n[l++];$o[c+f]=d,$o[c+f+t]=gF(d)}c+=t*2}return $o.subarray(0,a*t*2)}function _F(n){let e=null,t=!1;for(const r of n)r&&(e?(t||(e=[[e[0][0],e[0][1]],[e[1][0],e[1][1]]],t=!0),e[0][0]=Math.min(e[0][0],r[0][0]),e[0][1]=Math.min(e[0][1],r[0][1]),e[1][0]=Math.max(e[1][0],r[1][0]),e[1][1]=Math.max(e[1][1],r[1][1])):e=r);return e}const mF=Math.PI/180,yF=nl(),FT=[0,0,0],bF={unitsPerMeter:[1,1,1],metersPerUnit:[1,1,1]};function vF({width:n,height:e,orthographic:t,fovyRadians:r,focalDistance:i,padding:a,near:l,far:c}){const f=n/e,d=t?new ir().orthographic({fovy:r,aspect:f,focalDistance:i,near:l,far:c}):new ir().perspective({fovy:r,aspect:f,near:l,far:c});if(a){const{left:p=0,right:_=0,top:y=0,bottom:b=0}=a,T=hi((p+n-_)/2,0,n)-n/2,A=hi((y+e-b)/2,0,e)-e/2;d[8]-=T*2/n,d[9]+=A*2/e}return d}class Pl{constructor(e={}){this._frustumPlanes={},this.id=e.id||this.constructor.displayName||"viewport",this.x=e.x||0,this.y=e.y||0,this.width=e.width||1,this.height=e.height||1,this.zoom=e.zoom||0,this.padding=e.padding,this.distanceScales=e.distanceScales||bF,this.focalDistance=e.focalDistance||1,this.position=e.position||FT,this.modelMatrix=e.modelMatrix||null;const{longitude:t,latitude:r}=e;this.isGeospatial=Number.isFinite(r)&&Number.isFinite(t),this._initProps(e),this._initMatrices(e),this.equals=this.equals.bind(this),this.project=this.project.bind(this),this.unproject=this.unproject.bind(this),this.projectPosition=this.projectPosition.bind(this),this.unprojectPosition=this.unprojectPosition.bind(this),this.projectFlat=this.projectFlat.bind(this),this.unprojectFlat=this.unprojectFlat.bind(this)}get subViewports(){return null}get metersPerPixel(){return this.distanceScales.metersPerUnit[2]/this.scale}get projectionMode(){return this.isGeospatial?this.zoom<12?An.WEB_MERCATOR:An.WEB_MERCATOR_AUTO_OFFSET:An.IDENTITY}equals(e){return e instanceof Pl?this===e?!0:e.width===this.width&&e.height===this.height&&e.scale===this.scale&&Sl(e.projectionMatrix,this.projectionMatrix)&&Sl(e.viewMatrix,this.viewMatrix):!1}project(e,{topLeft:t=!0}={}){const r=this.projectPosition(e),i=gx(r,this.pixelProjectionMatrix),[a,l]=i,c=t?l:this.height-l;return e.length===2?[a,c]:[a,c,i[2]]}unproject(e,{topLeft:t=!0,targetZ:r}={}){const[i,a,l]=e,c=t?a:this.height-a,f=r&&r*this.distanceScales.unitsPerMeter[2],d=rm([i,c,l],this.pixelUnprojectionMatrix,f),[p,_,y]=this.unprojectPosition(d);return Number.isFinite(l)?[p,_,y]:Number.isFinite(r)?[p,_,r]:[p,_]}projectPosition(e){const[t,r]=this.projectFlat(e),i=(e[2]||0)*this.distanceScales.unitsPerMeter[2];return[t,r,i]}unprojectPosition(e){const[t,r]=this.unprojectFlat(e),i=(e[2]||0)*this.distanceScales.metersPerUnit[2];return[t,r,i]}projectFlat(e){if(this.isGeospatial){const t=Ia(e);return t[1]=hi(t[1],-318,830),t}return e}unprojectFlat(e){return this.isGeospatial?ns(e):e}getBounds(e={}){const t={targetZ:e.z||0},r=this.unproject([0,0],t),i=this.unproject([this.width,0],t),a=this.unproject([0,this.height],t),l=this.unproject([this.width,this.height],t);return[Math.min(r[0],i[0],a[0],l[0]),Math.min(r[1],i[1],a[1],l[1]),Math.max(r[0],i[0],a[0],l[0]),Math.max(r[1],i[1],a[1],l[1])]}getDistanceScales(e){return e&&this.isGeospatial?i_({longitude:e[0],latitude:e[1],highPrecision:!0}):this.distanceScales}containsPixel({x:e,y:t,width:r=1,height:i=1}){return e<this.x+this.width&&this.x<e+r&&t<this.y+this.height&&this.y<t+i}getFrustumPlanes(){return this._frustumPlanes.near?this._frustumPlanes:(Object.assign(this._frustumPlanes,pF(this.viewProjectionMatrix)),this._frustumPlanes)}panByPosition(e,t){return null}_initProps(e){const t=e.longitude,r=e.latitude;this.isGeospatial&&(Number.isFinite(e.zoom)||(this.zoom=E8({latitude:r})+Math.log2(this.focalDistance)),this.distanceScales=e.distanceScales||i_({latitude:r,longitude:t}));const i=Math.pow(2,this.zoom);this.scale=i;const{position:a,modelMatrix:l}=e;let c=FT;if(a&&(c=l?new ir(l).transformAsVector(a,[]):a),this.isGeospatial){const f=this.projectPosition([t,r,0]);this.center=new rr(c).scale(this.distanceScales.unitsPerMeter).add(f)}else this.center=this.projectPosition(c)}_initMatrices(e){const{viewMatrix:t=yF,projectionMatrix:r=null,orthographic:i=!1,fovyRadians:a,fovy:l=75,near:c=.1,far:f=1e3,padding:d=null,focalDistance:p=1}=e;this.viewMatrixUncentered=t,this.viewMatrix=new ir().multiplyRight(t).translate(new rr(this.center).negate()),this.projectionMatrix=r||vF({width:this.width,height:this.height,orthographic:i,fovyRadians:a||l*mF,focalDistance:p,padding:d,near:c,far:f});const _=nl();Wi(_,_,this.projectionMatrix),Wi(_,_,this.viewMatrix),this.viewProjectionMatrix=_,this.viewMatrixInverse=Kg([],this.viewMatrix)||this.viewMatrix,this.cameraPosition=dF(this.viewMatrixInverse);const y=nl(),b=nl();em(y,y,[this.width/2,-this.height/2,1]),ff(y,y,[1,-1,0]),Wi(b,y,this.viewProjectionMatrix),this.pixelProjectionMatrix=b,this.pixelUnprojectionMatrix=Kg(nl(),this.pixelProjectionMatrix),this.pixelUnprojectionMatrix||tt.warn("Pixel project matrix not invertible")()}}Pl.displayName="Viewport";class Na extends Pl{constructor(e={}){const{latitude:t=0,longitude:r=0,zoom:i=0,pitch:a=0,bearing:l=0,nearZMultiplier:c=.1,farZMultiplier:f=1.01,nearZ:d,farZ:p,orthographic:_=!1,projectionMatrix:y,repeat:b=!1,worldOffset:T=0,position:A,padding:C,legacyMeterSizes:N=!1}=e;let{width:O,height:R,altitude:E=1.5}=e;const k=Math.pow(2,i);O=O||1,R=R||1;let V,ne=null;if(y)E=y[5]/2,V=pf(E);else{e.fovy?(V=e.fovy,E=px(V)):V=pf(E);let se;if(C){const{top:re=0,bottom:q=0}=C;se=[0,hi((re+R-q)/2,0,R)-R/2]}ne=C8({width:O,height:R,scale:k,center:A&&[0,0,A[2]*Yp(t)],offset:se,pitch:a,fovy:V,nearZMultiplier:c,farZMultiplier:f}),Number.isFinite(d)&&(ne.near=d),Number.isFinite(p)&&(ne.far=p)}let G=R8({height:R,pitch:a,bearing:l,scale:k,altitude:E});T&&(G=new ir().translate([512*T,0,0]).multiplyLeft(G)),super({...e,width:O,height:R,viewMatrix:G,longitude:r,latitude:t,zoom:i,...ne,fovy:V,focalDistance:E}),this.latitude=t,this.longitude=r,this.zoom=i,this.pitch=a,this.bearing=l,this.altitude=E,this.fovy=V,this.orthographic=_,this._subViewports=b?[]:null,this._pseudoMeters=N,Object.freeze(this)}get subViewports(){if(this._subViewports&&!this._subViewports.length){const e=this.getBounds(),t=Math.floor((e[0]+180)/360),r=Math.ceil((e[2]-180)/360);for(let i=t;i<=r;i++){const a=i?new Na({...this,worldOffset:i}):this;this._subViewports.push(a)}}return this._subViewports}projectPosition(e){if(this._pseudoMeters)return super.projectPosition(e);const[t,r]=this.projectFlat(e),i=(e[2]||0)*Yp(e[1]);return[t,r,i]}unprojectPosition(e){if(this._pseudoMeters)return super.unprojectPosition(e);const[t,r]=this.unprojectFlat(e),i=(e[2]||0)/Yp(r);return[t,r,i]}addMetersToLngLat(e,t){return dx(e,t)}panByPosition(e,t){const r=rm(t,this.pixelUnprojectionMatrix),i=this.projectFlat(e),a=qg([],i,lU([],r)),l=qg([],this.center,a),[c,f]=this.unprojectFlat(l);return{longitude:c,latitude:f}}getBounds(e={}){const t=I8(this,e.z||0);return[Math.min(t[0][0],t[1][0],t[2][0],t[3][0]),Math.min(t[0][1],t[1][1],t[2][1],t[3][1]),Math.max(t[0][0],t[1][0],t[2][0],t[3][0]),Math.max(t[0][1],t[1][1],t[2][1],t[3][1])]}fitBounds(e,t={}){const{width:r,height:i}=this,{longitude:a,latitude:l,zoom:c}=M8({width:r,height:i,bounds:e,...t});return new Na({width:r,height:i,longitude:a,latitude:l,zoom:c})}}Na.displayName="WebMercatorViewport";const LT=[0,0,0];function Kp(n,e,t=!1){const r=e.projectPosition(n);if(t&&e instanceof Na){const[i,a,l=0]=n,c=e.getDistanceScales([i,a]);r[2]=l*c.unitsPerMeter[2]}return r}function TF(n){const{viewport:e,modelMatrix:t,coordinateOrigin:r}=n;let{coordinateSystem:i,fromCoordinateSystem:a,fromCoordinateOrigin:l}=n;return i===Ve.DEFAULT&&(i=e.isGeospatial?Ve.LNGLAT:Ve.CARTESIAN),a===void 0&&(a=i),l===void 0&&(l=r),{viewport:e,coordinateSystem:i,coordinateOrigin:r,modelMatrix:t,fromCoordinateSystem:a,fromCoordinateOrigin:l}}function wx(n,{viewport:e,modelMatrix:t,coordinateSystem:r,coordinateOrigin:i,offsetMode:a}){let[l,c,f=0]=n;switch(t&&([l,c,f]=kl([],[l,c,f,1],t)),r){case Ve.LNGLAT:return Kp([l,c,f],e,a);case Ve.LNGLAT_OFFSETS:return Kp([l+i[0],c+i[1],f+(i[2]||0)],e,a);case Ve.METER_OFFSETS:return Kp(dx(i,[l,c,f]),e,a);case Ve.CARTESIAN:default:return e.isGeospatial?[l+i[0],c+i[1],f+i[2]]:e.projectPosition([l,c,f])}}function wF(n,e){const{viewport:t,coordinateSystem:r,coordinateOrigin:i,modelMatrix:a,fromCoordinateSystem:l,fromCoordinateOrigin:c}=TF(e),{autoOffset:f=!0}=e,{geospatialOrigin:d=LT,shaderCoordinateOrigin:p=LT,offsetMode:_=!1}=f?ux(t,r,i):{},y=wx(n,{viewport:t,modelMatrix:a,coordinateSystem:l,coordinateOrigin:c,offsetMode:_});if(_){const b=t.projectPosition(d||p);SU(y,y,b)}return y}let xF=1,SF=1;class xx{constructor(){w(this,"time",0);w(this,"channels",new Map);w(this,"animations",new Map);w(this,"playing",!1);w(this,"lastEngineTime",-1)}addChannel(e){const{delay:t=0,duration:r=Number.POSITIVE_INFINITY,rate:i=1,repeat:a=1}=e,l=xF++,c={time:0,delay:t,duration:r,rate:i,repeat:a};return this._setChannelTime(c,this.time),this.channels.set(l,c),l}removeChannel(e){this.channels.delete(e);for(const[t,r]of this.animations)r.channel===e&&this.detachAnimation(t)}isFinished(e){const t=this.channels.get(e);return t===void 0?!1:this.time>=t.delay+t.duration*t.repeat}getTime(e){if(e===void 0)return this.time;const t=this.channels.get(e);return t===void 0?-1:t.time}setTime(e){this.time=Math.max(0,e);const t=this.channels.values();for(const i of t)this._setChannelTime(i,this.time);const r=this.animations.values();for(const i of r){const{animation:a,channel:l}=i;a.setTime(this.getTime(l))}}play(){this.playing=!0}pause(){this.playing=!1,this.lastEngineTime=-1}reset(){this.setTime(0)}attachAnimation(e,t){const r=SF++;return this.animations.set(r,{animation:e,channel:t}),e.setTime(this.getTime(t)),r}detachAnimation(e){this.animations.delete(e)}update(e){this.playing&&(this.lastEngineTime===-1&&(this.lastEngineTime=e),this.setTime(this.time+(e-this.lastEngineTime)),this.lastEngineTime=e)}_setChannelTime(e,t){const r=t-e.delay,i=e.duration*e.repeat;r>=i?e.time=e.duration*e.rate:(e.time=Math.max(0,r)%e.duration,e.time*=e.rate)}}function AF(n){return typeof window<"u"&&window.requestAnimationFrame?window.requestAnimationFrame(n):setTimeout(n,1e3/60)}function EF(n){return typeof window<"u"&&window.cancelAnimationFrame?window.cancelAnimationFrame(n):clearTimeout(n)}let RF=0;const CF={device:null,onAddHTML:()=>"",onInitialize:async()=>null,onRender:()=>{},onFinalize:()=>{},onError:n=>console.error(n),stats:Fg.stats.get(`animation-loop-${RF++}`),useDevicePixels:!0,autoResizeViewport:!1,autoResizeDrawingBuffer:!1};class MF{constructor(e){w(this,"device",null);w(this,"canvas",null);w(this,"props");w(this,"animationProps",null);w(this,"timeline",null);w(this,"stats");w(this,"cpuTime");w(this,"gpuTime");w(this,"frameRate");w(this,"display");w(this,"needsRedraw","initialized");w(this,"_initialized",!1);w(this,"_running",!1);w(this,"_animationFrameId",null);w(this,"_nextFramePromise",null);w(this,"_resolveNextFrame",null);w(this,"_cpuStartTime",0);w(this,"_error",null);if(this.props={...CF,...e},e=this.props,!e.device)throw new Error("No device provided");const{useDevicePixels:t=!0}=this.props;this.stats=e.stats||new Ff({id:"animation-loop-stats"}),this.cpuTime=this.stats.get("CPU Time"),this.gpuTime=this.stats.get("GPU Time"),this.frameRate=this.stats.get("Frame Rate"),this.setProps({autoResizeViewport:e.autoResizeViewport,autoResizeDrawingBuffer:e.autoResizeDrawingBuffer,useDevicePixels:t}),this.start=this.start.bind(this),this.stop=this.stop.bind(this),this._onMousemove=this._onMousemove.bind(this),this._onMouseleave=this._onMouseleave.bind(this)}destroy(){this.stop(),this._setDisplay(null)}delete(){this.destroy()}setError(e){var r,i;if(this.props.onError(e),this._error=Error(),((i=(r=this.device)==null?void 0:r.canvasContext)==null?void 0:i.canvas)instanceof HTMLCanvasElement){const a=document.createElement("h1");a.innerHTML=e.message,a.style.position="absolute",a.style.top="20%",a.style.left="10px",a.style.color="black",a.style.backgroundColor="red",document.body.appendChild(a)}}setNeedsRedraw(e){return this.needsRedraw=this.needsRedraw||e,this}setProps(e){return"autoResizeViewport"in e&&(this.props.autoResizeViewport=e.autoResizeViewport||!1),"autoResizeDrawingBuffer"in e&&(this.props.autoResizeDrawingBuffer=e.autoResizeDrawingBuffer||!1),"useDevicePixels"in e&&(this.props.useDevicePixels=e.useDevicePixels||!1),this}async start(){if(this._running)return this;this._running=!0;try{let e;return this._initialized||(this._initialized=!0,await this._initDevice(),this._initialize(),await this.props.onInitialize(this._getAnimationProps())),this._running?(e!==!1&&(this._cancelAnimationFrame(),this._requestAnimationFrame()),this):null}catch(e){const t=e instanceof Error?e:new Error("Unknown error");throw this.props.onError(t),t}}stop(){return this._running&&(this.animationProps&&!this._error&&this.props.onFinalize(this.animationProps),this._cancelAnimationFrame(),this._nextFramePromise=null,this._resolveNextFrame=null,this._running=!1),this}redraw(){var e;return(e=this.device)!=null&&e.isLost||this._error?this:(this._beginFrameTimers(),this._setupFrame(),this._updateAnimationProps(),this._renderFrame(this._getAnimationProps()),this._clearNeedsRedraw(),this._resolveNextFrame&&(this._resolveNextFrame(this),this._nextFramePromise=null,this._resolveNextFrame=null),this._endFrameTimers(),this)}attachTimeline(e){return this.timeline=e,this.timeline}detachTimeline(){this.timeline=null}waitForRender(){return this.setNeedsRedraw("waitForRender"),this._nextFramePromise||(this._nextFramePromise=new Promise(e=>{this._resolveNextFrame=e})),this._nextFramePromise}async toDataURL(){if(this.setNeedsRedraw("toDataURL"),await this.waitForRender(),this.canvas instanceof HTMLCanvasElement)return this.canvas.toDataURL();throw new Error("OffscreenCanvas")}_initialize(){this._startEventHandling(),this._initializeAnimationProps(),this._updateAnimationProps(),this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_setDisplay(e){this.display&&(this.display.destroy(),this.display.animationLoop=null),e&&(e.animationLoop=this),this.display=e}_requestAnimationFrame(){this._running&&(this._animationFrameId=AF(this._animationFrame.bind(this)))}_cancelAnimationFrame(){this._animationFrameId!==null&&(EF(this._animationFrameId),this._animationFrameId=null)}_animationFrame(){this._running&&(this.redraw(),this._requestAnimationFrame())}_renderFrame(e){var t;if(this.display){this.display._renderFrame(e);return}this.props.onRender(this._getAnimationProps()),(t=this.device)==null||t.submit()}_clearNeedsRedraw(){this.needsRedraw=!1}_setupFrame(){this._resizeCanvasDrawingBuffer(),this._resizeViewport()}_initializeAnimationProps(){var t,r;const e=(r=(t=this.device)==null?void 0:t.canvasContext)==null?void 0:r.canvas;if(!this.device||!e)throw new Error("loop");this.animationProps={animationLoop:this,device:this.device,canvas:e,timeline:this.timeline,useDevicePixels:this.props.useDevicePixels,needsRedraw:!1,width:1,height:1,aspect:1,time:0,startTime:Date.now(),engineTime:0,tick:0,tock:0,_mousePosition:null}}_getAnimationProps(){if(!this.animationProps)throw new Error("animationProps");return this.animationProps}_updateAnimationProps(){if(!this.animationProps)return;const{width:e,height:t,aspect:r}=this._getSizeAndAspect();(e!==this.animationProps.width||t!==this.animationProps.height)&&this.setNeedsRedraw("drawing buffer resized"),r!==this.animationProps.aspect&&this.setNeedsRedraw("drawing buffer aspect changed"),this.animationProps.width=e,this.animationProps.height=t,this.animationProps.aspect=r,this.animationProps.needsRedraw=this.needsRedraw,this.animationProps.engineTime=Date.now()-this.animationProps.startTime,this.timeline&&this.timeline.update(this.animationProps.engineTime),this.animationProps.tick=Math.floor(this.animationProps.time/1e3*60),this.animationProps.tock++,this.animationProps.time=this.timeline?this.timeline.getTime():this.animationProps.engineTime}async _initDevice(){var e;if(this.device=await this.props.device,!this.device)throw new Error("No device provided");this.canvas=((e=this.device.canvasContext)==null?void 0:e.canvas)||null}_createInfoDiv(){if(this.canvas&&this.props.onAddHTML){const e=document.createElement("div");document.body.appendChild(e),e.style.position="relative";const t=document.createElement("div");t.style.position="absolute",t.style.left="10px",t.style.bottom="10px",t.style.width="300px",t.style.background="white",this.canvas instanceof HTMLCanvasElement&&e.appendChild(this.canvas),e.appendChild(t);const r=this.props.onAddHTML(t);r&&(t.innerHTML=r)}}_getSizeAndAspect(){var a,l,c,f;if(!this.device)return{width:1,height:1,aspect:1};const[e,t]=((l=(a=this.device)==null?void 0:a.canvasContext)==null?void 0:l.getPixelSize())||[1,1];let r=1;const i=(f=(c=this.device)==null?void 0:c.canvasContext)==null?void 0:f.canvas;return i&&i.clientHeight?r=i.clientWidth/i.clientHeight:e>0&&t>0&&(r=e/t),{width:e,height:t,aspect:r}}_resizeViewport(){this.props.autoResizeViewport&&this.device.gl&&this.device.gl.viewport(0,0,this.device.gl.drawingBufferWidth,this.device.gl.drawingBufferHeight)}_resizeCanvasDrawingBuffer(){var e,t;this.props.autoResizeDrawingBuffer&&((t=(e=this.device)==null?void 0:e.canvasContext)==null||t.resize({useDevicePixels:this.props.useDevicePixels}))}_beginFrameTimers(){this.frameRate.timeEnd(),this.frameRate.timeStart(),this.cpuTime.timeStart()}_endFrameTimers(){this.cpuTime.timeEnd()}_startEventHandling(){this.canvas&&(this.canvas.addEventListener("mousemove",this._onMousemove.bind(this)),this.canvas.addEventListener("mouseleave",this._onMouseleave.bind(this)))}_onMousemove(e){e instanceof MouseEvent&&(this._getAnimationProps()._mousePosition=[e.offsetX,e.offsetY])}_onMouseleave(e){this._getAnimationProps()._mousePosition=null}}const Zp={};function Hf(n="id"){Zp[n]=Zp[n]||1;const e=Zp[n]++;return`${n}-${e}`}class zT{constructor(e){w(this,"id");w(this,"userData",{});w(this,"topology");w(this,"bufferLayout",[]);w(this,"vertexCount");w(this,"indices");w(this,"attributes");if(this.id=e.id||Hf("geometry"),this.topology=e.topology,this.indices=e.indices||null,this.attributes=e.attributes,this.vertexCount=e.vertexCount,this.bufferLayout=e.bufferLayout||[],this.indices&&!(this.indices.usage&rt.INDEX))throw new Error("Index buffer must have INDEX usage")}destroy(){var e;(e=this.indices)==null||e.destroy();for(const t of Object.values(this.attributes))t.destroy()}getVertexCount(){return this.vertexCount}getAttributes(){return this.attributes}getIndexes(){return this.indices||null}_calculateVertexCount(e){return e.byteLength/12}}function OF(n,e){if(e instanceof zT)return e;const t=IF(n,e),{attributes:r,bufferLayout:i}=NF(n,e);return new zT({topology:e.topology||"triangle-list",bufferLayout:i,vertexCount:e.vertexCount,indices:t,attributes:r})}function IF(n,e){if(!e.indices)return;const t=e.indices.value;return n.createBuffer({usage:rt.INDEX,data:t})}function NF(n,e){const t=[],r={};for(const[a,l]of Object.entries(e.attributes)){let c=a;switch(a){case"POSITION":c="positions";break;case"NORMAL":c="normals";break;case"TEXCOORD_0":c="texCoords";break;case"COLOR_0":c="colors";break}if(l){r[c]=n.createBuffer({data:l.value,id:`${a}-buffer`});const{value:f,size:d,normalized:p}=l;t.push({name:c,format:b6(f,d,p)})}}const i=e._calculateVertexCount(e.attributes,e.indices);return{attributes:r,bufferLayout:t,vertexCount:i}}const If=class If{constructor(e){w(this,"device");w(this,"destroyPolicy");w(this,"_hashCounter",0);w(this,"_hashes",{});w(this,"_renderPipelineCache",{});w(this,"_computePipelineCache",{});this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}static getDefaultPipelineFactory(e){return e._lumaData.defaultPipelineFactory=e._lumaData.defaultPipelineFactory||new If(e),e._lumaData.defaultPipelineFactory}createRenderPipeline(e){const t={...Aa.defaultProps,...e},r=this._hashRenderPipeline(t);if(!this._renderPipelineCache[r]){const i=this.device.createRenderPipeline({...t,id:t.id?`${t.id}-cached`:void 0});i.hash=r,this._renderPipelineCache[r]={pipeline:i,useCount:0}}return this._renderPipelineCache[r].useCount++,this._renderPipelineCache[r].pipeline}createComputePipeline(e){const t={...rf.defaultProps,...e},r=this._hashComputePipeline(t);if(!this._computePipelineCache[r]){const i=this.device.createComputePipeline({...t,id:t.id?`${t.id}-cached`:void 0});i.hash=r,this._computePipelineCache[r]={pipeline:i,useCount:0}}return this._computePipelineCache[r].useCount++,this._computePipelineCache[r].pipeline}release(e){const t=e.hash,r=e instanceof rf?this._computePipelineCache:this._renderPipelineCache;r[t].useCount--,r[t].useCount===0&&this.destroyPolicy==="unused"&&(r[t].pipeline.destroy(),delete r[t])}_hashComputePipeline(e){return`${this._getHash(e.shader.source)}`}_hashRenderPipeline(e){const t=e.vs?this._getHash(e.vs.source):0,r=e.fs?this._getHash(e.fs.source):0,i="-",a=this._getHash(JSON.stringify(e.bufferLayout));switch(this.device.type){case"webgl":return`${t}/${r}V${i}BL${a}`;default:const l=this._getHash(JSON.stringify(e.parameters));return`${t}/${r}V${i}T${e.topology}P${l}BL${a}`}}_getHash(e){return this._hashes[e]===void 0&&(this._hashes[e]=this._hashCounter++),this._hashes[e]}};w(If,"defaultProps",{...Aa.defaultProps});let s_=If;const Nf=class Nf{constructor(e){w(this,"device");w(this,"destroyPolicy");w(this,"_cache",{});this.device=e,this.destroyPolicy=e.props._factoryDestroyPolicy}static getDefaultShaderFactory(e){var t;return(t=e._lumaData).defaultShaderFactory||(t.defaultShaderFactory=new Nf(e)),e._lumaData.defaultShaderFactory}createShader(e){const t=this._hashShader(e);let r=this._cache[t];if(!r){const i=this.device.createShader({...e,id:e.id?`${e.id}-cached`:void 0});this._cache[t]=r={shader:i,useCount:0}}return r.useCount++,r.shader}release(e){const t=this._hashShader(e),r=this._cache[t];r&&(r.useCount--,r.useCount===0&&this.destroyPolicy==="unused"&&(delete this._cache[t],r.shader.destroy()))}_hashShader(e){return`${e.stage}:${e.source}`}};w(Nf,"defaultProps",{...ef.defaultProps});let a_=Nf;function kF(n,e){var i;const t={},r="Values";if(n.attributes.length===0&&!((i=n.varyings)!=null&&i.length))return{"No attributes or varyings":{[r]:"N/A"}};for(const a of n.attributes)if(a){const l=`${a.location} ${a.name}: ${a.type}`;t[`in ${l}`]={[r]:a.stepMode||"vertex"}}for(const a of n.varyings||[]){const l=`${a.location} ${a.name}`;t[`out ${l}`]={[r]:JSON.stringify(a)}}return t}let Ct=null,Ui=null;function DF(n,{id:e,minimap:t,opaque:r,top:i="0",left:a="0",rgbaScale:l=1}){Ct||(Ct=document.createElement("canvas"),Ct.id=e,Ct.title=e,Ct.style.zIndex="100",Ct.style.position="absolute",Ct.style.top=i,Ct.style.left=a,Ct.style.border="blue 5px solid",Ct.style.transform="scaleY(-1)",document.body.appendChild(Ct),Ui=Ct.getContext("2d")),(Ct.width!==n.width||Ct.height!==n.height)&&(Ct.width=n.width/2,Ct.height=n.height/2,Ct.style.width="400px",Ct.style.height="400px");const c=n.device.readPixelsToArrayWebGL(n),f=Ui==null?void 0:Ui.createImageData(n.width,n.height);if(f){for(let p=0;p<c.length;p+=4)f.data[0+p+0]=c[p+0]*l,f.data[0+p+1]=c[p+1]*l,f.data[0+p+2]=c[p+2]*l,f.data[0+p+3]=r?255:c[p+3]*l;Ui==null||Ui.putImageData(f,0,0)}}function o_(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!o_(n[r],e[r],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r)if(!e.hasOwnProperty(a)||!o_(n[a],e[a],t-1))return!1;return!0}return!1}function PF(n){return ArrayBuffer.isView(n)&&!(n instanceof DataView)}function UF(n){return Array.isArray(n)?n.length===0||typeof n[0]=="number":!1}function Sx(n){return PF(n)||UF(n)}function BF(n){return Sx(n)||typeof n=="number"||typeof n=="boolean"}function Ax(n){const e={bindings:{},uniforms:{}};return Object.keys(n).forEach(t=>{const r=n[t];BF(r)?e.uniforms[t]=r:e.bindings[t]=r}),e}class FF{constructor(e,t){w(this,"options",{disableWarnings:!1});w(this,"modules");w(this,"moduleUniforms");w(this,"moduleBindings");Object.assign(this.options,t);const r=$_(Object.values(e).filter(i=>i.dependencies));for(const i of r)e[i.name]=i;le.log(1,"Creating ShaderInputs with modules",Object.keys(e))(),this.modules=e,this.moduleUniforms={},this.moduleBindings={};for(const[i,a]of Object.entries(e))this._addModule(a),a.name&&i!==a.name&&!this.options.disableWarnings&&le.warn(`Module name: ${i} vs ${a.name}`)()}destroy(){}setProps(e){var t;for(const r of Object.keys(e)){const i=r,a=e[i]||{},l=this.modules[i];if(!l){this.options.disableWarnings||le.warn(`Module ${r} not found`)();continue}const c=this.moduleUniforms[i],f=this.moduleBindings[i],d=((t=l.getUniforms)==null?void 0:t.call(l,a,c))||a,{uniforms:p,bindings:_}=Ax(d);this.moduleUniforms[i]={...c,...p},this.moduleBindings[i]={...f,..._}}}getModules(){return Object.values(this.modules)}getUniformValues(){return this.moduleUniforms}getBindingValues(){const e={};for(const t of Object.values(this.moduleBindings))Object.assign(e,t);return e}getDebugTable(){var t;const e={};for(const[r,i]of Object.entries(this.moduleUniforms))for(const[a,l]of Object.entries(i))e[`${r}.${a}`]={type:(t=this.modules[r].uniformTypes)==null?void 0:t[a],value:String(l)};return e}_addModule(e){const t=e.name;this.moduleUniforms[t]=e.defaultUniforms||{},this.moduleBindings[t]={}}}let LF="";async function zF(n,e){const t=new Image;return t.crossOrigin="anonymous",t.src=n.startsWith("http")?n:LF+n,await t.decode(),e?await createImageBitmap(t,e):await createImageBitmap(t)}class Qp{constructor(e,t){w(this,"device");w(this,"id");w(this,"texture");w(this,"sampler");w(this,"view");w(this,"ready");w(this,"isReady",!1);w(this,"destroyed",!1);w(this,"resolveReady",()=>{});w(this,"rejectReady",()=>{});this.device=e,this.id=t.id||Hf("async-texture"),typeof(t==null?void 0:t.data)=="string"&&t.dimension==="2d"&&(t={...t,data:zF(t.data)}),this.ready=new Promise((r,i)=>{this.resolveReady=()=>{this.isReady=!0,r()},this.rejectReady=i}),this.initAsync(t)}get[Symbol.toStringTag](){return"AsyncTexture"}toString(){return`AsyncTexture:"${this.id}"(${this.isReady?"ready":"loading"})`}async initAsync(e){const t=e.data;let r;try{r=await Ex(t)}catch(a){this.rejectReady(a)}if(this.destroyed)return;const i={...e,data:r};this.texture=this.device.createTexture(i),this.sampler=this.texture.sampler,this.view=this.texture.view,this.isReady=!0,this.resolveReady()}destroy(){this.texture&&(this.texture.destroy(),this.texture=null),this.destroyed=!0}resize(e){if(!this.isReady)throw new Error("Cannot resize texture before it is ready");if(e.width===this.texture.width&&e.height===this.texture.height)return!1;if(this.texture){const t=this.texture;this.texture=t.clone(e),t.destroy()}return!0}}async function Ex(n){if(n=await n,Array.isArray(n))return await Promise.all(n.map(Ex));if(n&&typeof n=="object"&&n.constructor===Object){const e=n,t=await Promise.all(Object.values(e)),r=Object.keys(e),i={};for(let a=0;a<r.length;a++)i[r[a]]=t[a];return i}return n}const Bi=2,VF=1e4,kf=class kf{constructor(e,t){w(this,"device");w(this,"id");w(this,"source");w(this,"vs");w(this,"fs");w(this,"pipelineFactory");w(this,"shaderFactory");w(this,"userData",{});w(this,"parameters");w(this,"topology");w(this,"bufferLayout");w(this,"isInstanced");w(this,"instanceCount",0);w(this,"vertexCount");w(this,"indexBuffer",null);w(this,"bufferAttributes",{});w(this,"constantAttributes",{});w(this,"bindings",{});w(this,"uniforms",{});w(this,"vertexArray");w(this,"transformFeedback",null);w(this,"pipeline");w(this,"shaderInputs");w(this,"_uniformStore");w(this,"_attributeInfos",{});w(this,"_gpuGeometry",null);w(this,"_getModuleUniforms");w(this,"props");w(this,"_pipelineNeedsUpdate","newly created");w(this,"_needsRedraw","initializing");w(this,"_destroyed",!1);w(this,"_lastDrawTimestamp",-1);w(this,"_lastLogTime",0);w(this,"_logOpen",!1);w(this,"_drawCount",0);var f,d,p,_;this.props={...kf.defaultProps,...t},t=this.props,this.id=t.id||Hf("model"),this.device=e,Object.assign(this.userData,t.userData);const r=Object.fromEntries(((f=this.props.modules)==null?void 0:f.map(y=>[y.name,y]))||[]),i=t.shaderInputs||new FF(r,{disableWarnings:this.props.disableWarnings});this.setShaderInputs(i);const a=jF(e),l=(((d=this.props.modules)==null?void 0:d.length)>0?this.props.modules:(p=this.shaderInputs)==null?void 0:p.getModules())||[];if(this.device.type==="webgpu"&&this.props.source){const{source:y,getUniforms:b}=this.props.shaderAssembler.assembleWGSLShader({platformInfo:a,...this.props,modules:l});this.source=y,this._getModuleUniforms=b,(_=this.props).shaderLayout||(_.shaderLayout=K6(this.source))}else{const{vs:y,fs:b,getUniforms:T}=this.props.shaderAssembler.assembleGLSLShaderPair({platformInfo:a,...this.props,modules:l});this.vs=y,this.fs=b,this._getModuleUniforms=T}this.vertexCount=this.props.vertexCount,this.instanceCount=this.props.instanceCount,this.topology=this.props.topology,this.bufferLayout=this.props.bufferLayout,this.parameters=this.props.parameters,t.geometry&&this.setGeometry(t.geometry),this.pipelineFactory=t.pipelineFactory||s_.getDefaultPipelineFactory(this.device),this.shaderFactory=t.shaderFactory||a_.getDefaultShaderFactory(this.device),this.pipeline=this._updatePipeline(),this.vertexArray=e.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry),"isInstanced"in t&&(this.isInstanced=t.isInstanced),t.instanceCount&&this.setInstanceCount(t.instanceCount),t.vertexCount&&this.setVertexCount(t.vertexCount),t.indexBuffer&&this.setIndexBuffer(t.indexBuffer),t.attributes&&this.setAttributes(t.attributes),t.constantAttributes&&this.setConstantAttributes(t.constantAttributes),t.bindings&&this.setBindings(t.bindings),t.uniforms&&this.setUniformsWebGL(t.uniforms),t.moduleSettings&&this.updateModuleSettingsWebGL(t.moduleSettings),t.transformFeedback&&(this.transformFeedback=t.transformFeedback),Object.seal(this)}get[Symbol.toStringTag](){return"Model"}toString(){return`Model(${this.id})`}destroy(){var e;this._destroyed||(this.pipelineFactory.release(this.pipeline),this.shaderFactory.release(this.pipeline.vs),this.pipeline.fs&&this.shaderFactory.release(this.pipeline.fs),this._uniformStore.destroy(),(e=this._gpuGeometry)==null||e.destroy(),this._destroyed=!0)}needsRedraw(){this._getBindingsUpdateTimestamp()>this._lastDrawTimestamp&&this.setNeedsRedraw("contents of bound textures or buffers updated");const e=this._needsRedraw;return this._needsRedraw=!1,e}setNeedsRedraw(e){this._needsRedraw||(this._needsRedraw=e)}predraw(){this.updateShaderInputs(),this.pipeline=this._updatePipeline()}draw(e){const t=this._areBindingsLoading();if(t)return le.info(Bi,`>>> DRAWING ABORTED ${this.id}: ${t} not loaded`)(),!1;try{e.pushDebugGroup(`${this}.predraw(${e})`),this.predraw()}finally{e.popDebugGroup()}let r;try{e.pushDebugGroup(`${this}.draw(${e})`),this._logDrawCallStart(),this.pipeline=this._updatePipeline();const i=this._getBindings();this.pipeline.setBindings(i,{disableWarnings:this.props.disableWarnings}),l_(this.uniforms)||this.pipeline.setUniformsWebGL(this.uniforms);const{indexBuffer:a}=this.vertexArray,l=a?a.byteLength/(a.indexType==="uint32"?4:2):void 0;r=this.pipeline.draw({renderPass:e,vertexArray:this.vertexArray,isInstanced:this.isInstanced,vertexCount:this.vertexCount,instanceCount:this.instanceCount,indexCount:l,transformFeedback:this.transformFeedback||void 0,parameters:this.parameters,topology:this.topology})}finally{e.popDebugGroup(),this._logDrawCallEnd()}return this._logFramebuffer(e),r?(this._lastDrawTimestamp=this.device.timestamp,this._needsRedraw=!1):this._needsRedraw="waiting for resource initialization",r}setGeometry(e){var r;(r=this._gpuGeometry)==null||r.destroy();const t=e&&OF(this.device,e);if(t){this.setTopology(t.topology||"triangle-list");const i=new Bp(this.bufferLayout);this.bufferLayout=i.mergeBufferLayouts(t.bufferLayout,this.bufferLayout),this.vertexArray&&this._setGeometryAttributes(t)}this._gpuGeometry=t}setTopology(e){e!==this.topology&&(this.topology=e,this._setPipelineNeedsUpdate("topology"))}setBufferLayout(e){const t=new Bp(this.bufferLayout);this.bufferLayout=this._gpuGeometry?t.mergeBufferLayouts(e,this._gpuGeometry.bufferLayout):e,this._setPipelineNeedsUpdate("bufferLayout"),this.pipeline=this._updatePipeline(),this.vertexArray=this.device.createVertexArray({renderPipeline:this.pipeline}),this._gpuGeometry&&this._setGeometryAttributes(this._gpuGeometry)}setParameters(e){o_(e,this.parameters,2)||(this.parameters=e,this._setPipelineNeedsUpdate("parameters"))}setInstanceCount(e){this.instanceCount=e,this.isInstanced===void 0&&e>0&&(this.isInstanced=!0),this.setNeedsRedraw("instanceCount")}setVertexCount(e){this.vertexCount=e,this.setNeedsRedraw("vertexCount")}setShaderInputs(e){this.shaderInputs=e,this._uniformStore=new y6(this.shaderInputs.modules);for(const[t,r]of Object.entries(this.shaderInputs.modules))if(HF(r)){const i=this._uniformStore.getManagedUniformBuffer(this.device,t);this.bindings[`${t}Uniforms`]=i}this.setNeedsRedraw("shaderInputs")}updateShaderInputs(){this._uniformStore.setUniforms(this.shaderInputs.getUniformValues()),this.setBindings(this.shaderInputs.getBindingValues()),this.setNeedsRedraw("shaderInputs")}setBindings(e){Object.assign(this.bindings,e),this.setNeedsRedraw("bindings")}setTransformFeedback(e){this.transformFeedback=e,this.setNeedsRedraw("transformFeedback")}setIndexBuffer(e){this.vertexArray.setIndexBuffer(e),this.setNeedsRedraw("indexBuffer")}setAttributes(e,t){const r=(t==null?void 0:t.disableWarnings)??this.props.disableWarnings;e.indices&&le.warn(`Model:${this.id} setAttributes() - indexBuffer should be set using setIndexBuffer()`)(),this.bufferLayout=v6(this.pipeline.shaderLayout,this.bufferLayout);const i=new Bp(this.bufferLayout);for(const[a,l]of Object.entries(e)){const c=i.getBufferLayout(a);if(!c){r||le.warn(`Model(${this.id}): Missing layout for buffer "${a}".`)();continue}const f=i.getAttributeNamesForBuffer(c);let d=!1;for(const p of f){const _=this._attributeInfos[p];if(_){const y=this.device.type==="webgpu"?i.getBufferIndex(_.bufferName):_.location;this.vertexArray.setBuffer(y,l),d=!0}}!d&&!r&&le.warn(`Model(${this.id}): Ignoring buffer "${l.id}" for unknown attribute "${a}"`)()}this.setNeedsRedraw("attributes")}setConstantAttributes(e,t){for(const[r,i]of Object.entries(e)){const a=this._attributeInfos[r];a?this.vertexArray.setConstantWebGL(a.location,i):((t==null?void 0:t.disableWarnings)??this.props.disableWarnings)||le.warn(`Model "${this.id}: Ignoring constant supplied for unknown attribute "${r}"`)()}this.setNeedsRedraw("constants")}setUniforms(e){this.setUniformsWebGL(e)}setUniformsWebGL(e){l_(e)||(this.pipeline.setUniformsWebGL(e),Object.assign(this.uniforms,e)),this.setNeedsRedraw("uniforms")}updateModuleSettingsWebGL(e){const{bindings:t,uniforms:r}=Ax(this._getModuleUniforms(e));Object.assign(this.bindings,t),Object.assign(this.uniforms,r),this.setNeedsRedraw("moduleSettings")}_areBindingsLoading(){for(const e of Object.values(this.bindings))if(e instanceof Qp&&!e.isReady)return e.id;return!1}_getBindings(){const e={};for(const[t,r]of Object.entries(this.bindings))r instanceof Qp?r.isReady&&(e[t]=r.texture):e[t]=r;return e}_getBindingsUpdateTimestamp(){let e=0;for(const t of Object.values(this.bindings))t instanceof Ju?e=Math.max(e,t.texture.updateTimestamp):t instanceof rt||t instanceof ct?e=Math.max(e,t.updateTimestamp):t instanceof Qp?e=t.texture?Math.max(e,t.texture.updateTimestamp):1/0:t instanceof tf||(e=Math.max(e,t.buffer.updateTimestamp));return e}_setGeometryAttributes(e){const t={...e.attributes};for(const[r]of Object.entries(t))!this.pipeline.shaderLayout.attributes.find(i=>i.name===r)&&r!=="positions"&&delete t[r];this.vertexCount=e.vertexCount,this.setIndexBuffer(e.indices||null),this.setAttributes(e.attributes,{disableWarnings:!0}),this.setAttributes(t,{disableWarnings:this.props.disableWarnings}),this.setNeedsRedraw("geometry attributes")}_setPipelineNeedsUpdate(e){this._pipelineNeedsUpdate||(this._pipelineNeedsUpdate=e),this.setNeedsRedraw(e)}_updatePipeline(){if(this._pipelineNeedsUpdate){let e=null,t=null;this.pipeline&&(le.log(1,`Model ${this.id}: Recreating pipeline because "${this._pipelineNeedsUpdate}".`)(),e=this.pipeline.vs,t=this.pipeline.fs),this._pipelineNeedsUpdate=!1;const r=this.shaderFactory.createShader({id:`${this.id}-vertex`,stage:"vertex",source:this.source||this.vs,debugShaders:this.props.debugShaders});let i=null;this.source?i=r:this.fs&&(i=this.shaderFactory.createShader({id:`${this.id}-fragment`,stage:"fragment",source:this.source||this.fs,debugShaders:this.props.debugShaders})),this.pipeline=this.pipelineFactory.createRenderPipeline({...this.props,bufferLayout:this.bufferLayout,topology:this.topology,parameters:this.parameters,bindings:this._getBindings(),vs:r,fs:i}),this._attributeInfos=ww(this.pipeline.shaderLayout,this.bufferLayout),e&&this.shaderFactory.release(e),t&&this.shaderFactory.release(t)}return this.pipeline}_logDrawCallStart(){const e=le.level>3?0:VF;le.level<2||Date.now()-this._lastLogTime<e||(this._lastLogTime=Date.now(),this._logOpen=!0,le.group(Bi,`>>> DRAWING MODEL ${this.id}`,{collapsed:le.level<=2})())}_logDrawCallEnd(){if(this._logOpen){const e=kF(this.pipeline.shaderLayout,this.id);le.table(Bi,e)();const t=this.shaderInputs.getDebugTable();for(const[i,a]of Object.entries(this.uniforms))t[i]={value:a};le.table(Bi,t)();const r=this._getAttributeDebugTable();le.table(Bi,this._attributeInfos)(),le.table(Bi,r)(),le.groupEnd(Bi)(),this._logOpen=!1}}_logFramebuffer(e){const t=this.device.props.debugFramebuffers;if(this._drawCount++,!t)return;const r=e.props.framebuffer;r&&DF(r,{id:r.id,minimap:!0})}_getAttributeDebugTable(){const e={};for(const[t,r]of Object.entries(this._attributeInfos)){const i=this.vertexArray.attributes[r.location];e[r.location]={name:t,type:r.shaderType,values:i?this._getBufferOrConstantValues(i,r.bufferDataType):"null"}}if(this.vertexArray.indexBuffer){const{indexBuffer:t}=this.vertexArray,r=t.indexType==="uint32"?new Uint32Array(t.debugData):new Uint16Array(t.debugData);e.indices={name:"indices",type:t.indexType,values:r.toString()}}return e}_getBufferOrConstantValues(e,t){const r=Aw(t);return(e instanceof rt?new r(e.debugData):e).toString()}};w(kf,"defaultProps",{...Aa.defaultProps,source:void 0,vs:null,fs:null,id:"unnamed",handle:void 0,userData:{},defines:{},modules:[],moduleSettings:void 0,geometry:null,indexBuffer:null,attributes:{},constantAttributes:{},varyings:[],isInstanced:void 0,instanceCount:0,vertexCount:0,shaderInputs:void 0,pipelineFactory:void 0,shaderFactory:void 0,transformFeedback:void 0,shaderAssembler:Gu.getDefaultShaderAssembler(),debugShaders:void 0,disableWarnings:void 0});let El=kf;function HF(n){return!!(n.uniformTypes&&!l_(n.uniformTypes))}function jF(n){return{type:n.type,shaderLanguage:n.info.shadingLanguage,shaderLanguageVersion:n.info.shadingLanguageVersion,gpu:n.info.gpu,features:n.features}}function l_(n){for(const e in n)return!1;return!0}const dl=class dl{constructor(e,t=dl.defaultProps){w(this,"device");w(this,"model");w(this,"transformFeedback");if(!dl.isSupported(e))throw new Error("BufferTransform not yet implemented on WebGPU");this.device=e,this.model=new El(this.device,{id:t.id||"buffer-transform-model",fs:t.fs||TP(),topology:t.topology||"point-list",varyings:t.outputs||t.varyings,...t}),this.transformFeedback=this.device.createTransformFeedback({layout:this.model.pipeline.shaderLayout,buffers:t.feedbackBuffers}),this.model.setTransformFeedback(this.transformFeedback),Object.seal(this)}static isSupported(e){var t;return((t=e==null?void 0:e.info)==null?void 0:t.type)==="webgl"}destroy(){this.model&&this.model.destroy()}delete(){this.destroy()}run(e){e!=null&&e.inputBuffers&&this.model.setAttributes(e.inputBuffers),e!=null&&e.outputBuffers&&this.transformFeedback.setBuffers(e.outputBuffers);const t=this.device.beginRenderPass(e);this.model.draw(t),t.end()}getBuffer(e){return this.transformFeedback.getBuffer(e)}readAsync(e){const t=this.getBuffer(e);if(!t)throw new Error("BufferTransform#getBuffer");if(t instanceof rt)return t.readAsync();const{buffer:r,byteOffset:i=0,byteLength:a=r.byteLength}=t;return r.readAsync(i,a)}};w(dl,"defaultProps",{...El.defaultProps,outputs:void 0,feedbackBuffers:void 0});let Rl=dl;class $F{constructor(e){w(this,"id");w(this,"topology");w(this,"vertexCount");w(this,"indices");w(this,"attributes");w(this,"userData",{});const{attributes:t={},indices:r=null,vertexCount:i=null}=e;this.id=e.id||Hf("geometry"),this.topology=e.topology,r&&(this.indices=ArrayBuffer.isView(r)?{value:r,size:1}:r),this.attributes={};for(const[a,l]of Object.entries(t)){const c=ArrayBuffer.isView(l)?{value:l}:l;if(!ArrayBuffer.isView(c.value))throw new Error(`${this._print(a)}: must be typed array or object with value as typed array`);if((a==="POSITION"||a==="positions")&&!c.size&&(c.size=3),a==="indices"){if(this.indices)throw new Error("Multiple indices detected");this.indices=c}else this.attributes[a]=c}this.indices&&this.indices.isIndexed!==void 0&&(this.indices=Object.assign({},this.indices),delete this.indices.isIndexed),this.vertexCount=i||this._calculateVertexCount(this.attributes,this.indices)}getVertexCount(){return this.vertexCount}getAttributes(){return this.indices?{indices:this.indices,...this.attributes}:this.attributes}_print(e){return`Geometry ${this.id} attribute ${e}`}_setAttributes(e,t){return this}_calculateVertexCount(e,t){if(t)return t.value.length;let r=1/0;for(const i of Object.values(e)){const{value:a,size:l,constant:c}=i;!c&&a&&l!==void 0&&l>=1&&(r=Math.min(r,a.length/l))}return r}}const WF={blendColorOperation:"add",blendColorSrcFactor:"one",blendColorDstFactor:"zero",blendAlphaOperation:"add",blendAlphaSrcFactor:"constant-alpha",blendAlphaDstFactor:"zero"};class Rx extends im{constructor(){super(...arguments),this._colorEncoderState=null}render(e){return"pickingFBO"in e?this._drawPickingBuffer(e):super.render(e)}_drawPickingBuffer({layers:e,layerFilter:t,views:r,viewports:i,onViewportActive:a,pickingFBO:l,deviceRect:{x:c,y:f,width:d,height:p},cullRect:_,effects:y,pass:b="picking",pickZ:T,shaderModuleProps:A}){this.pickZ=T;const C=this._resetColorEncoder(T),N=[c,f,d,p],O=super.render({target:l,layers:e,layerFilter:t,views:r,viewports:i,onViewportActive:a,cullRect:_,effects:y==null?void 0:y.filter(E=>E.useInPicking),pass:b,isPicking:!0,shaderModuleProps:A,clearColor:[0,0,0,0],colorMask:15,scissorRect:N});return this._colorEncoderState=null,{decodePickingColor:C&&YF.bind(null,C),stats:O}}shouldDrawLayer(e){const{pickable:t,operation:r}=e.props;return t&&r.includes("draw")||r.includes("terrain")||r.includes("mask")}getShaderModuleProps(e,t,r){return{picking:{isActive:1,isAttribute:this.pickZ},lighting:{enabled:!1}}}getLayerParameters(e,t,r){const i={...e.props.parameters},{pickable:a,operation:l}=e.props;return!this._colorEncoderState||l.includes("terrain")?i.blend=!1:a&&l.includes("draw")&&(Object.assign(i,WF),i.blend=!0,i.blendColor=XF(this._colorEncoderState,e,r)),i}_resetColorEncoder(e){return this._colorEncoderState=e?null:{byLayer:new Map,byAlpha:[]},this._colorEncoderState}}function XF(n,e,t){const{byLayer:r,byAlpha:i}=n;let a,l=r.get(e);return l?(l.viewports.push(t),a=l.a):(a=r.size+1,a<=255?(l={a,layer:e,viewports:[t]},r.set(e,l),i[a]=l):(tt.warn("Too many pickable layers, only picking the first 255")(),a=0)),[0,0,0,a/255]}function YF(n,e){const t=n.byAlpha[e[3]];return t&&{pickedLayer:t.layer,pickedViewports:t.viewports,pickedObjectIndex:t.layer.decodePickingColor(e)}}const aa={NO_STATE:"Awaiting state",MATCHED:"Matched. State transferred from previous layer",INITIALIZED:"Initialized",AWAITING_GC:"Discarded. Awaiting garbage collection",AWAITING_FINALIZATION:"No longer matched. Awaiting garbage collection",FINALIZED:"Finalized! Awaiting garbage collection"},gf=Symbol.for("component"),Xi=Symbol.for("propTypes"),Gp=Symbol.for("deprecatedProps"),ma=Symbol.for("asyncPropDefaults"),rs=Symbol.for("asyncPropOriginal"),di=Symbol.for("asyncPropResolved");function Cx(n,e=()=>!0){return Array.isArray(n)?Mx(n,e,[]):e(n)?[n]:[]}function Mx(n,e,t){let r=-1;for(;++r<n.length;){const i=n[r];Array.isArray(i)?Mx(i,e,t):e(i)&&t.push(i)}return t}function qF({target:n,source:e,start:t=0,count:r=1}){const i=e.length,a=r*i;let l=0;for(let c=t;l<i;l++)n[c++]=e[l];for(;l<a;)l<a-l?(n.copyWithin(t+l,t,t+l),l*=2):(n.copyWithin(t+l,t,t+a-l),l=a);return n}class KF{constructor(e,t,r){this._loadCount=0,this._subscribers=new Set,this.id=e,this.context=r,this.setData(t)}subscribe(e){this._subscribers.add(e)}unsubscribe(e){this._subscribers.delete(e)}inUse(){return this._subscribers.size>0}delete(){}getData(){return this.isLoaded?this._error?Promise.reject(this._error):this._content:this._loader.then(()=>this.getData())}setData(e,t){if(e===this._data&&!t)return;this._data=e;const r=++this._loadCount;let i=e;typeof e=="string"&&(i=Ig(e)),i instanceof Promise?(this.isLoaded=!1,this._loader=i.then(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=void 0,this._content=a)}).catch(a=>{this._loadCount===r&&(this.isLoaded=!0,this._error=a||!0)})):(this.isLoaded=!0,this._error=void 0,this._content=e);for(const a of this._subscribers)a.onChange(this.getData())}}class ZF{constructor(e){var t;this.protocol=e.protocol||"resource://",this._context={device:e.device,gl:(t=e.device)==null?void 0:t.gl,resourceManager:this},this._resources={},this._consumers={},this._pruneRequest=null}contains(e){return e.startsWith(this.protocol)?!0:e in this._resources}add({resourceId:e,data:t,forceUpdate:r=!1,persistent:i=!0}){let a=this._resources[e];a?a.setData(t,r):(a=new KF(e,t,this._context),this._resources[e]=a),a.persistent=i}remove(e){const t=this._resources[e];t&&(t.delete(),delete this._resources[e])}unsubscribe({consumerId:e}){const t=this._consumers[e];if(t){for(const r in t){const i=t[r],a=this._resources[i.resourceId];a&&a.unsubscribe(i)}delete this._consumers[e],this.prune()}}subscribe({resourceId:e,onChange:t,consumerId:r,requestId:i="default"}){const{_resources:a,protocol:l}=this;e.startsWith(l)&&(e=e.replace(l,""),a[e]||this.add({resourceId:e,data:null,persistent:!1}));const c=a[e];if(this._track(r,i,c,t),c)return c.getData()}prune(){this._pruneRequest||(this._pruneRequest=setTimeout(()=>this._prune(),0))}finalize(){for(const e in this._resources)this._resources[e].delete()}_track(e,t,r,i){const a=this._consumers,l=a[e]=a[e]||{};let c=l[t];const f=c&&c.resourceId&&this._resources[c.resourceId];f&&(f.unsubscribe(c),this.prune()),r&&(c?(c.onChange=i,c.resourceId=r.id):c={onChange:i,resourceId:r.id},l[t]=c,r.subscribe(c))}_prune(){this._pruneRequest=null;for(const e of Object.keys(this._resources)){const t=this._resources[e];!t.persistent&&!t.inUse()&&(t.delete(),delete this._resources[e])}}}const QF="layerManager.setLayers",GF="layerManager.activateViewport";class JF{constructor(e,t){var c;this._lastRenderedLayers=[],this._needsRedraw=!1,this._needsUpdate=!1,this._nextLayers=null,this._debug=!1,this._defaultShaderModulesChanged=!1,this.activateViewport=f=>{Yt(GF,this,f),f&&(this.context.viewport=f)};const{deck:r,stats:i,viewport:a,timeline:l}=t||{};this.layers=[],this.resourceManager=new ZF({device:e,protocol:"deck://"}),this.context={mousePosition:null,userData:{},layerManager:this,device:e,gl:e==null?void 0:e.gl,deck:r,shaderAssembler:G8(((c=e==null?void 0:e.info)==null?void 0:c.shadingLanguage)||"glsl"),defaultShaderModules:[rB],renderPass:void 0,stats:i||new Ff({id:"deck.gl"}),viewport:a||new Pl({id:"DEFAULT-INITIAL-VIEWPORT"}),timeline:l||new xx,resourceManager:this.resourceManager,onError:void 0},Object.seal(this)}finalize(){this.resourceManager.finalize();for(const e of this.layers)this._finalizeLayer(e)}needsRedraw(e={clearRedrawFlags:!1}){let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);for(const r of this.layers){const i=r.getNeedsRedraw(e);t=t||i}return t}needsUpdate(){return this._nextLayers&&this._nextLayers!==this._lastRenderedLayers?"layers changed":this._defaultShaderModulesChanged?"shader modules changed":this._needsUpdate}setNeedsRedraw(e){this._needsRedraw=this._needsRedraw||e}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e}getLayers({layerIds:e}={}){return e?this.layers.filter(t=>e.find(r=>t.id.indexOf(r)===0)):this.layers}setProps(e){"debug"in e&&(this._debug=e.debug),"userData"in e&&(this.context.userData=e.userData),"layers"in e&&(this._nextLayers=e.layers),"onError"in e&&(this.context.onError=e.onError)}setLayers(e,t){Yt(QF,this,t,e),this._lastRenderedLayers=e;const r=Cx(e,Boolean);for(const i of r)i.context=this.context;this._updateLayers(this.layers,r)}updateLayers(){const e=this.needsUpdate();e&&(this.setNeedsRedraw(`updating layers: ${e}`),this.setLayers(this._nextLayers||this._lastRenderedLayers,e)),this._nextLayers=null}addDefaultShaderModule(e){const{defaultShaderModules:t}=this.context;t.find(r=>r.name===e.name)||(t.push(e),this._defaultShaderModulesChanged=!0)}removeDefaultShaderModule(e){const{defaultShaderModules:t}=this.context,r=t.findIndex(i=>i.name===e.name);r>=0&&(t.splice(r,1),this._defaultShaderModulesChanged=!0)}_handleError(e,t,r){r.raiseError(t,`${e} of ${r}`)}_updateLayers(e,t){const r={};for(const l of e)r[l.id]?tt.warn(`Multiple old layers with same id ${l.id}`)():r[l.id]=l;if(this._defaultShaderModulesChanged){for(const l of e)l.setNeedsUpdate(),l.setChangeFlags({extensionsChanged:!0});this._defaultShaderModulesChanged=!1}const i=[];this._updateSublayersRecursively(t,r,i),this._finalizeOldLayers(r);let a=!1;for(const l of i)if(l.hasUniformTransition()){a=`Uniform transition in ${l}`;break}this._needsUpdate=a,this.layers=i}_updateSublayersRecursively(e,t,r){for(const i of e){i.context=this.context;const a=t[i.id];a===null&&tt.warn(`Multiple new layers with same id ${i.id}`)(),t[i.id]=null;let l=null;try{this._debug&&a!==i&&i.validateProps(),a?(this._transferLayerState(a,i),this._updateLayer(i)):this._initializeLayer(i),r.push(i),l=i.isComposite?i.getSubLayers():null}catch(c){this._handleError("matching",c,i)}l&&this._updateSublayersRecursively(l,t,r)}}_finalizeOldLayers(e){for(const t in e){const r=e[t];r&&this._finalizeLayer(r)}}_initializeLayer(e){try{e._initialize(),e.lifecycle=aa.INITIALIZED}catch(t){this._handleError("initialization",t,e)}}_transferLayerState(e,t){t._transferState(e),t.lifecycle=aa.MATCHED,t!==e&&(e.lifecycle=aa.AWAITING_GC)}_updateLayer(e){try{e._update()}catch(t){this._handleError("update",t,e)}}_finalizeLayer(e){this._needsRedraw=this._needsRedraw||`finalized ${e}`,e.lifecycle=aa.AWAITING_FINALIZATION;try{e._finalize(),e.lifecycle=aa.FINALIZED}catch(t){this._handleError("finalization",t,e)}}}function Vn(n,e,t){if(n===e)return!0;if(!t||!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let r=0;r<n.length;r++)if(!Vn(n[r],e[r],t-1))return!1;return!0}if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const r=Object.keys(n),i=Object.keys(e);if(r.length!==i.length)return!1;for(const a of r)if(!e.hasOwnProperty(a)||!Vn(n[a],e[a],t-1))return!1;return!0}return!1}class e5{constructor(e){this.views=[],this.width=100,this.height=100,this.viewState={},this.controllers={},this.timeline=e.timeline,this._viewports=[],this._viewportMap={},this._isUpdating=!1,this._needsRedraw="First render",this._needsUpdate="Initialize",this._eventManager=e.eventManager,this._eventCallbacks={onViewStateChange:e.onViewStateChange,onInteractionStateChange:e.onInteractionStateChange},Object.seal(this),this.setProps(e)}finalize(){for(const e in this.controllers){const t=this.controllers[e];t&&t.finalize()}this.controllers={}}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}setNeedsUpdate(e){this._needsUpdate=this._needsUpdate||e,this._needsRedraw=this._needsRedraw||e}updateViewStates(){for(const e in this.controllers){const t=this.controllers[e];t&&t.updateTransition()}}getViewports(e){return e?this._viewports.filter(t=>t.containsPixel(e)):this._viewports}getViews(){const e={};return this.views.forEach(t=>{e[t.id]=t}),e}getView(e){return this.views.find(t=>t.id===e)}getViewState(e){const t=typeof e=="string"?this.getView(e):e,r=t&&this.viewState[t.getViewStateId()]||this.viewState;return t?t.filterViewState(r):r}getViewport(e){return this._viewportMap[e]}unproject(e,t){const r=this.getViewports(),i={x:e[0],y:e[1]};for(let a=r.length-1;a>=0;--a){const l=r[a];if(l.containsPixel(i)){const c=e.slice();return c[0]-=l.x,c[1]-=l.y,l.unproject(c,t)}}return null}setProps(e){e.views&&this._setViews(e.views),e.viewState&&this._setViewState(e.viewState),("width"in e||"height"in e)&&this._setSize(e.width,e.height),this._isUpdating||this._update()}_update(){this._isUpdating=!0,this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._needsUpdate&&(this._needsUpdate=!1,this._rebuildViewports()),this._isUpdating=!1}_setSize(e,t){(e!==this.width||t!==this.height)&&(this.width=e,this.height=t,this.setNeedsUpdate("Size changed"))}_setViews(e){e=Cx(e,Boolean),this._diffViews(e,this.views)&&this.setNeedsUpdate("views changed"),this.views=e}_setViewState(e){e?(!Vn(e,this.viewState,3)&&this.setNeedsUpdate("viewState changed"),this.viewState=e):tt.warn("missing `viewState` or `initialViewState`")()}_createController(e,t){const r=t.type;return new r({timeline:this.timeline,eventManager:this._eventManager,onViewStateChange:this._eventCallbacks.onViewStateChange,onStateChange:this._eventCallbacks.onInteractionStateChange,makeViewport:a=>{var l;return(l=this.getView(e.id))==null?void 0:l.makeViewport({viewState:a,width:this.width,height:this.height})}})}_updateController(e,t,r,i){const a=e.controller;if(a&&r){const l={...t,...a,id:e.id,x:r.x,y:r.y,width:r.width,height:r.height};return(!i||i.constructor!==a.type)&&(i=this._createController(e,l)),i&&i.setProps(l),i}return null}_rebuildViewports(){const{views:e}=this,t=this.controllers;this._viewports=[],this.controllers={};let r=!1;for(let i=e.length;i--;){const a=e[i],l=this.getViewState(a),c=a.makeViewport({viewState:l,width:this.width,height:this.height});let f=t[a.id];const d=!!a.controller;d&&!f&&(r=!0),(r||!d)&&f&&(f.finalize(),f=null),this.controllers[a.id]=this._updateController(a,l,c,f),c&&this._viewports.unshift(c)}for(const i in t){const a=t[i];a&&!this.controllers[i]&&a.finalize()}this._buildViewportMap()}_buildViewportMap(){this._viewportMap={},this._viewports.forEach(e=>{e.id&&(this._viewportMap[e.id]=this._viewportMap[e.id]||e)})}_diffViews(e,t){return e.length!==t.length?!0:e.some((r,i)=>!e[i].equals(t[i]))}}const t5=/([0-9]+\.?[0-9]*)(%|px)/;function ni(n){switch(typeof n){case"number":return{position:n,relative:!1};case"string":const e=t5.exec(n);if(e&&e.length>=3){const t=e[2]==="%",r=parseFloat(e[1]);return{position:t?r/100:r,relative:t}}default:throw new Error(`Could not parse position string ${n}`)}}function ri(n,e){return n.relative?Math.round(n.position*e):n.position}class ka{constructor(e){const{id:t,x:r=0,y:i=0,width:a="100%",height:l="100%",padding:c=null}=e;this.id=t||this.constructor.displayName||"view",this.props={...e,id:this.id},this._x=ni(r),this._y=ni(i),this._width=ni(a),this._height=ni(l),this._padding=c&&{left:ni(c.left||0),right:ni(c.right||0),top:ni(c.top||0),bottom:ni(c.bottom||0)},this.equals=this.equals.bind(this),Object.seal(this)}equals(e){return this===e?!0:this.constructor===e.constructor&&Vn(this.props,e.props,2)}makeViewport({width:e,height:t,viewState:r}){r=this.filterViewState(r);const i=this.getDimensions({width:e,height:t});if(!i.height||!i.width)return null;const a=this.getViewportType(r);return new a({...r,...this.props,...i})}getViewStateId(){const{viewState:e}=this.props;return typeof e=="string"?e:(e==null?void 0:e.id)||this.id}filterViewState(e){if(this.props.viewState&&typeof this.props.viewState=="object"){if(!this.props.viewState.id)return this.props.viewState;const t={...e};for(const r in this.props.viewState)r!=="id"&&(t[r]=this.props.viewState[r]);return t}return e}getDimensions({width:e,height:t}){const r={x:ri(this._x,e),y:ri(this._y,t),width:ri(this._width,e),height:ri(this._height,t)};return this._padding&&(r.padding={left:ri(this._padding.left,e),top:ri(this._padding.top,t),right:ri(this._padding.right,e),bottom:ri(this._padding.bottom,t)}),r}get controller(){const e=this.props.controller;return e?e===!0?{type:this.ControllerType}:typeof e=="function"?{type:e}:{type:this.ControllerType,...e}:null}}class jf{constructor(e){this._inProgress=!1,this._handle=null,this.time=0,this.settings={duration:0},this._timeline=e}get inProgress(){return this._inProgress}start(e){var t,r;this.cancel(),this.settings=e,this._inProgress=!0,(r=(t=this.settings).onStart)==null||r.call(t,this)}end(){var e,t;this._inProgress&&(this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1,(t=(e=this.settings).onEnd)==null||t.call(e,this))}cancel(){var e,t;this._inProgress&&((t=(e=this.settings).onInterrupt)==null||t.call(e,this),this._timeline.removeChannel(this._handle),this._handle=null,this._inProgress=!1)}update(){var e,t;if(!this._inProgress)return!1;if(this._handle===null){const{_timeline:r,settings:i}=this;this._handle=r.addChannel({delay:r.getTime(),duration:i.duration})}return this.time=this._timeline.getTime(this._handle),this._onUpdate(),(t=(e=this.settings).onUpdate)==null||t.call(e,this),this._timeline.isFinished(this._handle)&&this.end(),!0}_onUpdate(){}}const VT=()=>{},c_={BREAK:1,SNAP_TO_END:2,IGNORE:3},n5=n=>n,r5=c_.BREAK;class i5{constructor(e){this._onTransitionUpdate=t=>{const{time:r,settings:{interpolator:i,startProps:a,endProps:l,duration:c,easing:f}}=t,d=f(r/c),p=i.interpolateProps(a,l,d);this.propsInTransition=this.getControllerState({...this.props,...p}).getViewportProps(),this.onViewStateChange({viewState:this.propsInTransition,oldViewState:this.props})},this.getControllerState=e.getControllerState,this.propsInTransition=null,this.transition=new jf(e.timeline),this.onViewStateChange=e.onViewStateChange||VT,this.onStateChange=e.onStateChange||VT}finalize(){this.transition.cancel()}getViewportInTransition(){return this.propsInTransition}processViewStateChange(e){let t=!1;const r=this.props;if(this.props=e,!r||this._shouldIgnoreViewportChange(r,e))return!1;if(this._isTransitionEnabled(e)){let i=r;if(this.transition.inProgress){const{interruption:a,endProps:l}=this.transition.settings;i={...r,...a===c_.SNAP_TO_END?l:this.propsInTransition||r}}this._triggerTransition(i,e),t=!0}else this.transition.cancel();return t}updateTransition(){this.transition.update()}_isTransitionEnabled(e){const{transitionDuration:t,transitionInterpolator:r}=e;return(t>0||t==="auto")&&!!r}_isUpdateDueToCurrentTransition(e){return this.transition.inProgress&&this.propsInTransition?this.transition.settings.interpolator.arePropsEqual(e,this.propsInTransition):!1}_shouldIgnoreViewportChange(e,t){return this.transition.inProgress?this.transition.settings.interruption===c_.IGNORE||this._isUpdateDueToCurrentTransition(t):this._isTransitionEnabled(t)?t.transitionInterpolator.arePropsEqual(e,t):!0}_triggerTransition(e,t){const r=this.getControllerState(e),i=this.getControllerState(t).shortestPathFrom(r),a=t.transitionInterpolator,l=a.getDuration?a.getDuration(e,t):t.transitionDuration;if(l===0)return;const c=a.initializeProps(e,i);this.propsInTransition={};const f={duration:l,easing:t.transitionEasing||n5,interpolator:a,interruption:t.transitionInterruption||r5,startProps:c.start,endProps:c.end,onStart:t.onTransitionStart,onUpdate:this._onTransitionUpdate,onInterrupt:this._onTransitionEnd(t.onTransitionInterrupt),onEnd:this._onTransitionEnd(t.onTransitionEnd)};this.transition.start(f),this.onStateChange({inTransition:!0}),this.updateTransition()}_onTransitionEnd(e){return t=>{this.propsInTransition=null,this.onStateChange({inTransition:!1,isZooming:!1,isPanning:!1,isRotating:!1}),e==null||e(t)}}}function Vt(n,e){if(!n)throw new Error(e||"deck.gl: assertion failed.")}class Ox{constructor(e){const{compare:t,extract:r,required:i}=e;this._propsToCompare=t,this._propsToExtract=r||t,this._requiredProps=i}arePropsEqual(e,t){for(const r of this._propsToCompare)if(!(r in e)||!(r in t)||!Sl(e[r],t[r]))return!1;return!0}initializeProps(e,t){const r={},i={};for(const a of this._propsToExtract)(a in e||a in t)&&(r[a]=e[a],i[a]=t[a]);return this._checkRequiredProps(r),this._checkRequiredProps(i),{start:r,end:i}}getDuration(e,t){return t.transitionDuration}_checkRequiredProps(e){this._requiredProps&&this._requiredProps.forEach(t=>{const r=e[t];Vt(Number.isFinite(r)||Array.isArray(r),`${t} is required for transition`)})}}const s5=["longitude","latitude","zoom","bearing","pitch"],a5=["longitude","latitude","zoom"];class Ix extends Ox{constructor(e={}){const t=Array.isArray(e)?e:e.transitionProps,r=Array.isArray(e)?{}:e;r.transitionProps=Array.isArray(t)?{compare:t,required:t}:t||{compare:s5,required:a5},super(r.transitionProps),this.opts=r}initializeProps(e,t){const r=super.initializeProps(e,t),{makeViewport:i,around:a}=this.opts;if(i&&a){const l=i(e),c=i(t),f=l.unproject(a);r.start.around=a,Object.assign(r.end,{around:c.project(f),aroundPosition:f,width:t.width,height:t.height})}return r}interpolateProps(e,t,r){const i={};for(const a of this._propsToExtract)i[a]=xl(e[a]||0,t[a]||0,r);if(t.aroundPosition&&this.opts.makeViewport){const a=this.opts.makeViewport({...t,...i});Object.assign(i,a.panByPosition(t.aroundPosition,xl(e.around,t.around,r)))}return i}}const ii={transitionDuration:0},o5=300,du=n=>1-(1-n)*(1-n),sa={WHEEL:["wheel"],PAN:["panstart","panmove","panend"],PINCH:["pinchstart","pinchmove","pinchend"],MULTI_PAN:["multipanstart","multipanmove","multipanend"],DOUBLE_CLICK:["dblclick"],KEYBOARD:["keydown"]},Fi={};class l5{constructor(e){this.state={},this._events={},this._interactionState={isDragging:!1},this._customEvents=[],this._eventStartBlocked=null,this._panMove=!1,this.invertPan=!1,this.dragMode="rotate",this.inertia=0,this.scrollZoom=!0,this.dragPan=!0,this.dragRotate=!0,this.doubleClickZoom=!0,this.touchZoom=!0,this.touchRotate=!1,this.keyboard=!0,this.transitionManager=new i5({...e,getControllerState:t=>new this.ControllerState(t),onViewStateChange:this._onTransition.bind(this),onStateChange:this._setInteractionState.bind(this)}),this.handleEvent=this.handleEvent.bind(this),this.eventManager=e.eventManager,this.onViewStateChange=e.onViewStateChange||(()=>{}),this.onStateChange=e.onStateChange||(()=>{}),this.makeViewport=e.makeViewport}set events(e){this.toggleEvents(this._customEvents,!1),this.toggleEvents(e,!0),this._customEvents=e,this.props&&this.setProps(this.props)}finalize(){var e;for(const t in this._events)this._events[t]&&((e=this.eventManager)==null||e.off(t,this.handleEvent));this.transitionManager.finalize()}handleEvent(e){this._controllerState=void 0;const t=this._eventStartBlocked;switch(e.type){case"panstart":return t?!1:this._onPanStart(e);case"panmove":return this._onPan(e);case"panend":return this._onPanEnd(e);case"pinchstart":return t?!1:this._onPinchStart(e);case"pinchmove":return this._onPinch(e);case"pinchend":return this._onPinchEnd(e);case"multipanstart":return t?!1:this._onMultiPanStart(e);case"multipanmove":return this._onMultiPan(e);case"multipanend":return this._onMultiPanEnd(e);case"dblclick":return this._onDoubleClick(e);case"wheel":return this._onWheel(e);case"keydown":return this._onKeyDown(e);default:return!1}}get controllerState(){return this._controllerState=this._controllerState||new this.ControllerState({makeViewport:this.makeViewport,...this.props,...this.state}),this._controllerState}getCenter(e){const{x:t,y:r}=this.props,{offsetCenter:i}=e;return[i.x-t,i.y-r]}isPointInBounds(e,t){const{width:r,height:i}=this.props;if(t&&t.handled)return!1;const a=e[0]>=0&&e[0]<=r&&e[1]>=0&&e[1]<=i;return a&&t&&t.stopPropagation(),a}isFunctionKeyPressed(e){const{srcEvent:t}=e;return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}isDragging(){return this._interactionState.isDragging||!1}blockEvents(e){const t=setTimeout(()=>{this._eventStartBlocked===t&&(this._eventStartBlocked=null)},e);this._eventStartBlocked=t}setProps(e){e.dragMode&&(this.dragMode=e.dragMode),this.props=e,"transitionInterpolator"in e||(e.transitionInterpolator=this._getTransitionProps().transitionInterpolator),this.transitionManager.processViewStateChange(e);const{inertia:t}=e;this.inertia=Number.isFinite(t)?t:t===!0?o5:0;const{scrollZoom:r=!0,dragPan:i=!0,dragRotate:a=!0,doubleClickZoom:l=!0,touchZoom:c=!0,touchRotate:f=!1,keyboard:d=!0}=e,p=!!this.onViewStateChange;this.toggleEvents(sa.WHEEL,p&&r),this.toggleEvents(sa.PAN,p),this.toggleEvents(sa.PINCH,p&&(c||f)),this.toggleEvents(sa.MULTI_PAN,p&&f),this.toggleEvents(sa.DOUBLE_CLICK,p&&l),this.toggleEvents(sa.KEYBOARD,p&&d),this.scrollZoom=r,this.dragPan=i,this.dragRotate=a,this.doubleClickZoom=l,this.touchZoom=c,this.touchRotate=f,this.keyboard=d}updateTransition(){this.transitionManager.updateTransition()}toggleEvents(e,t){this.eventManager&&e.forEach(r=>{this._events[r]!==t&&(this._events[r]=t,t?this.eventManager.on(r,this.handleEvent):this.eventManager.off(r,this.handleEvent))})}updateViewport(e,t=null,r={}){const i={...e.getViewportProps(),...t},a=this.controllerState!==e;if(this.state=e.getState(),this._setInteractionState(r),a){const l=this.controllerState&&this.controllerState.getViewportProps();this.onViewStateChange&&this.onViewStateChange({viewState:i,interactionState:this._interactionState,oldViewState:l,viewId:this.props.id})}}_onTransition(e){this.onViewStateChange({...e,interactionState:this._interactionState,viewId:this.props.id})}_setInteractionState(e){Object.assign(this._interactionState,e),this.onStateChange(this._interactionState)}_onPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;let r=this.isFunctionKeyPressed(e)||e.rightButton||!1;(this.invertPan||this.dragMode==="pan")&&(r=!r);const i=this.controllerState[r?"panStart":"rotateStart"]({pos:t});return this._panMove=r,this.updateViewport(i,ii,{isDragging:!0}),!0}_onPan(e){return this.isDragging()?this._panMove?this._onPanMove(e):this._onPanRotate(e):!1}_onPanEnd(e){return this.isDragging()?this._panMove?this._onPanMoveEnd(e):this._onPanRotateEnd(e):!1}_onPanMove(e){if(!this.dragPan)return!1;const t=this.getCenter(e),r=this.controllerState.pan({pos:t});return this.updateViewport(r,ii,{isDragging:!0,isPanning:!0}),!0}_onPanMoveEnd(e){const{inertia:t}=this;if(this.dragPan&&t&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2],a=this.controllerState.pan({pos:i}).panEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:du},{isDragging:!1,isPanning:!0})}else{const r=this.controllerState.panEnd();this.updateViewport(r,null,{isDragging:!1,isPanning:!1})}return!0}_onPanRotate(e){if(!this.dragRotate)return!1;const t=this.getCenter(e),r=this.controllerState.rotate({pos:t});return this.updateViewport(r,ii,{isDragging:!0,isRotating:!0}),!0}_onPanRotateEnd(e){const{inertia:t}=this;if(this.dragRotate&&t&&e.velocity){const r=this.getCenter(e),i=[r[0]+e.velocityX*t/2,r[1]+e.velocityY*t/2],a=this.controllerState.rotate({pos:i}).rotateEnd();this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:du},{isDragging:!1,isRotating:!0})}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onWheel(e){if(!this.scrollZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;e.srcEvent.preventDefault();const{speed:r=.01,smooth:i=!1}=this.scrollZoom===!0?{}:this.scrollZoom,{delta:a}=e;let l=2/(1+Math.exp(-Math.abs(a*r)));a<0&&l!==0&&(l=1/l);const c=this.controllerState.zoom({pos:t,scale:l});return this.updateViewport(c,{...this._getTransitionProps({around:t}),transitionDuration:i?250:1},{isZooming:!0,isPanning:!0}),!0}_onMultiPanStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.rotateStart({pos:t});return this.updateViewport(r,ii,{isDragging:!0}),!0}_onMultiPan(e){if(!this.touchRotate||!this.isDragging())return!1;const t=this.getCenter(e);t[0]-=e.deltaX;const r=this.controllerState.rotate({pos:t});return this.updateViewport(r,ii,{isDragging:!0,isRotating:!0}),!0}_onMultiPanEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this;if(this.touchRotate&&t&&e.velocityY){const r=this.getCenter(e),i=[r[0],r[1]+=e.velocityY*t/2],a=this.controllerState.rotate({pos:i});this.updateViewport(a,{...this._getTransitionProps(),transitionDuration:t,transitionEasing:du},{isDragging:!1,isRotating:!0}),this.blockEvents(t)}else{const r=this.controllerState.rotateEnd();this.updateViewport(r,null,{isDragging:!1,isRotating:!1})}return!0}_onPinchStart(e){const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.controllerState.zoomStart({pos:t}).rotateStart({pos:t});return Fi._startPinchRotation=e.rotation,Fi._lastPinchEvent=e,this.updateViewport(r,ii,{isDragging:!0}),!0}_onPinch(e){if(!this.touchZoom&&!this.touchRotate||!this.isDragging())return!1;let t=this.controllerState;if(this.touchZoom){const{scale:r}=e,i=this.getCenter(e);t=t.zoom({pos:i,scale:r})}if(this.touchRotate){const{rotation:r}=e;t=t.rotate({deltaAngleX:Fi._startPinchRotation-r})}return this.updateViewport(t,ii,{isDragging:!0,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:this.touchRotate}),Fi._lastPinchEvent=e,!0}_onPinchEnd(e){if(!this.isDragging())return!1;const{inertia:t}=this,{_lastPinchEvent:r}=Fi;if(this.touchZoom&&t&&r&&e.scale!==r.scale){const i=this.getCenter(e);let a=this.controllerState.rotateEnd();const l=Math.log2(e.scale),c=(l-Math.log2(r.scale))/(e.deltaTime-r.deltaTime),f=Math.pow(2,l+c*t/2);a=a.zoom({pos:i,scale:f}).zoomEnd(),this.updateViewport(a,{...this._getTransitionProps({around:i}),transitionDuration:t,transitionEasing:du},{isDragging:!1,isPanning:this.touchZoom,isZooming:this.touchZoom,isRotating:!1}),this.blockEvents(t)}else{const i=this.controllerState.zoomEnd().rotateEnd();this.updateViewport(i,null,{isDragging:!1,isPanning:!1,isZooming:!1,isRotating:!1})}return Fi._startPinchRotation=null,Fi._lastPinchEvent=null,!0}_onDoubleClick(e){if(!this.doubleClickZoom)return!1;const t=this.getCenter(e);if(!this.isPointInBounds(t,e))return!1;const r=this.isFunctionKeyPressed(e),i=this.controllerState.zoom({pos:t,scale:r?.5:2});return this.updateViewport(i,this._getTransitionProps({around:t}),{isZooming:!0,isPanning:!0}),this.blockEvents(100),!0}_onKeyDown(e){if(!this.keyboard)return!1;const t=this.isFunctionKeyPressed(e),{zoomSpeed:r,moveSpeed:i,rotateSpeedX:a,rotateSpeedY:l}=this.keyboard===!0?{}:this.keyboard,{controllerState:c}=this;let f;const d={};switch(e.srcEvent.code){case"Minus":f=t?c.zoomOut(r).zoomOut(r):c.zoomOut(r),d.isZooming=!0;break;case"Equal":f=t?c.zoomIn(r).zoomIn(r):c.zoomIn(r),d.isZooming=!0;break;case"ArrowLeft":t?(f=c.rotateLeft(a),d.isRotating=!0):(f=c.moveLeft(i),d.isPanning=!0);break;case"ArrowRight":t?(f=c.rotateRight(a),d.isRotating=!0):(f=c.moveRight(i),d.isPanning=!0);break;case"ArrowUp":t?(f=c.rotateUp(l),d.isRotating=!0):(f=c.moveUp(i),d.isPanning=!0);break;case"ArrowDown":t?(f=c.rotateDown(l),d.isRotating=!0):(f=c.moveDown(i),d.isPanning=!0);break;default:return!1}return this.updateViewport(f,this._getTransitionProps(),d),!0}_getTransitionProps(e){const{transition:t}=this;return!t||!t.transitionInterpolator?ii:e?{...t,transitionInterpolator:new Ix({...e,...t.transitionInterpolator.opts,makeViewport:this.controllerState.makeViewport})}:t}}class c5{constructor(e,t){this._viewportProps=this.applyConstraints(e),this._state=t}getViewportProps(){return this._viewportProps}getState(){return this._state}}const HT=5,u5=1.2;class f5 extends c5{constructor(e){const{width:t,height:r,latitude:i,longitude:a,zoom:l,bearing:c=0,pitch:f=0,altitude:d=1.5,position:p=[0,0,0],maxZoom:_=20,minZoom:y=0,maxPitch:b=60,minPitch:T=0,startPanLngLat:A,startZoomLngLat:C,startRotatePos:N,startBearing:O,startPitch:R,startZoom:E,normalize:k=!0}=e;Vt(Number.isFinite(a)),Vt(Number.isFinite(i)),Vt(Number.isFinite(l)),super({width:t,height:r,latitude:i,longitude:a,zoom:l,bearing:c,pitch:f,altitude:d,maxZoom:_,minZoom:y,maxPitch:b,minPitch:T,normalize:k,position:p},{startPanLngLat:A,startZoomLngLat:C,startRotatePos:N,startBearing:O,startPitch:R,startZoom:E}),this.makeViewport=e.makeViewport}panStart({pos:e}){return this._getUpdatedState({startPanLngLat:this._unproject(e)})}pan({pos:e,startPos:t}){const r=this.getState().startPanLngLat||this._unproject(t);if(!r)return this;const a=this.makeViewport(this.getViewportProps()).panByPosition(r,e);return this._getUpdatedState(a)}panEnd(){return this._getUpdatedState({startPanLngLat:null})}rotateStart({pos:e}){return this._getUpdatedState({startRotatePos:e,startBearing:this.getViewportProps().bearing,startPitch:this.getViewportProps().pitch})}rotate({pos:e,deltaAngleX:t=0,deltaAngleY:r=0}){const{startRotatePos:i,startBearing:a,startPitch:l}=this.getState();if(!i||a===void 0||l===void 0)return this;let c;return e?c=this._getNewRotation(e,i,l,a):c={bearing:a+t,pitch:l+r},this._getUpdatedState(c)}rotateEnd(){return this._getUpdatedState({startBearing:null,startPitch:null})}zoomStart({pos:e}){return this._getUpdatedState({startZoomLngLat:this._unproject(e),startZoom:this.getViewportProps().zoom})}zoom({pos:e,startPos:t,scale:r}){let{startZoom:i,startZoomLngLat:a}=this.getState();if(a||(i=this.getViewportProps().zoom,a=this._unproject(t)||this._unproject(e)),!a)return this;const{maxZoom:l,minZoom:c}=this.getViewportProps();let f=i+Math.log2(r);f=hi(f,c,l);const d=this.makeViewport({...this.getViewportProps(),zoom:f});return this._getUpdatedState({zoom:f,...d.panByPosition(a,e)})}zoomEnd(){return this._getUpdatedState({startZoomLngLat:null,startZoom:null})}zoomIn(e=2){return this._zoomFromCenter(e)}zoomOut(e=2){return this._zoomFromCenter(1/e)}moveLeft(e=100){return this._panFromCenter([e,0])}moveRight(e=100){return this._panFromCenter([-e,0])}moveUp(e=100){return this._panFromCenter([0,e])}moveDown(e=100){return this._panFromCenter([0,-e])}rotateLeft(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing-e})}rotateRight(e=15){return this._getUpdatedState({bearing:this.getViewportProps().bearing+e})}rotateUp(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch+e})}rotateDown(e=10){return this._getUpdatedState({pitch:this.getViewportProps().pitch-e})}shortestPathFrom(e){const t=e.getViewportProps(),r={...this.getViewportProps()},{bearing:i,longitude:a}=r;return Math.abs(i-t.bearing)>180&&(r.bearing=i<0?i+360:i-360),Math.abs(a-t.longitude)>180&&(r.longitude=a<0?a+360:a-360),r}applyConstraints(e){const{maxZoom:t,minZoom:r,zoom:i}=e;e.zoom=hi(i,r,t);const{maxPitch:a,minPitch:l,pitch:c}=e;e.pitch=hi(c,l,a);const{normalize:f=!0}=e;return f&&Object.assign(e,N8(e)),e}_zoomFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.zoom({pos:[t/2,r/2],scale:e})}_panFromCenter(e){const{width:t,height:r}=this.getViewportProps();return this.pan({startPos:[t/2,r/2],pos:[t/2+e[0],r/2+e[1]]})}_getUpdatedState(e){return new this.constructor({makeViewport:this.makeViewport,...this.getViewportProps(),...this.getState(),...e})}_unproject(e){const t=this.makeViewport(this.getViewportProps());return e&&t.unproject(e)}_getNewRotation(e,t,r,i){const a=e[0]-t[0],l=e[1]-t[1],c=e[1],f=t[1],{width:d,height:p}=this.getViewportProps(),_=a/d;let y=0;l>0?Math.abs(p-f)>HT&&(y=l/(f-p)*u5):l<0&&f>HT&&(y=1-c/f),y=hi(y,-1,1);const{minPitch:b,maxPitch:T}=this.getViewportProps(),A=i+180*_;let C=r;return y>0?C=r+y*(T-r):y<0&&(C=r-y*(b-r)),{pitch:C,bearing:A}}}class h5 extends l5{constructor(){super(...arguments),this.ControllerState=f5,this.transition={transitionDuration:300,transitionInterpolator:new Ix({transitionProps:{compare:["longitude","latitude","zoom","bearing","pitch","position"],required:["longitude","latitude","zoom"]}})},this.dragMode="pan"}setProps(e){e.position=e.position||[0,0,0];const t=this.props;super.setProps(e),(!t||t.height!==e.height)&&this.updateViewport(new this.ControllerState({makeViewport:this.makeViewport,...e,...this.state}))}}class Nx extends ka{constructor(e={}){super(e)}getViewportType(){return Na}get ControllerType(){return h5}}Nx.displayName="MapView";const d5=new Tx;function p5(n,e){const t=n.order??1/0,r=e.order??1/0;return t-r}class g5{constructor(e){this._resolvedEffects=[],this._defaultEffects=[],this.effects=[],this._context=e,this._needsRedraw="Initial render",this._setEffects([])}addDefaultEffect(e){const t=this._defaultEffects;if(!t.find(r=>r.id===e.id)){const r=t.findIndex(i=>p5(i,e)>0);r<0?t.push(e):t.splice(r,0,e),e.setup(this._context),this._setEffects(this.effects)}}setProps(e){"effects"in e&&(Vn(e.effects,this.effects,1)||this._setEffects(e.effects))}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}getEffects(){return this._resolvedEffects}_setEffects(e){const t={};for(const i of this.effects)t[i.id]=i;const r=[];for(const i of e){const a=t[i.id];let l=i;a&&a!==i?a.setProps?(a.setProps(i.props),l=a):a.cleanup(this._context):a||i.setup(this._context),r.push(l),delete t[i.id]}for(const i in t)t[i].cleanup(this._context);this.effects=r,this._resolvedEffects=r.concat(this._defaultEffects),e.some(i=>i instanceof Tx)||this._resolvedEffects.push(d5),this._needsRedraw="effects changed"}finalize(){for(const e of this._resolvedEffects)e.cleanup(this._context);this.effects.length=0,this._resolvedEffects.length=0,this._defaultEffects.length=0}}class _5 extends im{shouldDrawLayer(e){const{operation:t}=e.props;return t.includes("draw")||t.includes("terrain")}}const m5="deckRenderer.renderLayers";class y5{constructor(e){this.device=e,this.layerFilter=null,this.drawPickingColors=!1,this.drawLayersPass=new _5(e),this.pickLayersPass=new Rx(e),this.renderCount=0,this._needsRedraw="Initial render",this.renderBuffers=[],this.lastPostProcessEffect=null}setProps(e){this.layerFilter!==e.layerFilter&&(this.layerFilter=e.layerFilter,this._needsRedraw="layerFilter changed"),this.drawPickingColors!==e.drawPickingColors&&(this.drawPickingColors=e.drawPickingColors,this._needsRedraw="drawPickingColors changed")}renderLayers(e){if(!e.viewports.length)return;const t=this.drawPickingColors?this.pickLayersPass:this.drawLayersPass,r={layerFilter:this.layerFilter,isPicking:this.drawPickingColors,...e};r.effects&&this._preRender(r.effects,r);const i=this.lastPostProcessEffect?this.renderBuffers[0]:r.target;this.lastPostProcessEffect&&(r.clearColor=[0,0,0,0],r.clearCanvas=!0);const a=t.render({...r,target:i});r.effects&&this._postRender(r.effects,r),this.renderCount++,Yt(m5,this,a,e)}needsRedraw(e={clearRedrawFlags:!1}){const t=this._needsRedraw;return e.clearRedrawFlags&&(this._needsRedraw=!1),t}finalize(){const{renderBuffers:e}=this;for(const t of e)t.delete();e.length=0}_preRender(e,t){this.lastPostProcessEffect=null,t.preRenderStats=t.preRenderStats||{};for(const r of e)t.preRenderStats[r.id]=r.preRender(t),r.postRender&&(this.lastPostProcessEffect=r.id);this.lastPostProcessEffect&&this._resizeRenderBuffers()}_resizeRenderBuffers(){const{renderBuffers:e}=this,t=this.device.canvasContext.getDrawingBufferSize();e.length===0&&[0,1].map(r=>{const i=this.device.createTexture({sampler:{minFilter:"linear",magFilter:"linear"}});e.push(this.device.createFramebuffer({id:`deck-renderbuffer-${r}`,colorAttachments:[i]}))});for(const r of e)r.resize(t)}_postRender(e,t){const{renderBuffers:r}=this,i={...t,inputBuffer:r[0],swapBuffer:r[1]};for(const a of e)if(a.postRender){i.target=a.id===this.lastPostProcessEffect?t.target:void 0;const l=a.postRender(i);i.inputBuffer=l,i.swapBuffer=l===r[0]?r[1]:r[0]}}}const b5={pickedColor:null,pickedObjectIndex:-1};function v5({pickedColors:n,decodePickingColor:e,deviceX:t,deviceY:r,deviceRadius:i,deviceRect:a}){const{x:l,y:c,width:f,height:d}=a;let p=i*i,_=-1,y=0;for(let b=0;b<d;b++){const T=b+c-r,A=T*T;if(A>p)y+=4*f;else for(let C=0;C<f;C++){if(n[y+3]-1>=0){const O=C+l-t,R=O*O+A;R<=p&&(p=R,_=y)}y+=4}}if(_>=0){const b=n.slice(_,_+4),T=e(b);if(T){const A=Math.floor(_/4/f),C=_/4-A*f;return{...T,pickedColor:b,pickedX:l+C,pickedY:c+A}}tt.error("Picked non-existent layer. Is picking buffer corrupt?")()}return b5}function T5({pickedColors:n,decodePickingColor:e}){const t=new Map;if(n){for(let r=0;r<n.length;r+=4)if(n[r+3]-1>=0){const a=n.slice(r,r+4),l=a.join(",");if(!t.has(l)){const c=e(a);c?t.set(l,{...c,color:a}):tt.error("Picked non-existent layer. Is picking buffer corrupt?")()}}}return Array.from(t.values())}function kx({pickInfo:n,viewports:e,pixelRatio:t,x:r,y:i,z:a}){let l=e[0];e.length>1&&(l=x5((n==null?void 0:n.pickedViewports)||e,{x:r,y:i}));let c;if(l){const f=[r-l.x,i-l.y];a!==void 0&&(f[2]=a),c=l.unproject(f)}return{color:null,layer:null,viewport:l,index:-1,picked:!1,x:r,y:i,pixel:[r,i],coordinate:c,devicePixel:n&&"pickedX"in n?[n.pickedX,n.pickedY]:void 0,pixelRatio:t}}function w5(n){const{pickInfo:e,lastPickedInfo:t,mode:r,layers:i}=n,{pickedColor:a,pickedLayer:l,pickedObjectIndex:c}=e,f=l?[l]:[];if(r==="hover"){const _=t.index,y=t.layerId,b=l?l.props.id:null;if(b!==y||c!==_){if(b!==y){const T=i.find(A=>A.props.id===y);T&&f.unshift(T)}t.layerId=b,t.index=c,t.info=null}}const d=kx(n),p=new Map;return p.set(null,d),f.forEach(_=>{let y={...d};_===l&&(y.color=a,y.index=c,y.picked=!0),y=Dx({layer:_,info:y,mode:r});const b=y.layer;_===l&&r==="hover"&&(t.info=y),p.set(b.id,y),r==="hover"&&b.updateAutoHighlight(y)}),p}function Dx({layer:n,info:e,mode:t}){for(;n&&e;){const r=e.layer||null;e.sourceLayer=r,e.layer=n,e=n.getPickingInfo({info:e,mode:t,sourceLayer:r}),n=n.parent}return e}function x5(n,e){for(let t=n.length-1;t>=0;t--){const r=n[t];if(r.containsPixel(e))return r}return n[0]}class S5{constructor(e){this._pickable=!0,this.device=e,this.pickLayersPass=new Rx(e),this.lastPickedInfo={index:-1,layerId:null,info:null}}setProps(e){"layerFilter"in e&&(this.layerFilter=e.layerFilter),"_pickable"in e&&(this._pickable=e._pickable)}finalize(){this.pickingFBO&&this.pickingFBO.destroy(),this.depthFBO&&this.depthFBO.destroy()}pickObject(e){return this._pickClosestObject(e)}pickObjects(e){return this._pickVisibleObjects(e)}getLastPickedObject({x:e,y:t,layers:r,viewports:i},a=this.lastPickedInfo.info){const l=a&&a.layer&&a.layer.id,c=a&&a.viewport&&a.viewport.id,f=l?r.find(y=>y.id===l):null,d=c&&i.find(y=>y.id===c)||i[0],p=d&&d.unproject([e-d.x,t-d.y]);return{...a,...{x:e,y:t,viewport:d,coordinate:p,layer:f}}}_resizeBuffer(){var t,r;if(!this.pickingFBO&&(this.pickingFBO=this.device.createFramebuffer({colorAttachments:["rgba8unorm"],depthStencilAttachment:"depth16unorm"}),this.device.isTextureFormatRenderable("rgba32float"))){const i=this.device.createFramebuffer({colorAttachments:["rgba32float"],depthStencilAttachment:"depth16unorm"});this.depthFBO=i}const{canvas:e}=this.device.getDefaultCanvasContext();(t=this.pickingFBO)==null||t.resize({width:e.width,height:e.height}),(r=this.depthFBO)==null||r.resize({width:e.width,height:e.height})}_getPickable(e){if(this._pickable===!1)return null;const t=e.filter(r=>this.pickLayersPass.shouldDrawLayer(r)&&!r.isComposite);return t.length?t:null}_pickClosestObject({layers:e,views:t,viewports:r,x:i,y:a,radius:l=0,depth:c=1,mode:f="query",unproject3D:d,onViewportActive:p,effects:_}){const y=this.device.canvasContext.cssToDeviceRatio(),b=this._getPickable(e);if(!b||r.length===0)return{result:[],emptyInfo:kx({viewports:r,x:i,y:a,pixelRatio:y})};this._resizeBuffer();const T=this.device.canvasContext.cssToDevicePixels([i,a],!0),A=[T.x+Math.floor(T.width/2),T.y+Math.floor(T.height/2)],C=Math.round(l*y),{width:N,height:O}=this.pickingFBO,R=this._getPickingRect({deviceX:A[0],deviceY:A[1],deviceRadius:C,deviceWidth:N,deviceHeight:O}),E={x:i-l,y:a-l,width:l*2+1,height:l*2+1};let k;const V=[],ne=new Set;for(let G=0;G<c;G++){let se;if(R){const q=this._drawAndSample({layers:b,views:t,viewports:r,onViewportActive:p,deviceRect:R,cullRect:E,effects:_,pass:`picking:${f}`});se=v5({...q,deviceX:A[0],deviceY:A[1],deviceRadius:C,deviceRect:R})}else se={pickedColor:null,pickedObjectIndex:-1};let re;if(se.pickedLayer&&d&&this.depthFBO){const{pickedColors:q}=this._drawAndSample({layers:[se.pickedLayer],views:t,viewports:r,onViewportActive:p,deviceRect:{x:se.pickedX,y:se.pickedY,width:1,height:1},cullRect:E,effects:_,pass:`picking:${f}:z`},!0);q[3]&&(re=q[0])}se.pickedLayer&&G+1<c&&(ne.add(se.pickedLayer),se.pickedLayer.disablePickingIndex(se.pickedObjectIndex)),k=w5({pickInfo:se,lastPickedInfo:this.lastPickedInfo,mode:f,layers:b,viewports:r,x:i,y:a,z:re,pixelRatio:y});for(const q of k.values())q.layer&&V.push(q);if(!se.pickedColor)break}for(const G of ne)G.restorePickingColors();return{result:V,emptyInfo:k.get(null)}}_pickVisibleObjects({layers:e,views:t,viewports:r,x:i,y:a,width:l=1,height:c=1,mode:f="query",maxObjects:d=null,onViewportActive:p,effects:_}){const y=this._getPickable(e);if(!y||r.length===0)return[];this._resizeBuffer();const b=this.device.canvasContext.cssToDeviceRatio(),T=this.device.canvasContext.cssToDevicePixels([i,a],!0),A=T.x,C=T.y+T.height,N=this.device.canvasContext.cssToDevicePixels([i+l,a+c],!0),O=N.x+N.width,R=N.y,E={x:A,y:R,width:O-A,height:C-R},k=this._drawAndSample({layers:y,views:t,viewports:r,onViewportActive:p,deviceRect:E,cullRect:{x:i,y:a,width:l,height:c},effects:_,pass:`picking:${f}`}),V=T5(k),ne=new Map,G=[],se=Number.isFinite(d);for(let re=0;re<V.length&&!(se&&G.length>=d);re++){const q=V[re];let ce={color:q.pickedColor,layer:null,index:q.pickedObjectIndex,picked:!0,x:i,y:a,pixelRatio:b};ce=Dx({layer:q.pickedLayer,info:ce,mode:f});const me=ce.layer.id;ne.has(me)||ne.set(me,new Set);const de=ne.get(me),_e=ce.object??ce.index;de.has(_e)||(de.add(_e),G.push(ce))}return G}_drawAndSample({layers:e,views:t,viewports:r,onViewportActive:i,deviceRect:a,cullRect:l,effects:c,pass:f},d=!1){const p=d?this.depthFBO:this.pickingFBO,_={layers:e,layerFilter:this.layerFilter,views:t,viewports:r,onViewportActive:i,pickingFBO:p,deviceRect:a,cullRect:l,effects:c,pass:f,pickZ:d,preRenderStats:{},isPicking:!0};for(const O of c)O.useInPicking&&(_.preRenderStats[O.id]=O.preRender(_));const{decodePickingColor:y}=this.pickLayersPass.render(_),{x:b,y:T,width:A,height:C}=a,N=new(d?Float32Array:Uint8Array)(A*C*4);return this.device.readPixelsToArrayWebGL(p,{sourceX:b,sourceY:T,sourceWidth:A,sourceHeight:C,target:N}),{pickedColors:N,decodePickingColor:y}}_getPickingRect({deviceX:e,deviceY:t,deviceRadius:r,deviceWidth:i,deviceHeight:a}){const l=Math.max(0,e-r),c=Math.max(0,t-r),f=Math.min(i,e+r+1)-l,d=Math.min(a,t+r+1)-c;return f<=0||d<=0?null:{x:l,y:c,width:f,height:d}}}const A5={"top-left":{top:0,left:0},"top-right":{top:0,right:0},"bottom-left":{bottom:0,left:0},"bottom-right":{bottom:0,right:0},fill:{top:0,left:0,bottom:0,right:0}},E5="top-left",jT="__root";class R5{constructor({deck:e,parentElement:t}){this.defaultWidgets=[],this.widgets=[],this.resolvedWidgets=[],this.containers={},this.lastViewports={},this.deck=e,this.parentElement=t}getWidgets(){return this.resolvedWidgets}setProps(e){e.widgets&&!Vn(e.widgets,this.widgets,1)&&this._setWidgets(e.widgets)}finalize(){for(const e of this.getWidgets())this._remove(e);this.defaultWidgets.length=0,this.resolvedWidgets.length=0;for(const e in this.containers)this.containers[e].remove()}addDefault(e){this.defaultWidgets.find(t=>t.id===e.id)||(this._add(e),this.defaultWidgets.push(e),this._setWidgets(this.widgets))}_setWidgets(e){const t={};for(const r of this.resolvedWidgets)t[r.id]=r;this.resolvedWidgets.length=0;for(const r of this.defaultWidgets)t[r.id]=null,this.resolvedWidgets.push(r);for(let r of e){const i=t[r.id];i?i.viewId!==r.viewId||i.placement!==r.placement?(this._remove(i),this._add(r)):r!==i&&(i.setProps(r.props),r=i):this._add(r),t[r.id]=null,this.resolvedWidgets.push(r)}for(const r in t){const i=t[r];i&&this._remove(i)}this.widgets=e}_add(e){const{viewId:t=null,placement:r=E5}=e,i=e.onAdd({deck:this.deck,viewId:t});i&&this._getContainer(t,r).append(i),e._element=i}_remove(e){var t;(t=e.onRemove)==null||t.call(e),e._element&&e._element.remove(),e._element=void 0}_getContainer(e,t){var l;const r=e||jT;let i=this.containers[r];i||(i=document.createElement("div"),i.style.pointerEvents="none",i.style.position="absolute",i.style.overflow="hidden",(l=this.parentElement)==null||l.append(i),this.containers[r]=i);let a=i.querySelector(`.${t}`);return a||(a=document.createElement("div"),a.className=t,a.style.position="absolute",a.style.zIndex="2",Object.assign(a.style,A5[t]),i.append(a)),a}_updateContainers(){const e=this.deck.width,t=this.deck.height;for(const r in this.containers){const i=this.lastViewports[r]||null,a=r===jT||i,l=this.containers[r];a?(l.style.display="block",l.style.left=`${i?i.x:0}px`,l.style.top=`${i?i.y:0}px`,l.style.width=`${i?i.width:e}px`,l.style.height=`${i?i.height:t}px`):l.style.display="none"}}onRedraw({viewports:e,layers:t}){var i,a;const r=e.reduce((l,c)=>(l[c.id]=c,l),{});for(const l of this.getWidgets()){const{viewId:c}=l;if(c){const f=r[c];f&&(l.onViewportChange&&l.onViewportChange(f),(i=l.onRedraw)==null||i.call(l,{viewports:[f],layers:t}))}else{if(l.onViewportChange)for(const f of e)l.onViewportChange(f);(a=l.onRedraw)==null||a.call(l,{viewports:e,layers:t})}}this.lastViewports=r,this._updateContainers()}onHover(e,t){var r,i;for(const a of this.getWidgets()){const{viewId:l}=a;(!l||l===((r=e.viewport)==null?void 0:r.id))&&((i=a.onHover)==null||i.call(a,e,t))}}onEvent(e,t){var i,a;const r=t_[t.type];if(r)for(const l of this.getWidgets()){const{viewId:c}=l;(!c||c===((i=e.viewport)==null?void 0:i.id))&&((a=l[r])==null||a.call(l,e,t))}}}const C5={zIndex:"1",position:"absolute",pointerEvents:"none",color:"#a0a7b4",backgroundColor:"#29323c",padding:"10px",top:"0",left:"0",display:"none"};class M5{constructor(){this.id="default-tooltip",this.placement="fill",this.props={},this.isVisible=!1}onAdd({deck:e}){const t=document.createElement("div");return t.className="deck-tooltip",Object.assign(t.style,C5),this.deck=e,this.element=t,t}onRemove(){this.deck=void 0,this.element=void 0}setProps(){}onViewportChange(e){var t;this.isVisible&&e.id===((t=this.lastViewport)==null?void 0:t.id)&&e!==this.lastViewport&&this.setTooltip(null)}onHover(e){const{deck:t}=this,r=t&&t.props.getTooltip;if(!r)return;const i=r(e);this.lastViewport=e.viewport,this.setTooltip(i,e.x,e.y)}setTooltip(e,t,r){const i=this.element;if(i){if(typeof e=="string")i.innerText=e;else if(e)e.text&&(i.innerText=e.text),e.html&&(i.innerHTML=e.html),e.className&&(i.className=e.className);else{this.isVisible=!1,i.style.display="none";return}this.isVisible=!0,i.style.display="block",i.style.transform=`translate(${t}px, ${r}px)`,e&&typeof e=="object"&&"style"in e&&Object.assign(i.style,e.style)}}}var ua;(function(n){n[n.DEPTH_BUFFER_BIT=256]="DEPTH_BUFFER_BIT",n[n.STENCIL_BUFFER_BIT=1024]="STENCIL_BUFFER_BIT",n[n.COLOR_BUFFER_BIT=16384]="COLOR_BUFFER_BIT",n[n.POINTS=0]="POINTS",n[n.LINES=1]="LINES",n[n.LINE_LOOP=2]="LINE_LOOP",n[n.LINE_STRIP=3]="LINE_STRIP",n[n.TRIANGLES=4]="TRIANGLES",n[n.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",n[n.TRIANGLE_FAN=6]="TRIANGLE_FAN",n[n.ZERO=0]="ZERO",n[n.ONE=1]="ONE",n[n.SRC_COLOR=768]="SRC_COLOR",n[n.ONE_MINUS_SRC_COLOR=769]="ONE_MINUS_SRC_COLOR",n[n.SRC_ALPHA=770]="SRC_ALPHA",n[n.ONE_MINUS_SRC_ALPHA=771]="ONE_MINUS_SRC_ALPHA",n[n.DST_ALPHA=772]="DST_ALPHA",n[n.ONE_MINUS_DST_ALPHA=773]="ONE_MINUS_DST_ALPHA",n[n.DST_COLOR=774]="DST_COLOR",n[n.ONE_MINUS_DST_COLOR=775]="ONE_MINUS_DST_COLOR",n[n.SRC_ALPHA_SATURATE=776]="SRC_ALPHA_SATURATE",n[n.CONSTANT_COLOR=32769]="CONSTANT_COLOR",n[n.ONE_MINUS_CONSTANT_COLOR=32770]="ONE_MINUS_CONSTANT_COLOR",n[n.CONSTANT_ALPHA=32771]="CONSTANT_ALPHA",n[n.ONE_MINUS_CONSTANT_ALPHA=32772]="ONE_MINUS_CONSTANT_ALPHA",n[n.FUNC_ADD=32774]="FUNC_ADD",n[n.FUNC_SUBTRACT=32778]="FUNC_SUBTRACT",n[n.FUNC_REVERSE_SUBTRACT=32779]="FUNC_REVERSE_SUBTRACT",n[n.BLEND_EQUATION=32777]="BLEND_EQUATION",n[n.BLEND_EQUATION_RGB=32777]="BLEND_EQUATION_RGB",n[n.BLEND_EQUATION_ALPHA=34877]="BLEND_EQUATION_ALPHA",n[n.BLEND_DST_RGB=32968]="BLEND_DST_RGB",n[n.BLEND_SRC_RGB=32969]="BLEND_SRC_RGB",n[n.BLEND_DST_ALPHA=32970]="BLEND_DST_ALPHA",n[n.BLEND_SRC_ALPHA=32971]="BLEND_SRC_ALPHA",n[n.BLEND_COLOR=32773]="BLEND_COLOR",n[n.ARRAY_BUFFER_BINDING=34964]="ARRAY_BUFFER_BINDING",n[n.ELEMENT_ARRAY_BUFFER_BINDING=34965]="ELEMENT_ARRAY_BUFFER_BINDING",n[n.LINE_WIDTH=2849]="LINE_WIDTH",n[n.ALIASED_POINT_SIZE_RANGE=33901]="ALIASED_POINT_SIZE_RANGE",n[n.ALIASED_LINE_WIDTH_RANGE=33902]="ALIASED_LINE_WIDTH_RANGE",n[n.CULL_FACE_MODE=2885]="CULL_FACE_MODE",n[n.FRONT_FACE=2886]="FRONT_FACE",n[n.DEPTH_RANGE=2928]="DEPTH_RANGE",n[n.DEPTH_WRITEMASK=2930]="DEPTH_WRITEMASK",n[n.DEPTH_CLEAR_VALUE=2931]="DEPTH_CLEAR_VALUE",n[n.DEPTH_FUNC=2932]="DEPTH_FUNC",n[n.STENCIL_CLEAR_VALUE=2961]="STENCIL_CLEAR_VALUE",n[n.STENCIL_FUNC=2962]="STENCIL_FUNC",n[n.STENCIL_FAIL=2964]="STENCIL_FAIL",n[n.STENCIL_PASS_DEPTH_FAIL=2965]="STENCIL_PASS_DEPTH_FAIL",n[n.STENCIL_PASS_DEPTH_PASS=2966]="STENCIL_PASS_DEPTH_PASS",n[n.STENCIL_REF=2967]="STENCIL_REF",n[n.STENCIL_VALUE_MASK=2963]="STENCIL_VALUE_MASK",n[n.STENCIL_WRITEMASK=2968]="STENCIL_WRITEMASK",n[n.STENCIL_BACK_FUNC=34816]="STENCIL_BACK_FUNC",n[n.STENCIL_BACK_FAIL=34817]="STENCIL_BACK_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_FAIL=34818]="STENCIL_BACK_PASS_DEPTH_FAIL",n[n.STENCIL_BACK_PASS_DEPTH_PASS=34819]="STENCIL_BACK_PASS_DEPTH_PASS",n[n.STENCIL_BACK_REF=36003]="STENCIL_BACK_REF",n[n.STENCIL_BACK_VALUE_MASK=36004]="STENCIL_BACK_VALUE_MASK",n[n.STENCIL_BACK_WRITEMASK=36005]="STENCIL_BACK_WRITEMASK",n[n.VIEWPORT=2978]="VIEWPORT",n[n.SCISSOR_BOX=3088]="SCISSOR_BOX",n[n.COLOR_CLEAR_VALUE=3106]="COLOR_CLEAR_VALUE",n[n.COLOR_WRITEMASK=3107]="COLOR_WRITEMASK",n[n.UNPACK_ALIGNMENT=3317]="UNPACK_ALIGNMENT",n[n.PACK_ALIGNMENT=3333]="PACK_ALIGNMENT",n[n.MAX_TEXTURE_SIZE=3379]="MAX_TEXTURE_SIZE",n[n.MAX_VIEWPORT_DIMS=3386]="MAX_VIEWPORT_DIMS",n[n.SUBPIXEL_BITS=3408]="SUBPIXEL_BITS",n[n.RED_BITS=3410]="RED_BITS",n[n.GREEN_BITS=3411]="GREEN_BITS",n[n.BLUE_BITS=3412]="BLUE_BITS",n[n.ALPHA_BITS=3413]="ALPHA_BITS",n[n.DEPTH_BITS=3414]="DEPTH_BITS",n[n.STENCIL_BITS=3415]="STENCIL_BITS",n[n.POLYGON_OFFSET_UNITS=10752]="POLYGON_OFFSET_UNITS",n[n.POLYGON_OFFSET_FACTOR=32824]="POLYGON_OFFSET_FACTOR",n[n.TEXTURE_BINDING_2D=32873]="TEXTURE_BINDING_2D",n[n.SAMPLE_BUFFERS=32936]="SAMPLE_BUFFERS",n[n.SAMPLES=32937]="SAMPLES",n[n.SAMPLE_COVERAGE_VALUE=32938]="SAMPLE_COVERAGE_VALUE",n[n.SAMPLE_COVERAGE_INVERT=32939]="SAMPLE_COVERAGE_INVERT",n[n.COMPRESSED_TEXTURE_FORMATS=34467]="COMPRESSED_TEXTURE_FORMATS",n[n.VENDOR=7936]="VENDOR",n[n.RENDERER=7937]="RENDERER",n[n.VERSION=7938]="VERSION",n[n.IMPLEMENTATION_COLOR_READ_TYPE=35738]="IMPLEMENTATION_COLOR_READ_TYPE",n[n.IMPLEMENTATION_COLOR_READ_FORMAT=35739]="IMPLEMENTATION_COLOR_READ_FORMAT",n[n.BROWSER_DEFAULT_WEBGL=37444]="BROWSER_DEFAULT_WEBGL",n[n.STATIC_DRAW=35044]="STATIC_DRAW",n[n.STREAM_DRAW=35040]="STREAM_DRAW",n[n.DYNAMIC_DRAW=35048]="DYNAMIC_DRAW",n[n.ARRAY_BUFFER=34962]="ARRAY_BUFFER",n[n.ELEMENT_ARRAY_BUFFER=34963]="ELEMENT_ARRAY_BUFFER",n[n.BUFFER_SIZE=34660]="BUFFER_SIZE",n[n.BUFFER_USAGE=34661]="BUFFER_USAGE",n[n.CURRENT_VERTEX_ATTRIB=34342]="CURRENT_VERTEX_ATTRIB",n[n.VERTEX_ATTRIB_ARRAY_ENABLED=34338]="VERTEX_ATTRIB_ARRAY_ENABLED",n[n.VERTEX_ATTRIB_ARRAY_SIZE=34339]="VERTEX_ATTRIB_ARRAY_SIZE",n[n.VERTEX_ATTRIB_ARRAY_STRIDE=34340]="VERTEX_ATTRIB_ARRAY_STRIDE",n[n.VERTEX_ATTRIB_ARRAY_TYPE=34341]="VERTEX_ATTRIB_ARRAY_TYPE",n[n.VERTEX_ATTRIB_ARRAY_NORMALIZED=34922]="VERTEX_ATTRIB_ARRAY_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_POINTER=34373]="VERTEX_ATTRIB_ARRAY_POINTER",n[n.VERTEX_ATTRIB_ARRAY_BUFFER_BINDING=34975]="VERTEX_ATTRIB_ARRAY_BUFFER_BINDING",n[n.CULL_FACE=2884]="CULL_FACE",n[n.FRONT=1028]="FRONT",n[n.BACK=1029]="BACK",n[n.FRONT_AND_BACK=1032]="FRONT_AND_BACK",n[n.BLEND=3042]="BLEND",n[n.DEPTH_TEST=2929]="DEPTH_TEST",n[n.DITHER=3024]="DITHER",n[n.POLYGON_OFFSET_FILL=32823]="POLYGON_OFFSET_FILL",n[n.SAMPLE_ALPHA_TO_COVERAGE=32926]="SAMPLE_ALPHA_TO_COVERAGE",n[n.SAMPLE_COVERAGE=32928]="SAMPLE_COVERAGE",n[n.SCISSOR_TEST=3089]="SCISSOR_TEST",n[n.STENCIL_TEST=2960]="STENCIL_TEST",n[n.NO_ERROR=0]="NO_ERROR",n[n.INVALID_ENUM=1280]="INVALID_ENUM",n[n.INVALID_VALUE=1281]="INVALID_VALUE",n[n.INVALID_OPERATION=1282]="INVALID_OPERATION",n[n.OUT_OF_MEMORY=1285]="OUT_OF_MEMORY",n[n.CONTEXT_LOST_WEBGL=37442]="CONTEXT_LOST_WEBGL",n[n.CW=2304]="CW",n[n.CCW=2305]="CCW",n[n.DONT_CARE=4352]="DONT_CARE",n[n.FASTEST=4353]="FASTEST",n[n.NICEST=4354]="NICEST",n[n.GENERATE_MIPMAP_HINT=33170]="GENERATE_MIPMAP_HINT",n[n.BYTE=5120]="BYTE",n[n.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",n[n.SHORT=5122]="SHORT",n[n.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",n[n.INT=5124]="INT",n[n.UNSIGNED_INT=5125]="UNSIGNED_INT",n[n.FLOAT=5126]="FLOAT",n[n.DOUBLE=5130]="DOUBLE",n[n.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",n[n.ALPHA=6406]="ALPHA",n[n.RGB=6407]="RGB",n[n.RGBA=6408]="RGBA",n[n.LUMINANCE=6409]="LUMINANCE",n[n.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",n[n.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",n[n.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",n[n.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",n[n.FRAGMENT_SHADER=35632]="FRAGMENT_SHADER",n[n.VERTEX_SHADER=35633]="VERTEX_SHADER",n[n.COMPILE_STATUS=35713]="COMPILE_STATUS",n[n.DELETE_STATUS=35712]="DELETE_STATUS",n[n.LINK_STATUS=35714]="LINK_STATUS",n[n.VALIDATE_STATUS=35715]="VALIDATE_STATUS",n[n.ATTACHED_SHADERS=35717]="ATTACHED_SHADERS",n[n.ACTIVE_ATTRIBUTES=35721]="ACTIVE_ATTRIBUTES",n[n.ACTIVE_UNIFORMS=35718]="ACTIVE_UNIFORMS",n[n.MAX_VERTEX_ATTRIBS=34921]="MAX_VERTEX_ATTRIBS",n[n.MAX_VERTEX_UNIFORM_VECTORS=36347]="MAX_VERTEX_UNIFORM_VECTORS",n[n.MAX_VARYING_VECTORS=36348]="MAX_VARYING_VECTORS",n[n.MAX_COMBINED_TEXTURE_IMAGE_UNITS=35661]="MAX_COMBINED_TEXTURE_IMAGE_UNITS",n[n.MAX_VERTEX_TEXTURE_IMAGE_UNITS=35660]="MAX_VERTEX_TEXTURE_IMAGE_UNITS",n[n.MAX_TEXTURE_IMAGE_UNITS=34930]="MAX_TEXTURE_IMAGE_UNITS",n[n.MAX_FRAGMENT_UNIFORM_VECTORS=36349]="MAX_FRAGMENT_UNIFORM_VECTORS",n[n.SHADER_TYPE=35663]="SHADER_TYPE",n[n.SHADING_LANGUAGE_VERSION=35724]="SHADING_LANGUAGE_VERSION",n[n.CURRENT_PROGRAM=35725]="CURRENT_PROGRAM",n[n.NEVER=512]="NEVER",n[n.LESS=513]="LESS",n[n.EQUAL=514]="EQUAL",n[n.LEQUAL=515]="LEQUAL",n[n.GREATER=516]="GREATER",n[n.NOTEQUAL=517]="NOTEQUAL",n[n.GEQUAL=518]="GEQUAL",n[n.ALWAYS=519]="ALWAYS",n[n.KEEP=7680]="KEEP",n[n.REPLACE=7681]="REPLACE",n[n.INCR=7682]="INCR",n[n.DECR=7683]="DECR",n[n.INVERT=5386]="INVERT",n[n.INCR_WRAP=34055]="INCR_WRAP",n[n.DECR_WRAP=34056]="DECR_WRAP",n[n.NEAREST=9728]="NEAREST",n[n.LINEAR=9729]="LINEAR",n[n.NEAREST_MIPMAP_NEAREST=9984]="NEAREST_MIPMAP_NEAREST",n[n.LINEAR_MIPMAP_NEAREST=9985]="LINEAR_MIPMAP_NEAREST",n[n.NEAREST_MIPMAP_LINEAR=9986]="NEAREST_MIPMAP_LINEAR",n[n.LINEAR_MIPMAP_LINEAR=9987]="LINEAR_MIPMAP_LINEAR",n[n.TEXTURE_MAG_FILTER=10240]="TEXTURE_MAG_FILTER",n[n.TEXTURE_MIN_FILTER=10241]="TEXTURE_MIN_FILTER",n[n.TEXTURE_WRAP_S=10242]="TEXTURE_WRAP_S",n[n.TEXTURE_WRAP_T=10243]="TEXTURE_WRAP_T",n[n.TEXTURE_2D=3553]="TEXTURE_2D",n[n.TEXTURE=5890]="TEXTURE",n[n.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",n[n.TEXTURE_BINDING_CUBE_MAP=34068]="TEXTURE_BINDING_CUBE_MAP",n[n.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",n[n.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",n[n.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",n[n.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",n[n.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",n[n.MAX_CUBE_MAP_TEXTURE_SIZE=34076]="MAX_CUBE_MAP_TEXTURE_SIZE",n[n.TEXTURE0=33984]="TEXTURE0",n[n.ACTIVE_TEXTURE=34016]="ACTIVE_TEXTURE",n[n.REPEAT=10497]="REPEAT",n[n.CLAMP_TO_EDGE=33071]="CLAMP_TO_EDGE",n[n.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",n[n.TEXTURE_WIDTH=4096]="TEXTURE_WIDTH",n[n.TEXTURE_HEIGHT=4097]="TEXTURE_HEIGHT",n[n.FLOAT_VEC2=35664]="FLOAT_VEC2",n[n.FLOAT_VEC3=35665]="FLOAT_VEC3",n[n.FLOAT_VEC4=35666]="FLOAT_VEC4",n[n.INT_VEC2=35667]="INT_VEC2",n[n.INT_VEC3=35668]="INT_VEC3",n[n.INT_VEC4=35669]="INT_VEC4",n[n.BOOL=35670]="BOOL",n[n.BOOL_VEC2=35671]="BOOL_VEC2",n[n.BOOL_VEC3=35672]="BOOL_VEC3",n[n.BOOL_VEC4=35673]="BOOL_VEC4",n[n.FLOAT_MAT2=35674]="FLOAT_MAT2",n[n.FLOAT_MAT3=35675]="FLOAT_MAT3",n[n.FLOAT_MAT4=35676]="FLOAT_MAT4",n[n.SAMPLER_2D=35678]="SAMPLER_2D",n[n.SAMPLER_CUBE=35680]="SAMPLER_CUBE",n[n.LOW_FLOAT=36336]="LOW_FLOAT",n[n.MEDIUM_FLOAT=36337]="MEDIUM_FLOAT",n[n.HIGH_FLOAT=36338]="HIGH_FLOAT",n[n.LOW_INT=36339]="LOW_INT",n[n.MEDIUM_INT=36340]="MEDIUM_INT",n[n.HIGH_INT=36341]="HIGH_INT",n[n.FRAMEBUFFER=36160]="FRAMEBUFFER",n[n.RENDERBUFFER=36161]="RENDERBUFFER",n[n.RGBA4=32854]="RGBA4",n[n.RGB5_A1=32855]="RGB5_A1",n[n.RGB565=36194]="RGB565",n[n.DEPTH_COMPONENT16=33189]="DEPTH_COMPONENT16",n[n.STENCIL_INDEX=6401]="STENCIL_INDEX",n[n.STENCIL_INDEX8=36168]="STENCIL_INDEX8",n[n.DEPTH_STENCIL=34041]="DEPTH_STENCIL",n[n.RENDERBUFFER_WIDTH=36162]="RENDERBUFFER_WIDTH",n[n.RENDERBUFFER_HEIGHT=36163]="RENDERBUFFER_HEIGHT",n[n.RENDERBUFFER_INTERNAL_FORMAT=36164]="RENDERBUFFER_INTERNAL_FORMAT",n[n.RENDERBUFFER_RED_SIZE=36176]="RENDERBUFFER_RED_SIZE",n[n.RENDERBUFFER_GREEN_SIZE=36177]="RENDERBUFFER_GREEN_SIZE",n[n.RENDERBUFFER_BLUE_SIZE=36178]="RENDERBUFFER_BLUE_SIZE",n[n.RENDERBUFFER_ALPHA_SIZE=36179]="RENDERBUFFER_ALPHA_SIZE",n[n.RENDERBUFFER_DEPTH_SIZE=36180]="RENDERBUFFER_DEPTH_SIZE",n[n.RENDERBUFFER_STENCIL_SIZE=36181]="RENDERBUFFER_STENCIL_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE=36048]="FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_OBJECT_NAME=36049]="FRAMEBUFFER_ATTACHMENT_OBJECT_NAME",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL=36050]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE=36051]="FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE",n[n.COLOR_ATTACHMENT0=36064]="COLOR_ATTACHMENT0",n[n.DEPTH_ATTACHMENT=36096]="DEPTH_ATTACHMENT",n[n.STENCIL_ATTACHMENT=36128]="STENCIL_ATTACHMENT",n[n.DEPTH_STENCIL_ATTACHMENT=33306]="DEPTH_STENCIL_ATTACHMENT",n[n.NONE=0]="NONE",n[n.FRAMEBUFFER_COMPLETE=36053]="FRAMEBUFFER_COMPLETE",n[n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT=36054]="FRAMEBUFFER_INCOMPLETE_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT=36055]="FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT",n[n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS=36057]="FRAMEBUFFER_INCOMPLETE_DIMENSIONS",n[n.FRAMEBUFFER_UNSUPPORTED=36061]="FRAMEBUFFER_UNSUPPORTED",n[n.FRAMEBUFFER_BINDING=36006]="FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_BINDING=36007]="RENDERBUFFER_BINDING",n[n.READ_FRAMEBUFFER=36008]="READ_FRAMEBUFFER",n[n.DRAW_FRAMEBUFFER=36009]="DRAW_FRAMEBUFFER",n[n.MAX_RENDERBUFFER_SIZE=34024]="MAX_RENDERBUFFER_SIZE",n[n.INVALID_FRAMEBUFFER_OPERATION=1286]="INVALID_FRAMEBUFFER_OPERATION",n[n.UNPACK_FLIP_Y_WEBGL=37440]="UNPACK_FLIP_Y_WEBGL",n[n.UNPACK_PREMULTIPLY_ALPHA_WEBGL=37441]="UNPACK_PREMULTIPLY_ALPHA_WEBGL",n[n.UNPACK_COLORSPACE_CONVERSION_WEBGL=37443]="UNPACK_COLORSPACE_CONVERSION_WEBGL",n[n.READ_BUFFER=3074]="READ_BUFFER",n[n.UNPACK_ROW_LENGTH=3314]="UNPACK_ROW_LENGTH",n[n.UNPACK_SKIP_ROWS=3315]="UNPACK_SKIP_ROWS",n[n.UNPACK_SKIP_PIXELS=3316]="UNPACK_SKIP_PIXELS",n[n.PACK_ROW_LENGTH=3330]="PACK_ROW_LENGTH",n[n.PACK_SKIP_ROWS=3331]="PACK_SKIP_ROWS",n[n.PACK_SKIP_PIXELS=3332]="PACK_SKIP_PIXELS",n[n.TEXTURE_BINDING_3D=32874]="TEXTURE_BINDING_3D",n[n.UNPACK_SKIP_IMAGES=32877]="UNPACK_SKIP_IMAGES",n[n.UNPACK_IMAGE_HEIGHT=32878]="UNPACK_IMAGE_HEIGHT",n[n.MAX_3D_TEXTURE_SIZE=32883]="MAX_3D_TEXTURE_SIZE",n[n.MAX_ELEMENTS_VERTICES=33e3]="MAX_ELEMENTS_VERTICES",n[n.MAX_ELEMENTS_INDICES=33001]="MAX_ELEMENTS_INDICES",n[n.MAX_TEXTURE_LOD_BIAS=34045]="MAX_TEXTURE_LOD_BIAS",n[n.MAX_FRAGMENT_UNIFORM_COMPONENTS=35657]="MAX_FRAGMENT_UNIFORM_COMPONENTS",n[n.MAX_VERTEX_UNIFORM_COMPONENTS=35658]="MAX_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_ARRAY_TEXTURE_LAYERS=35071]="MAX_ARRAY_TEXTURE_LAYERS",n[n.MIN_PROGRAM_TEXEL_OFFSET=35076]="MIN_PROGRAM_TEXEL_OFFSET",n[n.MAX_PROGRAM_TEXEL_OFFSET=35077]="MAX_PROGRAM_TEXEL_OFFSET",n[n.MAX_VARYING_COMPONENTS=35659]="MAX_VARYING_COMPONENTS",n[n.FRAGMENT_SHADER_DERIVATIVE_HINT=35723]="FRAGMENT_SHADER_DERIVATIVE_HINT",n[n.RASTERIZER_DISCARD=35977]="RASTERIZER_DISCARD",n[n.VERTEX_ARRAY_BINDING=34229]="VERTEX_ARRAY_BINDING",n[n.MAX_VERTEX_OUTPUT_COMPONENTS=37154]="MAX_VERTEX_OUTPUT_COMPONENTS",n[n.MAX_FRAGMENT_INPUT_COMPONENTS=37157]="MAX_FRAGMENT_INPUT_COMPONENTS",n[n.MAX_SERVER_WAIT_TIMEOUT=37137]="MAX_SERVER_WAIT_TIMEOUT",n[n.MAX_ELEMENT_INDEX=36203]="MAX_ELEMENT_INDEX",n[n.RED=6403]="RED",n[n.RGB8=32849]="RGB8",n[n.RGBA8=32856]="RGBA8",n[n.RGB10_A2=32857]="RGB10_A2",n[n.TEXTURE_3D=32879]="TEXTURE_3D",n[n.TEXTURE_WRAP_R=32882]="TEXTURE_WRAP_R",n[n.TEXTURE_MIN_LOD=33082]="TEXTURE_MIN_LOD",n[n.TEXTURE_MAX_LOD=33083]="TEXTURE_MAX_LOD",n[n.TEXTURE_BASE_LEVEL=33084]="TEXTURE_BASE_LEVEL",n[n.TEXTURE_MAX_LEVEL=33085]="TEXTURE_MAX_LEVEL",n[n.TEXTURE_COMPARE_MODE=34892]="TEXTURE_COMPARE_MODE",n[n.TEXTURE_COMPARE_FUNC=34893]="TEXTURE_COMPARE_FUNC",n[n.SRGB=35904]="SRGB",n[n.SRGB8=35905]="SRGB8",n[n.SRGB8_ALPHA8=35907]="SRGB8_ALPHA8",n[n.COMPARE_REF_TO_TEXTURE=34894]="COMPARE_REF_TO_TEXTURE",n[n.RGBA32F=34836]="RGBA32F",n[n.RGB32F=34837]="RGB32F",n[n.RGBA16F=34842]="RGBA16F",n[n.RGB16F=34843]="RGB16F",n[n.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",n[n.TEXTURE_BINDING_2D_ARRAY=35869]="TEXTURE_BINDING_2D_ARRAY",n[n.R11F_G11F_B10F=35898]="R11F_G11F_B10F",n[n.RGB9_E5=35901]="RGB9_E5",n[n.RGBA32UI=36208]="RGBA32UI",n[n.RGB32UI=36209]="RGB32UI",n[n.RGBA16UI=36214]="RGBA16UI",n[n.RGB16UI=36215]="RGB16UI",n[n.RGBA8UI=36220]="RGBA8UI",n[n.RGB8UI=36221]="RGB8UI",n[n.RGBA32I=36226]="RGBA32I",n[n.RGB32I=36227]="RGB32I",n[n.RGBA16I=36232]="RGBA16I",n[n.RGB16I=36233]="RGB16I",n[n.RGBA8I=36238]="RGBA8I",n[n.RGB8I=36239]="RGB8I",n[n.RED_INTEGER=36244]="RED_INTEGER",n[n.RGB_INTEGER=36248]="RGB_INTEGER",n[n.RGBA_INTEGER=36249]="RGBA_INTEGER",n[n.R8=33321]="R8",n[n.RG8=33323]="RG8",n[n.R16F=33325]="R16F",n[n.R32F=33326]="R32F",n[n.RG16F=33327]="RG16F",n[n.RG32F=33328]="RG32F",n[n.R8I=33329]="R8I",n[n.R8UI=33330]="R8UI",n[n.R16I=33331]="R16I",n[n.R16UI=33332]="R16UI",n[n.R32I=33333]="R32I",n[n.R32UI=33334]="R32UI",n[n.RG8I=33335]="RG8I",n[n.RG8UI=33336]="RG8UI",n[n.RG16I=33337]="RG16I",n[n.RG16UI=33338]="RG16UI",n[n.RG32I=33339]="RG32I",n[n.RG32UI=33340]="RG32UI",n[n.R8_SNORM=36756]="R8_SNORM",n[n.RG8_SNORM=36757]="RG8_SNORM",n[n.RGB8_SNORM=36758]="RGB8_SNORM",n[n.RGBA8_SNORM=36759]="RGBA8_SNORM",n[n.RGB10_A2UI=36975]="RGB10_A2UI",n[n.TEXTURE_IMMUTABLE_FORMAT=37167]="TEXTURE_IMMUTABLE_FORMAT",n[n.TEXTURE_IMMUTABLE_LEVELS=33503]="TEXTURE_IMMUTABLE_LEVELS",n[n.UNSIGNED_INT_2_10_10_10_REV=33640]="UNSIGNED_INT_2_10_10_10_REV",n[n.UNSIGNED_INT_10F_11F_11F_REV=35899]="UNSIGNED_INT_10F_11F_11F_REV",n[n.UNSIGNED_INT_5_9_9_9_REV=35902]="UNSIGNED_INT_5_9_9_9_REV",n[n.FLOAT_32_UNSIGNED_INT_24_8_REV=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",n[n.UNSIGNED_INT_24_8=34042]="UNSIGNED_INT_24_8",n[n.HALF_FLOAT=5131]="HALF_FLOAT",n[n.RG=33319]="RG",n[n.RG_INTEGER=33320]="RG_INTEGER",n[n.INT_2_10_10_10_REV=36255]="INT_2_10_10_10_REV",n[n.CURRENT_QUERY=34917]="CURRENT_QUERY",n[n.QUERY_RESULT=34918]="QUERY_RESULT",n[n.QUERY_RESULT_AVAILABLE=34919]="QUERY_RESULT_AVAILABLE",n[n.ANY_SAMPLES_PASSED=35887]="ANY_SAMPLES_PASSED",n[n.ANY_SAMPLES_PASSED_CONSERVATIVE=36202]="ANY_SAMPLES_PASSED_CONSERVATIVE",n[n.MAX_DRAW_BUFFERS=34852]="MAX_DRAW_BUFFERS",n[n.DRAW_BUFFER0=34853]="DRAW_BUFFER0",n[n.DRAW_BUFFER1=34854]="DRAW_BUFFER1",n[n.DRAW_BUFFER2=34855]="DRAW_BUFFER2",n[n.DRAW_BUFFER3=34856]="DRAW_BUFFER3",n[n.DRAW_BUFFER4=34857]="DRAW_BUFFER4",n[n.DRAW_BUFFER5=34858]="DRAW_BUFFER5",n[n.DRAW_BUFFER6=34859]="DRAW_BUFFER6",n[n.DRAW_BUFFER7=34860]="DRAW_BUFFER7",n[n.DRAW_BUFFER8=34861]="DRAW_BUFFER8",n[n.DRAW_BUFFER9=34862]="DRAW_BUFFER9",n[n.DRAW_BUFFER10=34863]="DRAW_BUFFER10",n[n.DRAW_BUFFER11=34864]="DRAW_BUFFER11",n[n.DRAW_BUFFER12=34865]="DRAW_BUFFER12",n[n.DRAW_BUFFER13=34866]="DRAW_BUFFER13",n[n.DRAW_BUFFER14=34867]="DRAW_BUFFER14",n[n.DRAW_BUFFER15=34868]="DRAW_BUFFER15",n[n.MAX_COLOR_ATTACHMENTS=36063]="MAX_COLOR_ATTACHMENTS",n[n.COLOR_ATTACHMENT1=36065]="COLOR_ATTACHMENT1",n[n.COLOR_ATTACHMENT2=36066]="COLOR_ATTACHMENT2",n[n.COLOR_ATTACHMENT3=36067]="COLOR_ATTACHMENT3",n[n.COLOR_ATTACHMENT4=36068]="COLOR_ATTACHMENT4",n[n.COLOR_ATTACHMENT5=36069]="COLOR_ATTACHMENT5",n[n.COLOR_ATTACHMENT6=36070]="COLOR_ATTACHMENT6",n[n.COLOR_ATTACHMENT7=36071]="COLOR_ATTACHMENT7",n[n.COLOR_ATTACHMENT8=36072]="COLOR_ATTACHMENT8",n[n.COLOR_ATTACHMENT9=36073]="COLOR_ATTACHMENT9",n[n.COLOR_ATTACHMENT10=36074]="COLOR_ATTACHMENT10",n[n.COLOR_ATTACHMENT11=36075]="COLOR_ATTACHMENT11",n[n.COLOR_ATTACHMENT12=36076]="COLOR_ATTACHMENT12",n[n.COLOR_ATTACHMENT13=36077]="COLOR_ATTACHMENT13",n[n.COLOR_ATTACHMENT14=36078]="COLOR_ATTACHMENT14",n[n.COLOR_ATTACHMENT15=36079]="COLOR_ATTACHMENT15",n[n.SAMPLER_3D=35679]="SAMPLER_3D",n[n.SAMPLER_2D_SHADOW=35682]="SAMPLER_2D_SHADOW",n[n.SAMPLER_2D_ARRAY=36289]="SAMPLER_2D_ARRAY",n[n.SAMPLER_2D_ARRAY_SHADOW=36292]="SAMPLER_2D_ARRAY_SHADOW",n[n.SAMPLER_CUBE_SHADOW=36293]="SAMPLER_CUBE_SHADOW",n[n.INT_SAMPLER_2D=36298]="INT_SAMPLER_2D",n[n.INT_SAMPLER_3D=36299]="INT_SAMPLER_3D",n[n.INT_SAMPLER_CUBE=36300]="INT_SAMPLER_CUBE",n[n.INT_SAMPLER_2D_ARRAY=36303]="INT_SAMPLER_2D_ARRAY",n[n.UNSIGNED_INT_SAMPLER_2D=36306]="UNSIGNED_INT_SAMPLER_2D",n[n.UNSIGNED_INT_SAMPLER_3D=36307]="UNSIGNED_INT_SAMPLER_3D",n[n.UNSIGNED_INT_SAMPLER_CUBE=36308]="UNSIGNED_INT_SAMPLER_CUBE",n[n.UNSIGNED_INT_SAMPLER_2D_ARRAY=36311]="UNSIGNED_INT_SAMPLER_2D_ARRAY",n[n.MAX_SAMPLES=36183]="MAX_SAMPLES",n[n.SAMPLER_BINDING=35097]="SAMPLER_BINDING",n[n.PIXEL_PACK_BUFFER=35051]="PIXEL_PACK_BUFFER",n[n.PIXEL_UNPACK_BUFFER=35052]="PIXEL_UNPACK_BUFFER",n[n.PIXEL_PACK_BUFFER_BINDING=35053]="PIXEL_PACK_BUFFER_BINDING",n[n.PIXEL_UNPACK_BUFFER_BINDING=35055]="PIXEL_UNPACK_BUFFER_BINDING",n[n.COPY_READ_BUFFER=36662]="COPY_READ_BUFFER",n[n.COPY_WRITE_BUFFER=36663]="COPY_WRITE_BUFFER",n[n.COPY_READ_BUFFER_BINDING=36662]="COPY_READ_BUFFER_BINDING",n[n.COPY_WRITE_BUFFER_BINDING=36663]="COPY_WRITE_BUFFER_BINDING",n[n.FLOAT_MAT2x3=35685]="FLOAT_MAT2x3",n[n.FLOAT_MAT2x4=35686]="FLOAT_MAT2x4",n[n.FLOAT_MAT3x2=35687]="FLOAT_MAT3x2",n[n.FLOAT_MAT3x4=35688]="FLOAT_MAT3x4",n[n.FLOAT_MAT4x2=35689]="FLOAT_MAT4x2",n[n.FLOAT_MAT4x3=35690]="FLOAT_MAT4x3",n[n.UNSIGNED_INT_VEC2=36294]="UNSIGNED_INT_VEC2",n[n.UNSIGNED_INT_VEC3=36295]="UNSIGNED_INT_VEC3",n[n.UNSIGNED_INT_VEC4=36296]="UNSIGNED_INT_VEC4",n[n.UNSIGNED_NORMALIZED=35863]="UNSIGNED_NORMALIZED",n[n.SIGNED_NORMALIZED=36764]="SIGNED_NORMALIZED",n[n.VERTEX_ATTRIB_ARRAY_INTEGER=35069]="VERTEX_ATTRIB_ARRAY_INTEGER",n[n.VERTEX_ATTRIB_ARRAY_DIVISOR=35070]="VERTEX_ATTRIB_ARRAY_DIVISOR",n[n.TRANSFORM_FEEDBACK_BUFFER_MODE=35967]="TRANSFORM_FEEDBACK_BUFFER_MODE",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS=35968]="MAX_TRANSFORM_FEEDBACK_SEPARATE_COMPONENTS",n[n.TRANSFORM_FEEDBACK_VARYINGS=35971]="TRANSFORM_FEEDBACK_VARYINGS",n[n.TRANSFORM_FEEDBACK_BUFFER_START=35972]="TRANSFORM_FEEDBACK_BUFFER_START",n[n.TRANSFORM_FEEDBACK_BUFFER_SIZE=35973]="TRANSFORM_FEEDBACK_BUFFER_SIZE",n[n.TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN=35976]="TRANSFORM_FEEDBACK_PRIMITIVES_WRITTEN",n[n.MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS=35978]="MAX_TRANSFORM_FEEDBACK_INTERLEAVED_COMPONENTS",n[n.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS=35979]="MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS",n[n.INTERLEAVED_ATTRIBS=35980]="INTERLEAVED_ATTRIBS",n[n.SEPARATE_ATTRIBS=35981]="SEPARATE_ATTRIBS",n[n.TRANSFORM_FEEDBACK_BUFFER=35982]="TRANSFORM_FEEDBACK_BUFFER",n[n.TRANSFORM_FEEDBACK_BUFFER_BINDING=35983]="TRANSFORM_FEEDBACK_BUFFER_BINDING",n[n.TRANSFORM_FEEDBACK=36386]="TRANSFORM_FEEDBACK",n[n.TRANSFORM_FEEDBACK_PAUSED=36387]="TRANSFORM_FEEDBACK_PAUSED",n[n.TRANSFORM_FEEDBACK_ACTIVE=36388]="TRANSFORM_FEEDBACK_ACTIVE",n[n.TRANSFORM_FEEDBACK_BINDING=36389]="TRANSFORM_FEEDBACK_BINDING",n[n.FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING=33296]="FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING",n[n.FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE=33297]="FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE",n[n.FRAMEBUFFER_ATTACHMENT_RED_SIZE=33298]="FRAMEBUFFER_ATTACHMENT_RED_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_GREEN_SIZE=33299]="FRAMEBUFFER_ATTACHMENT_GREEN_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_BLUE_SIZE=33300]="FRAMEBUFFER_ATTACHMENT_BLUE_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE=33301]="FRAMEBUFFER_ATTACHMENT_ALPHA_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE=33302]="FRAMEBUFFER_ATTACHMENT_DEPTH_SIZE",n[n.FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE=33303]="FRAMEBUFFER_ATTACHMENT_STENCIL_SIZE",n[n.FRAMEBUFFER_DEFAULT=33304]="FRAMEBUFFER_DEFAULT",n[n.DEPTH24_STENCIL8=35056]="DEPTH24_STENCIL8",n[n.DRAW_FRAMEBUFFER_BINDING=36006]="DRAW_FRAMEBUFFER_BINDING",n[n.READ_FRAMEBUFFER_BINDING=36010]="READ_FRAMEBUFFER_BINDING",n[n.RENDERBUFFER_SAMPLES=36011]="RENDERBUFFER_SAMPLES",n[n.FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER=36052]="FRAMEBUFFER_ATTACHMENT_TEXTURE_LAYER",n[n.FRAMEBUFFER_INCOMPLETE_MULTISAMPLE=36182]="FRAMEBUFFER_INCOMPLETE_MULTISAMPLE",n[n.UNIFORM_BUFFER=35345]="UNIFORM_BUFFER",n[n.UNIFORM_BUFFER_BINDING=35368]="UNIFORM_BUFFER_BINDING",n[n.UNIFORM_BUFFER_START=35369]="UNIFORM_BUFFER_START",n[n.UNIFORM_BUFFER_SIZE=35370]="UNIFORM_BUFFER_SIZE",n[n.MAX_VERTEX_UNIFORM_BLOCKS=35371]="MAX_VERTEX_UNIFORM_BLOCKS",n[n.MAX_FRAGMENT_UNIFORM_BLOCKS=35373]="MAX_FRAGMENT_UNIFORM_BLOCKS",n[n.MAX_COMBINED_UNIFORM_BLOCKS=35374]="MAX_COMBINED_UNIFORM_BLOCKS",n[n.MAX_UNIFORM_BUFFER_BINDINGS=35375]="MAX_UNIFORM_BUFFER_BINDINGS",n[n.MAX_UNIFORM_BLOCK_SIZE=35376]="MAX_UNIFORM_BLOCK_SIZE",n[n.MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS=35377]="MAX_COMBINED_VERTEX_UNIFORM_COMPONENTS",n[n.MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS=35379]="MAX_COMBINED_FRAGMENT_UNIFORM_COMPONENTS",n[n.UNIFORM_BUFFER_OFFSET_ALIGNMENT=35380]="UNIFORM_BUFFER_OFFSET_ALIGNMENT",n[n.ACTIVE_UNIFORM_BLOCKS=35382]="ACTIVE_UNIFORM_BLOCKS",n[n.UNIFORM_TYPE=35383]="UNIFORM_TYPE",n[n.UNIFORM_SIZE=35384]="UNIFORM_SIZE",n[n.UNIFORM_BLOCK_INDEX=35386]="UNIFORM_BLOCK_INDEX",n[n.UNIFORM_OFFSET=35387]="UNIFORM_OFFSET",n[n.UNIFORM_ARRAY_STRIDE=35388]="UNIFORM_ARRAY_STRIDE",n[n.UNIFORM_MATRIX_STRIDE=35389]="UNIFORM_MATRIX_STRIDE",n[n.UNIFORM_IS_ROW_MAJOR=35390]="UNIFORM_IS_ROW_MAJOR",n[n.UNIFORM_BLOCK_BINDING=35391]="UNIFORM_BLOCK_BINDING",n[n.UNIFORM_BLOCK_DATA_SIZE=35392]="UNIFORM_BLOCK_DATA_SIZE",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORMS=35394]="UNIFORM_BLOCK_ACTIVE_UNIFORMS",n[n.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES=35395]="UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES",n[n.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER=35396]="UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER",n[n.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER=35398]="UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER",n[n.OBJECT_TYPE=37138]="OBJECT_TYPE",n[n.SYNC_CONDITION=37139]="SYNC_CONDITION",n[n.SYNC_STATUS=37140]="SYNC_STATUS",n[n.SYNC_FLAGS=37141]="SYNC_FLAGS",n[n.SYNC_FENCE=37142]="SYNC_FENCE",n[n.SYNC_GPU_COMMANDS_COMPLETE=37143]="SYNC_GPU_COMMANDS_COMPLETE",n[n.UNSIGNALED=37144]="UNSIGNALED",n[n.SIGNALED=37145]="SIGNALED",n[n.ALREADY_SIGNALED=37146]="ALREADY_SIGNALED",n[n.TIMEOUT_EXPIRED=37147]="TIMEOUT_EXPIRED",n[n.CONDITION_SATISFIED=37148]="CONDITION_SATISFIED",n[n.WAIT_FAILED=37149]="WAIT_FAILED",n[n.SYNC_FLUSH_COMMANDS_BIT=1]="SYNC_FLUSH_COMMANDS_BIT",n[n.COLOR=6144]="COLOR",n[n.DEPTH=6145]="DEPTH",n[n.STENCIL=6146]="STENCIL",n[n.MIN=32775]="MIN",n[n.MAX=32776]="MAX",n[n.DEPTH_COMPONENT24=33190]="DEPTH_COMPONENT24",n[n.STREAM_READ=35041]="STREAM_READ",n[n.STREAM_COPY=35042]="STREAM_COPY",n[n.STATIC_READ=35045]="STATIC_READ",n[n.STATIC_COPY=35046]="STATIC_COPY",n[n.DYNAMIC_READ=35049]="DYNAMIC_READ",n[n.DYNAMIC_COPY=35050]="DYNAMIC_COPY",n[n.DEPTH_COMPONENT32F=36012]="DEPTH_COMPONENT32F",n[n.DEPTH32F_STENCIL8=36013]="DEPTH32F_STENCIL8",n[n.INVALID_INDEX=4294967295]="INVALID_INDEX",n[n.TIMEOUT_IGNORED=-1]="TIMEOUT_IGNORED",n[n.MAX_CLIENT_WAIT_TIMEOUT_WEBGL=37447]="MAX_CLIENT_WAIT_TIMEOUT_WEBGL",n[n.UNMASKED_VENDOR_WEBGL=37445]="UNMASKED_VENDOR_WEBGL",n[n.UNMASKED_RENDERER_WEBGL=37446]="UNMASKED_RENDERER_WEBGL",n[n.MAX_TEXTURE_MAX_ANISOTROPY_EXT=34047]="MAX_TEXTURE_MAX_ANISOTROPY_EXT",n[n.TEXTURE_MAX_ANISOTROPY_EXT=34046]="TEXTURE_MAX_ANISOTROPY_EXT",n[n.R16_EXT=33322]="R16_EXT",n[n.RG16_EXT=33324]="RG16_EXT",n[n.RGB16_EXT=32852]="RGB16_EXT",n[n.RGBA16_EXT=32859]="RGBA16_EXT",n[n.R16_SNORM_EXT=36760]="R16_SNORM_EXT",n[n.RG16_SNORM_EXT=36761]="RG16_SNORM_EXT",n[n.RGB16_SNORM_EXT=36762]="RGB16_SNORM_EXT",n[n.RGBA16_SNORM_EXT=36763]="RGBA16_SNORM_EXT",n[n.COMPRESSED_RGB_S3TC_DXT1_EXT=33776]="COMPRESSED_RGB_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777]="COMPRESSED_RGBA_S3TC_DXT1_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778]="COMPRESSED_RGBA_S3TC_DXT3_EXT",n[n.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779]="COMPRESSED_RGBA_S3TC_DXT5_EXT",n[n.COMPRESSED_SRGB_S3TC_DXT1_EXT=35916]="COMPRESSED_SRGB_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT=35917]="COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT=35918]="COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT",n[n.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT=35919]="COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT",n[n.COMPRESSED_RED_RGTC1_EXT=36283]="COMPRESSED_RED_RGTC1_EXT",n[n.COMPRESSED_SIGNED_RED_RGTC1_EXT=36284]="COMPRESSED_SIGNED_RED_RGTC1_EXT",n[n.COMPRESSED_RED_GREEN_RGTC2_EXT=36285]="COMPRESSED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT=36286]="COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT",n[n.COMPRESSED_RGBA_BPTC_UNORM_EXT=36492]="COMPRESSED_RGBA_BPTC_UNORM_EXT",n[n.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT=36493]="COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT",n[n.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT=36494]="COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT",n[n.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT=36495]="COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT",n[n.COMPRESSED_R11_EAC=37488]="COMPRESSED_R11_EAC",n[n.COMPRESSED_SIGNED_R11_EAC=37489]="COMPRESSED_SIGNED_R11_EAC",n[n.COMPRESSED_RG11_EAC=37490]="COMPRESSED_RG11_EAC",n[n.COMPRESSED_SIGNED_RG11_EAC=37491]="COMPRESSED_SIGNED_RG11_EAC",n[n.COMPRESSED_RGB8_ETC2=37492]="COMPRESSED_RGB8_ETC2",n[n.COMPRESSED_RGBA8_ETC2_EAC=37493]="COMPRESSED_RGBA8_ETC2_EAC",n[n.COMPRESSED_SRGB8_ETC2=37494]="COMPRESSED_SRGB8_ETC2",n[n.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC=37495]="COMPRESSED_SRGB8_ALPHA8_ETC2_EAC",n[n.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2=37496]="COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2=37497]="COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2",n[n.COMPRESSED_RGB_PVRTC_4BPPV1_IMG=35840]="COMPRESSED_RGB_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG=35842]="COMPRESSED_RGBA_PVRTC_4BPPV1_IMG",n[n.COMPRESSED_RGB_PVRTC_2BPPV1_IMG=35841]="COMPRESSED_RGB_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG=35843]="COMPRESSED_RGBA_PVRTC_2BPPV1_IMG",n[n.COMPRESSED_RGB_ETC1_WEBGL=36196]="COMPRESSED_RGB_ETC1_WEBGL",n[n.COMPRESSED_RGB_ATC_WEBGL=35986]="COMPRESSED_RGB_ATC_WEBGL",n[n.COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL=35986]="COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL=34798]="COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL",n[n.COMPRESSED_RGBA_ASTC_4x4_KHR=37808]="COMPRESSED_RGBA_ASTC_4x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x4_KHR=37809]="COMPRESSED_RGBA_ASTC_5x4_KHR",n[n.COMPRESSED_RGBA_ASTC_5x5_KHR=37810]="COMPRESSED_RGBA_ASTC_5x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x5_KHR=37811]="COMPRESSED_RGBA_ASTC_6x5_KHR",n[n.COMPRESSED_RGBA_ASTC_6x6_KHR=37812]="COMPRESSED_RGBA_ASTC_6x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x5_KHR=37813]="COMPRESSED_RGBA_ASTC_8x5_KHR",n[n.COMPRESSED_RGBA_ASTC_8x6_KHR=37814]="COMPRESSED_RGBA_ASTC_8x6_KHR",n[n.COMPRESSED_RGBA_ASTC_8x8_KHR=37815]="COMPRESSED_RGBA_ASTC_8x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x5_KHR=37816]="COMPRESSED_RGBA_ASTC_10x5_KHR",n[n.COMPRESSED_RGBA_ASTC_10x6_KHR=37817]="COMPRESSED_RGBA_ASTC_10x6_KHR",n[n.COMPRESSED_RGBA_ASTC_10x8_KHR=37818]="COMPRESSED_RGBA_ASTC_10x8_KHR",n[n.COMPRESSED_RGBA_ASTC_10x10_KHR=37819]="COMPRESSED_RGBA_ASTC_10x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x10_KHR=37820]="COMPRESSED_RGBA_ASTC_12x10_KHR",n[n.COMPRESSED_RGBA_ASTC_12x12_KHR=37821]="COMPRESSED_RGBA_ASTC_12x12_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR=37840]="COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR=37841]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR=37842]="COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR=37843]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR=37844]="COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR=37845]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR=37846]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR=37847]="COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR=37848]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR=37849]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR=37850]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR=37851]="COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR=37852]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR",n[n.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR=37853]="COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR",n[n.QUERY_COUNTER_BITS_EXT=34916]="QUERY_COUNTER_BITS_EXT",n[n.CURRENT_QUERY_EXT=34917]="CURRENT_QUERY_EXT",n[n.QUERY_RESULT_EXT=34918]="QUERY_RESULT_EXT",n[n.QUERY_RESULT_AVAILABLE_EXT=34919]="QUERY_RESULT_AVAILABLE_EXT",n[n.TIME_ELAPSED_EXT=35007]="TIME_ELAPSED_EXT",n[n.TIMESTAMP_EXT=36392]="TIMESTAMP_EXT",n[n.GPU_DISJOINT_EXT=36795]="GPU_DISJOINT_EXT",n[n.COMPLETION_STATUS_KHR=37297]="COMPLETION_STATUS_KHR",n[n.DEPTH_CLAMP_EXT=34383]="DEPTH_CLAMP_EXT",n[n.FIRST_VERTEX_CONVENTION_WEBGL=36429]="FIRST_VERTEX_CONVENTION_WEBGL",n[n.LAST_VERTEX_CONVENTION_WEBGL=36430]="LAST_VERTEX_CONVENTION_WEBGL",n[n.PROVOKING_VERTEX_WEBL=36431]="PROVOKING_VERTEX_WEBL",n[n.POLYGON_MODE_WEBGL=2880]="POLYGON_MODE_WEBGL",n[n.POLYGON_OFFSET_LINE_WEBGL=10754]="POLYGON_OFFSET_LINE_WEBGL",n[n.LINE_WEBGL=6913]="LINE_WEBGL",n[n.FILL_WEBGL=6914]="FILL_WEBGL",n[n.MAX_CLIP_DISTANCES_WEBGL=3378]="MAX_CLIP_DISTANCES_WEBGL",n[n.MAX_CULL_DISTANCES_WEBGL=33529]="MAX_CULL_DISTANCES_WEBGL",n[n.MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL=33530]="MAX_COMBINED_CLIP_AND_CULL_DISTANCES_WEBGL",n[n.CLIP_DISTANCE0_WEBGL=12288]="CLIP_DISTANCE0_WEBGL",n[n.CLIP_DISTANCE1_WEBGL=12289]="CLIP_DISTANCE1_WEBGL",n[n.CLIP_DISTANCE2_WEBGL=12290]="CLIP_DISTANCE2_WEBGL",n[n.CLIP_DISTANCE3_WEBGL=12291]="CLIP_DISTANCE3_WEBGL",n[n.CLIP_DISTANCE4_WEBGL=12292]="CLIP_DISTANCE4_WEBGL",n[n.CLIP_DISTANCE5_WEBGL=12293]="CLIP_DISTANCE5_WEBGL",n[n.CLIP_DISTANCE6_WEBGL=12294]="CLIP_DISTANCE6_WEBGL",n[n.CLIP_DISTANCE7_WEBGL=12295]="CLIP_DISTANCE7_WEBGL",n[n.POLYGON_OFFSET_CLAMP_EXT=36379]="POLYGON_OFFSET_CLAMP_EXT",n[n.LOWER_LEFT_EXT=36001]="LOWER_LEFT_EXT",n[n.UPPER_LEFT_EXT=36002]="UPPER_LEFT_EXT",n[n.NEGATIVE_ONE_TO_ONE_EXT=37726]="NEGATIVE_ONE_TO_ONE_EXT",n[n.ZERO_TO_ONE_EXT=37727]="ZERO_TO_ONE_EXT",n[n.CLIP_ORIGIN_EXT=37724]="CLIP_ORIGIN_EXT",n[n.CLIP_DEPTH_MODE_EXT=37725]="CLIP_DEPTH_MODE_EXT",n[n.SRC1_COLOR_WEBGL=35065]="SRC1_COLOR_WEBGL",n[n.SRC1_ALPHA_WEBGL=34185]="SRC1_ALPHA_WEBGL",n[n.ONE_MINUS_SRC1_COLOR_WEBGL=35066]="ONE_MINUS_SRC1_COLOR_WEBGL",n[n.ONE_MINUS_SRC1_ALPHA_WEBGL=35067]="ONE_MINUS_SRC1_ALPHA_WEBGL",n[n.MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL=35068]="MAX_DUAL_SOURCE_DRAW_BUFFERS_WEBGL",n[n.MIRROR_CLAMP_TO_EDGE_EXT=34627]="MIRROR_CLAMP_TO_EDGE_EXT"})(ua||(ua={}));const sm={3042:!1,32773:new Float32Array([0,0,0,0]),32777:32774,34877:32774,32969:1,32968:0,32971:1,32970:0,3106:new Float32Array([0,0,0,0]),3107:[!0,!0,!0,!0],2884:!1,2885:1029,2929:!1,2931:1,2932:513,2928:new Float32Array([0,1]),2930:!0,3024:!0,35725:null,36006:null,36007:null,34229:null,34964:null,2886:2305,33170:4352,2849:1,32823:!1,32824:0,10752:0,32926:!1,32928:!1,32938:1,32939:!1,3089:!1,3088:new Int32Array([0,0,1024,1024]),2960:!1,2961:0,2968:4294967295,36005:4294967295,2962:519,2967:0,2963:4294967295,34816:519,36003:0,36004:4294967295,2964:7680,2965:7680,2966:7680,34817:7680,34818:7680,34819:7680,2978:[0,0,1024,1024],36389:null,36662:null,36663:null,35053:null,35055:null,35723:4352,36010:null,35977:!1,3333:4,3317:4,37440:!1,37441:!1,37443:37444,3330:0,3332:0,3331:0,3314:0,32878:0,3316:0,3315:0,32877:0},gt=(n,e,t)=>e?n.enable(t):n.disable(t),$T=(n,e,t)=>n.hint(t,e),fn=(n,e,t)=>n.pixelStorei(t,e),WT=(n,e,t)=>{const r=t===36006?36009:36008;return n.bindFramebuffer(r,e)},Wo=(n,e,t)=>{const i={34964:34962,36662:36662,36663:36663,35053:35051,35055:35052}[t];n.bindBuffer(i,e)};function Jp(n){return Array.isArray(n)||ArrayBuffer.isView(n)&&!(n instanceof DataView)}const O5={3042:gt,32773:(n,e)=>n.blendColor(...e),32777:"blendEquation",34877:"blendEquation",32969:"blendFunc",32968:"blendFunc",32971:"blendFunc",32970:"blendFunc",3106:(n,e)=>n.clearColor(...e),3107:(n,e)=>n.colorMask(...e),2884:gt,2885:(n,e)=>n.cullFace(e),2929:gt,2931:(n,e)=>n.clearDepth(e),2932:(n,e)=>n.depthFunc(e),2928:(n,e)=>n.depthRange(...e),2930:(n,e)=>n.depthMask(e),3024:gt,35723:$T,35725:(n,e)=>n.useProgram(e),36007:(n,e)=>n.bindRenderbuffer(36161,e),36389:(n,e)=>{var t;return(t=n.bindTransformFeedback)==null?void 0:t.call(n,36386,e)},34229:(n,e)=>n.bindVertexArray(e),36006:WT,36010:WT,34964:Wo,36662:Wo,36663:Wo,35053:Wo,35055:Wo,2886:(n,e)=>n.frontFace(e),33170:$T,2849:(n,e)=>n.lineWidth(e),32823:gt,32824:"polygonOffset",10752:"polygonOffset",35977:gt,32926:gt,32928:gt,32938:"sampleCoverage",32939:"sampleCoverage",3089:gt,3088:(n,e)=>n.scissor(...e),2960:gt,2961:(n,e)=>n.clearStencil(e),2968:(n,e)=>n.stencilMaskSeparate(1028,e),36005:(n,e)=>n.stencilMaskSeparate(1029,e),2962:"stencilFuncFront",2967:"stencilFuncFront",2963:"stencilFuncFront",34816:"stencilFuncBack",36003:"stencilFuncBack",36004:"stencilFuncBack",2964:"stencilOpFront",2965:"stencilOpFront",2966:"stencilOpFront",34817:"stencilOpBack",34818:"stencilOpBack",34819:"stencilOpBack",2978:(n,e)=>n.viewport(...e),34383:gt,10754:gt,12288:gt,12289:gt,12290:gt,12291:gt,12292:gt,12293:gt,12294:gt,12295:gt,3333:fn,3317:fn,37440:fn,37441:fn,37443:fn,3330:fn,3332:fn,3331:fn,3314:fn,32878:fn,3316:fn,3315:fn,32877:fn,framebuffer:(n,e)=>{const t=e&&"handle"in e?e.handle:e;return n.bindFramebuffer(36160,t)},blend:(n,e)=>e?n.enable(3042):n.disable(3042),blendColor:(n,e)=>n.blendColor(...e),blendEquation:(n,e)=>{const t=typeof e=="number"?[e,e]:e;n.blendEquationSeparate(...t)},blendFunc:(n,e)=>{const t=(e==null?void 0:e.length)===2?[...e,...e]:e;n.blendFuncSeparate(...t)},clearColor:(n,e)=>n.clearColor(...e),clearDepth:(n,e)=>n.clearDepth(e),clearStencil:(n,e)=>n.clearStencil(e),colorMask:(n,e)=>n.colorMask(...e),cull:(n,e)=>e?n.enable(2884):n.disable(2884),cullFace:(n,e)=>n.cullFace(e),depthTest:(n,e)=>e?n.enable(2929):n.disable(2929),depthFunc:(n,e)=>n.depthFunc(e),depthMask:(n,e)=>n.depthMask(e),depthRange:(n,e)=>n.depthRange(...e),dither:(n,e)=>e?n.enable(3024):n.disable(3024),derivativeHint:(n,e)=>{n.hint(35723,e)},frontFace:(n,e)=>n.frontFace(e),mipmapHint:(n,e)=>n.hint(33170,e),lineWidth:(n,e)=>n.lineWidth(e),polygonOffsetFill:(n,e)=>e?n.enable(32823):n.disable(32823),polygonOffset:(n,e)=>n.polygonOffset(...e),sampleCoverage:(n,e)=>n.sampleCoverage(e[0],e[1]||!1),scissorTest:(n,e)=>e?n.enable(3089):n.disable(3089),scissor:(n,e)=>n.scissor(...e),stencilTest:(n,e)=>e?n.enable(2960):n.disable(2960),stencilMask:(n,e)=>{e=Jp(e)?e:[e,e];const[t,r]=e;n.stencilMaskSeparate(1028,t),n.stencilMaskSeparate(1029,r)},stencilFunc:(n,e)=>{e=Jp(e)&&e.length===3?[...e,...e]:e;const[t,r,i,a,l,c]=e;n.stencilFuncSeparate(1028,t,r,i),n.stencilFuncSeparate(1029,a,l,c)},stencilOp:(n,e)=>{e=Jp(e)&&e.length===3?[...e,...e]:e;const[t,r,i,a,l,c]=e;n.stencilOpSeparate(1028,t,r,i),n.stencilOpSeparate(1029,a,l,c)},viewport:(n,e)=>n.viewport(...e)};function lt(n,e,t){return e[n]!==void 0?e[n]:t[n]}const I5={blendEquation:(n,e,t)=>n.blendEquationSeparate(lt(32777,e,t),lt(34877,e,t)),blendFunc:(n,e,t)=>n.blendFuncSeparate(lt(32969,e,t),lt(32968,e,t),lt(32971,e,t),lt(32970,e,t)),polygonOffset:(n,e,t)=>n.polygonOffset(lt(32824,e,t),lt(10752,e,t)),sampleCoverage:(n,e,t)=>n.sampleCoverage(lt(32938,e,t),lt(32939,e,t)),stencilFuncFront:(n,e,t)=>n.stencilFuncSeparate(1028,lt(2962,e,t),lt(2967,e,t),lt(2963,e,t)),stencilFuncBack:(n,e,t)=>n.stencilFuncSeparate(1029,lt(34816,e,t),lt(36003,e,t),lt(36004,e,t)),stencilOpFront:(n,e,t)=>n.stencilOpSeparate(1028,lt(2964,e,t),lt(2965,e,t),lt(2966,e,t)),stencilOpBack:(n,e,t)=>n.stencilOpSeparate(1029,lt(34817,e,t),lt(34818,e,t),lt(34819,e,t))},XT={enable:(n,e)=>n({[e]:!0}),disable:(n,e)=>n({[e]:!1}),pixelStorei:(n,e,t)=>n({[e]:t}),hint:(n,e,t)=>n({[e]:t}),useProgram:(n,e)=>n({35725:e}),bindRenderbuffer:(n,e,t)=>n({36007:t}),bindTransformFeedback:(n,e,t)=>n({36389:t}),bindVertexArray:(n,e)=>n({34229:e}),bindFramebuffer:(n,e,t)=>{switch(e){case 36160:return n({36006:t,36010:t});case 36009:return n({36006:t});case 36008:return n({36010:t});default:return null}},bindBuffer:(n,e,t)=>{const r={34962:[34964],36662:[36662],36663:[36663],35051:[35053],35052:[35055]}[e];return r?n({[r]:t}):{valueChanged:!0}},blendColor:(n,e,t,r,i)=>n({32773:new Float32Array([e,t,r,i])}),blendEquation:(n,e)=>n({32777:e,34877:e}),blendEquationSeparate:(n,e,t)=>n({32777:e,34877:t}),blendFunc:(n,e,t)=>n({32969:e,32968:t,32971:e,32970:t}),blendFuncSeparate:(n,e,t,r,i)=>n({32969:e,32968:t,32971:r,32970:i}),clearColor:(n,e,t,r,i)=>n({3106:new Float32Array([e,t,r,i])}),clearDepth:(n,e)=>n({2931:e}),clearStencil:(n,e)=>n({2961:e}),colorMask:(n,e,t,r,i)=>n({3107:[e,t,r,i]}),cullFace:(n,e)=>n({2885:e}),depthFunc:(n,e)=>n({2932:e}),depthRange:(n,e,t)=>n({2928:new Float32Array([e,t])}),depthMask:(n,e)=>n({2930:e}),frontFace:(n,e)=>n({2886:e}),lineWidth:(n,e)=>n({2849:e}),polygonOffset:(n,e,t)=>n({32824:e,10752:t}),sampleCoverage:(n,e,t)=>n({32938:e,32939:t}),scissor:(n,e,t,r,i)=>n({3088:new Int32Array([e,t,r,i])}),stencilMask:(n,e)=>n({2968:e,36005:e}),stencilMaskSeparate:(n,e,t)=>n({[e===1028?2968:36005]:t}),stencilFunc:(n,e,t,r)=>n({2962:e,2967:t,2963:r,34816:e,36003:t,36004:r}),stencilFuncSeparate:(n,e,t,r,i)=>n({[e===1028?2962:34816]:t,[e===1028?2967:36003]:r,[e===1028?2963:36004]:i}),stencilOp:(n,e,t,r)=>n({2964:e,2965:t,2966:r,34817:e,34818:t,34819:r}),stencilOpSeparate:(n,e,t,r,i)=>n({[e===1028?2964:34817]:t,[e===1028?2965:34818]:r,[e===1028?2966:34819]:i}),viewport:(n,e,t,r,i)=>n({2978:[e,t,r,i]})},Kn=(n,e)=>n.isEnabled(e),YT={3042:Kn,2884:Kn,2929:Kn,3024:Kn,32823:Kn,32926:Kn,32928:Kn,3089:Kn,2960:Kn,35977:Kn},N5=new Set([34016,36388,36387,35983,35368,34965,35739,35738,3074,34853,34854,34855,34856,34857,34858,34859,34860,34861,34862,34863,34864,34865,34866,34867,34868,35097,32873,35869,32874,34068]);function Ua(n,e){if(D5(e))return;const t={};for(const i in e){const a=Number(i),l=O5[i];l&&(typeof l=="string"?t[l]=!0:l(n,e[i],a))}const r=n.state&&n.state.cache;if(r)for(const i in t){const a=I5[i];a(n,e,r)}}function Px(n,e=sm){if(typeof e=="number"){const i=e,a=YT[i];return a?a(n,i):n.getParameter(i)}const t=Array.isArray(e)?e:Object.keys(e),r={};for(const i of t){const a=YT[i];r[i]=a?a(n,Number(i)):n.getParameter(Number(i))}return r}function k5(n){Ua(n,sm)}function D5(n){for(const e in n)return!1;return!0}function P5(n,e){if(n===e)return!0;const t=Array.isArray(n)||ArrayBuffer.isView(n),r=Array.isArray(e)||ArrayBuffer.isView(e);if(t&&r&&n.length===e.length){for(let i=0;i<n.length;++i)if(n[i]!==e[i])return!1;return!0}return!1}class Yi{constructor(e,t){w(this,"gl");w(this,"program",null);w(this,"stateStack",[]);w(this,"enable",!0);w(this,"cache",null);w(this,"log");w(this,"initialized",!1);this.gl=e,this.log=(t==null?void 0:t.log)||(()=>{}),this._updateCache=this._updateCache.bind(this),Object.seal(this)}static get(e){return e.state}push(e={}){this.stateStack.push({})}pop(){const e=this.stateStack[this.stateStack.length-1];Ua(this.gl,e),this.stateStack.pop()}trackState(e,t){if(this.cache=t.copyState?Px(e):Object.assign({},sm),this.initialized)throw new Error("WebGLStateTracker");this.initialized=!0,this.gl.state=this,B5(e);for(const r in XT){const i=XT[r];U5(e,r,i)}qT(e,"getParameter"),qT(e,"isEnabled")}_updateCache(e){let t=!1,r;const i=this.stateStack.length>0?this.stateStack[this.stateStack.length-1]:null;for(const a in e){const l=e[a],c=this.cache[a];P5(l,c)||(t=!0,r=c,i&&!(a in i)&&(i[a]=c),this.cache[a]=l)}return{valueChanged:t,oldValue:r}}}function qT(n,e){const t=n[e].bind(n);n[e]=function(i){if(i===void 0||N5.has(i))return t(i);const a=Yi.get(n);return i in a.cache||(a.cache[i]=t(i)),a.enable?a.cache[i]:t(i)},Object.defineProperty(n[e],"name",{value:`${e}-from-cache`,configurable:!1})}function U5(n,e,t){if(!n[e])return;const r=n[e].bind(n);n[e]=function(...a){const l=Yi.get(n),{valueChanged:c,oldValue:f}=t(l._updateCache,...a);return c&&r(...a),f},Object.defineProperty(n[e],"name",{value:`${e}-to-cache`,configurable:!1})}function B5(n){const e=n.useProgram.bind(n);n.useProgram=function(r){const i=Yi.get(n);i.program!==r&&(e(r),i.program=r)}}function F5(n,e,t){let r="";const i={preserveDrawingBuffer:!0,...t};let a=null;if(a||(a=n.getContext("webgl2",i)),i.failIfMajorPerformanceCaveat&&(r||(r="Only software GPU is available. Set `failIfMajorPerformanceCaveat: false` to allow.")),!a&&!t.failIfMajorPerformanceCaveat&&(i.failIfMajorPerformanceCaveat=!1,a=n.getContext("webgl2",i),a.luma||(a.luma={}),a.luma.softwareRenderer=!0),a||(a=n.getContext("webgl",{}),a&&(a=null,r||(r="Your browser only supports WebGL1"))),!a)throw r||(r="Your browser does not support WebGL"),new Error(`Failed to create WebGL context: ${r}`);const{onContextLost:l,onContextRestored:c}=e;return n.addEventListener("webglcontextlost",f=>l(f),!1),n.addEventListener("webglcontextrestored",f=>c(f),!1),a.luma||(a.luma={}),a}function Da(n,e,t){return t[e]===void 0&&(t[e]=n.getExtension(e)||null),t[e]}function L5(n,e){const t=n.getParameter(7936),r=n.getParameter(7937);Da(n,"WEBGL_debug_renderer_info",e);const i=e.WEBGL_debug_renderer_info,a=n.getParameter(i?i.UNMASKED_VENDOR_WEBGL:7936),l=n.getParameter(i?i.UNMASKED_RENDERER_WEBGL:7937),c=a||t,f=l||r,d=n.getParameter(7938),p=Ux(c,f),_=z5(c,f),y=V5(c,f);return{type:"webgl",gpu:p,gpuType:y,gpuBackend:_,vendor:c,renderer:f,version:d,shadingLanguage:"glsl",shadingLanguageVersion:300}}function Ux(n,e){return/NVIDIA/i.exec(n)||/NVIDIA/i.exec(e)?"nvidia":/INTEL/i.exec(n)||/INTEL/i.exec(e)?"intel":/Apple/i.exec(n)||/Apple/i.exec(e)?"apple":/AMD/i.exec(n)||/AMD/i.exec(e)||/ATI/i.exec(n)||/ATI/i.exec(e)?"amd":/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e)?"software":"unknown"}function z5(n,e){return/Metal/i.exec(n)||/Metal/i.exec(e)?"metal":/ANGLE/i.exec(n)||/ANGLE/i.exec(e)?"opengl":"unknown"}function V5(n,e){if(/SwiftShader/i.exec(n)||/SwiftShader/i.exec(e))return"cpu";switch(Ux(n,e)){case"intel":return"integrated";case"software":return"cpu";case"unknown":return"unknown";default:return"discrete"}}function Bx(n){switch(n){case"uint8":return 5121;case"sint8":return 5120;case"unorm8":return 5121;case"snorm8":return 5120;case"uint16":return 5123;case"sint16":return 5122;case"unorm16":return 5123;case"snorm16":return 5122;case"uint32":return 5125;case"sint32":return 5124;case"float16":return 5131;case"float32":return 5126}throw new Error(String(n))}const rl="WEBGL_compressed_texture_s3tc",il="WEBGL_compressed_texture_s3tc_srgb",fa="EXT_texture_compression_rgtc",ha="EXT_texture_compression_bptc",H5="WEBGL_compressed_texture_etc",j5="WEBGL_compressed_texture_astc",$5="WEBGL_compressed_texture_etc1",W5="WEBGL_compressed_texture_pvrtc",X5="WEBGL_compressed_texture_atc",KT="EXT_texture_norm16",ZT="EXT_render_snorm",Y5="EXT_color_buffer_float",am={"float32-renderable-webgl":["EXT_color_buffer_float"],"float16-renderable-webgl":["EXT_color_buffer_half_float"],"rgb9e5ufloat-renderable-webgl":["WEBGL_render_shared_exponent"],"snorm8-renderable-webgl":[ZT],"norm16-renderable-webgl":[KT],"snorm16-renderable-webgl":[KT,ZT],"float32-filterable":["OES_texture_float_linear"],"float16-filterable-webgl":["OES_texture_half_float_linear"],"texture-filterable-anisotropic-webgl":["EXT_texture_filter_anisotropic"],"texture-blend-float-webgl":["EXT_float_blend"],"texture-compression-bc":[rl,il,fa,ha],"texture-compression-bc5-webgl":[fa],"texture-compression-bc7-webgl":[ha],"texture-compression-etc2":[H5],"texture-compression-astc":[j5],"texture-compression-etc1-webgl":[$5],"texture-compression-pvrtc-webgl":[W5],"texture-compression-atc-webgl":[X5]};function q5(n){return n in am}function K5(n,e,t){return(am[e]||[]).every(i=>Da(n,i,t))}const om={r8unorm:{gl:33321,rb:!0},r8snorm:{gl:36756},r8uint:{gl:33330,rb:!0},r8sint:{gl:33329,rb:!0},rg8unorm:{gl:33323,rb:!0},rg8snorm:{gl:36757},rg8uint:{gl:33336,rb:!0},rg8sint:{gl:33335,rb:!0},r16uint:{gl:33332,rb:!0},r16sint:{gl:33331,rb:!0},r16float:{gl:33325,rb:!0},"r16unorm-webgl":{gl:33322,rb:!0},"r16snorm-webgl":{gl:36760},"rgba4unorm-webgl":{gl:32854,rb:!0},"rgb565unorm-webgl":{gl:36194,rb:!0},"rgb5a1unorm-webgl":{gl:32855,rb:!0},"rgb8unorm-webgl":{gl:32849},"rgb8snorm-webgl":{gl:36758},rgba8unorm:{gl:32856},"rgba8unorm-srgb":{gl:35907},rgba8snorm:{gl:36759},rgba8uint:{gl:36220},rgba8sint:{gl:36238},bgra8unorm:{},"bgra8unorm-srgb":{},rg16uint:{gl:33338},rg16sint:{gl:33337},rg16float:{gl:33327,rb:!0},"rg16unorm-webgl":{gl:33324},"rg16snorm-webgl":{gl:36761},r32uint:{gl:33334,rb:!0},r32sint:{gl:33333,rb:!0},r32float:{gl:33326},rgb9e5ufloat:{gl:35901},rg11b10ufloat:{gl:35898,rb:!0},rgb10a2unorm:{gl:32857,rb:!0},"rgb10a2uint-webgl":{gl:36975,rb:!0},"rgb16unorm-webgl":{gl:32852},"rgb16snorm-webgl":{gl:36762},rg32uint:{gl:33340,rb:!0},rg32sint:{gl:33339,rb:!0},rg32float:{gl:33328,rb:!0},rgba16uint:{gl:36214,rb:!0},rgba16sint:{gl:36232,rb:!0},rgba16float:{gl:34842},"rgba16unorm-webgl":{gl:32859,rb:!0},"rgba16snorm-webgl":{gl:36763},"rgb32float-webgl":{gl:34837,x:Y5,dataFormat:6407,types:[5126]},rgba32uint:{gl:36208,rb:!0},rgba32sint:{gl:36226,rb:!0},rgba32float:{gl:34836,rb:!0},stencil8:{gl:36168,rb:!0},depth16unorm:{gl:33189,dataFormat:6402,types:[5123],rb:!0},depth24plus:{gl:33190,dataFormat:6402,types:[5125]},depth32float:{gl:36012,dataFormat:6402,types:[5126],rb:!0},"depth24plus-stencil8":{gl:35056,rb:!0,depthTexture:!0,dataFormat:34041,types:[34042]},"depth32float-stencil8":{gl:36013,dataFormat:34041,types:[36269],rb:!0},"bc1-rgb-unorm-webgl":{gl:33776,x:rl},"bc1-rgb-unorm-srgb-webgl":{gl:35916,x:il},"bc1-rgba-unorm":{gl:33777,x:rl},"bc1-rgba-unorm-srgb":{gl:35916,x:il},"bc2-rgba-unorm":{gl:33778,x:rl},"bc2-rgba-unorm-srgb":{gl:35918,x:il},"bc3-rgba-unorm":{gl:33779,x:rl},"bc3-rgba-unorm-srgb":{gl:35919,x:il},"bc4-r-unorm":{gl:36283,x:fa},"bc4-r-snorm":{gl:36284,x:fa},"bc5-rg-unorm":{gl:36285,x:fa},"bc5-rg-snorm":{gl:36286,x:fa},"bc6h-rgb-ufloat":{gl:36495,x:ha},"bc6h-rgb-float":{gl:36494,x:ha},"bc7-rgba-unorm":{gl:36492,x:ha},"bc7-rgba-unorm-srgb":{gl:36493,x:ha},"etc2-rgb8unorm":{gl:37492},"etc2-rgb8unorm-srgb":{gl:37494},"etc2-rgb8a1unorm":{gl:37496},"etc2-rgb8a1unorm-srgb":{gl:37497},"etc2-rgba8unorm":{gl:37493},"etc2-rgba8unorm-srgb":{gl:37495},"eac-r11unorm":{gl:37488},"eac-r11snorm":{gl:37489},"eac-rg11unorm":{gl:37490},"eac-rg11snorm":{gl:37491},"astc-4x4-unorm":{gl:37808},"astc-4x4-unorm-srgb":{gl:37840},"astc-5x4-unorm":{gl:37809},"astc-5x4-unorm-srgb":{gl:37841},"astc-5x5-unorm":{gl:37810},"astc-5x5-unorm-srgb":{gl:37842},"astc-6x5-unorm":{gl:37811},"astc-6x5-unorm-srgb":{gl:37843},"astc-6x6-unorm":{gl:37812},"astc-6x6-unorm-srgb":{gl:37844},"astc-8x5-unorm":{gl:37813},"astc-8x5-unorm-srgb":{gl:37845},"astc-8x6-unorm":{gl:37814},"astc-8x6-unorm-srgb":{gl:37846},"astc-8x8-unorm":{gl:37815},"astc-8x8-unorm-srgb":{gl:37847},"astc-10x5-unorm":{gl:37819},"astc-10x5-unorm-srgb":{gl:37851},"astc-10x6-unorm":{gl:37817},"astc-10x6-unorm-srgb":{gl:37849},"astc-10x8-unorm":{gl:37818},"astc-10x8-unorm-srgb":{gl:37850},"astc-10x10-unorm":{gl:37819},"astc-10x10-unorm-srgb":{gl:37851},"astc-12x10-unorm":{gl:37820},"astc-12x10-unorm-srgb":{gl:37852},"astc-12x12-unorm":{gl:37821},"astc-12x12-unorm-srgb":{gl:37853},"pvrtc-rgb4unorm-webgl":{gl:35840},"pvrtc-rgba4unorm-webgl":{gl:35842},"pvrtc-rbg2unorm-webgl":{gl:35841},"pvrtc-rgba2unorm-webgl":{gl:35843},"etc1-rbg-unorm-webgl":{gl:36196},"atc-rgb-unorm-webgl":{gl:35986},"atc-rgba-unorm-webgl":{gl:35986},"atc-rgbai-unorm-webgl":{gl:34798}};function Z5(n,e,t){let r=e.create;const i=om[e.format];return(i==null?void 0:i.gl)===void 0&&(r=!1),i!=null&&i.x&&(r=r&&!!Da(n,i.x,t)),{format:e.format,create:r&&e.create,render:r&&e.render,filter:r&&e.filter,blend:r&&e.blend,store:r&&e.store}}function Fx(n){var i;const e=om[n],t=J5(n),r=W_(n);return{internalFormat:t,format:(e==null?void 0:e.dataFormat)||G5(r.channels,r.integer,r.normalized,t),type:r.dataType?Bx(r.dataType):((i=e==null?void 0:e.types)==null?void 0:i[0])||5121,compressed:r.compressed||!1}}function Q5(n){switch(W_(n).attachment){case"depth":return 36096;case"stencil":return 36128;case"depth-stencil":return 33306;default:throw new Error(`Not a depth stencil format: ${n}`)}}function G5(n,e,t,r){if(r===6408||r===6407)return r;switch(n){case"r":return e&&!t?36244:6403;case"rg":return e&&!t?33320:33319;case"rgb":return e&&!t?36248:6407;case"rgba":return e&&!t?36249:6408;case"bgra":throw new Error("bgra pixels not supported by WebGL");default:return 6408}}function J5(n){const e=om[n],t=e==null?void 0:e.gl;if(t===void 0)throw new Error(`Unsupported texture format ${n}`);return t}const QT={"depth-clip-control":"EXT_depth_clamp","timer-query-webgl":"EXT_disjoint_timer_query_webgl2","compilation-status-async-webgl":"KHR_parallel_shader_compile","polygon-mode-webgl":"WEBGL_polygon_mode","provoking-vertex-webgl":"WEBGL_provoking_vertex","shader-clip-cull-distance-webgl":"WEBGL_clip_cull_distance","shader-noperspective-interpolation-webgl":"NV_shader_noperspective_interpolation","shader-conservative-depth-webgl":"EXT_conservative_depth"};class eL extends BP{constructor(t,r,i){super([],i);w(this,"gl");w(this,"extensions");w(this,"testedFeatures",new Set);this.gl=t,this.extensions=r,Da(t,"EXT_color_buffer_float",r)}*[Symbol.iterator](){const t=this.getFeatures();for(const r of t)this.has(r)&&(yield r);return[]}has(t){var r;return(r=this.disabledFeatures)!=null&&r[t]?!1:(this.testedFeatures.has(t)||(this.testedFeatures.add(t),q5(t)&&K5(this.gl,t,this.extensions)&&this.features.add(t),this.getWebGLFeature(t)&&this.features.add(t)),this.features.has(t))}initializeFeatures(){const t=this.getFeatures().filter(r=>r!=="polygon-mode-webgl");for(const r of t)this.has(r)}getFeatures(){return[...Object.keys(QT),...Object.keys(am)]}getWebGLFeature(t){const r=QT[t];return typeof r=="string"?!!Da(this.gl,r,this.extensions):!!r}}class tL extends UP{constructor(t){super();w(this,"gl");w(this,"limits",{});this.gl=t}get maxTextureDimension1D(){return 0}get maxTextureDimension2D(){return this.getParameter(3379)}get maxTextureDimension3D(){return this.getParameter(32883)}get maxTextureArrayLayers(){return this.getParameter(35071)}get maxBindGroups(){return 0}get maxDynamicUniformBuffersPerPipelineLayout(){return 0}get maxDynamicStorageBuffersPerPipelineLayout(){return 0}get maxSampledTexturesPerShaderStage(){return this.getParameter(35660)}get maxSamplersPerShaderStage(){return this.getParameter(35661)}get maxStorageBuffersPerShaderStage(){return 0}get maxStorageTexturesPerShaderStage(){return 0}get maxUniformBuffersPerShaderStage(){return this.getParameter(35375)}get maxUniformBufferBindingSize(){return this.getParameter(35376)}get maxStorageBufferBindingSize(){return 0}get minUniformBufferOffsetAlignment(){return this.getParameter(35380)}get minStorageBufferOffsetAlignment(){return 0}get maxVertexBuffers(){return 16}get maxVertexAttributes(){return this.getParameter(34921)}get maxVertexBufferArrayStride(){return 2048}get maxInterStageShaderComponents(){return this.getParameter(35659)}get maxComputeWorkgroupStorageSize(){return 0}get maxComputeInvocationsPerWorkgroup(){return 0}get maxComputeWorkgroupSizeX(){return 0}get maxComputeWorkgroupSizeY(){return 0}get maxComputeWorkgroupSizeZ(){return 0}get maxComputeWorkgroupsPerDimension(){return 0}getParameter(t){return this.limits[t]===void 0&&(this.limits[t]=this.gl.getParameter(t)),this.limits[t]||0}}class cl extends nf{constructor(t,r){super(t,r);w(this,"device");w(this,"gl");w(this,"handle");w(this,"colorAttachments",[]);w(this,"depthStencilAttachment",null);const i=r.handle===null;this.device=t,this.gl=t.gl,this.handle=this.props.handle||i?this.props.handle:this.gl.createFramebuffer(),i||(t.setSpectorMetadata(this.handle,{id:this.props.id,props:this.props}),this.autoCreateAttachmentTextures(),this.updateAttachments())}destroy(){super.destroy(),!this.destroyed&&this.handle!==null&&this.gl.deleteFramebuffer(this.handle)}updateAttachments(){const t=this.gl.bindFramebuffer(36160,this.handle);for(let r=0;r<this.colorAttachments.length;++r){const i=this.colorAttachments[r];if(i){const a=36064+r;this._attachTextureView(a,i)}}if(this.depthStencilAttachment){const r=Q5(this.depthStencilAttachment.props.format);this._attachTextureView(r,this.depthStencilAttachment)}if(this.device.props.debug){const r=this.gl.checkFramebufferStatus(36160);if(r!==36053)throw new Error(`Framebuffer ${rL(r)}`)}this.gl.bindFramebuffer(36160,t)}_attachTextureView(t,r){const{gl:i}=this.device,{texture:a}=r,l=r.props.baseMipLevel,c=r.props.baseArrayLayer;switch(i.bindTexture(a.glTarget,a.handle),a.glTarget){case 35866:case 32879:i.framebufferTextureLayer(36160,t,a.handle,l,c);break;case 34067:const f=nL(c);i.framebufferTexture2D(36160,t,f,a.handle,l);break;case 3553:i.framebufferTexture2D(36160,t,3553,a.handle,l);break;default:throw new Error("Illegal texture type")}i.bindTexture(a.glTarget,null)}}function nL(n){return n<34069?n+34069:n}function rL(n){switch(n){case 36053:return"success";case 36054:return"Mismatched attachments";case 36055:return"No attachments";case 36057:return"Height/width mismatch";case 36061:return"Unsupported or split attachments";case 36182:return"Samples mismatch";default:return`${n}`}}class iL extends Lg{constructor(t,r){super(r);w(this,"device");w(this,"format","rgba8unorm");w(this,"depthStencilFormat","depth24plus");w(this,"presentationSize");w(this,"_framebuffer",null);this.device=t,this.presentationSize=[-1,-1],this._setAutoCreatedCanvasId(`${this.device.id}-canvas`),this.update()}get[Symbol.toStringTag](){return"WebGLCanvasContext"}getCurrentFramebuffer(){return this.update(),this._framebuffer=this._framebuffer||new cl(this.device,{handle:null}),this._framebuffer}update(){const t=this.getPixelSize();(t[0]!==this.presentationSize[0]||t[1]!==this.presentationSize[1])&&(this.presentationSize=t,this.resize())}resize(t){if(this.device.gl&&this.canvas){const r=this.getDevicePixelRatio(t==null?void 0:t.useDevicePixels);this.setDevicePixelRatio(r,t);return}}commit(){}}async function Lx(n,e){const t=document.getElementsByTagName("head")[0];if(!t)throw new Error("loadScript");const r=document.createElement("script");return r.setAttribute("type","text/javascript"),r.setAttribute("src",n),new Promise((i,a)=>{r.onload=i,r.onerror=l=>a(new Error(`Unable to load script '${n}': ${l}`)),t.appendChild(r)})}const sL=1;let Ge=null,GT=!1;const lm={debugSpectorJS:le.get("debug-spectorjs"),debugSpectorJSUrl:"https://cdn.jsdelivr.net/npm/spectorjs@0.9.30/dist/spector.bundle.js",gl:void 0};async function aL(n){if(!globalThis.SPECTOR)try{await Lx(n.debugSpectorJSUrl||lm.debugSpectorJSUrl)}catch(e){le.warn(String(e))}}function oL(n){var e;if(n={...lm,...n},!n.debugSpectorJS)return null;if(!Ge&&globalThis.SPECTOR&&!((e=globalThis.luma)!=null&&e.spector)){le.probe(sL,"SPECTOR found and initialized. Start with `luma.spector.displayUI()`")();const{Spector:t}=globalThis.SPECTOR;Ge=new t,globalThis.luma&&(globalThis.luma.spector=Ge)}if(!Ge)return null;if(GT||(GT=!0,Ge.spyCanvases(),Ge==null||Ge.onCaptureStarted.add(t=>le.info("Spector capture started:",t)()),Ge==null||Ge.onCapture.add(t=>{le.info("Spector capture complete:",t)(),Ge==null||Ge.getResultUI(),Ge==null||Ge.resultView.display(),Ge==null||Ge.resultView.addCapture(t)})),n.gl){const t=n.gl,r=t.device;Ge==null||Ge.startCapture(n.gl,500),t.device=r,new Promise(i=>setTimeout(i,2e3)).then(i=>{le.info("Spector capture stopped after 2 seconds")(),Ge==null||Ge.stopCapture()})}return Ge}const lL="https://unpkg.com/webgl-debug@2.0.1/index.js";function zx(n){return n.luma=n.luma||{},n.luma}async function cL(){as()&&!globalThis.WebGLDebugUtils&&(globalThis.global=globalThis.global||globalThis,globalThis.global.module={},await Lx(lL))}function uL(n,e={}){return e.debugWebGL||e.traceWebGL?hL(n,e):fL(n)}function fL(n){const e=zx(n);return e.realContext?e.realContext:n}function hL(n,e){if(!globalThis.WebGLDebugUtils)return le.warn("webgl-debug not loaded")(),n;const t=zx(n);if(t.debugContext)return t.debugContext;globalThis.WebGLDebugUtils.init({...ua,...n});const r=globalThis.WebGLDebugUtils.makeDebugContext(n,dL.bind(null,e),pL.bind(null,e));for(const l in ua)!(l in r)&&typeof ua[l]=="number"&&(r[l]=ua[l]);class i{}Object.setPrototypeOf(r,Object.getPrototypeOf(n)),Object.setPrototypeOf(i,r);const a=Object.create(i);return t.realContext=n,t.debugContext=a,a.debug=!0,a}function JT(n,e){e=Array.from(e).map(r=>r===void 0?"undefined":r);let t=globalThis.WebGLDebugUtils.glFunctionArgsToString(n,e);return t=`${t.slice(0,100)}${t.length>100?"...":""}`,`gl.${n}(${t})`}function dL(n,e,t,r){r=Array.from(r).map(c=>c===void 0?"undefined":c);const i=globalThis.WebGLDebugUtils.glEnumToString(e),a=globalThis.WebGLDebugUtils.glFunctionArgsToString(t,r),l=`${i} in gl.${t}(${a})`;le.error(l)();debugger}function pL(n,e,t){let r="";le.level>=1&&(r=JT(e,t),n.traceWebGL&&le.log(1,r)());for(const i of t)if(i===void 0){r=r||JT(e,t);debugger}}const eg={};function gL(n="id"){eg[n]=eg[n]||1;const e=eg[n]++;return`${n}-${e}`}class ul extends rt{constructor(t,r={}){super(t,r);w(this,"device");w(this,"gl");w(this,"handle");w(this,"glTarget");w(this,"glUsage");w(this,"glIndexType",5123);w(this,"byteLength");w(this,"bytesUsed");this.device=t,this.gl=this.device.gl;const i=typeof r=="object"?r.handle:void 0;this.handle=i||this.gl.createBuffer(),t.setSpectorMetadata(this.handle,{...this.props,data:typeof this.props.data}),this.glTarget=_L(this.props.usage),this.glUsage=mL(this.props.usage),this.glIndexType=this.props.indexType==="uint32"?5125:5123,r.data?this._initWithData(r.data,r.byteOffset,r.byteLength):this._initWithByteLength(r.byteLength||0)}_initWithData(t,r=0,i=t.byteLength+r){const a=this.glTarget;this.gl.bindBuffer(a,this.handle),this.gl.bufferData(a,i,this.glUsage),this.gl.bufferSubData(a,r,t),this.gl.bindBuffer(a,null),this.bytesUsed=i,this.byteLength=i,this._setDebugData(t,r,i),this.trackAllocatedMemory(i)}_initWithByteLength(t){let r=t;t===0&&(r=new Float32Array(0));const i=this.glTarget;return this.gl.bindBuffer(i,this.handle),this.gl.bufferData(i,r,this.glUsage),this.gl.bindBuffer(i,null),this.bytesUsed=t,this.byteLength=t,this._setDebugData(null,0,t),this.trackAllocatedMemory(t),this}destroy(){!this.destroyed&&this.handle&&(this.removeStats(),this.trackDeallocatedMemory(),this.gl.deleteBuffer(this.handle),this.destroyed=!0,this.handle=null)}write(t,r=0){this.gl.bindBuffer(36663,this.handle),this.gl.bufferSubData(36663,r,t),this.gl.bindBuffer(36663,null),this._setDebugData(t,r,t.byteLength)}async readAsync(t=0,r){return this.readSyncWebGL(t,r)}readSyncWebGL(t=0,r){r=r??this.byteLength-t;const i=new Uint8Array(r),a=0;return this.gl.bindBuffer(36662,this.handle),this.gl.getBufferSubData(36662,t,i,a,r),this.gl.bindBuffer(36662,null),this._setDebugData(i,t,r),i}}function _L(n){return n&rt.INDEX?34963:n&rt.VERTEX?34962:n&rt.UNIFORM?35345:34962}function mL(n){return n&rt.INDEX||n&rt.VERTEX?35044:n&rt.UNIFORM?35048:35044}function yL(n){const e=n.split(/\r?\n/),t=[];for(const r of e){if(r.length<=1)continue;const i=r.split(":");if(i.length===2){const[_,y]=i;t.push({message:y.trim(),type:e2(_),lineNum:0,linePos:0});continue}const[a,l,c,...f]=i;let d=parseInt(c,10);isNaN(d)&&(d=0);let p=parseInt(l,10);isNaN(p)&&(p=0),t.push({message:f.join(":").trim(),type:e2(a),lineNum:d,linePos:p})}return t}function e2(n){const e=["warning","error","info"],t=n.toLowerCase();return e.includes(t)?t:"info"}class bL extends ef{constructor(t,r){super(t,r);w(this,"device");w(this,"handle");switch(this.device=t,this.props.stage){case"vertex":this.handle=this.props.handle||this.device.gl.createShader(35633);break;case"fragment":this.handle=this.props.handle||this.device.gl.createShader(35632);break;default:throw new Error(this.props.stage)}this._compile(this.source)}destroy(){this.handle&&(this.removeStats(),this.device.gl.deleteShader(this.handle),this.destroyed=!0)}get asyncCompilationStatus(){return this._waitForCompilationComplete().then(()=>this.compilationStatus)}async getCompilationInfo(){return await this._waitForCompilationComplete(),this.getCompilationInfoSync()}getCompilationInfoSync(){const t=this.device.gl.getShaderInfoLog(this.handle);return t?yL(t):[]}getTranslatedSource(){const r=this.device.getExtension("WEBGL_debug_shaders").WEBGL_debug_shaders;return(r==null?void 0:r.getTranslatedShaderSource(this.handle))||null}async _compile(t){t=t.startsWith("#version ")?t:`#version 300 es
${t}`;const{gl:r}=this.device;if(r.shaderSource(this.handle,t),r.compileShader(this.handle),!this.device.props.debug){this.compilationStatus="pending";return}if(!this.device.features.has("compilation-status-async-webgl")){if(this._getCompilationStatus(),this.debugShader(),this.compilationStatus==="error")throw new Error(`GLSL compilation errors in ${this.props.stage} shader ${this.props.id}`);return}le.once(1,"Shader compilation is asynchronous")(),await this._waitForCompilationComplete(),le.info(2,`Shader ${this.id} - async compilation complete: ${this.compilationStatus}`)(),this._getCompilationStatus(),this.debugShader()}async _waitForCompilationComplete(){const t=async a=>await new Promise(l=>setTimeout(l,a));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:i}=this.device;for(;;){if(i.getShaderParameter(this.handle,37297))return;await t(10)}}_getCompilationStatus(){this.compilationStatus=this.device.gl.getShaderParameter(this.handle,35713)?"success":"error"}}function vL(n,e,t,r){if(SL(e))return r(n);const i=n;i.pushState();try{return TL(n,e),Ua(i.gl,t),r(n)}finally{i.popState()}}function TL(n,e){const t=n,{gl:r}=t;if(e.cullMode)switch(e.cullMode){case"none":r.disable(2884);break;case"front":r.enable(2884),r.cullFace(1028);break;case"back":r.enable(2884),r.cullFace(1029);break}if(e.frontFace&&r.frontFace(qi("frontFace",e.frontFace,{ccw:2305,cw:2304})),e.unclippedDepth&&n.features.has("depth-clip-control")&&r.enable(34383),e.depthBias!==void 0&&(r.enable(32823),r.polygonOffset(e.depthBias,e.depthBiasSlopeScale||0)),e.provokingVertex&&n.features.has("provoking-vertex-webgl")){const a=t.getExtension("WEBGL_provoking_vertex").WEBGL_provoking_vertex,l=qi("provokingVertex",e.provokingVertex,{first:36429,last:36430});a==null||a.provokingVertexWEBGL(l)}if((e.polygonMode||e.polygonOffsetLine)&&n.features.has("polygon-mode-webgl")){if(e.polygonMode){const a=t.getExtension("WEBGL_polygon_mode").WEBGL_polygon_mode,l=qi("polygonMode",e.polygonMode,{fill:6914,line:6913});a==null||a.polygonModeWEBGL(1028,l),a==null||a.polygonModeWEBGL(1029,l)}e.polygonOffsetLine&&r.enable(10754)}if(n.features.has("shader-clip-cull-distance-webgl")&&(e.clipDistance0&&r.enable(12288),e.clipDistance1&&r.enable(12289),e.clipDistance2&&r.enable(12290),e.clipDistance3&&r.enable(12291),e.clipDistance4&&r.enable(12292),e.clipDistance5&&r.enable(12293),e.clipDistance6&&r.enable(12294),e.clipDistance7&&r.enable(12295)),e.depthWriteEnabled!==void 0&&r.depthMask(xL("depthWriteEnabled",e.depthWriteEnabled)),e.depthCompare&&(e.depthCompare!=="always"?r.enable(2929):r.disable(2929),r.depthFunc(u_("depthCompare",e.depthCompare))),e.stencilWriteMask){const i=e.stencilWriteMask;r.stencilMaskSeparate(1028,i),r.stencilMaskSeparate(1029,i)}if(e.stencilReadMask&&le.warn("stencilReadMask not supported under WebGL"),e.stencilCompare){const i=e.stencilReadMask||4294967295,a=u_("depthCompare",e.stencilCompare);e.stencilCompare!=="always"?r.enable(2960):r.disable(2960),r.stencilFuncSeparate(1028,a,0,i),r.stencilFuncSeparate(1029,a,0,i)}if(e.stencilPassOperation&&e.stencilFailOperation&&e.stencilDepthFailOperation){const i=tg("stencilPassOperation",e.stencilPassOperation),a=tg("stencilFailOperation",e.stencilFailOperation),l=tg("stencilDepthFailOperation",e.stencilDepthFailOperation);r.stencilOpSeparate(1028,a,l,i),r.stencilOpSeparate(1029,a,l,i)}switch(e.blend){case!0:r.enable(3042);break;case!1:r.disable(3042);break}if(e.blendColorOperation||e.blendAlphaOperation){const i=t2("blendColorOperation",e.blendColorOperation||"add"),a=t2("blendAlphaOperation",e.blendAlphaOperation||"add");r.blendEquationSeparate(i,a);const l=pu("blendColorSrcFactor",e.blendColorSrcFactor||"one"),c=pu("blendColorDstFactor",e.blendColorDstFactor||"zero"),f=pu("blendAlphaSrcFactor",e.blendAlphaSrcFactor||"one"),d=pu("blendAlphaDstFactor",e.blendAlphaDstFactor||"zero");r.blendFuncSeparate(l,c,f,d)}}function u_(n,e){return qi(n,e,{never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519})}function tg(n,e){return qi(n,e,{keep:7680,zero:0,replace:7681,invert:5386,"increment-clamp":7682,"decrement-clamp":7683,"increment-wrap":34055,"decrement-wrap":34056})}function t2(n,e){return qi(n,e,{add:32774,subtract:32778,"reverse-subtract":32779,min:32775,max:32776})}function pu(n,e){return qi(n,e,{one:1,zero:0,"src-color":768,"one-minus-src-color":769,"dst-color":774,"one-minus-dst-color":775,"src-alpha":770,"one-minus-src-alpha":771,"dst-alpha":772,"one-minus-dst-alpha":773,"src-alpha-saturated":776,"constant-color":32769,"one-minus-constant-color":32770,"constant-alpha":32771,"one-minus-constant-alpha":32772})}function wL(n,e){return`Illegal parameter ${e} for ${n}`}function qi(n,e,t){if(!(e in t))throw new Error(wL(n,e));return t[e]}function xL(n,e){return e}function SL(n){let e=!0;for(const t in n){e=!1;break}return e}function Vx(n){const e={};return n.addressModeU&&(e[10242]=ng(n.addressModeU)),n.addressModeV&&(e[10243]=ng(n.addressModeV)),n.addressModeW&&(e[32882]=ng(n.addressModeW)),n.magFilter&&(e[10240]=f_(n.magFilter)),(n.minFilter||n.mipmapFilter)&&(e[10241]=AL(n.minFilter||"linear",n.mipmapFilter)),n.lodMinClamp!==void 0&&(e[33082]=n.lodMinClamp),n.lodMaxClamp!==void 0&&(e[33083]=n.lodMaxClamp),n.type==="comparison-sampler"&&(e[34892]=34894),n.compare&&(e[34893]=u_("compare",n.compare)),n.maxAnisotropy&&(e[34046]=n.maxAnisotropy),e}function ng(n){switch(n){case"clamp-to-edge":return 33071;case"repeat":return 10497;case"mirror-repeat":return 33648}}function f_(n){switch(n){case"nearest":return 9728;case"linear":return 9729}}function AL(n,e="none"){if(!e)return f_(n);switch(e){case"none":return f_(n);case"nearest":return n==="nearest"?9984:9986;case"linear":return n==="nearest"?9985:9987}}class h_ extends tf{constructor(t,r){super(t,r);w(this,"device");w(this,"handle");w(this,"parameters");this.device=t,this.parameters=Vx(r),this.handle=this.handle||this.device.gl.createSampler(),this._setSamplerParameters(this.parameters)}destroy(){this.handle&&(this.device.gl.deleteSampler(this.handle),this.handle=void 0)}toString(){return`Sampler(${this.id},${JSON.stringify(this.props)})`}_setSamplerParameters(t){for(const[r,i]of Object.entries(t)){const a=Number(r);switch(a){case 33082:case 33083:this.device.gl.samplerParameterf(this.handle,a,i);break;default:this.device.gl.samplerParameteri(this.handle,a,i);break}}}}class da extends Ju{constructor(t,r){super(t,{...ct.defaultProps,...r});w(this,"device");w(this,"gl");w(this,"handle");w(this,"texture");this.device=t,this.gl=this.device.gl,this.handle=null,this.texture=r.texture}}const EL="Failed to deduce GL constant from typed array";function RL(n){switch(ArrayBuffer.isView(n)?n.constructor:n){case Float32Array:return 5126;case Uint16Array:return 5123;case Uint32Array:return 5125;case Uint8Array:return 5121;case Uint8ClampedArray:return 5121;case Int8Array:return 5120;case Int16Array:return 5122;case Int32Array:return 5124;default:throw new Error(EL)}}function CL(n,e){const{clamped:t=!0}=e||{};switch(n){case 5126:return Float32Array;case 5123:case 33635:case 32819:case 32820:return Uint16Array;case 5125:return Uint32Array;case 5121:return t?Uint8ClampedArray:Uint8Array;case 5120:return Int8Array;case 5122:return Int16Array;case 5124:return Int32Array;default:throw new Error("Failed to deduce typed array type from GL constant")}}function Hx(n){switch(n){case 6406:case 33326:case 6403:case 36244:return 1;case 33339:case 33340:case 33328:case 33320:case 33319:return 2;case 6407:case 36248:case 34837:return 3;case 6408:case 36249:case 34836:return 4;default:return 0}}function ML(n){switch(n){case 5121:return 1;case 33635:case 32819:case 32820:return 2;case 5126:return 4;default:return 0}}function _f(n,e,t){if(OL(e))return t(n);const{nocatch:r=!0}=e,i=Yi.get(n);i.push(),Ua(n,e);let a;if(r)a=t(n),i.pop();else try{a=t(n)}finally{i.pop()}return a}function OL(n){for(const e in n)return!1;return!0}function IL(n,e,t){const{dimension:r,width:i,height:a,depth:l=0}=t,{glInternalFormat:c}=t,f=t.glTarget;switch(r){case"2d-array":case"3d":n.texStorage3D(f,e,c,i,a,l);break;default:n.texStorage2D(f,e,c,i,a)}}function n2(n,e,t,r){const{width:i,height:a}=r,{dimension:l,depth:c=0,mipLevel:f=0}=r,{x:d=0,y:p=0,z:_=0}=r,{glFormat:y,glType:b}=r,T=jx(r.glTarget,l,c),A=r.flipY?{37440:!0}:{};_f(n,A,()=>{switch(l){case"2d-array":case"3d":n.bindTexture(T,e),n.texSubImage3D(T,f,d,p,_,i,a,c,y,b,t),n.bindTexture(T,null);break;case"2d":case"cube":n.bindTexture(T,e),n.texSubImage2D(T,f,d,p,i,a,y,b,t),n.bindTexture(T,null);break;default:throw new Error(l)}})}function r2(n,e,t){const{dimension:r,width:i,height:a,depth:l=0,mipLevel:c=0,byteOffset:f=0}=t,{x:d=0,y:p=0,z:_=0}=t,{glFormat:y,glType:b,compressed:T}=t,A=jx(t.glTarget,r,l);switch(r){case"2d-array":case"3d":T?n.compressedTexSubImage3D(A,c,d,p,_,i,a,l,y,e,f):n.texSubImage3D(A,c,d,p,_,i,a,l,y,b,e,f);break;case"2d":case"cube":T?n.compressedTexSubImage2D(A,c,d,p,i,a,y,e,f):n.texSubImage2D(A,c,d,p,i,a,y,b,e,f);break;default:throw new Error(r)}}function NL(n){switch(n){case"1d":break;case"2d":return 3553;case"3d":return 32879;case"cube":return 34067;case"2d-array":return 35866}throw new Error(n)}function jx(n,e,t){return e==="cube"?34069+t:n}function kL(n,e){var N;const{sourceX:t=0,sourceY:r=0,sourceAttachment:i=0}=e||{};let{target:a=null,sourceWidth:l,sourceHeight:c,sourceDepth:f,sourceFormat:d,sourceType:p}=e||{};const{framebuffer:_,deleteFramebuffer:y}=$x(n),{gl:b,handle:T}=_;l||(l=_.width),c||(c=_.height);const A=(N=_.colorAttachments[i])==null?void 0:N.texture;if(!A)throw new Error(`Invalid framebuffer attachment ${i}`);f=(A==null?void 0:A.depth)||1,d||(d=(A==null?void 0:A.glFormat)||6408),p||(p=(A==null?void 0:A.glType)||5121),a=UL(a,p,d,l,c),p=p||RL(a);const C=b.bindFramebuffer(36160,T);return b.readBuffer(36064+i),b.readPixels(t,r,l,c,d,p,a),b.readBuffer(36064),b.bindFramebuffer(36160,C||null),y&&_.destroy(),a}function DL(n,e){const{target:t,sourceX:r=0,sourceY:i=0,sourceFormat:a=6408,targetByteOffset:l=0}=e||{};let{sourceWidth:c,sourceHeight:f,sourceType:d}=e||{};const{framebuffer:p,deleteFramebuffer:_}=$x(n);c=c||p.width,f=f||p.height;const y=p;d=d||5121;let b=t;if(!b){const A=Hx(a),C=ML(d),N=l+c*f*A*C;b=y.device.createBuffer({byteLength:N})}const T=n.device.createCommandEncoder();return T.copyTextureToBuffer({sourceTexture:n,width:c,height:f,origin:[r,i],destinationBuffer:b,byteOffset:l}),T.destroy(),_&&p.destroy(),b}function $x(n){return n instanceof nf?{framebuffer:n,deleteFramebuffer:!1}:{framebuffer:PL(n),deleteFramebuffer:!0}}function PL(n,e){const{device:t,width:r,height:i,id:a}=n;return t.createFramebuffer({...e,id:`framebuffer-for-${a}`,width:r,height:i,colorAttachments:[n]})}function UL(n,e,t,r,i,a){if(n)return n;e||(e=5121);const l=CL(e,{clamped:!1}),c=Hx(t);return new l(r*i*c)}class fl extends ct{constructor(t,r){super(t,r);w(this,"device");w(this,"gl");w(this,"handle");w(this,"sampler");w(this,"view");w(this,"mipmaps");w(this,"compressed");w(this,"glTarget");w(this,"glFormat");w(this,"glType");w(this,"glInternalFormat");w(this,"textureUnit",0);const i={...this.props};i.data=r.data,this.device=t,this.gl=this.device.gl,this.glTarget=NL(this.props.dimension);const a=Fx(this.props.format);this.glInternalFormat=a.internalFormat,this.glFormat=a.format,this.glType=a.type,this.compressed=a.compressed,this.mipmaps=!!this.props.mipmaps,this._initialize(i),Object.seal(this)}_initialize(t){this.handle=this.props.handle||this.gl.createTexture(),this.device.setSpectorMetadata(this.handle,{...this.props,data:t.data});let{width:r,height:i}=t;if(!r||!i){const a=ct.getTextureDataSize(t.data);r=(a==null?void 0:a.width)||1,i=(a==null?void 0:a.height)||1}if(this.width=r,this.height=i,this.depth=t.depth,this.setSampler(t.sampler),this.view=new da(this.device,{...this.props,texture:this}),this.bind(),IL(this.gl,this.mipLevels,this),t.data)switch(t.dimension){case"1d":this.setTexture1DData(t.data);break;case"2d":this.setTexture2DData(t.data);break;case"3d":this.setTexture3DData(t.data);break;case"cube":this.setTextureCubeData(t.data);break;case"2d-array":this.setTextureArrayData(t.data);break;case"cube-array":this.setTextureCubeArrayData(t.data);break;default:throw new Error(t.dimension)}this.mipmaps&&this.generateMipmap()}destroy(){this.handle&&(this.gl.deleteTexture(this.handle),this.removeStats(),this.trackDeallocatedMemory("Texture"),this.destroyed=!0)}createView(t){return new da(this.device,{...t,texture:this})}setSampler(t={}){let r;t instanceof h_?(this.sampler=t,r=t.props):(this.sampler=new h_(this.device,t),r=t);const i=Vx(r);this._setSamplerParameters(i)}generateMipmap(t){if(!(!(this.device.isTextureFormatRenderable(this.props.format)&&this.device.isTextureFormatFilterable(this.props.format))&&(le.warn(`${this} is not renderable or filterable, may not be able to generate mipmaps`)(),!(t!=null&&t.force))))try{this.gl.bindTexture(this.glTarget,this.handle),this.gl.generateMipmap(this.glTarget)}catch(i){le.warn(`Error generating mipmap for ${this}: ${i.message}`)()}finally{this.gl.bindTexture(this.glTarget,null)}}copyExternalImage(t){const r=ct.getExternalImageSize(t.image),i={...ct.defaultCopyExternalImageOptions,...r,...t},{image:a,depth:l,mipLevel:c,x:f,y:d,z:p,flipY:_}=i;let{width:y,height:b}=i;const{dimension:T,glTarget:A,glFormat:C,glInternalFormat:N,glType:O}=this;if(y=Math.min(y,this.width-f),b=Math.min(b,this.height-d),t.sourceX||t.sourceY)throw new Error("WebGL does not support sourceX/sourceY)");return n2(this.device.gl,this.handle,a,{dimension:T,mipLevel:c,x:f,y:d,z:p,width:y,height:b,depth:l,glFormat:C,glType:O,glTarget:A,flipY:_}),{width:i.width,height:i.height}}setTexture1DData(t){throw new Error("setTexture1DData not supported in WebGL.")}setTexture2DData(t,r=0){this.bind();const i=ct.normalizeTextureData(t,this);i.length>1&&this.props.mipmaps!==!1&&le.warn(`Texture ${this.id} mipmap and multiple LODs.`)();for(let a=0;a<i.length;a++){const l=i[a];this._setMipLevel(r,a,l)}this.unbind()}setTexture3DData(t){if(this.props.dimension!=="3d")throw new Error(this.id);ArrayBuffer.isView(t)&&(this.bind(),r2(this.device.gl,t,this),this.unbind())}setTextureCubeData(t,r=0){if(this.props.dimension!=="cube")throw new Error(this.id);for(const i of ct.CubeFaces)this.setTextureCubeFaceData(t[i],i)}setTextureArrayData(t){throw this.props.dimension!=="2d-array"?new Error(this.id):new Error("setTextureArrayData not implemented.")}setTextureCubeArrayData(t){throw new Error("setTextureCubeArrayData not supported in WebGL2.")}setTextureCubeFaceData(t,r,i=0){Array.isArray(t)&&t.length>1&&this.props.mipmaps!==!1&&le.warn(`${this.id} has mipmap and multiple LODs.`)();const a=ct.CubeFaces.indexOf(r);this.setTexture2DData(t,a)}update(){throw new Error("Texture.update() not implemented. Use ExternalTexture")}setImageDataForFace(t){const{face:r,width:i,height:a,pixels:l,data:c,format:f=6408,type:d=5121}=t,{gl:p}=this,_=l||c;this.bind(),_ instanceof Promise?_.then(y=>this.setImageDataForFace(Object.assign({},t,{face:r,data:y,pixels:y}))):this.width||this.height?p.texImage2D(r,0,f,i,a,0,f,d,_):p.texImage2D(r,0,f,f,d,_)}_getImageDataMap(t){for(let r=0;r<ct.CubeFaces.length;++r){const i=ct.CubeFaces[r];t[i]&&(t[34069+r]=t[i],delete t[i])}return t}_setSamplerParameters(t){le.log(1,`${this.id} sampler parameters`,this.device.getGLKeys(t))(),this.gl.bindTexture(this.glTarget,this.handle);for(const[r,i]of Object.entries(t)){const a=Number(r),l=i;switch(a){case 33082:case 33083:this.gl.texParameterf(this.glTarget,a,l);break;case 10241:this.gl.texParameteri(this.glTarget,a,l);break;case 10242:case 10243:this.gl.texParameteri(this.glTarget,a,l);break;case 34046:this.device.features.has("texture-filterable-anisotropic-webgl")&&this.gl.texParameteri(this.glTarget,a,l);break;default:this.gl.texParameteri(this.glTarget,a,l);break}}this.gl.bindTexture(this.glTarget,null)}_setMipLevel(t,r,i,a=this.glTarget){if(ct.isExternalImage(i)){n2(this.device.gl,this.handle,i,{...this,depth:t,mipLevel:r,glTarget:a,flipY:this.props.flipY});return}if(ct.isTextureLevelData(i)){r2(this.device.gl,i.data,{...this,depth:t,mipLevel:r,glTarget:a});return}throw new Error("Texture: invalid image data")}getActiveUnit(){return this.gl.getParameter(34016)-33984}bind(t){const{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.glTarget,this.handle),t}unbind(t){const{gl:r}=this;return t!==void 0&&(this.textureUnit=t,r.activeTexture(33984+t)),r.bindTexture(this.glTarget,null),t}}const BL=[1,2,4,8];class FL extends zg{constructor(t,r){var l;super(t,r);w(this,"device");w(this,"glParameters");this.device=t;let i;if(!((l=r==null?void 0:r.parameters)!=null&&l.viewport))if(r!=null&&r.framebuffer){const{width:c,height:f}=r.framebuffer;i=[0,0,c,f]}else{const[c,f]=t.getCanvasContext().getDrawingBufferSize();i=[0,0,c,f]}this.device.pushState(),this.setParameters({viewport:i,...this.props.parameters});const a=this.props.framebuffer;if(a!=null&&a.handle)if(this.props.framebuffer){const c=this.props.framebuffer.colorAttachments.map((f,d)=>36064+d);this.device.gl.drawBuffers(c)}else this.device.gl.drawBuffers([1029]);this.clear()}end(){this.device.popState()}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}setParameters(t={}){const r={...this.glParameters};r.framebuffer=this.props.framebuffer||null,this.props.depthReadOnly&&(r.depthMask=!this.props.depthReadOnly),r.stencilMask=this.props.stencilReadOnly?0:1,r[35977]=this.props.discard,t.viewport&&(t.viewport.length>=6?(r.viewport=t.viewport.slice(0,4),r.depthRange=[t.viewport[4],t.viewport[5]]):r.viewport=t.viewport),t.scissorRect&&(r.scissorTest=!0,r.scissor=t.scissorRect),t.blendConstant&&(r.blendColor=t.blendConstant),t.stencilReference&&(console.warn("RenderPassParameters.stencilReference not yet implemented in WebGL"),t[2967]=t.stencilReference),t.colorMask&&(r.colorMask=BL.map(i=>!!(i&t.colorMask))),this.glParameters=r,Ua(this.device.gl,r)}beginOcclusionQuery(t){const r=this.props.occlusionQuerySet;r==null||r.beginOcclusionQuery()}endOcclusionQuery(){const t=this.props.occlusionQuerySet;t==null||t.endOcclusionQuery()}clear(){const t={...this.glParameters};let r=0;this.props.clearColors&&this.props.clearColors.forEach((i,a)=>{i&&this.clearColorBuffer(a,i)}),this.props.clearColor!==!1&&this.props.clearColors===void 0&&(r|=16384,t.clearColor=this.props.clearColor),this.props.clearDepth!==!1&&(r|=256,t.clearDepth=this.props.clearDepth),this.props.clearStencil!==!1&&(r|=1024,t.clearStencil=this.props.clearStencil),r!==0&&_f(this.device.gl,t,()=>{this.device.gl.clear(r)})}clearColorBuffer(t=0,r=[0,0,0,0]){_f(this.device.gl,{framebuffer:this.props.framebuffer},()=>{switch(r.constructor){case Int8Array:case Int16Array:case Int32Array:this.device.gl.clearBufferiv(6144,t,r);break;case Uint8Array:case Uint8ClampedArray:case Uint16Array:case Uint32Array:this.device.gl.clearBufferuiv(6144,t,r);break;case Float32Array:this.device.gl.clearBufferfv(6144,t,r);break;default:throw new Error("clearColorBuffer: color must be typed array")}})}}function LL(n){return zL.includes(n)}const zL=[35678,35680,35679,35682,36289,36292,36293,36298,36299,36300,36303,36306,36307,36308,36311],Wx={5126:[5126,1,"float","f32","float32"],35664:[5126,2,"vec2","vec2<f32>","float32x2"],35665:[5126,3,"vec3","vec3<f32>","float32x3"],35666:[5126,4,"vec4","vec4<f32>","float32x4"],5124:[5124,1,"int","i32","sint32"],35667:[5124,2,"ivec2","vec2<i32>","sint32x2"],35668:[5124,3,"ivec3","vec3<i32>","sint32x3"],35669:[5124,4,"ivec4","vec4<i32>","sint32x4"],5125:[5125,1,"uint","u32","uint32"],36294:[5125,2,"uvec2","vec2<u32>","uint32x2"],36295:[5125,3,"uvec3","vec3<u32>","uint32x3"],36296:[5125,4,"uvec4","vec4<u32>","uint32x4"],35670:[5126,1,"bool","f32","float32"],35671:[5126,2,"bvec2","vec2<f32>","float32x2"],35672:[5126,3,"bvec3","vec3<f32>","float32x3"],35673:[5126,4,"bvec4","vec4<f32>","float32x4"],35674:[5126,8,"mat2","mat2x2<f32>"],35685:[5126,8,"mat2x3","mat2x3<f32>"],35686:[5126,8,"mat2x4","mat2x4<f32>"],35687:[5126,12,"mat3x2","mat3x2<f32>"],35675:[5126,12,"mat3","mat3x3<f32>"],35688:[5126,12,"mat3x4","mat3x4<f32>"],35689:[5126,16,"mat4x2","mat4x2<f32>"],35690:[5126,16,"mat4x3","mat4x3<f32>"],35676:[5126,16,"mat4","mat4x4<f32>"]};function Xx(n){const e=Wx[n];if(!e)throw new Error("uniform");const[t,r,,i]=e;return{format:i,components:r,glType:t}}function VL(n){const e=Wx[n];if(!e)throw new Error("attribute");const[,t,,r,i]=e;return{attributeType:r,vertexFormat:i,components:t}}function HL(n,e){const t={attributes:[],bindings:[]};t.attributes=jL(n,e);const r=XL(n,e);for(const c of r){const f=c.uniforms.map(d=>({name:d.name,format:d.format,byteOffset:d.byteOffset,byteStride:d.byteStride,arrayLength:d.arrayLength}));t.bindings.push({type:"uniform",name:c.name,group:0,location:c.location,visibility:(c.vertex?1:0)&(c.fragment?2:0),minBindingSize:c.byteLength,uniforms:f})}const i=WL(n,e);let a=0;for(const c of i)if(LL(c.type)){const{viewDimension:f,sampleType:d}=qL(c.type);t.bindings.push({type:"texture",name:c.name,group:0,location:a,viewDimension:f,sampleType:d}),c.textureUnit=a,a+=1}i.length&&(t.uniforms=i);const l=$L(n,e);return l!=null&&l.length&&(t.varyings=l),t}function jL(n,e){const t=[],r=n.getProgramParameter(e,35721);for(let i=0;i<r;i++){const a=n.getActiveAttrib(e,i);if(!a)throw new Error("activeInfo");const{name:l,type:c}=a,f=n.getAttribLocation(e,l);if(f>=0){const{attributeType:d}=VL(c),p=/instance/i.test(l)?"instance":"vertex";t.push({name:l,location:f,stepMode:p,type:d})}}return t.sort((i,a)=>i.location-a.location),t}function $L(n,e){const t=[],r=n.getProgramParameter(e,35971);for(let i=0;i<r;i++){const a=n.getTransformFeedbackVarying(e,i);if(!a)throw new Error("activeInfo");const{name:l,type:c,size:f}=a,{glType:d,components:p}=Xx(c),_={location:i,name:l,type:d,size:f*p};t.push(_)}return t.sort((i,a)=>i.location-a.location),t}function WL(n,e){const t=[],r=n.getProgramParameter(e,35718);for(let i=0;i<r;i++){const a=n.getActiveUniform(e,i);if(!a)throw new Error("activeInfo");const{name:l,size:c,type:f}=a,{name:d,isArray:p}=KL(l);let _=n.getUniformLocation(e,d);const y={location:_,name:d,size:c,type:f,isArray:p};if(t.push(y),y.size>1)for(let b=0;b<y.size;b++){const T=`${d}[${b}]`;_=n.getUniformLocation(e,T);const A={...y,name:T,location:_};t.push(A)}}return t}function XL(n,e){const t=(a,l)=>n.getActiveUniformBlockParameter(e,a,l),r=[],i=n.getProgramParameter(e,35382);for(let a=0;a<i;a++){const l={name:n.getActiveUniformBlockName(e,a)||"",location:t(a,35391),byteLength:t(a,35392),vertex:t(a,35396),fragment:t(a,35398),uniformCount:t(a,35394),uniforms:[]},c=t(a,35395)||[],f=n.getActiveUniforms(e,c,35383),d=n.getActiveUniforms(e,c,35384),p=n.getActiveUniforms(e,c,35387),_=n.getActiveUniforms(e,c,35388);for(let y=0;y<l.uniformCount;++y){const b=n.getActiveUniform(e,c[y]);if(!b)throw new Error("activeInfo");l.uniforms.push({name:b.name,format:Xx(f[y]).format,type:f[y],arrayLength:d[y],byteOffset:p[y],byteStride:_[y]})}r.push(l)}return r.sort((a,l)=>a.location-l.location),r}const YL={35678:["2d","float"],35680:["cube","float"],35679:["3d","float"],35682:["3d","depth"],36289:["2d-array","float"],36292:["2d-array","depth"],36293:["cube","float"],36298:["2d","sint"],36299:["3d","sint"],36300:["cube","sint"],36303:["2d-array","uint"],36306:["2d","uint"],36307:["3d","uint"],36308:["cube","uint"],36311:["2d-array","uint"]};function qL(n){const e=YL[n];if(!e)throw new Error("sampler");const[t,r]=e;return{viewDimension:t,sampleType:r}}function KL(n){if(n[n.length-1]!=="]")return{name:n,length:1,isArray:!1};const t=/([^[]*)(\[[0-9]+\])?/.exec(n);if(!t||t.length<2)throw new Error(`Failed to parse GLSL uniform name ${n}`);return{name:t[1],length:t[2]?1:0,isArray:!!t[2]}}function ZL(n,e,t,r){const i=n;let a=r;a===!0&&(a=1),a===!1&&(a=0);const l=typeof a=="number"?[a]:a;switch(t){case 35678:case 35680:case 35679:case 35682:case 36289:case 36292:case 36293:case 36298:case 36299:case 36300:case 36303:case 36306:case 36307:case 36308:case 36311:if(typeof r!="number")throw new Error("samplers must be set to integers");return n.uniform1i(e,r);case 5126:return n.uniform1fv(e,l);case 35664:return n.uniform2fv(e,l);case 35665:return n.uniform3fv(e,l);case 35666:return n.uniform4fv(e,l);case 5124:return n.uniform1iv(e,l);case 35667:return n.uniform2iv(e,l);case 35668:return n.uniform3iv(e,l);case 35669:return n.uniform4iv(e,l);case 35670:return n.uniform1iv(e,l);case 35671:return n.uniform2iv(e,l);case 35672:return n.uniform3iv(e,l);case 35673:return n.uniform4iv(e,l);case 5125:return i.uniform1uiv(e,l,1);case 36294:return i.uniform2uiv(e,l,2);case 36295:return i.uniform3uiv(e,l,3);case 36296:return i.uniform4uiv(e,l,4);case 35674:return n.uniformMatrix2fv(e,!1,l);case 35675:return n.uniformMatrix3fv(e,!1,l);case 35676:return n.uniformMatrix4fv(e,!1,l);case 35685:return i.uniformMatrix2x3fv(e,!1,l);case 35686:return i.uniformMatrix2x4fv(e,!1,l);case 35687:return i.uniformMatrix3x2fv(e,!1,l);case 35688:return i.uniformMatrix3x4fv(e,!1,l);case 35689:return i.uniformMatrix4x2fv(e,!1,l);case 35690:return i.uniformMatrix4x3fv(e,!1,l)}throw new Error("Illegal uniform")}function QL(n){return Sx(n)!==null||typeof n=="number"||typeof n=="boolean"}function GL(n){const e={bindings:{},uniforms:{}};return Object.keys(n).forEach(t=>{const r=n[t];QL(r)?e.uniforms[t]=r:e.bindings[t]=r}),e}function JL(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 3;case"triangle-list":return 4;case"triangle-strip":return 5;default:throw new Error(n)}}function ez(n){switch(n){case"point-list":return 0;case"line-list":return 1;case"line-strip":return 1;case"triangle-list":return 4;case"triangle-strip":return 4;default:throw new Error(n)}}const i2=4;class tz extends Aa{constructor(t,r){super(t,r);w(this,"device");w(this,"handle");w(this,"vs");w(this,"fs");w(this,"introspectedLayout");w(this,"uniforms",{});w(this,"bindings",{});w(this,"varyings",null);w(this,"_uniformCount",0);w(this,"_uniformSetters",{});this.device=t,this.handle=this.props.handle||this.device.gl.createProgram(),this.device.setSpectorMetadata(this.handle,{id:this.props.id}),this.vs=r.vs,this.fs=r.fs;const{varyings:i,bufferMode:a=35981}=r;i&&i.length>0&&(this.varyings=i,this.device.gl.transformFeedbackVaryings(this.handle,i,a)),this._linkShaders(),le.time(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.introspectedLayout=HL(this.device.gl,this.handle),le.timeEnd(1,`RenderPipeline ${this.id} - shaderLayout introspection`)(),this.shaderLayout=nz(this.introspectedLayout,r.shaderLayout)}destroy(){this.handle&&(this.device.gl.deleteProgram(this.handle),this.destroyed=!0)}setBindings(t,r){for(const[i,a]of Object.entries(t)){const l=this.shaderLayout.bindings.find(c=>c.name===i)||this.shaderLayout.bindings.find(c=>c.name===`${i}Uniforms`);if(!l){const c=this.shaderLayout.bindings.map(f=>`"${f.name}"`).join(", ");r!=null&&r.disableWarnings||le.warn(`No binding "${i}" in render pipeline "${this.id}", expected one of ${c}`,a)();continue}switch(a||le.warn(`Unsetting binding "${i}" in render pipeline "${this.id}"`)(),l.type){case"uniform":if(!(a instanceof ul)&&!(a.buffer instanceof ul))throw new Error("buffer value");break;case"texture":if(!(a instanceof da||a instanceof fl||a instanceof cl))throw new Error("texture value");break;case"sampler":le.warn(`Ignoring sampler ${i}`)();break;default:throw new Error(l.type)}this.bindings[i]=a}}draw(t){var C;const{renderPass:r,parameters:i=this.props.parameters,topology:a=this.props.topology,vertexArray:l,vertexCount:c,instanceCount:f,isInstanced:d=!1,firstVertex:p=0,transformFeedback:_}=t,y=JL(a),b=!!l.indexBuffer,T=(C=l.indexBuffer)==null?void 0:C.glIndexType;if(this.linkStatus!=="success")return le.info(2,`RenderPipeline:${this.id}.draw() aborted - waiting for shader linking`)(),!1;if(!this._areTexturesRenderable())return le.info(2,`RenderPipeline:${this.id}.draw() aborted - textures not yet loaded`)(),!1;this.device.gl.useProgram(this.handle),l.bindBeforeRender(r),_&&_.begin(this.props.topology),this._applyBindings(),this._applyUniforms();const A=r;return vL(this.device,i,A.glParameters,()=>{b&&d?this.device.gl.drawElementsInstanced(y,c||0,T,p,f||0):b?this.device.gl.drawElements(y,c||0,T,p):d?this.device.gl.drawArraysInstanced(y,p,c||0,f||0):this.device.gl.drawArrays(y,p,c||0),_&&_.end()}),l.unbindAfterRender(r),!0}setUniformsWebGL(t){const{bindings:r}=GL(t);Object.keys(r).forEach(i=>{le.warn(`Unsupported value "${JSON.stringify(r[i])}" used in setUniforms() for key ${i}. Use setBindings() instead?`)()}),Object.assign(this.uniforms,t)}async _linkShaders(){const{gl:t}=this.device;if(t.attachShader(this.handle,this.vs.handle),t.attachShader(this.handle,this.fs.handle),le.time(i2,`linkProgram for ${this.id}`)(),t.linkProgram(this.handle),le.timeEnd(i2,`linkProgram for ${this.id}`)(),le.level,!this.device.features.has("compilation-status-async-webgl")){const i=this._getLinkStatus();this._reportLinkStatus(i);return}le.once(1,"RenderPipeline linking is asynchronous")(),await this._waitForLinkComplete(),le.info(2,`RenderPipeline ${this.id} - async linking complete: ${this.linkStatus}`)();const r=this._getLinkStatus();this._reportLinkStatus(r)}async _reportLinkStatus(t){var r;switch(t){case"success":return;default:switch(this.vs.compilationStatus){case"error":throw this.vs.debugShader(),new Error(`Error during compilation of shader ${this.vs.id}`);case"pending":this.vs.asyncCompilationStatus.then(()=>this.vs.debugShader());break}switch((r=this.fs)==null?void 0:r.compilationStatus){case"error":throw this.fs.debugShader(),new Error(`Error during compilation of shader ${this.fs.id}`);case"pending":this.fs.asyncCompilationStatus.then(()=>this.fs.debugShader());break}const i=this.device.gl.getProgramInfoLog(this.handle);throw new Error(`Error during ${t}: ${i}`)}}_getLinkStatus(){const{gl:t}=this.device;return t.getProgramParameter(this.handle,35714)?(t.validateProgram(this.handle),t.getProgramParameter(this.handle,35715)?(this.linkStatus="success","success"):(this.linkStatus="error","validation")):(this.linkStatus="error","linking")}async _waitForLinkComplete(){const t=async a=>await new Promise(l=>setTimeout(l,a));if(!this.device.features.has("compilation-status-async-webgl")){await t(10);return}const{gl:i}=this.device;for(;;){if(i.getProgramParameter(this.handle,37297))return;await t(10)}}_areTexturesRenderable(){let t=!0;for(const r of this.shaderLayout.bindings)!this.bindings[r.name]&&!this.bindings[r.name.replace(/Uniforms$/,"")]&&(le.warn(`Binding ${r.name} not found in ${this.id}`)(),t=!1);return t}_applyBindings(){if(this.linkStatus!=="success")return;const{gl:t}=this.device;t.useProgram(this.handle);let r=0,i=0;for(const a of this.shaderLayout.bindings){const l=this.bindings[a.name]||this.bindings[a.name.replace(/Uniforms$/,"")];if(!l)throw new Error(`No value for binding ${a.name} in ${this.id}`);switch(a.type){case"uniform":const{name:c}=a,f=t.getUniformBlockIndex(this.handle,c);if(f===4294967295)throw new Error(`Invalid uniform block name ${c}`);t.uniformBlockBinding(this.handle,i,f),l instanceof ul?t.bindBufferBase(35345,i,l.handle):t.bindBufferRange(35345,i,l.buffer.handle,l.offset||0,l.size||l.buffer.byteLength-l.offset),i+=1;break;case"texture":if(!(l instanceof da||l instanceof fl||l instanceof cl))throw new Error("texture");let d;if(l instanceof da)d=l.texture;else if(l instanceof fl)d=l;else if(l instanceof cl&&l.colorAttachments[0]instanceof da)le.warn("Passing framebuffer in texture binding may be deprecated. Use fbo.colorAttachments[0] instead")(),d=l.colorAttachments[0].texture;else throw new Error("No texture");t.activeTexture(33984+r),t.bindTexture(d.glTarget,d.handle),r+=1;break;case"sampler":break;case"storage":case"read-only-storage":throw new Error(`binding type '${a.type}' not supported in WebGL`)}}}_applyUniforms(){for(const t of this.shaderLayout.uniforms||[]){const{name:r,location:i,type:a,textureUnit:l}=t,c=this.uniforms[r]??l;c!==void 0&&ZL(this.device.gl,i,a,c)}}}function nz(n,e){const t={...n,attributes:n.attributes.map(r=>({...r}))};for(const r of(e==null?void 0:e.attributes)||[]){const i=t.attributes.find(a=>a.name===r.name);i?(i.type=r.type||i.type,i.stepMode=r.stepMode||i.stepMode):le.warn(`shader layout attribute ${r.name} not present in shader`)}return t}class rz extends Hg{constructor(t){super(t,{});w(this,"device");w(this,"commands",[]);this.device=t}submitCommands(t=this.commands){for(const r of t)switch(r.name){case"copy-buffer-to-buffer":iz(this.device,r.options);break;case"copy-buffer-to-texture":sz(this.device,r.options);break;case"copy-texture-to-buffer":az(this.device,r.options);break;case"copy-texture-to-texture":oz(this.device,r.options);break;default:throw new Error(r.name)}}}function iz(n,e){const t=e.sourceBuffer,r=e.destinationBuffer;n.gl.bindBuffer(36662,t.handle),n.gl.bindBuffer(36663,r.handle),n.gl.copyBufferSubData(36662,36663,e.sourceOffset??0,e.destinationOffset??0,e.size),n.gl.bindBuffer(36662,null),n.gl.bindBuffer(36663,null)}function sz(n,e){throw new Error("Not implemented")}function az(n,e){const{sourceTexture:t,mipLevel:r=0,aspect:i="all",width:a=e.sourceTexture.width,height:l=e.sourceTexture.height,depthOrArrayLayers:c=0,origin:f=[0,0],destinationBuffer:d,byteOffset:p=0,bytesPerRow:_,rowsPerImage:y}=e;if(i!=="all")throw new Error("aspect not supported in WebGL");if(r!==0||c!==0||_||y)throw new Error("not implemented");const{framebuffer:b,destroyFramebuffer:T}=Yx(t);let A;try{const C=d,N=a||b.width,O=l||b.height,R=Fx(b.colorAttachments[0].texture.props.format),E=R.format,k=R.type;n.gl.bindBuffer(35051,C.handle),A=n.gl.bindFramebuffer(36160,b.handle),n.gl.readPixels(f[0],f[1],N,O,E,k,p)}finally{n.gl.bindBuffer(35051,null),A!==void 0&&n.gl.bindFramebuffer(36160,A),T&&b.destroy()}}function oz(n,e){const{sourceTexture:t,destinationMipLevel:r=0,origin:i=[0,0],destinationOrigin:a=[0,0],destinationTexture:l}=e;let{width:c=e.destinationTexture.width,height:f=e.destinationTexture.height}=e;const{framebuffer:d,destroyFramebuffer:p}=Yx(t),[_,y]=i,[b,T,A]=a,C=n.gl.bindFramebuffer(36160,d.handle);let N=null,O;if(l instanceof fl)N=l,c=Number.isFinite(c)?c:N.width,f=Number.isFinite(f)?f:N.height,N.bind(0),O=N.glTarget;else throw new Error("invalid destination");switch(O){case 3553:case 34067:n.gl.copyTexSubImage2D(O,r,b,T,_,y,c,f);break;case 35866:case 32879:n.gl.copyTexSubImage3D(O,r,b,T,A,_,y,c,f);break}N&&N.unbind(),n.gl.bindFramebuffer(36160,C),p&&d.destroy()}function Yx(n){if(n instanceof ct){const{width:e,height:t,id:r}=n;return{framebuffer:n.device.createFramebuffer({id:`framebuffer-for-${r}`,width:e,height:t,colorAttachments:[n]}),destroyFramebuffer:!0}}return{framebuffer:n,destroyFramebuffer:!1}}class lz extends Vg{constructor(t,r){super(t,r);w(this,"device");w(this,"commandBuffer");this.device=t,this.commandBuffer=new rz(t)}destroy(){}finish(){this.commandBuffer.submitCommands()}copyBufferToBuffer(t){this.commandBuffer.commands.push({name:"copy-buffer-to-buffer",options:t})}copyBufferToTexture(t){this.commandBuffer.commands.push({name:"copy-buffer-to-texture",options:t})}copyTextureToBuffer(t){this.commandBuffer.commands.push({name:"copy-texture-to-buffer",options:t})}copyTextureToTexture(t){this.commandBuffer.commands.push({name:"copy-texture-to-texture",options:t})}pushDebugGroup(t){}popDebugGroup(){}insertDebugMarker(t){}resolveQuerySet(t,r,i){}}function cz(n){const{target:e,source:t,start:r=0,count:i=1}=n,a=t.length,l=i*a;let c=0;for(let f=r;c<a;c++)e[f++]=t[c];for(;c<l;)c<l-c?(e.copyWithin(r+c,r,r+c),c*=2):(e.copyWithin(r+c,r,r+l-c),c=l);return n.target}class cm extends jg{constructor(t,r){super(t,r);w(this,"device");w(this,"handle");w(this,"buffer",null);w(this,"bufferValue",null);this.device=t,this.handle=this.device.gl.createVertexArray()}get[Symbol.toStringTag](){return"VertexArray"}static isConstantAttributeZeroSupported(t){return EN()==="Chrome"}destroy(){var t;super.destroy(),this.buffer&&((t=this.buffer)==null||t.destroy()),this.handle&&(this.device.gl.deleteVertexArray(this.handle),this.handle=void 0)}setIndexBuffer(t){const r=t;if(r&&r.glTarget!==34963)throw new Error("Use .setBuffer()");this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34963,r?r.handle:null),this.indexBuffer=r,this.device.gl.bindVertexArray(null)}setBuffer(t,r){const i=r;if(i.glTarget===34963)throw new Error("Use .setIndexBuffer()");const{size:a,type:l,stride:c,offset:f,normalized:d,integer:p,divisor:_}=this._getAccessor(t);this.device.gl.bindVertexArray(this.handle),this.device.gl.bindBuffer(34962,i.handle),p?this.device.gl.vertexAttribIPointer(t,a,l,c,f):this.device.gl.vertexAttribPointer(t,a,l,d,c,f),this.device.gl.bindBuffer(34962,null),this.device.gl.enableVertexAttribArray(t),this.device.gl.vertexAttribDivisor(t,_||0),this.attributes[t]=i,this.device.gl.bindVertexArray(null)}setConstantWebGL(t,r){this._enable(t,!1),this.attributes[t]=r}bindBeforeRender(){this.device.gl.bindVertexArray(this.handle),this._applyConstantAttributes()}unbindAfterRender(){this.device.gl.bindVertexArray(null)}_applyConstantAttributes(){for(let t=0;t<this.maxVertexAttributes;++t){const r=this.attributes[t];ArrayBuffer.isView(r)&&this.device.setConstantAttributeWebGL(t,r)}}_getAccessor(t){const r=this.attributeInfos[t];if(!r)throw new Error(`Unknown attribute location ${t}`);const i=Bx(r.bufferDataType);return{size:r.bufferComponents,type:i,stride:r.byteStride,offset:r.byteOffset,normalized:r.normalized,integer:r.integer,divisor:r.stepMode==="instance"?1:0}}_enable(t,r=!0){const a=cm.isConstantAttributeZeroSupported(this.device)||t!==0;(r||a)&&(t=Number(t),this.device.gl.bindVertexArray(this.handle),r?this.device.gl.enableVertexAttribArray(t):this.device.gl.disableVertexAttribArray(t),this.device.gl.bindVertexArray(null))}getConstantBuffer(t,r){const i=uz(r),a=i.byteLength*t,l=i.length*t;if(this.buffer&&a!==this.buffer.byteLength)throw new Error(`Buffer size is immutable, byte length ${a} !== ${this.buffer.byteLength}.`);let c=!this.buffer;if(this.buffer=this.buffer||this.device.createBuffer({byteLength:a}),c=c||!fz(i,this.bufferValue),c){const f=h6(r.constructor,l);cz({target:f,source:i,start:0,count:l}),this.buffer.write(f),this.bufferValue=r}return this.buffer}}function uz(n){return Array.isArray(n)?new Float32Array(n):n}function fz(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}class hz extends $g{constructor(t,r){super(t,r);w(this,"device");w(this,"gl");w(this,"handle");w(this,"layout");w(this,"buffers",{});w(this,"unusedBuffers",{});w(this,"bindOnUse",!0);w(this,"_bound",!1);this.device=t,this.gl=t.gl,this.handle=this.props.handle||this.gl.createTransformFeedback(),this.layout=this.props.layout,r.buffers&&this.setBuffers(r.buffers),Object.seal(this)}destroy(){this.gl.deleteTransformFeedback(this.handle),super.destroy()}begin(t="point-list"){this.gl.bindTransformFeedback(36386,this.handle),this.bindOnUse&&this._bindBuffers(),this.gl.beginTransformFeedback(ez(t))}end(){this.gl.endTransformFeedback(),this.bindOnUse&&this._unbindBuffers(),this.gl.bindTransformFeedback(36386,null)}setBuffers(t){this.buffers={},this.unusedBuffers={},this.bind(()=>{for(const r in t)this.setBuffer(r,t[r])})}setBuffer(t,r){const i=this._getVaryingIndex(t),{buffer:a,byteLength:l,byteOffset:c}=this._getBufferRange(r);if(i<0){this.unusedBuffers[t]=a,le.warn(`${this.id} unusedBuffers varying buffer ${t}`)();return}this.buffers[i]={buffer:a,byteLength:l,byteOffset:c},this.bindOnUse||this._bindBuffer(i,a,c,l)}getBuffer(t){if(s2(t))return this.buffers[t]||null;const r=this._getVaryingIndex(t);return r>=0?this.buffers[r]:null}bind(t=this.handle){if(typeof t!="function")return this.gl.bindTransformFeedback(36386,t),this;let r;return this._bound?r=t():(this.gl.bindTransformFeedback(36386,this.handle),this._bound=!0,r=t(),this._bound=!1,this.gl.bindTransformFeedback(36386,null)),r}unbind(){this.bind(null)}_getBufferRange(t){if(t instanceof ul)return{buffer:t,byteOffset:0,byteLength:t.byteLength};const{buffer:r,byteOffset:i=0,byteLength:a=t.buffer.byteLength}=t;return{buffer:r,byteOffset:i,byteLength:a}}_getVaryingIndex(t){if(s2(t))return Number(t);for(const r of this.layout.varyings)if(t===r.name)return r.location;return-1}_bindBuffers(){for(const t in this.buffers){const{buffer:r,byteLength:i,byteOffset:a}=this._getBufferRange(this.buffers[t]);this._bindBuffer(Number(t),r,a,i)}}_unbindBuffers(){for(const t in this.buffers)this.gl.bindBufferBase(35982,Number(t),null)}_bindBuffer(t,r,i=0,a){const l=r&&r.handle;!l||a===void 0?this.gl.bindBufferBase(35982,t,l):this.gl.bindBufferRange(35982,t,l,i,a)}}function s2(n){return typeof n=="number"?Number.isInteger(n):/^\d+$/.test(n)}class dz extends Wg{constructor(t,r){super(t,r);w(this,"device");w(this,"handle");w(this,"target",null);w(this,"_queryPending",!1);w(this,"_pollingPromise",null);if(this.device=t,r.count>1)throw new Error("WebGL QuerySet can only have one value");this.handle=this.device.gl.createQuery(),Object.seal(this)}get[Symbol.toStringTag](){return"Query"}destroy(){this.device.gl.deleteQuery(this.handle)}beginTimestampQuery(){return this._begin(35007)}endTimestampQuery(){this._end()}beginOcclusionQuery(t){return this._begin(t!=null&&t.conservative?36202:35887)}endOcclusionQuery(){this._end()}beginTransformFeedbackQuery(){return this._begin(35976)}endTransformFeedbackQuery(){this._end()}async resolveQuery(){return[await this.pollQuery()]}_begin(t){this._queryPending||(this.target=t,this.device.gl.beginQuery(this.target,this.handle))}_end(){this._queryPending||this.target&&(this.device.gl.endQuery(this.target),this.target=null,this._queryPending=!0)}isResultAvailable(){if(!this._queryPending)return!1;const t=this.device.gl.getQueryParameter(this.handle,34919);return t&&(this._queryPending=!1),t}isTimerDisjoint(){return this.device.gl.getParameter(36795)}getResult(){return this.device.gl.getQueryParameter(this.handle,34918)}getTimerMilliseconds(){return this.getResult()/1e6}pollQuery(t=Number.POSITIVE_INFINITY){if(this._pollingPromise)return this._pollingPromise;let r=0;return this._pollingPromise=new Promise((i,a)=>{const l=()=>{this.isResultAvailable()?(i(this.getResult()),this._pollingPromise=null):r++>t?(a("Timed out"),this._pollingPromise=null):requestAnimationFrame(l)};requestAnimationFrame(l)}),this._pollingPromise}}class pa extends pi{constructor(t){var _,y;super({...t,id:t.id||gL("webgl-device")});w(this,"type","webgl");w(this,"handle");w(this,"features");w(this,"limits");w(this,"info");w(this,"canvasContext");w(this,"lost");w(this,"_resolveContextLost");w(this,"gl");w(this,"debug",!1);w(this,"_canvasSizeInfo",{clientWidth:0,clientHeight:0,devicePixelRatio:1});w(this,"_extensions",{});w(this,"_polyfilled",!1);w(this,"spectorJS");w(this,"renderPass",null);w(this,"_constants");const r=pi._getCanvasContextProps(t);if(!r)throw new Error("WebGLDevice requires props.createCanvasContext to be set");let i=(y=(_=r.canvas)==null?void 0:_.gl)==null?void 0:y.device;if(i)throw new Error(`WebGL context already attached to device ${i.id}`);this.canvasContext=new iL(this,r),this.lost=new Promise(b=>{this._resolveContextLost=b});const a={...t.webgl};r.alphaMode==="premultiplied"&&(a.premultipliedAlpha=!0),t.powerPreference!==void 0&&(a.powerPreference=t.powerPreference);const c=this.props._handle||F5(this.canvasContext.canvas,{onContextLost:b=>{var T;return(T=this._resolveContextLost)==null?void 0:T.call(this,{reason:"destroyed",message:"Entered sleep mode, or too many apps or browser tabs are using the GPU."})},onContextRestored:b=>console.log("WebGL context restored")},a);if(!c)throw new Error("WebGL context creation failed");if(i=c.device,i){if(t._reuseDevices)return le.log(1,`Not creating a new Device, instead returning a reference to Device ${i.id} already attached to WebGL context`,i)(),i._reused=!0,i;throw new Error(`WebGL context already attached to device ${i.id}`)}this.handle=c,this.gl=c,this.spectorJS=oL({...this.props,gl:this.handle}),this.gl.device=this,this.gl._version=2,this.info=L5(this.gl,this._extensions),this.limits=new tL(this.gl),this.features=new eL(this.gl,this._extensions,this.props._disabledFeatures),this.props._initializeFeatures&&this.features.initializeFeatures(),r.autoResize!==!1&&this.canvasContext.resize(),new Yi(this.gl,{log:(...b)=>le.log(1,...b)()}).trackState(this.gl,{copyState:!1});const d=t.debugWebGL||t.debug,p=t.debugWebGL;d&&(this.gl=uL(this.gl,{debugWebGL:d,traceWebGL:p}),le.warn("WebGL debug mode activated. Performance reduced.")(),t.debugWebGL&&(le.level=Math.max(le.level,1)))}destroy(){!this.props._reuseDevices&&!this._reused&&delete this.gl.device}get isLost(){return this.gl.isContextLost()}createCanvasContext(t){throw new Error("WebGL only supports a single canvas")}createBuffer(t){const r=this._normalizeBufferProps(t);return new ul(this,r)}createTexture(t){return new fl(this,t)}createExternalTexture(t){throw new Error("createExternalTexture() not implemented")}createSampler(t){return new h_(this,t)}createShader(t){return new bL(this,t)}createFramebuffer(t){return new cl(this,t)}createVertexArray(t){return new cm(this,t)}createTransformFeedback(t){return new hz(this,t)}createQuerySet(t){return new dz(this,t)}createRenderPipeline(t){return new tz(this,t)}beginRenderPass(t){return new FL(this,t)}createComputePipeline(t){throw new Error("ComputePipeline not supported in WebGL")}beginComputePass(t){throw new Error("ComputePass not supported in WebGL")}createCommandEncoder(t={}){return new lz(this,t)}submit(){var t;(t=this.renderPass)==null||t.end(),this.renderPass=null}readPixelsToArrayWebGL(t,r){return kL(t,r)}readPixelsToBufferWebGL(t,r){return DL(t,r)}setParametersWebGL(t){Ua(this.gl,t)}getParametersWebGL(t){return Px(this.gl,t)}withParametersWebGL(t,r){return _f(this.gl,t,r)}resetWebGL(){le.warn("WebGLDevice.resetWebGL is deprecated, use only for debugging")(),k5(this.gl)}_getDeviceSpecificTextureFormatCapabilities(t){return Z5(this.gl,t,this._extensions)}loseDevice(){var a;let t=!1;const i=this.getExtension("WEBGL_lose_context").WEBGL_lose_context;return i&&(t=!0,i.loseContext()),(a=this._resolveContextLost)==null||a.call(this,{reason:"destroyed",message:"Application triggered context loss"}),t}pushState(){Yi.get(this.gl).push()}popState(){Yi.get(this.gl).pop()}setSpectorMetadata(t,r){t.__SPECTOR_Metadata=r}getGLKey(t,r){const i=Number(t);for(const a in this.gl)if(this.gl[a]===i)return`GL.${a}`;return r!=null&&r.emptyIfUnknown?"":String(t)}getGLKeys(t){const r={emptyIfUnknown:!0};return Object.entries(t).reduce((i,[a,l])=>(i[`${a}:${this.getGLKey(a,r)}`]=`${l}:${this.getGLKey(l,r)}`,i),{})}setConstantAttributeWebGL(t,r){const i=this.limits.maxVertexAttributes;this._constants=this._constants||new Array(i).fill(null);const a=this._constants[t];switch(a&&mz(a,r)&&le.info(1,`setConstantAttributeWebGL(${t}) could have been skipped, value unchanged`)(),this._constants[t]=r,r.constructor){case Float32Array:pz(this,t,r);break;case Int32Array:gz(this,t,r);break;case Uint32Array:_z(this,t,r);break;default:throw new Error("constant")}}getExtension(t){return Da(this.gl,t,this._extensions),this._extensions}}function pz(n,e,t){switch(t.length){case 1:n.gl.vertexAttrib1fv(e,t);break;case 2:n.gl.vertexAttrib2fv(e,t);break;case 3:n.gl.vertexAttrib3fv(e,t);break;case 4:n.gl.vertexAttrib4fv(e,t);break}}function gz(n,e,t){n.gl.vertexAttribI4iv(e,t)}function _z(n,e,t){n.gl.vertexAttribI4uiv(e,t)}function mz(n,e){if(!n||!e||n.length!==e.length||n.constructor!==e.constructor)return!1;for(let t=0;t<n.length;++t)if(n[t]!==e[t])return!1;return!0}const yz={WEBGL_depth_texture:{UNSIGNED_INT_24_8_WEBGL:34042},OES_element_index_uint:{},OES_texture_float:{},OES_texture_half_float:{HALF_FLOAT_OES:5131},EXT_color_buffer_float:{},OES_standard_derivatives:{FRAGMENT_SHADER_DERIVATIVE_HINT_OES:35723},EXT_frag_depth:{},EXT_blend_minmax:{MIN_EXT:32775,MAX_EXT:32776},EXT_shader_texture_lod:{}},bz=n=>({drawBuffersWEBGL(e){return n.drawBuffers(e)},COLOR_ATTACHMENT0_WEBGL:36064,COLOR_ATTACHMENT1_WEBGL:36065,COLOR_ATTACHMENT2_WEBGL:36066,COLOR_ATTACHMENT3_WEBGL:36067}),vz=n=>({VERTEX_ARRAY_BINDING_OES:34229,createVertexArrayOES(){return n.createVertexArray()},deleteVertexArrayOES(e){return n.deleteVertexArray(e)},isVertexArrayOES(e){return n.isVertexArray(e)},bindVertexArrayOES(e){return n.bindVertexArray(e)}}),Tz=n=>({VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE:35070,drawArraysInstancedANGLE(...e){return n.drawArraysInstanced(...e)},drawElementsInstancedANGLE(...e){return n.drawElementsInstanced(...e)},vertexAttribDivisorANGLE(...e){return n.vertexAttribDivisor(...e)}});function wz(n=!0){const e=HTMLCanvasElement.prototype;if(!n&&e.originalGetContext){e.getContext=e.originalGetContext,e.originalGetContext=void 0;return}e.originalGetContext=e.getContext,e.getContext=function(t,r){if(t==="webgl"||t==="experimental-webgl"){const i=this.originalGetContext("webgl2",r);return i instanceof HTMLElement&&xz(i),i}return this.originalGetContext(t,r)}}function xz(n){n.getExtension("EXT_color_buffer_float");const e={...yz,WEBGL_disjoint_timer_query:n.getExtension("EXT_disjoint_timer_query_webgl2"),WEBGL_draw_buffers:bz(n),OES_vertex_array_object:vz(n),ANGLE_instanced_arrays:Tz(n)},t=n.getExtension;n.getExtension=function(i){const a=t.call(n,i);return a||(i in e?e[i]:null)};const r=n.getSupportedExtensions;n.getSupportedExtensions=function(){const i=r.apply(n)||[];return i==null?void 0:i.concat(Object.keys(e))}}const gu=1;class Sz extends HP{constructor(){super();w(this,"type","webgl");pi.defaultProps={...pi.defaultProps,...lm},pa.adapter=this}isSupported(){return typeof WebGL2RenderingContext<"u"}enforceWebGL2(t){wz(t)}async attach(t){if(t instanceof pa)return t;if((t==null?void 0:t.device)instanceof pi)return t.device;if(!Az(t))throw new Error("Invalid WebGL2RenderingContext");return new pa({_handle:t,createCanvasContext:{canvas:t.canvas,autoResize:!1}})}async create(t={}){le.groupCollapsed(gu,"WebGLDevice created")();const r=[];(t.debugWebGL||t.debug)&&r.push(cL()),t.debugSpectorJS&&r.push(aL(t));const i=await Promise.allSettled(r);for(const c of i)c.status==="rejected"&&le.error(`Failed to initialize debug libraries ${c.reason}`)();const a=new pa(t),l=`${a._reused?"Reusing":"Created"} device with WebGL2 ${a.debug?"debug ":""}context: ${a.info.vendor}, ${a.info.renderer} for canvas: ${a.canvasContext.id}`;return le.probe(gu,l)(),le.table(gu,a.info)(),le.groupEnd(gu)(),a}}function Az(n){return typeof WebGL2RenderingContext<"u"&&n instanceof WebGL2RenderingContext?!0:!!(n&&Number.isFinite(n._version))}const a2=new Sz;function si(){}const Ez=({isDragging:n})=>n?"grabbing":"grab",qx={id:"",width:"100%",height:"100%",style:null,viewState:null,initialViewState:null,pickingRadius:0,layerFilter:null,parameters:{},parent:null,device:null,deviceProps:{},gl:null,canvas:null,layers:[],effects:[],views:null,controller:null,useDevicePixels:!0,touchAction:"none",eventRecognizerOptions:{},_framebuffer:null,_animate:!1,_pickable:!0,_typedArrayManagerProps:{},_customRender:null,widgets:[],onDeviceInitialized:si,onWebGLInitialized:si,onResize:si,onViewStateChange:si,onInteractionStateChange:si,onBeforeRender:si,onAfterRender:si,onLoad:si,onError:n=>tt.error(n.message,n.cause)(),onHover:null,onClick:null,onDragStart:null,onDrag:null,onDragEnd:null,_onMetrics:null,getCursor:Ez,getTooltip:null,debug:!1,drawPickingColors:!1};class um{constructor(e){this.width=0,this.height=0,this.userData={},this.device=null,this.canvas=null,this.viewManager=null,this.layerManager=null,this.effectManager=null,this.deckRenderer=null,this.deckPicker=null,this.eventManager=null,this.widgetManager=null,this.tooltip=null,this.animationLoop=null,this.cursorState={isHovering:!1,isDragging:!1},this.stats=new Ff({id:"deck.gl"}),this.metrics={fps:0,setPropsTime:0,updateAttributesTime:0,framesRedrawn:0,pickTime:0,pickCount:0,gpuTime:0,gpuTimePerFrame:0,cpuTime:0,cpuTimePerFrame:0,bufferMemory:0,textureMemory:0,renderbufferMemory:0,gpuMemory:0},this._metricsCounter=0,this._needsRedraw="Initial render",this._pickRequest={mode:"hover",x:-1,y:-1,radius:0,event:null},this._lastPointerDownInfo=null,this._onPointerMove=r=>{const{_pickRequest:i}=this;if(r.type==="pointerleave")i.x=-1,i.y=-1,i.radius=0;else{if(r.leftButton||r.rightButton)return;{const a=r.offsetCenter;if(!a)return;i.x=a.x,i.y=a.y,i.radius=this.props.pickingRadius}}this.layerManager&&(this.layerManager.context.mousePosition={x:i.x,y:i.y}),i.event=r},this._onEvent=r=>{const i=t_[r.type],a=r.offsetCenter;if(!i||!a||!this.layerManager)return;const l=this.layerManager.getLayers(),c=this.deckPicker.getLastPickedObject({x:a.x,y:a.y,layers:l,viewports:this.getViewports(a)},this._lastPointerDownInfo),{layer:f}=c,d=f&&(f[i]||f.props[i]),p=this.props[i];let _=!1;d&&(_=d.call(f,c,r)),_||(p==null||p(c,r),this.widgetManager.onEvent(c,r))},this._onPointerDown=r=>{var l;if(((l=this.device)==null?void 0:l.type)==="webgpu")return;const i=r.offsetCenter,a=this._pick("pickObject","pickObject Time",{x:i.x,y:i.y,radius:this.props.pickingRadius});this._lastPointerDownInfo=a.result[0]||a.emptyInfo},this.props={...qx,...e},e=this.props,e.viewState&&e.initialViewState&&tt.warn("View state tracking is disabled. Use either `initialViewState` for auto update or `viewState` for manual update.")(),this.viewState=this.props.initialViewState,e.device&&(this.device=e.device);let t=this.device;!t&&e.gl&&(e.gl instanceof WebGLRenderingContext&&tt.error("WebGL1 context not supported.")(),t=a2.attach(e.gl)),t||(t=Fg.createDevice({type:"best-available",_reuseDevices:!0,adapters:[a2],...e.deviceProps,createCanvasContext:{canvas:this._createCanvas(e),useDevicePixels:this.props.useDevicePixels,autoResize:!1}})),this.animationLoop=this._createAnimationLoop(t,e),this.setProps(e),e._typedArrayManagerProps&&Al.setOptions(e._typedArrayManagerProps),this.animationLoop.start()}finalize(){var e,t,r,i,a,l,c,f,d,p;(e=this.animationLoop)==null||e.stop(),(t=this.animationLoop)==null||t.destroy(),this.animationLoop=null,this._lastPointerDownInfo=null,(r=this.layerManager)==null||r.finalize(),this.layerManager=null,(i=this.viewManager)==null||i.finalize(),this.viewManager=null,(a=this.effectManager)==null||a.finalize(),this.effectManager=null,(l=this.deckRenderer)==null||l.finalize(),this.deckRenderer=null,(c=this.deckPicker)==null||c.finalize(),this.deckPicker=null,(f=this.eventManager)==null||f.destroy(),this.eventManager=null,(d=this.widgetManager)==null||d.finalize(),this.widgetManager=null,!this.props.canvas&&!this.props.device&&!this.props.gl&&this.canvas&&((p=this.canvas.parentElement)==null||p.removeChild(this.canvas),this.canvas=null)}setProps(e){var r;this.stats.get("setProps Time").timeStart(),"onLayerHover"in e&&tt.removed("onLayerHover","onHover")(),"onLayerClick"in e&&tt.removed("onLayerClick","onClick")(),e.initialViewState&&!Vn(this.props.initialViewState,e.initialViewState,3)&&(this.viewState=e.initialViewState),Object.assign(this.props,e),this._setCanvasSize(this.props);const t=Object.create(this.props);Object.assign(t,{views:this._getViews(),width:this.width,height:this.height,viewState:this._getViewState()}),(r=this.animationLoop)==null||r.setProps(t),this.layerManager&&(this.viewManager.setProps(t),this.layerManager.activateViewport(this.getViewports()[0]),this.layerManager.setProps(t),this.effectManager.setProps(t),this.deckRenderer.setProps(t),this.deckPicker.setProps(t),this.widgetManager.setProps(t)),this.stats.get("setProps Time").timeEnd()}needsRedraw(e={clearRedrawFlags:!1}){if(!this.layerManager)return!1;if(this.props._animate)return"Deck._animate";let t=this._needsRedraw;e.clearRedrawFlags&&(this._needsRedraw=!1);const r=this.viewManager.needsRedraw(e),i=this.layerManager.needsRedraw(e),a=this.effectManager.needsRedraw(e),l=this.deckRenderer.needsRedraw(e);return t=t||r||i||a||l,t}redraw(e){if(!this.layerManager)return;let t=this.needsRedraw({clearRedrawFlags:!0});t=e||t,t&&(this.stats.get("Redraw Count").incrementCount(),this.props._customRender?this.props._customRender(t):this._drawLayers(t))}get isInitialized(){return this.viewManager!==null}getViews(){return Vt(this.viewManager),this.viewManager.views}getViewports(e){return Vt(this.viewManager),this.viewManager.getViewports(e)}getCanvas(){return this.canvas}pickObject(e){const t=this._pick("pickObject","pickObject Time",e).result;return t.length?t[0]:null}pickMultipleObjects(e){return e.depth=e.depth||10,this._pick("pickObject","pickMultipleObjects Time",e).result}pickObjects(e){return this._pick("pickObjects","pickObjects Time",e)}_addResources(e,t=!1){for(const r in e)this.layerManager.resourceManager.add({resourceId:r,data:e[r],forceUpdate:t})}_removeResources(e){for(const t of e)this.layerManager.resourceManager.remove(t)}_addDefaultEffect(e){this.effectManager.addDefaultEffect(e)}_addDefaultShaderModule(e){this.layerManager.addDefaultShaderModule(e)}_removeDefaultShaderModule(e){var t;(t=this.layerManager)==null||t.removeDefaultShaderModule(e)}_pick(e,t,r){Vt(this.deckPicker);const{stats:i}=this;i.get("Pick Count").incrementCount(),i.get(t).timeStart();const a=this.deckPicker[e]({layers:this.layerManager.getLayers(r),views:this.viewManager.getViews(),viewports:this.getViewports(r),onViewportActive:this.layerManager.activateViewport,effects:this.effectManager.getEffects(),...r});return i.get(t).timeEnd(),a}_createCanvas(e){let t=e.canvas;return typeof t=="string"&&(t=document.getElementById(t),Vt(t)),t||(t=document.createElement("canvas"),t.id=e.id||"deckgl-overlay",(e.parent||document.body).appendChild(t)),Object.assign(t.style,e.style),t}_setCanvasSize(e){var i;if(!this.canvas)return;const{width:t,height:r}=e;if(t||t===0){const a=Number.isFinite(t)?`${t}px`:t;this.canvas.style.width=a}if(r||r===0){const a=Number.isFinite(r)?`${r}px`:r;this.canvas.style.position=((i=e.style)==null?void 0:i.position)||"absolute",this.canvas.style.height=a}}_updateCanvasSize(){var i,a;const{canvas:e}=this;if(!e)return;const t=e.clientWidth??e.width,r=e.clientHeight??e.height;(t!==this.width||r!==this.height)&&(this.width=t,this.height=r,(i=this.viewManager)==null||i.setProps({width:t,height:r}),(a=this.layerManager)==null||a.activateViewport(this.getViewports()[0]),this.props.onResize({width:t,height:r}))}_createAnimationLoop(e,t){const{gl:r,onError:i,useDevicePixels:a}=t;return new MF({device:e,useDevicePixels:a,autoResizeDrawingBuffer:!r,autoResizeViewport:!1,onInitialize:l=>this._setDevice(l.device),onRender:this._onRenderFrame.bind(this),onError:i})}_getViewState(){return this.props.viewState||this.viewState}_getViews(){const{views:e}=this.props,t=Array.isArray(e)?e:e?[e]:[new Nx({id:"default-view"})];return t.length&&this.props.controller&&(t[0].props.controller=this.props.controller),t}_onContextLost(){const{onError:e}=this.props;this.animationLoop&&e&&e(new Error("WebGL context is lost"))}_pickAndCallback(){var t,r,i,a;if(((t=this.device)==null?void 0:t.type)==="webgpu")return;const{_pickRequest:e}=this;if(e.event){const{result:l,emptyInfo:c}=this._pick("pickObject","pickObject Time",e);this.cursorState.isHovering=l.length>0;let f=c,d=!1;for(const p of l)f=p,d=((r=p.layer)==null?void 0:r.onHover(p,e.event))||d;d||((a=(i=this.props).onHover)==null||a.call(i,f,e.event),this.widgetManager.onHover(f,e.event)),e.event=null}}_updateCursor(){const e=this.props.parent||this.canvas;e&&(e.style.cursor=this.props.getCursor(this.cursorState))}_setDevice(e){var i,a;if(this.device=e,!this.animationLoop)return;this.canvas||(this.canvas=(i=this.device.canvasContext)==null?void 0:i.canvas),this.device.type==="webgl"&&this.device.setParametersWebGL({blend:!0,blendFunc:[770,771,1,771],polygonOffsetFill:!0,depthTest:!0,depthFunc:515}),this.props.onDeviceInitialized(this.device),this.device.type==="webgl"&&this.props.onWebGLInitialized(this.device.gl);const t=new xx;t.play(),this.animationLoop.attachTimeline(t),this.eventManager=new e8(this.props.parent||this.canvas,{touchAction:this.props.touchAction,recognizers:Object.keys(AT).map(l=>{var b;const[c,f,d,p]=AT[l],_=(b=this.props.eventRecognizerOptions)==null?void 0:b[l],y={...f,..._,event:l};return{recognizer:new c(y),recognizeWith:d,requestFailure:p}}),events:{pointerdown:this._onPointerDown,pointermove:this._onPointerMove,pointerleave:this._onPointerMove}});for(const l in t_)this.eventManager.on(l,this._onEvent);this.viewManager=new e5({timeline:t,eventManager:this.eventManager,onViewStateChange:this._onViewStateChange.bind(this),onInteractionStateChange:this._onInteractionStateChange.bind(this),views:this._getViews(),viewState:this._getViewState(),width:this.width,height:this.height});const r=this.viewManager.getViewports()[0];this.layerManager=new JF(this.device,{deck:this,stats:this.stats,viewport:r,timeline:t}),this.effectManager=new g5({deck:this,device:this.device}),this.deckRenderer=new y5(this.device),this.deckPicker=new S5(this.device),this.widgetManager=new R5({deck:this,parentElement:(a=this.canvas)==null?void 0:a.parentElement}),this.widgetManager.addDefault(new M5),this.setProps(this.props),this._updateCanvasSize(),this.props.onLoad()}_drawLayers(e,t){var l;const{device:r,gl:i}=this.layerManager.context;this.props.onBeforeRender({device:r,gl:i});const a={target:this.props._framebuffer,layers:this.layerManager.getLayers(),viewports:this.viewManager.getViewports(),onViewportActive:this.layerManager.activateViewport,views:this.viewManager.getViews(),pass:"screen",effects:this.effectManager.getEffects(),...t};(l=this.deckRenderer)==null||l.renderLayers(a),a.pass==="screen"&&this.widgetManager.onRedraw({viewports:a.viewports,layers:a.layers}),this.props.onAfterRender({device:r,gl:i})}_onRenderFrame(){var e;this._getFrameStats(),this._metricsCounter++%60===0&&(this._getMetrics(),this.stats.reset(),tt.table(4,this.metrics)(),this.props._onMetrics&&this.props._onMetrics(this.metrics)),this._updateCanvasSize(),this._updateCursor(),this.layerManager.updateLayers(),((e=this.device)==null?void 0:e.type)!=="webgpu"&&this._pickAndCallback(),this.redraw(),this.viewManager&&this.viewManager.updateViewStates()}_onViewStateChange(e){const t=this.props.onViewStateChange(e)||e.viewState;this.viewState&&(this.viewState={...this.viewState,[e.viewId]:t},this.props.viewState||this.viewManager&&this.viewManager.setProps({viewState:this.viewState}))}_onInteractionStateChange(e){this.cursorState.isDragging=e.isDragging||!1,this.props.onInteractionStateChange(e)}_getFrameStats(){const{stats:e}=this;e.get("frameRate").timeEnd(),e.get("frameRate").timeStart();const t=this.animationLoop.stats;e.get("GPU Time").addTime(t.get("GPU Time").lastTiming),e.get("CPU Time").addTime(t.get("CPU Time").lastTiming)}_getMetrics(){const{metrics:e,stats:t}=this;e.fps=t.get("frameRate").getHz(),e.setPropsTime=t.get("setProps Time").time,e.updateAttributesTime=t.get("Update Attributes").time,e.framesRedrawn=t.get("Redraw Count").count,e.pickTime=t.get("pickObject Time").time+t.get("pickMultipleObjects Time").time+t.get("pickObjects Time").time,e.pickCount=t.get("Pick Count").count,e.gpuTime=t.get("GPU Time").time,e.cpuTime=t.get("CPU Time").time,e.gpuTimePerFrame=t.get("GPU Time").getAverageTime(),e.cpuTimePerFrame=t.get("CPU Time").getAverageTime();const r=Fg.stats.get("Memory Usage");e.bufferMemory=r.get("Buffer Memory").count,e.textureMemory=r.get("Texture Memory").count,e.renderbufferMemory=r.get("Renderbuffer Memory").count,e.gpuMemory=r.get("GPU Memory").count}}um.defaultProps=qx;um.VERSION=YD;function Rz(n){switch(n){case"float64":return Float64Array;case"uint8":case"unorm8":return Uint8ClampedArray;default:return Aw(n)}}const Cz=Sw;function _u(n,e,t){const r=t==="webgpu"&&e.type==="uint8"?"unorm8":e.type;return{attribute:n,format:e.size>1?`${r}x${e.size}`:e.type,byteOffset:e.offset||0}}function Hi(n){return n.stride||n.size*n.bytesPerElement}function Mz(n,e){return n.type===e.type&&n.size===e.size&&Hi(n)===Hi(e)&&(n.offset||0)===(e.offset||0)}function d_(n,e){e.offset&&tt.removed("shaderAttribute.offset","vertexOffset, elementOffset")();const t=Hi(n),r=e.vertexOffset!==void 0?e.vertexOffset:n.vertexOffset||0,i=e.elementOffset||0,a=r*t+i*n.bytesPerElement+(n.offset||0);return{...e,offset:a,stride:t}}function Oz(n,e){const t=d_(n,e);return{high:t,low:{...t,offset:t.offset+n.size*4}}}class Iz{constructor(e,t,r){this._buffer=null,this.device=e,this.id=t.id||"",this.size=t.size||1;const i=t.logicalType||t.type,a=i==="float64";let{defaultValue:l}=t;l=Number.isFinite(l)?[l]:l||new Array(this.size).fill(0);let c;a?c="float32":!i&&t.isIndexed?c="uint32":c=i||"float32";let f=Rz(i||c);this.doublePrecision=a,a&&t.fp64===!1&&(f=Float32Array),this.value=null,this.settings={...t,defaultType:f,defaultValue:l,logicalType:i,type:c,normalized:c.includes("norm"),size:this.size,bytesPerElement:f.BYTES_PER_ELEMENT},this.state={...r,externalBuffer:null,bufferAccessor:this.settings,allocatedValue:null,numInstances:0,bounds:null,constant:!1}}get isConstant(){return this.state.constant}get buffer(){return this._buffer}get byteOffset(){const e=this.getAccessor();return e.vertexOffset?e.vertexOffset*Hi(e):0}get numInstances(){return this.state.numInstances}set numInstances(e){this.state.numInstances=e}delete(){this._buffer&&(this._buffer.delete(),this._buffer=null),Al.release(this.state.allocatedValue)}getBuffer(){return this.state.constant?null:this.state.externalBuffer||this._buffer}getValue(e=this.id,t=null){const r={};if(this.state.constant){const i=this.value;if(t){const a=d_(this.getAccessor(),t),l=a.offset/i.BYTES_PER_ELEMENT,c=a.size||this.size;r[e]=i.subarray(l,l+c)}else r[e]=i}else r[e]=this.getBuffer();return this.doublePrecision&&(this.value instanceof Float64Array?r[`${e}64Low`]=r[e]:r[`${e}64Low`]=new Float32Array(this.size)),r}_getBufferLayout(e=this.id,t=null){const r=this.getAccessor(),i=[],a={name:this.id,byteStride:Hi(r),attributes:i};if(this.doublePrecision){const l=Oz(r,t||{});i.push(_u(e,{...r,...l.high},this.device.type),_u(`${e}64Low`,{...r,...l.low},this.device.type))}else if(t){const l=d_(r,t);i.push(_u(e,{...r,...l},this.device.type))}else i.push(_u(e,r,this.device.type));return a}setAccessor(e){this.state.bufferAccessor=e}getAccessor(){return this.state.bufferAccessor}getBounds(){if(this.state.bounds)return this.state.bounds;let e=null;if(this.state.constant&&this.value){const t=Array.from(this.value);e=[t,t]}else{const{value:t,numInstances:r,size:i}=this,a=r*i;if(t&&a&&t.length>=a){const l=new Array(i).fill(1/0),c=new Array(i).fill(-1/0);for(let f=0;f<a;)for(let d=0;d<i;d++){const p=t[f++];p<l[d]&&(l[d]=p),p>c[d]&&(c[d]=p)}e=[l,c]}}return this.state.bounds=e,e}setData(e){const{state:t}=this;let r;ArrayBuffer.isView(e)?r={value:e}:e instanceof rt?r={buffer:e}:r=e;const i={...this.settings,...r};if(ArrayBuffer.isView(r.value)){if(!r.type)if(this.doublePrecision&&r.value instanceof Float64Array)i.type="float32";else{const l=Cz(r.value);i.type=i.normalized?l.replace("int","norm"):l}i.bytesPerElement=r.value.BYTES_PER_ELEMENT,i.stride=Hi(i)}if(t.bounds=null,r.constant){let a=r.value;if(a=this._normalizeValue(a,[],0),this.settings.normalized&&(a=this.normalizeConstant(a)),!(!t.constant||!this._areValuesEqual(a,this.value)))return!1;t.externalBuffer=null,t.constant=!0,this.value=ArrayBuffer.isView(a)?a:new Float32Array(a)}else if(r.buffer){const a=r.buffer;t.externalBuffer=a,t.constant=!1,this.value=r.value||null}else if(r.value){this._checkExternalBuffer(r);let a=r.value;t.externalBuffer=null,t.constant=!1,this.value=a;let{buffer:l}=this;const c=Hi(i),f=(i.vertexOffset||0)*c;if(this.doublePrecision&&a instanceof Float64Array&&(a=qp(a,i)),this.settings.isIndexed){const p=this.settings.defaultType;a.constructor!==p&&(a=new p(a))}const d=a.byteLength+f+c*2;(!l||l.byteLength<d)&&(l=this._createBuffer(d)),l.write(a,f)}return this.setAccessor(i),!0}updateSubBuffer(e={}){this.state.bounds=null;const t=this.value,{startOffset:r=0,endOffset:i}=e;this.buffer.write(this.doublePrecision&&t instanceof Float64Array?qp(t,{size:this.size,startIndex:r,endIndex:i}):t.subarray(r,i),r*t.BYTES_PER_ELEMENT+this.byteOffset)}allocate(e,t=!1){const{state:r}=this,i=r.allocatedValue,a=Al.allocate(i,e+1,{size:this.size,type:this.settings.defaultType,copy:t});this.value=a;const{byteOffset:l}=this;let{buffer:c}=this;return(!c||c.byteLength<a.byteLength+l)&&(c=this._createBuffer(a.byteLength+l),t&&i&&c.write(i instanceof Float64Array?qp(i,this):i,l)),r.allocatedValue=a,r.constant=!1,r.externalBuffer=null,this.setAccessor(this.settings),!0}_checkExternalBuffer(e){const{value:t}=e;if(!ArrayBuffer.isView(t))throw new Error(`Attribute ${this.id} value is not TypedArray`);const r=this.settings.defaultType;let i=!1;if(this.doublePrecision&&(i=t.BYTES_PER_ELEMENT<4),i)throw new Error(`Attribute ${this.id} does not support ${t.constructor.name}`);!(t instanceof r)&&this.settings.normalized&&!("normalized"in e)&&tt.warn(`Attribute ${this.id} is normalized`)()}normalizeConstant(e){switch(this.settings.type){case"snorm8":return new Float32Array(e).map(t=>(t+128)/255*2-1);case"snorm16":return new Float32Array(e).map(t=>(t+32768)/65535*2-1);case"unorm8":return new Float32Array(e).map(t=>t/255);case"unorm16":return new Float32Array(e).map(t=>t/65535);default:return e}}_normalizeValue(e,t,r){const{defaultValue:i,size:a}=this.settings;if(Number.isFinite(e))return t[r]=e,t;if(!e){let l=a;for(;--l>=0;)t[r+l]=i[l];return t}switch(a){case 4:t[r+3]=Number.isFinite(e[3])?e[3]:i[3];case 3:t[r+2]=Number.isFinite(e[2])?e[2]:i[2];case 2:t[r+1]=Number.isFinite(e[1])?e[1]:i[1];case 1:t[r+0]=Number.isFinite(e[0])?e[0]:i[0];break;default:let l=a;for(;--l>=0;)t[r+l]=Number.isFinite(e[l])?e[l]:i[l]}return t}_areValuesEqual(e,t){if(!e||!t)return!1;const{size:r}=this;for(let i=0;i<r;i++)if(e[i]!==t[i])return!1;return!0}_createBuffer(e){var i;this._buffer&&this._buffer.destroy();const{isIndexed:t,type:r}=this.settings;return this._buffer=this.device.createBuffer({...(i=this._buffer)==null?void 0:i.props,id:this.id,usage:(t?rt.INDEX:rt.VERTEX)|rt.COPY_DST,indexType:t?r:void 0,byteLength:e}),this._buffer}}const o2=[],l2=[];function Nz(n,e=0,t=1/0){let r=o2;const i={index:-1,data:n,target:[]};return n?typeof n[Symbol.iterator]=="function"?r=n:n.length>0&&(l2.length=n.length,r=l2):r=o2,(e>0||Number.isFinite(t))&&(r=(Array.isArray(r)?r:Array.from(r)).slice(e,t),i.index=e-1),{iterable:r,objectInfo:i}}function Kx(n){return n&&n[Symbol.asyncIterator]}function kz(n,e){const{size:t,stride:r,offset:i,startIndices:a,nested:l}=e,c=n.BYTES_PER_ELEMENT,f=r?r/c:t,d=i?i/c:0,p=Math.floor((n.length-d)/f);return(_,{index:y,target:b})=>{if(!a){const N=y*f+d;for(let O=0;O<t;O++)b[O]=n[N+O];return b}const T=a[y],A=a[y+1]||p;let C;if(l){C=new Array(A-T);for(let N=T;N<A;N++){const O=N*f+d;b=new Array(t);for(let R=0;R<t;R++)b[R]=n[O+R];C[N-T]=b}}else if(f===t)C=n.subarray(T*t+d,A*t+d);else{C=new n.constructor((A-T)*t);let N=0;for(let O=T;O<A;O++){const R=O*f+d;for(let E=0;E<t;E++)C[N++]=n[R+E]}}return C}}const Dz=[],Eu=[[0,1/0]];function Pz(n,e){if(n===Eu||(e[0]<0&&(e[0]=0),e[0]>=e[1]))return n;const t=[],r=n.length;let i=0;for(let a=0;a<r;a++){const l=n[a];l[1]<e[0]?(t.push(l),i=a+1):l[0]>e[1]?t.push(l):e=[Math.min(l[0],e[0]),Math.max(l[1],e[1])]}return t.splice(i,0,e),t}const Uz={interpolation:{duration:0,easing:n=>n},spring:{stiffness:.05,damping:.5}};function Zx(n,e){if(!n)return null;Number.isFinite(n)&&(n={type:"interpolation",duration:n});const t=n.type||"interpolation";return{...Uz[t],...e,...n,type:t}}class Qx extends Iz{constructor(e,t){super(e,t,{startIndices:null,lastExternalBuffer:null,binaryValue:null,binaryAccessor:null,needsUpdate:!0,needsRedraw:!1,layoutChanged:!1,updateRanges:Eu}),this.constant=!1,this.settings.update=t.update||(t.accessor?this._autoUpdater:void 0),Object.seal(this.settings),Object.seal(this.state),this._validateAttributeUpdaters()}get startIndices(){return this.state.startIndices}set startIndices(e){this.state.startIndices=e}needsUpdate(){return this.state.needsUpdate}needsRedraw({clearChangedFlags:e=!1}={}){const t=this.state.needsRedraw;return this.state.needsRedraw=t&&!e,t}layoutChanged(){return this.state.layoutChanged}setAccessor(e){var t;(t=this.state).layoutChanged||(t.layoutChanged=!Mz(e,this.getAccessor())),super.setAccessor(e)}getUpdateTriggers(){const{accessor:e}=this.settings;return[this.id].concat(typeof e!="function"&&e||[])}supportsTransition(){return!!this.settings.transition}getTransitionSetting(e){if(!e||!this.supportsTransition())return null;const{accessor:t}=this.settings,r=this.settings.transition,i=Array.isArray(t)?e[t.find(a=>e[a])]:e[t];return Zx(i,r)}setNeedsUpdate(e=this.id,t){if(this.state.needsUpdate=this.state.needsUpdate||e,this.setNeedsRedraw(e),t){const{startRow:r=0,endRow:i=1/0}=t;this.state.updateRanges=Pz(this.state.updateRanges,[r,i])}else this.state.updateRanges=Eu}clearNeedsUpdate(){this.state.needsUpdate=!1,this.state.updateRanges=Dz}setNeedsRedraw(e=this.id){this.state.needsRedraw=this.state.needsRedraw||e}allocate(e){const{state:t,settings:r}=this;return r.noAlloc?!1:r.update?(super.allocate(e,t.updateRanges!==Eu),!0):!1}updateBuffer({numInstances:e,data:t,props:r,context:i}){if(!this.needsUpdate())return!1;const{state:{updateRanges:a},settings:{update:l,noAlloc:c}}=this;let f=!0;if(l){for(const[d,p]of a)l.call(i,this,{data:t,startRow:d,endRow:p,props:r,numInstances:e});if(this.value)if(this.constant||!this.buffer||this.buffer.byteLength<this.value.byteLength+this.byteOffset)this.setData({value:this.value,constant:this.constant}),this.constant=!1;else for(const[d,p]of a){const _=Number.isFinite(d)?this.getVertexOffset(d):0,y=Number.isFinite(p)?this.getVertexOffset(p):c||!Number.isFinite(e)?this.value.length:e*this.size;super.updateSubBuffer({startOffset:_,endOffset:y})}this._checkAttributeArray()}else f=!1;return this.clearNeedsUpdate(),this.setNeedsRedraw(),f}setConstantValue(e){return this.device.type==="webgpu"||e===void 0||typeof e=="function"?!1:(this.setData({constant:!0,value:e})&&this.setNeedsRedraw(),this.clearNeedsUpdate(),!0)}setExternalBuffer(e){const{state:t}=this;return e?(this.clearNeedsUpdate(),t.lastExternalBuffer===e||(t.lastExternalBuffer=e,this.setNeedsRedraw(),this.setData(e)),!0):(t.lastExternalBuffer=null,!1)}setBinaryValue(e,t=null){const{state:r,settings:i}=this;if(!e)return r.binaryValue=null,r.binaryAccessor=null,!1;if(i.noAlloc)return!1;if(r.binaryValue===e)return this.clearNeedsUpdate(),!0;if(r.binaryValue=e,this.setNeedsRedraw(),i.transform||t!==this.startIndices){ArrayBuffer.isView(e)&&(e={value:e});const l=e;Vt(ArrayBuffer.isView(l.value),`invalid ${i.accessor}`);const c=!!l.size&&l.size!==this.size;return r.binaryAccessor=kz(l.value,{size:l.size||this.size,stride:l.stride,offset:l.offset,startIndices:t,nested:c}),!1}return this.clearNeedsUpdate(),this.setData(e),!0}getVertexOffset(e){const{startIndices:t}=this;return(t?e<t.length?t[e]:this.numInstances:e)*this.size}getValue(){const e=this.settings.shaderAttributes,t=super.getValue();if(!e)return t;for(const r in e)Object.assign(t,super.getValue(r,e[r]));return t}getBufferLayout(e){this.state.layoutChanged=!1;const t=this.settings.shaderAttributes,r=super._getBufferLayout(),{stepMode:i}=this.settings;if(i==="dynamic"?r.stepMode=e?e.isInstanced?"instance":"vertex":"instance":r.stepMode=i??"vertex",!t)return r;for(const a in t){const l=super._getBufferLayout(a,t[a]);r.attributes.push(...l.attributes)}return r}_autoUpdater(e,{data:t,startRow:r,endRow:i,props:a,numInstances:l}){if(e.constant&&this.context.device.type!=="webgpu")return;const{settings:c,state:f,value:d,size:p,startIndices:_}=e,{accessor:y,transform:b}=c;let T=f.binaryAccessor||(typeof y=="function"?y:a[y]);typeof T!="function"&&(T=()=>T),Vt(typeof T=="function",`accessor "${y}" is not a function`);let A=e.getVertexOffset(r);const{iterable:C,objectInfo:N}=Nz(t,r,i);for(const O of C){N.index++;let R=T(O,N);if(b&&(R=b.call(this,R)),_){const E=(N.index<_.length-1?_[N.index+1]:l)-_[N.index];if(R&&Array.isArray(R[0])){let k=A;for(const V of R)e._normalizeValue(V,d,k),k+=p}else R&&R.length>p?d.set(R,A):(e._normalizeValue(R,N.target,0),qF({target:d,source:N.target,start:A,count:E}));A+=E*p}else e._normalizeValue(R,d,A),A+=p}}_validateAttributeUpdaters(){const{settings:e}=this;if(!(e.noAlloc||typeof e.update=="function"))throw new Error(`Attribute ${this.id} missing update or accessor`)}_checkAttributeArray(){const{value:e}=this,t=Math.min(4,this.size);if(e&&e.length>=t){let r=!0;switch(t){case 4:r=r&&Number.isFinite(e[3]);case 3:r=r&&Number.isFinite(e[2]);case 2:r=r&&Number.isFinite(e[1]);case 1:r=r&&Number.isFinite(e[0]);break;default:r=!1}if(!r)throw new Error(`Illegal attribute generated for ${this.id}`)}}}function rg(n){const{source:e,target:t,start:r=0,size:i,getData:a}=n,l=n.end||t.length,c=e.length,f=l-r;if(c>f){t.set(e.subarray(0,f),r);return}if(t.set(e,r),!a)return;let d=c;for(;d<f;){const p=a(d,e);for(let _=0;_<i;_++)t[r+d]=p[_]||0,d++}}function Bz({source:n,target:e,size:t,getData:r,sourceStartIndices:i,targetStartIndices:a}){if(!i||!a)return rg({source:n,target:e,size:t,getData:r}),e;let l=0,c=0;const f=r&&((p,_)=>r(p+c,_)),d=Math.min(i.length,a.length);for(let p=1;p<d;p++){const _=i[p]*t,y=a[p]*t;rg({source:n.subarray(l,_),target:e,start:c,end:y,size:t,getData:f}),l=_,c=y}return c<e.length&&rg({source:[],target:e,start:c,size:t,getData:f}),e}function Fz(n){const{device:e,settings:t,value:r}=n,i=new Qx(e,t);return i.setData({value:r instanceof Float64Array?new Float64Array(0):new Float32Array(0),normalized:t.normalized}),i}function Gx(n){switch(n){case 1:return"float";case 2:return"vec2";case 3:return"vec3";case 4:return"vec4";default:throw new Error(`No defined attribute type for size "${n}"`)}}function Jx(n){switch(n){case 1:return"float32";case 2:return"float32x2";case 3:return"float32x3";case 4:return"float32x4";default:throw new Error("invalid type size")}}function eS(n){n.push(n.shift())}function Lz(n,e){const{doublePrecision:t,settings:r,value:i,size:a}=n,l=t&&i instanceof Float64Array?2:1;let c=0;const{shaderAttributes:f}=n.settings;if(f)for(const d of Object.values(f))c=Math.max(c,d.vertexOffset??0);return(r.noAlloc?i.length:(e+c)*a)*l}function tS({device:n,source:e,target:t}){return(!t||t.byteLength<e.byteLength)&&(t==null||t.destroy(),t=n.createBuffer({byteLength:e.byteLength,usage:e.usage})),t}function nS({device:n,buffer:e,attribute:t,fromLength:r,toLength:i,fromStartIndices:a,getData:l=c=>c}){const c=t.doublePrecision&&t.value instanceof Float64Array?2:1,f=t.size*c,d=t.byteOffset,p=t.settings.bytesPerElement<4?d/t.settings.bytesPerElement*4:d,_=t.startIndices,y=a&&_,b=t.isConstant;if(!y&&e&&r>=i)return e;const T=t.value instanceof Float64Array?Float32Array:t.value.constructor,A=b?t.value:new T(t.getBuffer().readSyncWebGL(d,i*T.BYTES_PER_ELEMENT).buffer);if(t.settings.normalized&&!b){const R=l;l=(E,k)=>t.normalizeConstant(R(E,k))}const C=b?(R,E)=>l(A,E):(R,E)=>l(A.subarray(R+d,R+d+f),E),N=e?new Float32Array(e.readSyncWebGL(p,r*4).buffer):new Float32Array(0),O=new Float32Array(i);return Bz({source:N,target:O,sourceStartIndices:a,targetStartIndices:_,size:f,getData:C}),(!e||e.byteLength<O.byteLength+p)&&(e==null||e.destroy(),e=n.createBuffer({byteLength:O.byteLength+p,usage:35050})),e.write(O,p),e}class rS{constructor({device:e,attribute:t,timeline:r}){this.buffers=[],this.currentLength=0,this.device=e,this.transition=new jf(r),this.attribute=t,this.attributeInTransition=Fz(t),this.currentStartIndices=t.startIndices}get inProgress(){return this.transition.inProgress}start(e,t,r=1/0){this.settings=e,this.currentStartIndices=this.attribute.startIndices,this.currentLength=Lz(this.attribute,t),this.transition.start({...e,duration:r})}update(){const e=this.transition.update();return e&&this.onUpdate(),e}setBuffer(e){this.attributeInTransition.setData({buffer:e,normalized:this.attribute.settings.normalized,value:this.attributeInTransition.value})}cancel(){this.transition.cancel()}delete(){this.cancel();for(const e of this.buffers)e.destroy();this.buffers.length=0}}class zz extends rS{constructor({device:e,attribute:t,timeline:r}){super({device:e,attribute:t,timeline:r}),this.type="interpolation",this.transform=$z(e,t)}start(e,t){const r=this.currentLength,i=this.currentStartIndices;if(super.start(e,t,e.duration),e.duration<=0){this.transition.cancel();return}const{buffers:a,attribute:l}=this;eS(a),a[0]=nS({device:this.device,buffer:a[0],attribute:l,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter}),a[1]=tS({device:this.device,source:a[0],target:a[1]}),this.setBuffer(a[1]);const{transform:c}=this,f=c.model;let d=Math.floor(this.currentLength/l.size);iS(l)&&(d/=2),f.setVertexCount(d),l.isConstant?(f.setAttributes({aFrom:a[0]}),f.setConstantAttributes({aTo:l.value})):f.setAttributes({aFrom:a[0],aTo:l.getBuffer()}),c.transformFeedback.setBuffers({vCurrent:a[1]})}onUpdate(){const{duration:e,easing:t}=this.settings,{time:r}=this.transition;let i=r/e;t&&(i=t(i));const{model:a}=this.transform,l={time:i};a.shaderInputs.setProps({interpolation:l}),this.transform.run({discard:!0})}delete(){super.delete(),this.transform.destroy()}}const Vz=`uniform interpolationUniforms {
  float time;
} interpolation;
`,c2={name:"interpolation",vs:Vz,uniformTypes:{time:"f32"}},Hz=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vCurrent;

void main(void) {
  vCurrent = mix(aFrom, aTo, interpolation.time);
  gl_Position = vec4(0.0);
}
`,jz=`#version 300 es
#define SHADER_NAME interpolation-transition-vertex-shader

in ATTRIBUTE_TYPE aFrom;
in ATTRIBUTE_TYPE aFrom64Low;
in ATTRIBUTE_TYPE aTo;
in ATTRIBUTE_TYPE aTo64Low;
out ATTRIBUTE_TYPE vCurrent;
out ATTRIBUTE_TYPE vCurrent64Low;

vec2 mix_fp64(vec2 a, vec2 b, float x) {
  vec2 range = sub_fp64(b, a);
  return sum_fp64(a, mul_fp64(range, vec2(x, 0.0)));
}

void main(void) {
  for (int i=0; i<ATTRIBUTE_SIZE; i++) {
    vec2 value = mix_fp64(vec2(aFrom[i], aFrom64Low[i]), vec2(aTo[i], aTo64Low[i]), interpolation.time);
    vCurrent[i] = value.x;
    vCurrent64Low[i] = value.y;
  }
  gl_Position = vec4(0.0);
}
`;function iS(n){return n.doublePrecision&&n.value instanceof Float64Array}function $z(n,e){const t=e.size,r=Gx(t),i=Jx(t),a=e.getBufferLayout();return iS(e)?new Rl(n,{vs:jz,bufferLayout:[{name:"aFrom",byteStride:8*t,attributes:[{attribute:"aFrom",format:i,byteOffset:0},{attribute:"aFrom64Low",format:i,byteOffset:4*t}]},{name:"aTo",byteStride:8*t,attributes:[{attribute:"aTo",format:i,byteOffset:0},{attribute:"aTo64Low",format:i,byteOffset:4*t}]}],modules:[GU,c2],defines:{ATTRIBUTE_TYPE:r,ATTRIBUTE_SIZE:t},moduleSettings:{},varyings:["vCurrent","vCurrent64Low"],bufferMode:35980,disableWarnings:!0}):new Rl(n,{vs:Hz,bufferLayout:[{name:"aFrom",format:i},{name:"aTo",format:a.attributes[0].format}],modules:[c2],defines:{ATTRIBUTE_TYPE:r},varyings:["vCurrent"],disableWarnings:!0})}class Wz extends rS{constructor({device:e,attribute:t,timeline:r}){super({device:e,attribute:t,timeline:r}),this.type="spring",this.texture=Qz(e),this.framebuffer=Gz(e,this.texture),this.transform=Zz(e,t)}start(e,t){const r=this.currentLength,i=this.currentStartIndices;super.start(e,t);const{buffers:a,attribute:l}=this;for(let f=0;f<2;f++)a[f]=nS({device:this.device,buffer:a[f],attribute:l,fromLength:r,toLength:this.currentLength,fromStartIndices:i,getData:e.enter});a[2]=tS({device:this.device,source:a[0],target:a[2]}),this.setBuffer(a[1]);const{model:c}=this.transform;c.setVertexCount(Math.floor(this.currentLength/l.size)),l.isConstant?c.setConstantAttributes({aTo:l.value}):c.setAttributes({aTo:l.getBuffer()})}onUpdate(){const{buffers:e,transform:t,framebuffer:r,transition:i}=this,a=this.settings;t.model.setAttributes({aPrev:e[0],aCur:e[1]}),t.transformFeedback.setBuffers({vNext:e[2]});const l={stiffness:a.stiffness,damping:a.damping};t.model.shaderInputs.setProps({spring:l}),t.run({framebuffer:r,discard:!1,parameters:{viewport:[0,0,1,1]},clearColor:[0,0,0,0]}),eS(e),this.setBuffer(e[1]),this.device.readPixelsToArrayWebGL(r)[0]>0||i.end()}delete(){super.delete(),this.transform.destroy(),this.texture.destroy(),this.framebuffer.destroy()}}const Xz=`uniform springUniforms {
  float damping;
  float stiffness;
} spring;
`,Yz={name:"spring",vs:Xz,uniformTypes:{damping:"f32",stiffness:"f32"}},qz=`#version 300 es
#define SHADER_NAME spring-transition-vertex-shader

#define EPSILON 0.00001

in ATTRIBUTE_TYPE aPrev;
in ATTRIBUTE_TYPE aCur;
in ATTRIBUTE_TYPE aTo;
out ATTRIBUTE_TYPE vNext;
out float vIsTransitioningFlag;

ATTRIBUTE_TYPE getNextValue(ATTRIBUTE_TYPE cur, ATTRIBUTE_TYPE prev, ATTRIBUTE_TYPE dest) {
  ATTRIBUTE_TYPE velocity = cur - prev;
  ATTRIBUTE_TYPE delta = dest - cur;
  ATTRIBUTE_TYPE force = delta * spring.stiffness;
  ATTRIBUTE_TYPE resistance = velocity * spring.damping;
  return force - resistance + velocity + cur;
}

void main(void) {
  bool isTransitioning = length(aCur - aPrev) > EPSILON || length(aTo - aCur) > EPSILON;
  vIsTransitioningFlag = isTransitioning ? 1.0 : 0.0;

  vNext = getNextValue(aCur, aPrev, aTo);
  gl_Position = vec4(0, 0, 0, 1);
  gl_PointSize = 100.0;
}
`,Kz=`#version 300 es
#define SHADER_NAME spring-transition-is-transitioning-fragment-shader

in float vIsTransitioningFlag;

out vec4 fragColor;

void main(void) {
  if (vIsTransitioningFlag == 0.0) {
    discard;
  }
  fragColor = vec4(1.0);
}`;function Zz(n,e){const t=Gx(e.size),r=Jx(e.size);return new Rl(n,{vs:qz,fs:Kz,bufferLayout:[{name:"aPrev",format:r},{name:"aCur",format:r},{name:"aTo",format:e.getBufferLayout().attributes[0].format}],varyings:["vNext"],modules:[Yz],defines:{ATTRIBUTE_TYPE:t},parameters:{depthCompare:"always",blendColorOperation:"max",blendColorSrcFactor:"one",blendColorDstFactor:"one",blendAlphaOperation:"max",blendAlphaSrcFactor:"one",blendAlphaDstFactor:"one"}})}function Qz(n){return n.createTexture({data:new Uint8Array(4),format:"rgba8unorm",mipmaps:!1,width:1,height:1})}function Gz(n,e){return n.createFramebuffer({id:"spring-transition-is-transitioning-framebuffer",width:1,height:1,colorAttachments:[e]})}const Jz={interpolation:zz,spring:Wz};class eV{constructor(e,{id:t,timeline:r}){if(!e)throw new Error("AttributeTransitionManager is constructed without device");this.id=t,this.device=e,this.timeline=r,this.transitions={},this.needsRedraw=!1,this.numInstances=1}finalize(){for(const e in this.transitions)this._removeTransition(e)}update({attributes:e,transitions:t,numInstances:r}){this.numInstances=r||1;for(const i in e){const a=e[i],l=a.getTransitionSetting(t);l&&this._updateAttribute(i,a,l)}for(const i in this.transitions){const a=e[i];(!a||!a.getTransitionSetting(t))&&this._removeTransition(i)}}hasAttribute(e){const t=this.transitions[e];return t&&t.inProgress}getAttributes(){const e={};for(const t in this.transitions){const r=this.transitions[t];r.inProgress&&(e[t]=r.attributeInTransition)}return e}run(){if(this.numInstances===0)return!1;for(const t in this.transitions)this.transitions[t].update()&&(this.needsRedraw=!0);const e=this.needsRedraw;return this.needsRedraw=!1,e}_removeTransition(e){this.transitions[e].delete(),delete this.transitions[e]}_updateAttribute(e,t,r){const i=this.transitions[e];let a=!i||i.type!==r.type;if(a){i&&this._removeTransition(e);const l=Jz[r.type];l?this.transitions[e]=new l({attribute:t,timeline:this.timeline,device:this.device}):(tt.error(`unsupported transition type '${r.type}'`)(),a=!1)}(a||t.needsRedraw())&&(this.needsRedraw=!0,this.transitions[e].start(r,this.numInstances))}}const u2="attributeManager.invalidate",tV="attributeManager.updateStart",nV="attributeManager.updateEnd",rV="attribute.updateStart",iV="attribute.allocate",sV="attribute.updateEnd";class aV{constructor(e,{id:t="attribute-manager",stats:r,timeline:i}={}){this.mergeBoundsMemoized=Dl(_F),this.id=t,this.device=e,this.attributes={},this.updateTriggers={},this.needsRedraw=!0,this.userData={},this.stats=r,this.attributeTransitionManager=new eV(e,{id:`${t}-transitions`,timeline:i}),Object.seal(this)}finalize(){for(const e in this.attributes)this.attributes[e].delete();this.attributeTransitionManager.finalize()}getNeedsRedraw(e={clearRedrawFlags:!1}){const t=this.needsRedraw;return this.needsRedraw=this.needsRedraw&&!e.clearRedrawFlags,t&&this.id}setNeedsRedraw(){this.needsRedraw=!0}add(e){this._add(e)}addInstanced(e){this._add(e,{stepMode:"instance"})}remove(e){for(const t of e)this.attributes[t]!==void 0&&(this.attributes[t].delete(),delete this.attributes[t])}invalidate(e,t){const r=this._invalidateTrigger(e,t);Yt(u2,this,e,r)}invalidateAll(e){for(const t in this.attributes)this.attributes[t].setNeedsUpdate(t,e);Yt(u2,this,"all")}update({data:e,numInstances:t,startIndices:r=null,transitions:i,props:a={},buffers:l={},context:c={}}){let f=!1;Yt(tV,this),this.stats&&this.stats.get("Update Attributes").timeStart();for(const d in this.attributes){const p=this.attributes[d],_=p.settings.accessor;p.startIndices=r,p.numInstances=t,a[d]&&tt.removed(`props.${d}`,`data.attributes.${d}`)(),p.setExternalBuffer(l[d])||p.setBinaryValue(typeof _=="string"?l[_]:void 0,e.startIndices)||typeof _=="string"&&!l[_]&&p.setConstantValue(a[_])||p.needsUpdate()&&(f=!0,this._updateAttribute({attribute:p,numInstances:t,data:e,props:a,context:c})),this.needsRedraw=this.needsRedraw||p.needsRedraw()}f&&Yt(nV,this,t),this.stats&&this.stats.get("Update Attributes").timeEnd(),this.attributeTransitionManager.update({attributes:this.attributes,numInstances:t,transitions:i})}updateTransition(){const{attributeTransitionManager:e}=this,t=e.run();return this.needsRedraw=this.needsRedraw||t,t}getAttributes(){return{...this.attributes,...this.attributeTransitionManager.getAttributes()}}getBounds(e){const t=e.map(r=>{var i;return(i=this.attributes[r])==null?void 0:i.getBounds()});return this.mergeBoundsMemoized(t)}getChangedAttributes(e={clearChangedFlags:!1}){const{attributes:t,attributeTransitionManager:r}=this,i={...r.getAttributes()};for(const a in t){const l=t[a];l.needsRedraw(e)&&!r.hasAttribute(a)&&(i[a]=l)}return i}getBufferLayouts(e){return Object.values(this.getAttributes()).map(t=>t.getBufferLayout(e))}_add(e,t){for(const r in e){const i=e[r],a={...i,id:r,size:i.isIndexed&&1||i.size||1,...t};this.attributes[r]=new Qx(this.device,a)}this._mapUpdateTriggersToAttributes()}_mapUpdateTriggersToAttributes(){const e={};for(const t in this.attributes)this.attributes[t].getUpdateTriggers().forEach(i=>{e[i]||(e[i]=[]),e[i].push(t)});this.updateTriggers=e}_invalidateTrigger(e,t){const{attributes:r,updateTriggers:i}=this,a=i[e];return a&&a.forEach(l=>{const c=r[l];c&&c.setNeedsUpdate(c.id,t)}),a}_updateAttribute(e){const{attribute:t,numInstances:r}=e;if(Yt(rV,t),t.constant){t.setConstantValue(t.value);return}t.allocate(r)&&Yt(iV,t,r),t.updateBuffer(e)&&(this.needsRedraw=!0,Yt(sV,t,r))}}class oV extends jf{get value(){return this._value}_onUpdate(){const{time:e,settings:{fromValue:t,toValue:r,duration:i,easing:a}}=this,l=a(e/i);this._value=xl(t,r,l)}}const f2=1e-5;function h2(n,e,t,r,i){const a=e-n,c=(t-e)*i,f=-a*r;return c+f+a+e}function lV(n,e,t,r,i){if(Array.isArray(t)){const a=[];for(let l=0;l<t.length;l++)a[l]=h2(n[l],e[l],t[l],r,i);return a}return h2(n,e,t,r,i)}function d2(n,e){if(Array.isArray(n)){let t=0;for(let r=0;r<n.length;r++){const i=n[r]-e[r];t+=i*i}return Math.sqrt(t)}return Math.abs(n-e)}class cV extends jf{get value(){return this._currValue}_onUpdate(){const{fromValue:e,toValue:t,damping:r,stiffness:i}=this.settings,{_prevValue:a=e,_currValue:l=e}=this;let c=lV(a,l,t,r,i);const f=d2(c,t),d=d2(c,l);f<f2&&d<f2&&(c=t,this.end()),this._prevValue=l,this._currValue=c}}const uV={interpolation:oV,spring:cV};class fV{constructor(e){this.transitions=new Map,this.timeline=e}get active(){return this.transitions.size>0}add(e,t,r,i){const{transitions:a}=this;if(a.has(e)){const f=a.get(e),{value:d=f.settings.fromValue}=f;t=d,this.remove(e)}if(i=Zx(i),!i)return;const l=uV[i.type];if(!l){tt.error(`unsupported transition type '${i.type}'`)();return}const c=new l(this.timeline);c.start({...i,fromValue:t,toValue:r}),a.set(e,c)}remove(e){const{transitions:t}=this;t.has(e)&&(t.get(e).cancel(),t.delete(e))}update(){const e={};for(const[t,r]of this.transitions)r.update(),e[t]=r.value,r.inProgress||this.remove(t);return e}clear(){for(const e of this.transitions.keys())this.remove(e)}}function hV(n){const e=n[Xi];for(const t in e){const r=e[t],{validate:i}=r;if(i&&!i(n[t],r))throw new Error(`Invalid prop ${t}: ${n[t]}`)}}function dV(n,e){const t=sS({newProps:n,oldProps:e,propTypes:n[Xi],ignoreProps:{data:null,updateTriggers:null,extensions:null,transitions:null}}),r=gV(n,e);let i=!1;return r||(i=_V(n,e)),{dataChanged:r,propsChanged:t,updateTriggersChanged:i,extensionsChanged:mV(n,e),transitionsChanged:pV(n,e)}}function pV(n,e){if(!n.transitions)return!1;const t={},r=n[Xi];let i=!1;for(const a in n.transitions){const l=r[a],c=l&&l.type;(c==="number"||c==="color"||c==="array")&&p_(n[a],e[a],l)&&(t[a]=!0,i=!0)}return i?t:!1}function sS({newProps:n,oldProps:e,ignoreProps:t={},propTypes:r={},triggerName:i="props"}){if(e===n)return!1;if(typeof n!="object"||n===null)return`${i} changed shallowly`;if(typeof e!="object"||e===null)return`${i} changed shallowly`;for(const a of Object.keys(n))if(!(a in t)){if(!(a in e))return`${i}.${a} added`;const l=p_(n[a],e[a],r[a]);if(l)return`${i}.${a} ${l}`}for(const a of Object.keys(e))if(!(a in t)){if(!(a in n))return`${i}.${a} dropped`;if(!Object.hasOwnProperty.call(n,a)){const l=p_(n[a],e[a],r[a]);if(l)return`${i}.${a} ${l}`}}return!1}function p_(n,e,t){let r=t&&t.equal;return r&&!r(n,e,t)||!r&&(r=n&&e&&n.equals,r&&!r.call(n,e))?"changed deeply":!r&&e!==n?"changed shallowly":null}function gV(n,e){if(e===null)return"oldProps is null, initial diff";let t=!1;const{dataComparator:r,_dataDiff:i}=n;return r?r(n.data,e.data)||(t="Data comparator detected a change"):n.data!==e.data&&(t="A new data container was supplied"),t&&i&&(t=i(n.data,e.data)||t),t}function _V(n,e){if(e===null)return{all:!0};if("all"in n.updateTriggers&&p2(n,e,"all"))return{all:!0};const t={};let r=!1;for(const i in n.updateTriggers)i!=="all"&&p2(n,e,i)&&(t[i]=!0,r=!0);return r?t:!1}function mV(n,e){if(e===null)return!0;const t=e.extensions,{extensions:r}=n;if(r===t)return!1;if(!t||!r||r.length!==t.length)return!0;for(let i=0;i<r.length;i++)if(!r[i].equals(t[i]))return!0;return!1}function p2(n,e,t){let r=n.updateTriggers[t];r=r??{};let i=e.updateTriggers[t];return i=i??{},sS({oldProps:i,newProps:r,triggerName:t})}const yV="count(): argument not an object",bV="count(): argument not a container";function vV(n){if(!wV(n))throw new Error(yV);if(typeof n.count=="function")return n.count();if(Number.isFinite(n.size))return n.size;if(Number.isFinite(n.length))return n.length;if(TV(n))return Object.keys(n).length;throw new Error(bV)}function TV(n){return n!==null&&typeof n=="object"&&n.constructor===Object}function wV(n){return n!==null&&typeof n=="object"}function g2(n,e){if(!e)return n;const t={...n,...e};if("defines"in e&&(t.defines={...n.defines,...e.defines}),"modules"in e&&(t.modules=(n.modules||[]).concat(e.modules),e.modules.some(r=>r.name==="project64"))){const r=t.modules.findIndex(i=>i.name==="project32");r>=0&&t.modules.splice(r,1)}if("inject"in e)if(!n.inject)t.inject=e.inject;else{const r={...n.inject};for(const i in e.inject)r[i]=(r[i]||"")+e.inject[i];t.inject=r}return t}const xV={minFilter:"linear",mipmapFilter:"linear",magFilter:"linear",addressModeU:"clamp-to-edge",addressModeV:"clamp-to-edge"},g_={};function SV(n,e,t,r){if(t instanceof ct)return t;t.constructor&&t.constructor.name!=="Object"&&(t={data:t});let i=null;t.compressed&&(i={minFilter:"linear",mipmapFilter:t.data.length>1?"nearest":"linear"});const a=e.createTexture({...t,sampler:{...xV,...i,...r},mipmaps:!0});return g_[a.id]=n,a}function AV(n,e){!e||!(e instanceof ct)||g_[e.id]===n&&(e.delete(),delete g_[e.id])}const EV={boolean:{validate(n,e){return!0},equal(n,e,t){return!!n==!!e}},number:{validate(n,e){return Number.isFinite(n)&&(!("max"in e)||n<=e.max)&&(!("min"in e)||n>=e.min)}},color:{validate(n,e){return e.optional&&!n||__(n)&&(n.length===3||n.length===4)},equal(n,e,t){return Vn(n,e,1)}},accessor:{validate(n,e){const t=mf(n);return t==="function"||t===mf(e.value)},equal(n,e,t){return typeof e=="function"?!0:Vn(n,e,1)}},array:{validate(n,e){return e.optional&&!n||__(n)},equal(n,e,t){const{compare:r}=t,i=Number.isInteger(r)?r:r?1:0;return r?Vn(n,e,i):n===e}},object:{equal(n,e,t){if(t.ignore)return!0;const{compare:r}=t,i=Number.isInteger(r)?r:r?1:0;return r?Vn(n,e,i):n===e}},function:{validate(n,e){return e.optional&&!n||typeof n=="function"},equal(n,e,t){return!t.compare&&t.ignore!==!1||n===e}},data:{transform:(n,e,t)=>{if(!n)return n;const{dataTransform:r}=t.props;return r?r(n):typeof n.shape=="string"&&n.shape.endsWith("-table")&&Array.isArray(n.data)?n.data:n}},image:{transform:(n,e,t)=>{const r=t.context;return!r||!r.device?null:SV(t.id,r.device,n,{...e.parameters,...t.props.textureParameters})},release:(n,e,t)=>{AV(t.id,n)}}};function RV(n){const e={},t={},r={};for(const[i,a]of Object.entries(n)){const l=a==null?void 0:a.deprecatedFor;if(l)r[i]=Array.isArray(l)?l:[l];else{const c=CV(i,a);e[i]=c,t[i]=c.value}}return{propTypes:e,defaultProps:t,deprecatedProps:r}}function CV(n,e){switch(mf(e)){case"object":return Xo(n,e);case"array":return Xo(n,{type:"array",value:e,compare:!1});case"boolean":return Xo(n,{type:"boolean",value:e});case"number":return Xo(n,{type:"number",value:e});case"function":return Xo(n,{type:"function",value:e,compare:!0});default:return{name:n,type:"unknown",value:e}}}function Xo(n,e){return"type"in e?{name:n,...EV[e.type],...e}:"value"in e?{name:n,type:mf(e.value),...e}:{name:n,type:"object",value:e}}function __(n){return Array.isArray(n)||ArrayBuffer.isView(n)}function mf(n){return __(n)?"array":n===null?"null":typeof n}function MV(n,e){let t;for(let a=e.length-1;a>=0;a--){const l=e[a];"extensions"in l&&(t=l.extensions)}const r=m_(n.constructor,t),i=Object.create(r);i[gf]=n,i[rs]={},i[di]={};for(let a=0;a<e.length;++a){const l=e[a];for(const c in l)i[c]=l[c]}return Object.freeze(i),i}const OV="_mergedDefaultProps";function m_(n,e){if(!(n instanceof $f.constructor))return{};let t=OV;if(e)for(const i of e){const a=i.constructor;a&&(t+=`:${a.extensionName||a.name}`)}const r=aS(n,t);return r||(n[t]=IV(n,e||[]))}function IV(n,e){if(!n.prototype)return null;const r=Object.getPrototypeOf(n),i=m_(r),a=aS(n,"defaultProps")||{},l=RV(a),c=Object.assign(Object.create(null),i,l.defaultProps),f=Object.assign(Object.create(null),i==null?void 0:i[Xi],l.propTypes),d=Object.assign(Object.create(null),i==null?void 0:i[Gp],l.deprecatedProps);for(const p of e){const _=m_(p.constructor);_&&(Object.assign(c,_),Object.assign(f,_[Xi]),Object.assign(d,_[Gp]))}return NV(c,n),DV(c,f),kV(c,d),c[Xi]=f,c[Gp]=d,e.length===0&&!fm(n,"_propTypes")&&(n._propTypes=f),c}function NV(n,e){const t=UV(e);Object.defineProperties(n,{id:{writable:!0,value:t}})}function kV(n,e){for(const t in e)Object.defineProperty(n,t,{enumerable:!1,set(r){const i=`${this.id}: ${t}`;for(const a of e[t])fm(this,a)||(this[a]=r);tt.deprecated(i,e[t].join("/"))()}})}function DV(n,e){const t={},r={};for(const i in e){const a=e[i],{name:l,value:c}=a;a.async&&(t[l]=c,r[l]=PV(l))}n[ma]=t,n[rs]={},Object.defineProperties(n,r)}function PV(n){return{enumerable:!0,set(e){typeof e=="string"||e instanceof Promise||Kx(e)?this[rs][n]=e:this[di][n]=e},get(){if(this[di]){if(n in this[di])return this[di][n]||this[ma][n];if(n in this[rs]){const e=this[gf]&&this[gf].internalState;if(e&&e.hasAsyncProp(n))return e.getAsyncProp(n)||this[ma][n]}}return this[ma][n]}}}function fm(n,e){return Object.prototype.hasOwnProperty.call(n,e)}function aS(n,e){return fm(n,e)&&n[e]}function UV(n){const e=n.componentName;return e||tt.warn(`${n.name}.componentName not specified`)(),e||n.name}let BV=0;class $f{constructor(...e){this.props=MV(this,e),this.id=this.props.id,this.count=BV++}clone(e){const{props:t}=this,r={};for(const i in t[ma])i in t[di]?r[i]=t[di][i]:i in t[rs]&&(r[i]=t[rs][i]);return new this.constructor({...t,...r,...e})}}$f.componentName="Component";$f.defaultProps={};const FV=Object.freeze({});class LV{constructor(e){this.component=e,this.asyncProps={},this.onAsyncPropUpdated=()=>{},this.oldProps=null,this.oldAsyncProps=null}finalize(){for(const e in this.asyncProps){const t=this.asyncProps[e];t&&t.type&&t.type.release&&t.type.release(t.resolvedValue,t.type,this.component)}this.asyncProps={},this.component=null,this.resetOldProps()}getOldProps(){return this.oldAsyncProps||this.oldProps||FV}resetOldProps(){this.oldAsyncProps=null,this.oldProps=this.component?this.component.props:null}hasAsyncProp(e){return e in this.asyncProps}getAsyncProp(e){const t=this.asyncProps[e];return t&&t.resolvedValue}isAsyncPropLoading(e){if(e){const t=this.asyncProps[e];return!!(t&&t.pendingLoadCount>0&&t.pendingLoadCount!==t.resolvedLoadCount)}for(const t in this.asyncProps)if(this.isAsyncPropLoading(t))return!0;return!1}reloadAsyncProp(e,t){this._watchPromise(e,Promise.resolve(t))}setAsyncProps(e){this.component=e[gf]||this.component;const t=e[di]||{},r=e[rs]||e,i=e[ma]||{};for(const a in t){const l=t[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,l),t[a]=this.getAsyncProp(a)}for(const a in r){const l=r[a];this._createAsyncPropData(a,i[a]),this._updateAsyncProp(a,l)}}_fetch(e,t){return null}_onResolve(e,t){}_onError(e,t){}_updateAsyncProp(e,t){if(this._didAsyncInputValueChange(e,t)){if(typeof t=="string"&&(t=this._fetch(e,t)),t instanceof Promise){this._watchPromise(e,t);return}if(Kx(t)){this._resolveAsyncIterable(e,t);return}this._setPropValue(e,t)}}_freezeAsyncOldProps(){if(!this.oldAsyncProps&&this.oldProps){this.oldAsyncProps=Object.create(this.oldProps);for(const e in this.asyncProps)Object.defineProperty(this.oldAsyncProps,e,{enumerable:!0,value:this.oldProps[e]})}}_didAsyncInputValueChange(e,t){const r=this.asyncProps[e];return t===r.resolvedValue||t===r.lastValue?!1:(r.lastValue=t,!0)}_setPropValue(e,t){this._freezeAsyncOldProps();const r=this.asyncProps[e];r&&(t=this._postProcessValue(r,t),r.resolvedValue=t,r.pendingLoadCount++,r.resolvedLoadCount=r.pendingLoadCount)}_setAsyncPropValue(e,t,r){const i=this.asyncProps[e];i&&r>=i.resolvedLoadCount&&t!==void 0&&(this._freezeAsyncOldProps(),i.resolvedValue=t,i.resolvedLoadCount=r,this.onAsyncPropUpdated(e,t))}_watchPromise(e,t){const r=this.asyncProps[e];if(r){r.pendingLoadCount++;const i=r.pendingLoadCount;t.then(a=>{this.component&&(a=this._postProcessValue(r,a),this._setAsyncPropValue(e,a,i),this._onResolve(e,a))}).catch(a=>{this._onError(e,a)})}}async _resolveAsyncIterable(e,t){if(e!=="data"){this._setPropValue(e,t);return}const r=this.asyncProps[e];if(!r)return;r.pendingLoadCount++;const i=r.pendingLoadCount;let a=[],l=0;for await(const c of t){if(!this.component)return;const{dataTransform:f}=this.component.props;f?a=f(c,a):a=a.concat(c),Object.defineProperty(a,"__diff",{enumerable:!1,value:[{startRow:l,endRow:a.length}]}),l=a.length,this._setAsyncPropValue(e,a,i)}this._onResolve(e,a)}_postProcessValue(e,t){const r=e.type;return r&&this.component&&(r.release&&r.release(e.resolvedValue,r,this.component),r.transform)?r.transform(t,r,this.component):t}_createAsyncPropData(e,t){if(!this.asyncProps[e]){const i=this.component&&this.component.props[Xi];this.asyncProps[e]={type:i&&i[e],lastValue:null,resolvedValue:t,pendingLoadCount:0,resolvedLoadCount:0}}}}class zV extends LV{constructor({attributeManager:e,layer:t}){super(t),this.attributeManager=e,this.needsRedraw=!0,this.needsUpdate=!0,this.subLayers=null,this.usesPickingColorCache=!1}get layer(){return this.component}_fetch(e,t){const r=this.layer,i=r==null?void 0:r.props.fetch;return i?i(t,{propName:e,layer:r}):super._fetch(e,t)}_onResolve(e,t){const r=this.layer;if(r){const i=r.props.onDataLoad;e==="data"&&i&&i(t,{propName:e,layer:r})}}_onError(e,t){const r=this.layer;r&&r.raiseError(t,`loading ${e} of ${this.layer}`)}}const VV="layer.changeFlag",HV="layer.initialize",jV="layer.update",$V="layer.finalize",WV="layer.matched",_2=2**24-1,XV=Object.freeze([]),YV=Dl(({oldViewport:n,viewport:e})=>n.equals(e));let Dn=new Uint8ClampedArray(0);const qV={data:{type:"data",value:XV,async:!0},dataComparator:{type:"function",value:null,optional:!0},_dataDiff:{type:"function",value:n=>n&&n.__diff,optional:!0},dataTransform:{type:"function",value:null,optional:!0},onDataLoad:{type:"function",value:null,optional:!0},onError:{type:"function",value:null,optional:!0},fetch:{type:"function",value:(n,{propName:e,layer:t,loaders:r,loadOptions:i,signal:a})=>{const{resourceManager:l}=t.context;i=i||t.getLoadOptions(),r=r||t.props.loaders,a&&(i={...i,fetch:{...i==null?void 0:i.fetch,signal:a}});let c=l.contains(n);return!c&&!i&&(l.add({resourceId:n,data:Ig(n,r),persistent:!1}),c=!0),c?l.subscribe({resourceId:n,onChange:f=>{var d;return(d=t.internalState)==null?void 0:d.reloadAsyncProp(e,f)},consumerId:t.id,requestId:e}):Ig(n,r,i)}},updateTriggers:{},visible:!0,pickable:!1,opacity:{type:"number",min:0,max:1,value:1},operation:"draw",onHover:{type:"function",value:null,optional:!0},onClick:{type:"function",value:null,optional:!0},onDragStart:{type:"function",value:null,optional:!0},onDrag:{type:"function",value:null,optional:!0},onDragEnd:{type:"function",value:null,optional:!0},coordinateSystem:Ve.DEFAULT,coordinateOrigin:{type:"array",value:[0,0,0],compare:!0},modelMatrix:{type:"array",value:null,compare:!0,optional:!0},wrapLongitude:!1,positionFormat:"XYZ",colorFormat:"RGBA",parameters:{type:"object",value:{},optional:!0,compare:2},loadOptions:{type:"object",value:null,optional:!0,ignore:!0},transitions:null,extensions:[],loaders:{type:"array",value:[],optional:!0,ignore:!0},getPolygonOffset:{type:"function",value:({layerIndex:n})=>[0,-n*100]},highlightedObjectIndex:null,autoHighlight:!1,highlightColor:{type:"accessor",value:[0,0,128,128]}};class Wf extends $f{constructor(){super(...arguments),this.internalState=null,this.lifecycle=aa.NO_STATE,this.parent=null}static get componentName(){return Object.prototype.hasOwnProperty.call(this,"layerName")?this.layerName:""}get root(){let e=this;for(;e.parent;)e=e.parent;return e}toString(){return`${this.constructor.layerName||this.constructor.name}({id: '${this.props.id}'})`}project(e){Vt(this.internalState);const t=this.internalState.viewport||this.context.viewport,r=wx(e,{viewport:t,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem}),[i,a,l]=gx(r,t.pixelProjectionMatrix);return e.length===2?[i,a]:[i,a,l]}unproject(e){return Vt(this.internalState),(this.internalState.viewport||this.context.viewport).unproject(e)}projectPosition(e,t){Vt(this.internalState);const r=this.internalState.viewport||this.context.viewport;return wF(e,{viewport:r,modelMatrix:this.props.modelMatrix,coordinateOrigin:this.props.coordinateOrigin,coordinateSystem:this.props.coordinateSystem,...t})}get isComposite(){return!1}get isDrawable(){return!0}setState(e){this.setChangeFlags({stateChanged:!0}),Object.assign(this.state,e),this.setNeedsRedraw()}setNeedsRedraw(){this.internalState&&(this.internalState.needsRedraw=!0)}setNeedsUpdate(){this.internalState&&(this.context.layerManager.setNeedsUpdate(String(this)),this.internalState.needsUpdate=!0)}get isLoaded(){return this.internalState?!this.internalState.isAsyncPropLoading():!1}get wrapLongitude(){return this.props.wrapLongitude}isPickable(){return this.props.pickable&&this.props.visible}getModels(){const e=this.state;return e&&(e.models||e.model&&[e.model])||[]}setShaderModuleProps(...e){for(const t of this.getModels())t.shaderInputs.setProps(...e)}getAttributeManager(){return this.internalState&&this.internalState.attributeManager}getCurrentLayer(){return this.internalState&&this.internalState.layer}getLoadOptions(){return this.props.loadOptions}use64bitPositions(){const{coordinateSystem:e}=this.props;return e===Ve.DEFAULT||e===Ve.LNGLAT||e===Ve.CARTESIAN}onHover(e,t){return this.props.onHover&&this.props.onHover(e,t)||!1}onClick(e,t){return this.props.onClick&&this.props.onClick(e,t)||!1}nullPickingColor(){return[0,0,0]}encodePickingColor(e,t=[]){return t[0]=e+1&255,t[1]=e+1>>8&255,t[2]=e+1>>8>>8&255,t}decodePickingColor(e){Vt(e instanceof Uint8Array);const[t,r,i]=e;return t+r*256+i*65536-1}getNumInstances(){return Number.isFinite(this.props.numInstances)?this.props.numInstances:this.state&&this.state.numInstances!==void 0?this.state.numInstances:vV(this.props.data)}getStartIndices(){return this.props.startIndices?this.props.startIndices:this.state&&this.state.startIndices?this.state.startIndices:null}getBounds(){var e;return(e=this.getAttributeManager())==null?void 0:e.getBounds(["positions","instancePositions"])}getShaders(e){e=g2(e,{disableWarnings:!0,modules:this.context.defaultShaderModules});for(const t of this.props.extensions)e=g2(e,t.getShaders.call(this,t));return e}shouldUpdateState(e){return e.changeFlags.propsOrDataChanged}updateState(e){const t=this.getAttributeManager(),{dataChanged:r}=e.changeFlags;if(r&&t)if(Array.isArray(r))for(const i of r)t.invalidateAll(i);else t.invalidateAll();if(t){const{props:i}=e,a=this.internalState.hasPickingBuffer,l=Number.isInteger(i.highlightedObjectIndex)||i.pickable||i.extensions.some(c=>c.getNeedsPickingBuffer.call(this,c));if(a!==l){this.internalState.hasPickingBuffer=l;const{pickingColors:c,instancePickingColors:f}=t.attributes,d=c||f;d&&(l&&d.constant&&(d.constant=!1,t.invalidate(d.id)),!d.value&&!l&&(d.constant=!0,d.value=[0,0,0]))}}}finalizeState(e){for(const r of this.getModels())r.destroy();const t=this.getAttributeManager();t&&t.finalize(),this.context&&this.context.resourceManager.unsubscribe({consumerId:this.id}),this.internalState&&(this.internalState.uniformTransitions.clear(),this.internalState.finalize())}draw(e){for(const t of this.getModels())t.draw(e.renderPass)}getPickingInfo({info:e,mode:t,sourceLayer:r}){const{index:i}=e;return i>=0&&Array.isArray(this.props.data)&&(e.object=this.props.data[i]),e}raiseError(e,t){var r,i,a,l;t&&(e=new Error(`${t}: ${e.message}`,{cause:e})),(i=(r=this.props).onError)!=null&&i.call(r,e)||(l=(a=this.context)==null?void 0:a.onError)==null||l.call(a,e,this)}getNeedsRedraw(e={clearRedrawFlags:!1}){return this._getNeedsRedraw(e)}needsUpdate(){return this.internalState?this.internalState.needsUpdate||this.hasUniformTransition()||this.shouldUpdateState(this._getUpdateParams()):!1}hasUniformTransition(){var e;return((e=this.internalState)==null?void 0:e.uniformTransitions.active)||!1}activateViewport(e){if(!this.internalState)return;const t=this.internalState.viewport;this.internalState.viewport=e,(!t||!YV({oldViewport:t,viewport:e}))&&(this.setChangeFlags({viewportChanged:!0}),this.isComposite?this.needsUpdate()&&this.setNeedsUpdate():this._update())}invalidateAttribute(e="all"){const t=this.getAttributeManager();t&&(e==="all"?t.invalidateAll():t.invalidate(e))}updateAttributes(e){let t=!1;for(const r in e)e[r].layoutChanged()&&(t=!0);for(const r of this.getModels())this._setModelAttributes(r,e,t)}_updateAttributes(){const e=this.getAttributeManager();if(!e)return;const t=this.props,r=this.getNumInstances(),i=this.getStartIndices();e.update({data:t.data,numInstances:r,startIndices:i,props:t,transitions:t.transitions,buffers:t.data.attributes,context:this});const a=e.getChangedAttributes({clearChangedFlags:!0});this.updateAttributes(a)}_updateAttributeTransition(){const e=this.getAttributeManager();e&&e.updateTransition()}_updateUniformTransition(){const{uniformTransitions:e}=this.internalState;if(e.active){const t=e.update(),r=Object.create(this.props);for(const i in t)Object.defineProperty(r,i,{value:t[i]});return r}return this.props}calculateInstancePickingColors(e,{numInstances:t}){if(e.constant)return;const r=Math.floor(Dn.length/4);if(this.internalState.usesPickingColorCache=!0,r<t){t>_2&&tt.warn("Layer has too many data objects. Picking might not be able to distinguish all objects.")(),Dn=Al.allocate(Dn,t,{size:4,copy:!0,maxCount:Math.max(t,_2)});const i=Math.floor(Dn.length/4),a=[0,0,0];for(let l=r;l<i;l++)this.encodePickingColor(l,a),Dn[l*4+0]=a[0],Dn[l*4+1]=a[1],Dn[l*4+2]=a[2],Dn[l*4+3]=0}e.value=Dn.subarray(0,t*4)}_setModelAttributes(e,t,r=!1){var c;if(!Object.keys(t).length)return;if(r){const f=this.getAttributeManager();e.setBufferLayout(f.getBufferLayouts(e)),t=f.getAttributes()}const i=((c=e.userData)==null?void 0:c.excludeAttributes)||{},a={},l={};for(const f in t){if(i[f])continue;const d=t[f].getValue();for(const p in d){const _=d[p];_ instanceof rt?t[f].settings.isIndexed?e.setIndexBuffer(_):a[p]=_:_&&(l[p]=_)}}e.setAttributes(a),e.setConstantAttributes(l)}disablePickingIndex(e){const t=this.props.data;if(!("attributes"in t)){this._disablePickingIndex(e);return}const{pickingColors:r,instancePickingColors:i}=this.getAttributeManager().attributes,a=r||i,l=a&&t.attributes&&t.attributes[a.id];if(l&&l.value){const c=l.value,f=this.encodePickingColor(e);for(let d=0;d<t.length;d++){const p=a.getVertexOffset(d);c[p]===f[0]&&c[p+1]===f[1]&&c[p+2]===f[2]&&this._disablePickingIndex(d)}}else this._disablePickingIndex(e)}_disablePickingIndex(e){const{pickingColors:t,instancePickingColors:r}=this.getAttributeManager().attributes,i=t||r;if(!i)return;const a=i.getVertexOffset(e),l=i.getVertexOffset(e+1);i.buffer.write(new Uint8Array(l-a),a)}restorePickingColors(){const{pickingColors:e,instancePickingColors:t}=this.getAttributeManager().attributes,r=e||t;r&&(this.internalState.usesPickingColorCache&&r.value.buffer!==Dn.buffer&&(r.value=Dn.subarray(0,r.value.length)),r.updateSubBuffer({startOffset:0}))}_initialize(){Vt(!this.internalState),Vt(Number.isFinite(this.props.coordinateSystem)),Yt(HV,this);const e=this._getAttributeManager();e&&e.addInstanced({instancePickingColors:{type:"uint8",size:4,noAlloc:!0,update:this.calculateInstancePickingColors}}),this.internalState=new zV({attributeManager:e,layer:this}),this._clearChangeFlags(),this.state={},Object.defineProperty(this.state,"attributeManager",{get:()=>(tt.deprecated("layer.state.attributeManager","layer.getAttributeManager()")(),e)}),this.internalState.uniformTransitions=new fV(this.context.timeline),this.internalState.onAsyncPropUpdated=this._onAsyncPropUpdated.bind(this),this.internalState.setAsyncProps(this.props),this.initializeState(this.context);for(const t of this.props.extensions)t.initializeState.call(this,this.context,t);this.setChangeFlags({dataChanged:"init",propsChanged:"init",viewportChanged:!0,extensionsChanged:!0}),this._update()}_transferState(e){Yt(WV,this,this===e);const{state:t,internalState:r}=e;this!==e&&(this.internalState=r,this.state=t,this.internalState.setAsyncProps(this.props),this._diffProps(this.props,this.internalState.getOldProps()))}_update(){const e=this.needsUpdate();if(Yt(jV,this,e),!e)return;const t=this.props,r=this.context,i=this.internalState,a=r.viewport,l=this._updateUniformTransition();i.propsInTransition=l,r.viewport=i.viewport||a,this.props=l;try{const c=this._getUpdateParams(),f=this.getModels();if(r.device)this.updateState(c);else try{this.updateState(c)}catch{}for(const p of this.props.extensions)p.updateState.call(this,c,p);this.setNeedsRedraw(),this._updateAttributes();const d=this.getModels()[0]!==f[0];this._postUpdate(c,d)}finally{r.viewport=a,this.props=t,this._clearChangeFlags(),i.needsUpdate=!1,i.resetOldProps()}}_finalize(){Yt($V,this),this.finalizeState(this.context);for(const e of this.props.extensions)e.finalizeState.call(this,this.context,e)}_drawLayer({renderPass:e,shaderModuleProps:t=null,uniforms:r={},parameters:i={}}){this._updateAttributeTransition();const a=this.props,l=this.context;this.props=this.internalState.propsInTransition||a;try{t&&this.setShaderModuleProps(t);const{getPolygonOffset:c}=this.props,f=c&&c(r)||[0,0];l.device instanceof pa&&l.device.setParametersWebGL({polygonOffset:f});for(const d of this.getModels())d.device.type==="webgpu"?d.setParameters({...d.parameters,...i}):d.setParameters(i);if(l.device instanceof pa)l.device.withParametersWebGL(i,()=>{const d={renderPass:e,shaderModuleProps:t,uniforms:r,parameters:i,context:l};for(const p of this.props.extensions)p.draw.call(this,d,p);this.draw(d)});else{const d={renderPass:e,shaderModuleProps:t,uniforms:r,parameters:i,context:l};for(const p of this.props.extensions)p.draw.call(this,d,p);this.draw(d)}}finally{this.props=a}}getChangeFlags(){var e;return(e=this.internalState)==null?void 0:e.changeFlags}setChangeFlags(e){if(!this.internalState)return;const{changeFlags:t}=this.internalState;for(const i in e)if(e[i]){let a=!1;switch(i){case"dataChanged":const l=e[i],c=t[i];l&&Array.isArray(c)&&(t.dataChanged=Array.isArray(l)?c.concat(l):l,a=!0);default:t[i]||(t[i]=e[i],a=!0)}a&&Yt(VV,this,i,e)}const r=!!(t.dataChanged||t.updateTriggersChanged||t.propsChanged||t.extensionsChanged);t.propsOrDataChanged=r,t.somethingChanged=r||t.viewportChanged||t.stateChanged}_clearChangeFlags(){this.internalState.changeFlags={dataChanged:!1,propsChanged:!1,updateTriggersChanged:!1,viewportChanged:!1,stateChanged:!1,extensionsChanged:!1,propsOrDataChanged:!1,somethingChanged:!1}}_diffProps(e,t){var i;const r=dV(e,t);if(r.updateTriggersChanged)for(const a in r.updateTriggersChanged)r.updateTriggersChanged[a]&&this.invalidateAttribute(a);if(r.transitionsChanged)for(const a in r.transitionsChanged)this.internalState.uniformTransitions.add(a,t[a],e[a],(i=e.transitions)==null?void 0:i[a]);return this.setChangeFlags(r)}validateProps(){hV(this.props)}updateAutoHighlight(e){this.props.autoHighlight&&!Number.isInteger(this.props.highlightedObjectIndex)&&this._updateAutoHighlight(e)}_updateAutoHighlight(e){const t={highlightedObjectColor:e.picked?e.color:null},{highlightColor:r}=this.props;e.picked&&typeof r=="function"&&(t.highlightColor=r(e)),this.setShaderModuleProps({picking:t}),this.setNeedsRedraw()}_getAttributeManager(){const e=this.context;return new aV(e.device,{id:this.props.id,stats:e.stats,timeline:e.timeline})}_postUpdate(e,t){const{props:r,oldProps:i}=e,a=this.state.model;a!=null&&a.isInstanced&&a.setInstanceCount(this.getNumInstances());const{autoHighlight:l,highlightedObjectIndex:c,highlightColor:f}=r;if(t||i.autoHighlight!==l||i.highlightedObjectIndex!==c||i.highlightColor!==f){const d={};Array.isArray(f)&&(d.highlightColor=f),(t||i.autoHighlight!==l||c!==i.highlightedObjectIndex)&&(d.highlightedObjectColor=Number.isFinite(c)&&c>=0?this.encodePickingColor(c):null),this.setShaderModuleProps({picking:d})}}_getUpdateParams(){return{props:this.props,oldProps:this.internalState.getOldProps(),context:this.context,changeFlags:this.internalState.changeFlags}}_getNeedsRedraw(e){if(!this.internalState)return!1;let t=!1;t=t||this.internalState.needsRedraw&&this.id;const r=this.getAttributeManager(),i=r?r.getNeedsRedraw(e):!1;if(t=t||i,t)for(const a of this.props.extensions)a.onNeedsRedraw.call(this,a);return this.internalState.needsRedraw=this.internalState.needsRedraw&&!e.clearRedrawFlags,t}_onAsyncPropUpdated(){this._diffProps(this.props,this.internalState.getOldProps()),this.setNeedsUpdate()}}Wf.defaultProps=qV;Wf.layerName="Layer";const ig={bearing:0,pitch:0,position:[0,0,0]},KV={speed:1.2,curve:1.414};class m2 extends Ox{constructor(e={}){super({compare:["longitude","latitude","zoom","bearing","pitch","position"],extract:["width","height","longitude","latitude","zoom","bearing","pitch","position"],required:["width","height","latitude","longitude","zoom"]}),this.opts={...KV,...e}}interpolateProps(e,t,r){const i=D8(e,t,r,this.opts);for(const a in ig)i[a]=xl(e[a]||ig[a],t[a]||ig[a],r);return i}getDuration(e,t){let{transitionDuration:r}=t;return r==="auto"&&(r=P8(e,t,this.opts)),r}}const ZV=typeof window<"u"?K.useLayoutEffect:K.useEffect;function yf(n,e){for(;n;){if(n===e)return!0;n=Object.getPrototypeOf(n)}return!1}const QV={position:"absolute",zIndex:-1};function oS(n,e){if(typeof n=="function")return n(e);if(Array.isArray(n))return n.map(t=>oS(t,e));if(Xf(n)){if(GV(n))return e.style=QV,K.cloneElement(n,e);if(JV(n))return K.cloneElement(n,e)}return n}function Xf(n){return n&&typeof n=="object"&&"type"in n||!1}function GV(n){var e;return(e=n.props)==null?void 0:e.mapStyle}function JV(n){const e=n.type;return e&&e.deckGLViewProps}function y_(n){if(typeof n=="function")return K.createElement(ka,{},n);if(Array.isArray(n))return n.map(y_);if(Xf(n)){if(n.type===K.Fragment)return y_(n.props.children);if(yf(n.type,ka))return n}return n}function e9({children:n,layers:e=[],views:t=null}){const r=[],i=[],a={};return K.Children.forEach(y_(n),l=>{if(Xf(l)){const c=l.type;if(yf(c,Wf)){const f=t9(c,l.props);i.push(f)}else r.push(l);if(yf(c,ka)&&c!==ka&&l.props.id){const f=new c(l.props);a[f.id]=f}}else l&&r.push(l)}),Object.keys(a).length>0&&(Array.isArray(t)?t.forEach(l=>{a[l.id]=l}):t&&(a[t.id]=t),t=Object.values(a)),e=i.length>0?[...i,...e]:e,{layers:e,children:r,views:t}}function t9(n,e){const t={},r=n.defaultProps||{};for(const i in e)r[i]!==e[i]&&(t[i]=e[i]);return new n(t)}const n9=K.createContext();function r9({children:n,deck:e,ContextProvider:t=n9.Provider}){const{viewManager:r}=e||{};if(!r||!r.views.length)return[];const i={},a=r.views[0].id;for(const l of n){let c=a,f=l;Xf(l)&&yf(l.type,ka)&&(c=l.props.id||a,f=l.props.children);const d=r.getViewport(c),p=r.getViewState(c);if(d){p.padding=d.padding;const{x:_,y,width:b,height:T}=d;f=oS(f,{x:_,y,width:b,height:T,viewport:d,viewState:p}),i[c]||(i[c]={viewport:d,children:[]}),i[c].children.push(f)}}return Object.keys(i).map(l=>{const{viewport:c,children:f}=i[l],{x:d,y:p,width:_,height:y}=c,b={position:"absolute",left:d,top:p,width:_,height:y},T=`view-${l}`,A=K.createElement("div",{key:T,id:T,style:b},...f),C={deck:e,viewport:c,container:e.canvas.offsetParent,eventManager:e.eventManager,onViewStateChange:O=>{O.viewId=l,e._onViewStateChange(O)},widgets:[]},N=`view-${l}-context`;return K.createElement(t,{key:N,value:C},A)})}const i9={mixBlendMode:null};function s9({width:n,height:e,style:t}){const r={position:"absolute",zIndex:0,left:0,top:0,width:n,height:e},i={left:0,top:0};if(t)for(const a in t)a in i9?i[a]=t[a]:r[a]=t[a];return{containerStyle:r,canvasStyle:i}}function a9(n){return{get deck(){return n.deck},pickObject:e=>n.deck.pickObject(e),pickMultipleObjects:e=>n.deck.pickMultipleObjects(e),pickObjects:e=>n.deck.pickObjects(e)}}function lS(n){n.redrawReason&&(n.deck._drawLayers(n.redrawReason),n.redrawReason=null)}function o9(n,e,t){var i,a,l;const r=new e({...t,_customRender:((l=(a=(i=t.deviceProps)==null?void 0:i.adapters)==null?void 0:a[0])==null?void 0:l.type)==="webgpu"?void 0:c=>{n.redrawReason=c;const f=r.getViewports();n.lastRenderedViewports!==f?n.forceUpdate():lS(n)}});return r}function l9(n,e){const[t,r]=K.useState(0),a=K.useRef({control:null,version:t,forceUpdate:()=>r(k=>k+1)}).current,l=K.useRef(null),c=K.useRef(null),f=K.useMemo(()=>e9(n),[n.layers,n.views,n.children]);let d=!0;const p=k=>{var V;return d&&n.viewState?(a.viewStateUpdateRequested=k,null):(a.viewStateUpdateRequested=null,(V=n.onViewStateChange)==null?void 0:V.call(n,k))},_=k=>{var V;d?a.interactionStateUpdateRequested=k:(a.interactionStateUpdateRequested=null,(V=n.onInteractionStateChange)==null||V.call(n,k))},y=K.useMemo(()=>{const k={widgets:[],...n,style:null,width:"100%",height:"100%",parent:l.current,canvas:c.current,layers:f.layers,views:f.views,onViewStateChange:p,onInteractionStateChange:_};return delete k._customRender,a.deck&&a.deck.setProps(k),k},[n]);K.useEffect(()=>{const k=n.Deck||um;return a.deck=o9(a,k,{...y,parent:l.current,canvas:c.current}),()=>{var V;return(V=a.deck)==null?void 0:V.finalize()}},[]),ZV(()=>{lS(a);const{viewStateUpdateRequested:k,interactionStateUpdateRequested:V}=a;k&&p(k),V&&_(V)}),K.useImperativeHandle(e,()=>a9(a),[]);const b=a.deck&&a.deck.isInitialized?a.deck.getViewports():void 0,{ContextProvider:T,width:A="100%",height:C="100%",id:N,style:O}=n,{containerStyle:R,canvasStyle:E}=K.useMemo(()=>s9({width:A,height:C,style:O}),[A,C,O]);if(!a.viewStateUpdateRequested&&a.lastRenderedViewports===b||a.version!==t){a.lastRenderedViewports=b,a.version=t;const k=r9({children:f.children,deck:a.deck,ContextProvider:T}),V=K.createElement("canvas",{key:"canvas",id:N||"deckgl-overlay",ref:c,style:E});a.control=K.createElement("div",{id:`${N||"deckgl"}-wrapper`,ref:l,style:R},[V,k])}return d=!1,a.control}const c9=K.forwardRef(l9),u9="modulepreload",f9=function(n){return"/Priyanka_Karnam_Final/"+n},y2={},h9=function(e,t,r){let i=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const l=document.querySelector("meta[property=csp-nonce]"),c=(l==null?void 0:l.nonce)||(l==null?void 0:l.getAttribute("nonce"));i=Promise.allSettled(t.map(f=>{if(f=f9(f),f in y2)return;y2[f]=!0;const d=f.endsWith(".css"),p=d?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${p}`))return;const _=document.createElement("link");if(_.rel=d?"stylesheet":u9,d||(_.as="script"),_.crossOrigin="",_.href=f,c&&_.setAttribute("nonce",c),document.head.appendChild(_),d)return new Promise((y,b)=>{_.addEventListener("load",y),_.addEventListener("error",()=>b(new Error(`Unable to preload CSS for ${f}`)))})}))}function a(l){const c=new Event("vite:preloadError",{cancelable:!0});if(c.payload=l,window.dispatchEvent(c),!c.defaultPrevented)throw l}return i.then(l=>{for(const c of l||[])c.status==="rejected"&&a(c.reason);return e().catch(a)})},d9=K.createContext(null);function p9(n,e){const t=Array.isArray(n)?n[0]:n?n.x:0,r=Array.isArray(n)?n[1]:n?n.y:0,i=Array.isArray(e)?e[0]:e?e.x:0,a=Array.isArray(e)?e[1]:e?e.y:0;return t===i&&r===a}function Mr(n,e){if(n===e)return!0;if(!n||!e)return!1;if(Array.isArray(n)){if(!Array.isArray(e)||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(!Mr(n[t],e[t]))return!1;return!0}else if(Array.isArray(e))return!1;if(typeof n=="object"&&typeof e=="object"){const t=Object.keys(n),r=Object.keys(e);if(t.length!==r.length)return!1;for(const i of t)if(!e.hasOwnProperty(i)||!Mr(n[i],e[i]))return!1;return!0}return!1}function g9(n){const e=n.clone();return e.pixelsToGLUnits=n.pixelsToGLUnits,e}function b2(n,e){if(!n.getProjection)return;const t=n.getProjection(),r=e.getProjection();Mr(t,r)||e.setProjection(t)}function v2(n){return{longitude:n.center.lng,latitude:n.center.lat,zoom:n.zoom,pitch:n.pitch,bearing:n.bearing,padding:n.padding}}function T2(n,e){const t=e.viewState||e;let r=!1;if("zoom"in t){const i=n.zoom;n.zoom=t.zoom,r=r||i!==n.zoom}if("bearing"in t){const i=n.bearing;n.bearing=t.bearing,r=r||i!==n.bearing}if("pitch"in t){const i=n.pitch;n.pitch=t.pitch,r=r||i!==n.pitch}if(t.padding&&!n.isPaddingEqual(t.padding)&&(r=!0,n.padding=t.padding),"longitude"in t&&"latitude"in t){const i=n.center;n.center=new i.constructor(t.longitude,t.latitude),r=r||i!==n.center}return r}const _9=["type","source","source-layer","minzoom","maxzoom","filter","layout"];function w2(n){if(!n)return null;if(typeof n=="string"||("toJS"in n&&(n=n.toJS()),!n.layers))return n;const e={};for(const r of n.layers)e[r.id]=r;const t=n.layers.map(r=>{let i=null;"interactive"in r&&(i=Object.assign({},r),delete i.interactive);const a=e[r.ref];if(a){i=i||Object.assign({},r),delete i.ref;for(const l of _9)l in a&&(i[l]=a[l])}return i||r});return{...n,layers:t}}var x2={};const S2={version:8,sources:{},layers:[]},A2={mousedown:"onMouseDown",mouseup:"onMouseUp",mouseover:"onMouseOver",mousemove:"onMouseMove",click:"onClick",dblclick:"onDblClick",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",mouseout:"onMouseOut",contextmenu:"onContextMenu",touchstart:"onTouchStart",touchend:"onTouchEnd",touchmove:"onTouchMove",touchcancel:"onTouchCancel"},sg={movestart:"onMoveStart",move:"onMove",moveend:"onMoveEnd",dragstart:"onDragStart",drag:"onDrag",dragend:"onDragEnd",zoomstart:"onZoomStart",zoom:"onZoom",zoomend:"onZoomEnd",rotatestart:"onRotateStart",rotate:"onRotate",rotateend:"onRotateEnd",pitchstart:"onPitchStart",pitch:"onPitch",pitchend:"onPitchEnd"},E2={wheel:"onWheel",boxzoomstart:"onBoxZoomStart",boxzoomend:"onBoxZoomEnd",boxzoomcancel:"onBoxZoomCancel",resize:"onResize",load:"onLoad",render:"onRender",idle:"onIdle",remove:"onRemove",data:"onData",styledata:"onStyleData",sourcedata:"onSourceData",error:"onError"},m9=["minZoom","maxZoom","minPitch","maxPitch","maxBounds","projection","renderWorldCopies"],y9=["scrollZoom","boxZoom","dragRotate","dragPan","keyboard","doubleClickZoom","touchZoomRotate","touchPitch"];class Pa{constructor(e,t,r){this._map=null,this._internalUpdate=!1,this._inRender=!1,this._hoveredFeatures=null,this._deferredEvents={move:!1,zoom:!1,pitch:!1,rotate:!1},this._onEvent=i=>{const a=this.props[E2[i.type]];a?a(i):i.type==="error"&&console.error(i.error)},this._onPointerEvent=i=>{(i.type==="mousemove"||i.type==="mouseout")&&this._updateHover(i);const a=this.props[A2[i.type]];a&&(this.props.interactiveLayerIds&&i.type!=="mouseover"&&i.type!=="mouseout"&&(i.features=this._hoveredFeatures||this._queryRenderedFeatures(i.point)),a(i),delete i.features)},this._onCameraEvent=i=>{if(!this._internalUpdate){const a=this.props[sg[i.type]];a&&a(i)}i.type in this._deferredEvents&&(this._deferredEvents[i.type]=!1)},this._MapClass=e,this.props=t,this._initialize(r)}get map(){return this._map}get transform(){return this._renderTransform}setProps(e){const t=this.props;this.props=e;const r=this._updateSettings(e,t);r&&this._createShadowTransform(this._map);const i=this._updateSize(e),a=this._updateViewState(e,!0);this._updateStyle(e,t),this._updateStyleComponents(e,t),this._updateHandlers(e,t),(r||i||a&&!this._map.isMoving())&&this.redraw()}static reuse(e,t){const r=Pa.savedMaps.pop();if(!r)return null;const i=r.map,a=i.getContainer();for(t.className=a.className;a.childNodes.length>0;)t.appendChild(a.childNodes[0]);i._container=t,r.setProps({...e,styleDiffing:!1}),i.resize();const{initialViewState:l}=e;return l&&(l.bounds?i.fitBounds(l.bounds,{...l.fitBoundsOptions,duration:0}):r._updateViewState(l,!1)),i.isStyleLoaded()?i.fire("load"):i.once("styledata",()=>i.fire("load")),i._update(),r}_initialize(e){const{props:t}=this,{mapStyle:r=S2}=t,i={...t,...t.initialViewState,accessToken:t.mapboxAccessToken||b9()||null,container:e,style:w2(r)},a=i.initialViewState||i.viewState||i;if(Object.assign(i,{center:[a.longitude||0,a.latitude||0],zoom:a.zoom||0,pitch:a.pitch||0,bearing:a.bearing||0}),t.gl){const p=HTMLCanvasElement.prototype.getContext;HTMLCanvasElement.prototype.getContext=()=>(HTMLCanvasElement.prototype.getContext=p,t.gl)}const l=new this._MapClass(i);a.padding&&l.setPadding(a.padding),t.cursor&&(l.getCanvas().style.cursor=t.cursor),this._createShadowTransform(l);const c=l._render;l._render=p=>{this._inRender=!0,c.call(l,p),this._inRender=!1};const f=l._renderTaskQueue.run;l._renderTaskQueue.run=p=>{f.call(l._renderTaskQueue,p),this._onBeforeRepaint()},l.on("render",()=>this._onAfterRepaint());const d=l.fire;l.fire=this._fireEvent.bind(this,d),l.on("resize",()=>{this._renderTransform.resize(l.transform.width,l.transform.height)}),l.on("styledata",()=>{this._updateStyleComponents(this.props,{}),b2(l.transform,this._renderTransform)}),l.on("sourcedata",()=>this._updateStyleComponents(this.props,{}));for(const p in A2)l.on(p,this._onPointerEvent);for(const p in sg)l.on(p,this._onCameraEvent);for(const p in E2)l.on(p,this._onEvent);this._map=l}recycle(){const t=this.map.getContainer().querySelector("[mapboxgl-children]");t==null||t.remove(),Pa.savedMaps.push(this)}destroy(){this._map.remove()}redraw(){const e=this._map;!this._inRender&&e.style&&(e._frame&&(e._frame.cancel(),e._frame=null),e._render())}_createShadowTransform(e){const t=g9(e.transform);e.painter.transform=t,this._renderTransform=t}_updateSize(e){const{viewState:t}=e;if(t){const r=this._map;if(t.width!==r.transform.width||t.height!==r.transform.height)return r.resize(),!0}return!1}_updateViewState(e,t){if(this._internalUpdate)return!1;const r=this._map,i=this._renderTransform,{zoom:a,pitch:l,bearing:c}=i,f=r.isMoving();f&&(i.cameraElevationReference="sea");const d=T2(i,{...v2(r.transform),...e});if(f&&(i.cameraElevationReference="ground"),d&&t){const p=this._deferredEvents;p.move=!0,p.zoom||(p.zoom=a!==i.zoom),p.rotate||(p.rotate=c!==i.bearing),p.pitch||(p.pitch=l!==i.pitch)}return f||T2(r.transform,e),d}_updateSettings(e,t){const r=this._map;let i=!1;for(const a of m9)if(a in e&&!Mr(e[a],t[a])){i=!0;const l=r[`set${a[0].toUpperCase()}${a.slice(1)}`];l==null||l.call(r,e[a])}return i}_updateStyle(e,t){if(e.cursor!==t.cursor&&(this._map.getCanvas().style.cursor=e.cursor||""),e.mapStyle!==t.mapStyle){const{mapStyle:r=S2,styleDiffing:i=!0}=e,a={diff:i};return"localIdeographFontFamily"in e&&(a.localIdeographFontFamily=e.localIdeographFontFamily),this._map.setStyle(w2(r),a),!0}return!1}_updateStyleComponents(e,t){const r=this._map;let i=!1;return r.isStyleLoaded()&&("light"in e&&r.setLight&&!Mr(e.light,t.light)&&(i=!0,r.setLight(e.light)),"fog"in e&&r.setFog&&!Mr(e.fog,t.fog)&&(i=!0,r.setFog(e.fog)),"terrain"in e&&r.setTerrain&&!Mr(e.terrain,t.terrain)&&(!e.terrain||r.getSource(e.terrain.source))&&(i=!0,r.setTerrain(e.terrain))),i}_updateHandlers(e,t){const r=this._map;let i=!1;for(const a of y9){const l=e[a]??!0,c=t[a]??!0;Mr(l,c)||(i=!0,l?r[a].enable(l):r[a].disable())}return i}_queryRenderedFeatures(e){const t=this._map,r=t.transform,{interactiveLayerIds:i=[]}=this.props;try{return t.transform=this._renderTransform,t.queryRenderedFeatures(e,{layers:i.filter(t.getLayer.bind(t))})}catch{return[]}finally{t.transform=r}}_updateHover(e){var i;const{props:t}=this;if(t.interactiveLayerIds&&(t.onMouseMove||t.onMouseEnter||t.onMouseLeave)){const a=e.type,l=((i=this._hoveredFeatures)==null?void 0:i.length)>0,c=this._queryRenderedFeatures(e.point),f=c.length>0;!f&&l&&(e.type="mouseleave",this._onPointerEvent(e)),this._hoveredFeatures=c,f&&!l&&(e.type="mouseenter",this._onPointerEvent(e)),e.type=a}else this._hoveredFeatures=null}_fireEvent(e,t,r){const i=this._map,a=i.transform,l=typeof t=="string"?t:t.type;return l==="move"&&this._updateViewState(this.props,!1),l in sg&&(typeof t=="object"&&(t.viewState=v2(a)),this._map.isMoving())?(i.transform=this._renderTransform,e.call(i,t,r),i.transform=a,i):(e.call(i,t,r),i)}_onBeforeRepaint(){const e=this._map;this._internalUpdate=!0;for(const r in this._deferredEvents)this._deferredEvents[r]&&e.fire(r);this._internalUpdate=!1;const t=this._map.transform;e.transform=this._renderTransform,this._onAfterRepaint=()=>{b2(this._renderTransform,t),e.transform=t}}}Pa.savedMaps=[];function b9(){let n=null;if(typeof location<"u"){const e=/access_token=([^&\/]*)/.exec(location.search);n=e&&e[1]}try{n=n||x2.MapboxAccessToken}catch{}try{n=n||x2.REACT_APP_MAPBOX_ACCESS_TOKEN}catch{}return n}const v9=["setMaxBounds","setMinZoom","setMaxZoom","setMinPitch","setMaxPitch","setRenderWorldCopies","setProjection","setStyle","addSource","removeSource","addLayer","removeLayer","setLayerZoomRange","setFilter","setPaintProperty","setLayoutProperty","setLight","setTerrain","setFog","remove"];function T9(n){if(!n)return null;const e=n.map,t={getMap:()=>e,getCenter:()=>n.transform.center,getZoom:()=>n.transform.zoom,getBearing:()=>n.transform.bearing,getPitch:()=>n.transform.pitch,getPadding:()=>n.transform.padding,getBounds:()=>n.transform.getBounds(),project:r=>{const i=e.transform;e.transform=n.transform;const a=e.project(r);return e.transform=i,a},unproject:r=>{const i=e.transform;e.transform=n.transform;const a=e.unproject(r);return e.transform=i,a},queryTerrainElevation:(r,i)=>{const a=e.transform;e.transform=n.transform;const l=e.queryTerrainElevation(r,i);return e.transform=a,l},queryRenderedFeatures:(r,i)=>{const a=e.transform;e.transform=n.transform;const l=e.queryRenderedFeatures(r,i);return e.transform=a,l}};for(const r of w9(e))!(r in t)&&!v9.includes(r)&&(t[r]=e[r].bind(e));return t}function w9(n){const e=new Set;let t=n;for(;t;){for(const r of Object.getOwnPropertyNames(t))r[0]!=="_"&&typeof n[r]=="function"&&r!=="fire"&&r!=="setEventedParent"&&e.add(r);t=Object.getPrototypeOf(t)}return Array.from(e)}const x9=typeof document<"u"?K.useLayoutEffect:K.useEffect,S9=["baseApiUrl","maxParallelImageRequests","workerClass","workerCount","workerUrl"];function A9(n,e){for(const r of S9)r in e&&(n[r]=e[r]);const{RTLTextPlugin:t="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-rtl-text/v0.2.3/mapbox-gl-rtl-text.js"}=e;t&&n.getRTLTextPluginStatus&&n.getRTLTextPluginStatus()==="unavailable"&&n.setRTLTextPlugin(t,r=>{r&&console.error(r)},!0)}const Yf=K.createContext(null);function E9(n,e){const t=K.useContext(d9),[r,i]=K.useState(null),a=K.useRef(),{current:l}=K.useRef({mapLib:null,map:null});K.useEffect(()=>{const d=n.mapLib;let p=!0,_;return Promise.resolve(d||h9(()=>import("./mapbox-gl-kkImOxJX.js").then(y=>y.m),[])).then(y=>{if(!p)return;if(!y)throw new Error("Invalid mapLib");const b="Map"in y?y:y.default;if(!b.Map)throw new Error("Invalid mapLib");A9(b,n),n.reuseMaps&&(_=Pa.reuse(n,a.current)),_||(_=new Pa(b.Map,n,a.current)),l.map=T9(_),l.mapLib=b,i(_),t==null||t.onMapMount(l.map,n.id)}).catch(y=>{const{onError:b}=n;b?b({type:"error",target:null,error:y}):console.error(y)}),()=>{p=!1,_&&(t==null||t.onMapUnmount(n.id),n.reuseMaps?_.recycle():_.destroy())}},[]),x9(()=>{r&&r.setProps(n)}),K.useImperativeHandle(e,()=>l.map,[r]);const c=K.useMemo(()=>({position:"relative",width:"100%",height:"100%",...n.style}),[n.style]),f={height:"100%"};return K.createElement("div",{id:n.id,ref:a,style:c},r&&K.createElement(Yf.Provider,{value:l},K.createElement("div",{"mapboxgl-children":"",style:f},n.children)))}const R9=K.forwardRef(E9);var cS=N2();const C9=/box|flex|grid|column|lineHeight|fontWeight|opacity|order|tabSize|zIndex/;function cs(n,e){if(!n||!e)return;const t=n.style;for(const r in e){const i=e[r];Number.isFinite(i)&&!C9.test(r)?t[r]=`${i}px`:t[r]=i}}function uS(n,e){if(n===e)return null;const t=R2(n),r=R2(e),i=[];for(const a of r)t.has(a)||i.push(a);for(const a of t)r.has(a)||i.push(a);return i.length===0?null:i}function R2(n){return new Set(n?n.trim().split(/\s+/):[])}K.memo(K.forwardRef((n,e)=>{const{map:t,mapLib:r}=K.useContext(Yf),i=K.useRef({props:n}),a=K.useMemo(()=>{let N=!1;K.Children.forEach(n.children,E=>{E&&(N=!0)});const O={...n,element:N?document.createElement("div"):null},R=new r.Marker(O);return R.setLngLat([n.longitude,n.latitude]),R.getElement().addEventListener("click",E=>{var k,V;(V=(k=i.current.props).onClick)==null||V.call(k,{type:"click",target:R,originalEvent:E})}),R.on("dragstart",E=>{var V,ne;const k=E;k.lngLat=a.getLngLat(),(ne=(V=i.current.props).onDragStart)==null||ne.call(V,k)}),R.on("drag",E=>{var V,ne;const k=E;k.lngLat=a.getLngLat(),(ne=(V=i.current.props).onDrag)==null||ne.call(V,k)}),R.on("dragend",E=>{var V,ne;const k=E;k.lngLat=a.getLngLat(),(ne=(V=i.current.props).onDragEnd)==null||ne.call(V,k)}),R},[]);K.useEffect(()=>(a.addTo(t.getMap()),()=>{a.remove()}),[]);const{longitude:l,latitude:c,offset:f,style:d,draggable:p=!1,popup:_=null,rotation:y=0,rotationAlignment:b="auto",pitchAlignment:T="auto"}=n;K.useEffect(()=>{cs(a.getElement(),d)},[d]),K.useImperativeHandle(e,()=>a,[]);const A=i.current.props;(a.getLngLat().lng!==l||a.getLngLat().lat!==c)&&a.setLngLat([l,c]),f&&!p9(a.getOffset(),f)&&a.setOffset(f),a.isDraggable()!==p&&a.setDraggable(p),a.getRotation()!==y&&a.setRotation(y),a.getRotationAlignment()!==b&&a.setRotationAlignment(b),a.getPitchAlignment()!==T&&a.setPitchAlignment(T),a.getPopup()!==_&&a.setPopup(_);const C=uS(A.className,n.className);if(C)for(const N of C)a.toggleClassName(N);return i.current.props=n,cS.createPortal(n.children,a.getElement())}));K.memo(K.forwardRef((n,e)=>{const{map:t,mapLib:r}=K.useContext(Yf),i=K.useMemo(()=>document.createElement("div"),[]),a=K.useRef({props:n}),l=K.useMemo(()=>{const c={...n},f=new r.Popup(c);return f.setLngLat([n.longitude,n.latitude]),f.once("open",d=>{var p,_;(_=(p=a.current.props).onOpen)==null||_.call(p,d)}),f},[]);if(K.useEffect(()=>{const c=f=>{var d,p;(p=(d=a.current.props).onClose)==null||p.call(d,f)};return l.on("close",c),l.setDOMContent(i).addTo(t.getMap()),()=>{l.off("close",c),l.isOpen()&&l.remove()}},[]),K.useEffect(()=>{cs(l.getElement(),n.style)},[n.style]),K.useImperativeHandle(e,()=>l,[]),l.isOpen()){const c=a.current.props;(l.getLngLat().lng!==n.longitude||l.getLngLat().lat!==n.latitude)&&l.setLngLat([n.longitude,n.latitude]),n.offset&&!Mr(c.offset,n.offset)&&(l.options.anchor=n.anchor,l.setOffset(n.offset)),(c.anchor!==n.anchor||c.maxWidth!==n.maxWidth)&&l.setMaxWidth(n.maxWidth);const f=uS(c.className,n.className);if(f)for(const d of f)l.toggleClassName(d);a.current.props=n}return cS.createPortal(n.children,i)}));function Ul(n,e,t,r){const i=K.useContext(Yf),a=K.useMemo(()=>n(i),[]);return K.useEffect(()=>{const l=e,c=null,f=typeof e=="function"?e:null,{map:d}=i;return d.hasControl(a)||(d.addControl(a,l==null?void 0:l.position),c&&c(i)),()=>{f&&f(i),d.hasControl(a)&&d.removeControl(a)}},[]),a}function M9(n){const e=Ul(({mapLib:t})=>new t.AttributionControl(n),{position:n.position});return K.useEffect(()=>{cs(e._container,n.style)},[n.style]),null}K.memo(M9);function O9(n){const e=Ul(({mapLib:t})=>new t.FullscreenControl({container:n.containerId&&document.getElementById(n.containerId)}),{position:n.position});return K.useEffect(()=>{cs(e._controlContainer,n.style)},[n.style]),null}K.memo(O9);function I9(n,e){const t=K.useRef({props:n}),r=Ul(({mapLib:i})=>{const a=new i.GeolocateControl(n),l=a._setupUI.bind(a);return a._setupUI=c=>{a._container.hasChildNodes()||l(c)},a.on("geolocate",c=>{var f,d;(d=(f=t.current.props).onGeolocate)==null||d.call(f,c)}),a.on("error",c=>{var f,d;(d=(f=t.current.props).onError)==null||d.call(f,c)}),a.on("outofmaxbounds",c=>{var f,d;(d=(f=t.current.props).onOutOfMaxBounds)==null||d.call(f,c)}),a.on("trackuserlocationstart",c=>{var f,d;(d=(f=t.current.props).onTrackUserLocationStart)==null||d.call(f,c)}),a.on("trackuserlocationend",c=>{var f,d;(d=(f=t.current.props).onTrackUserLocationEnd)==null||d.call(f,c)}),a},{position:n.position});return t.current.props=n,K.useImperativeHandle(e,()=>r,[]),K.useEffect(()=>{cs(r._container,n.style)},[n.style]),null}K.memo(K.forwardRef(I9));function N9(n){const e=Ul(({mapLib:t})=>new t.NavigationControl(n),{position:n.position});return K.useEffect(()=>{cs(e._container,n.style)},[n.style]),null}K.memo(N9);function k9(n){const e=Ul(({mapLib:a})=>new a.ScaleControl(n),{position:n.position}),t=K.useRef(n),r=t.current;t.current=n;const{style:i}=n;return n.maxWidth!==void 0&&n.maxWidth!==r.maxWidth&&(e.options.maxWidth=n.maxWidth),n.unit!==void 0&&n.unit!==r.unit&&e.setUnit(n.unit),K.useEffect(()=>{cs(e._container,i)},[i]),null}K.memo(k9);const C2=`uniform scatterplotUniforms {
  float radiusScale;
  float radiusMinPixels;
  float radiusMaxPixels;
  float lineWidthScale;
  float lineWidthMinPixels;
  float lineWidthMaxPixels;
  float stroked;
  float filled;
  bool antialiasing;
  bool billboard;
  highp int radiusUnits;
  highp int lineWidthUnits;
} scatterplot;
`,D9={name:"scatterplot",vs:C2,fs:C2,source:"",uniformTypes:{radiusScale:"f32",radiusMinPixels:"f32",radiusMaxPixels:"f32",lineWidthScale:"f32",lineWidthMinPixels:"f32",lineWidthMaxPixels:"f32",stroked:"f32",filled:"f32",antialiasing:"f32",billboard:"f32",radiusUnits:"i32",lineWidthUnits:"i32"}},P9=`#version 300 es
#define SHADER_NAME scatterplot-layer-vertex-shader
in vec3 positions;
in vec3 instancePositions;
in vec3 instancePositions64Low;
in float instanceRadius;
in float instanceLineWidths;
in vec4 instanceFillColors;
in vec4 instanceLineColors;
in vec3 instancePickingColors;
out vec4 vFillColor;
out vec4 vLineColor;
out vec2 unitPosition;
out float innerUnitRadius;
out float outerRadiusPixels;
void main(void) {
geometry.worldPosition = instancePositions;
outerRadiusPixels = clamp(
project_size_to_pixel(scatterplot.radiusScale * instanceRadius, scatterplot.radiusUnits),
scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
);
float lineWidthPixels = clamp(
project_size_to_pixel(scatterplot.lineWidthScale * instanceLineWidths, scatterplot.lineWidthUnits),
scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
);
outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
float edgePadding = scatterplot.antialiasing ? (outerRadiusPixels + SMOOTH_EDGE_RADIUS) / outerRadiusPixels : 1.0;
unitPosition = edgePadding * positions.xy;
geometry.uv = unitPosition;
geometry.pickingColor = instancePickingColors;
innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / outerRadiusPixels;
if (scatterplot.billboard) {
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, vec3(0.0), geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
vec3 offset = edgePadding * positions * outerRadiusPixels;
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position.xy += project_pixel_size_to_clipspace(offset.xy);
} else {
vec3 offset = edgePadding * positions * project_pixel_size(outerRadiusPixels);
DECKGL_FILTER_SIZE(offset, geometry);
gl_Position = project_position_to_clipspace(instancePositions, instancePositions64Low, offset, geometry.position);
DECKGL_FILTER_GL_POSITION(gl_Position, geometry);
}
vFillColor = vec4(instanceFillColors.rgb, instanceFillColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vFillColor, geometry);
vLineColor = vec4(instanceLineColors.rgb, instanceLineColors.a * layer.opacity);
DECKGL_FILTER_COLOR(vLineColor, geometry);
}
`,U9=`#version 300 es
#define SHADER_NAME scatterplot-layer-fragment-shader
precision highp float;
in vec4 vFillColor;
in vec4 vLineColor;
in vec2 unitPosition;
in float innerUnitRadius;
in float outerRadiusPixels;
out vec4 fragColor;
void main(void) {
geometry.uv = unitPosition;
float distToCenter = length(unitPosition) * outerRadiusPixels;
float inCircle = scatterplot.antialiasing ?
smoothedge(distToCenter, outerRadiusPixels) :
step(distToCenter, outerRadiusPixels);
if (inCircle == 0.0) {
discard;
}
if (scatterplot.stroked > 0.5) {
float isLine = scatterplot.antialiasing ?
smoothedge(innerUnitRadius * outerRadiusPixels, distToCenter) :
step(innerUnitRadius * outerRadiusPixels, distToCenter);
if (scatterplot.filled > 0.5) {
fragColor = mix(vFillColor, vLineColor, isLine);
} else {
if (isLine == 0.0) {
discard;
}
fragColor = vec4(vLineColor.rgb, vLineColor.a * isLine);
}
} else if (scatterplot.filled < 0.5) {
discard;
} else {
fragColor = vFillColor;
}
fragColor.a *= inCircle;
DECKGL_FILTER_COLOR(fragColor, geometry);
}
`,B9=`// TODO(ibgreen): Hack for Layer uniforms (move to new "color" module?)

struct LayerUniforms {
  opacity: f32,
};

var<private> layer: LayerUniforms = LayerUniforms(1.0);
// @group(0) @binding(1) var<uniform> layer: LayerUniforms;

// Main shaders

struct ScatterplotUniforms {
  radiusScale: f32,
  radiusMinPixels: f32,
  radiusMaxPixels: f32,
  lineWidthScale: f32,
  lineWidthMinPixels: f32,
  lineWidthMaxPixels: f32,
  stroked: f32,
  filled: i32,
  antialiasing: i32,
  billboard: i32,
  radiusUnits: i32,
  lineWidthUnits: i32,
};

struct ConstantAttributeUniforms {
 instancePositions: vec3<f32>,
 instancePositions64Low: vec3<f32>,
 instanceRadius: f32,
 instanceLineWidths: f32,
 instanceFillColors: vec4<f32>,
 instanceLineColors: vec4<f32>,
 instancePickingColors: vec3<f32>,

 instancePositionsConstant: i32,
 instancePositions64LowConstant: i32,
 instanceRadiusConstant: i32,
 instanceLineWidthsConstant: i32,
 instanceFillColorsConstant: i32,
 instanceLineColorsConstant: i32,
 instancePickingColorsConstant: i32
};

@group(0) @binding(2) var<uniform> scatterplot: ScatterplotUniforms;

struct ConstantAttributes {
  instancePositions: vec3<f32>,
  instancePositions64Low: vec3<f32>,
  instanceRadius: f32,
  instanceLineWidths: f32,
  instanceFillColors: vec4<f32>,
  instanceLineColors: vec4<f32>,
  instancePickingColors: vec3<f32>
};

const constants = ConstantAttributes(
  vec3<f32>(0.0),
  vec3<f32>(0.0),
  0.0,
  0.0,
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec4<f32>(0.0, 0.0, 0.0, 1.0),
  vec3<f32>(0.0)
);

struct Attributes {
  @builtin(instance_index) instanceIndex : u32,
  @builtin(vertex_index) vertexIndex : u32,
  @location(0) positions: vec3<f32>,
  @location(1) instancePositions: vec3<f32>,
  @location(2) instancePositions64Low: vec3<f32>,
  @location(3) instanceRadius: f32,
  @location(4) instanceLineWidths: f32,
  @location(5) instanceFillColors: vec4<f32>,
  @location(6) instanceLineColors: vec4<f32>,
  @location(7) instancePickingColors: vec3<f32>
};

struct Varyings {
  @builtin(position) position: vec4<f32>,
  @location(0) vFillColor: vec4<f32>,
  @location(1) vLineColor: vec4<f32>,
  @location(2) unitPosition: vec2<f32>,
  @location(3) innerUnitRadius: f32,
  @location(4) outerRadiusPixels: f32,
};

@vertex
fn vertexMain(attributes: Attributes) -> Varyings {
  var varyings: Varyings;

  // Draw an inline geometry constant array clip space triangle to verify that rendering works.
  // var positions = array<vec2<f32>, 3>(vec2(0.0, 0.5), vec2(-0.5, -0.5), vec2(0.5, -0.5));
  // if (attributes.instanceIndex == 0) {
  //   varyings.position = vec4<f32>(positions[attributes.vertexIndex], 0.0, 1.0);
  //   return varyings;
  // }

  // var geometry: Geometry;
  // geometry.worldPosition = instancePositions;

  // Multiply out radius and clamp to limits
  varyings.outerRadiusPixels = clamp(
    project_unit_size_to_pixel(scatterplot.radiusScale * attributes.instanceRadius, scatterplot.radiusUnits),
    scatterplot.radiusMinPixels, scatterplot.radiusMaxPixels
  );

  // Multiply out line width and clamp to limits
  let lineWidthPixels = clamp(
    project_unit_size_to_pixel(scatterplot.lineWidthScale * attributes.instanceLineWidths, scatterplot.lineWidthUnits),
    scatterplot.lineWidthMinPixels, scatterplot.lineWidthMaxPixels
  );

  // outer radius needs to offset by half stroke width
  varyings.outerRadiusPixels += scatterplot.stroked * lineWidthPixels / 2.0;
  // Expand geometry to accommodate edge smoothing
  let edgePadding = select(
    (varyings.outerRadiusPixels + SMOOTH_EDGE_RADIUS) / varyings.outerRadiusPixels,
    1.0,
    scatterplot.antialiasing != 0
  );

  // position on the containing square in [-1, 1] space
  varyings.unitPosition = edgePadding * attributes.positions.xy;
  geometry.uv = varyings.unitPosition;
  geometry.pickingColor = attributes.instancePickingColors;

  varyings.innerUnitRadius = 1.0 - scatterplot.stroked * lineWidthPixels / varyings.outerRadiusPixels;

  if (scatterplot.billboard != 0) {
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, vec3<f32>(0.0)); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
    let offset = attributes.positions; // * edgePadding * varyings.outerRadiusPixels;
    // DECKGL_FILTER_SIZE(offset, geometry);
    let clipPixels = project_pixel_size_to_clipspace(offset.xy);
    varyings.position.x = clipPixels.x;
    varyings.position.y = clipPixels.y;
  } else {
    let offset = edgePadding * attributes.positions * project_pixel_size_float(varyings.outerRadiusPixels);
    // DECKGL_FILTER_SIZE(offset, geometry);
    varyings.position = project_position_to_clipspace(attributes.instancePositions, attributes.instancePositions64Low, offset); // TODO , geometry.position);
    // DECKGL_FILTER_GL_POSITION(varyings.position, geometry);
  }

  // Apply opacity to instance color, or return instance picking color
  varyings.vFillColor = vec4<f32>(attributes.instanceFillColors.rgb, attributes.instanceFillColors.a * layer.opacity);
  // DECKGL_FILTER_COLOR(varyings.vFillColor, geometry);
  varyings.vLineColor = vec4<f32>(attributes.instanceLineColors.rgb, attributes.instanceLineColors.a * layer.opacity);
  // DECKGL_FILTER_COLOR(varyings.vLineColor, geometry);

  return varyings;
}

@fragment
fn fragmentMain(varyings: Varyings) -> @location(0) vec4<f32> {
  // var geometry: Geometry;
  // geometry.uv = unitPosition;

  let distToCenter = length(varyings.unitPosition) * varyings.outerRadiusPixels;
  let inCircle = select(
    smoothedge(distToCenter, varyings.outerRadiusPixels),
    step(distToCenter, varyings.outerRadiusPixels),
    scatterplot.antialiasing != 0
  );

  if (inCircle == 0.0) {
    // discard;
  }

  var fragColor: vec4<f32>;

  if (scatterplot.stroked != 0) {
    let isLine = select(
      smoothedge(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      step(varyings.innerUnitRadius * varyings.outerRadiusPixels, distToCenter),
      scatterplot.antialiasing != 0
    );

    if (scatterplot.filled != 0) {
      fragColor = mix(varyings.vFillColor, varyings.vLineColor, isLine);
    } else {
      if (isLine == 0.0) {
        // discard;
      }
      fragColor = vec4<f32>(varyings.vLineColor.rgb, varyings.vLineColor.a * isLine);
    }
  } else if (scatterplot.filled == 0) {
    // discard;
  } else {
    fragColor = varyings.vFillColor;
  }

  fragColor.a *= inCircle;
  // DECKGL_FILTER_COLOR(fragColor, geometry);

  return fragColor;
  // return vec4<f32>(0, 0, 1, 1);
}
`,M2=[0,0,0,255],F9={radiusUnits:"meters",radiusScale:{type:"number",min:0,value:1},radiusMinPixels:{type:"number",min:0,value:0},radiusMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},lineWidthUnits:"meters",lineWidthScale:{type:"number",min:0,value:1},lineWidthMinPixels:{type:"number",min:0,value:0},lineWidthMaxPixels:{type:"number",min:0,value:Number.MAX_SAFE_INTEGER},stroked:!1,filled:!0,billboard:!1,antialiasing:!0,getPosition:{type:"accessor",value:n=>n.position},getRadius:{type:"accessor",value:1},getFillColor:{type:"accessor",value:M2},getLineColor:{type:"accessor",value:M2},getLineWidth:{type:"accessor",value:1},strokeWidth:{deprecatedFor:"getLineWidth"},outline:{deprecatedFor:"stroked"},getColor:{deprecatedFor:["getFillColor","getLineColor"]}};class hm extends Wf{getShaders(){return super.getShaders({vs:P9,fs:U9,source:B9,modules:[T8,q8,D9]})}initializeState(){this.getAttributeManager().addInstanced({instancePositions:{size:3,type:"float64",fp64:this.use64bitPositions(),transition:!0,accessor:"getPosition"},instanceRadius:{size:1,transition:!0,accessor:"getRadius",defaultValue:1},instanceFillColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getFillColor",defaultValue:[0,0,0,255]},instanceLineColors:{size:this.props.colorFormat.length,transition:!0,type:"unorm8",accessor:"getLineColor",defaultValue:[0,0,0,255]},instanceLineWidths:{size:1,transition:!0,accessor:"getLineWidth",defaultValue:1}})}updateState(e){var t;super.updateState(e),e.changeFlags.extensionsChanged&&((t=this.state.model)==null||t.destroy(),this.state.model=this._getModel(),this.getAttributeManager().invalidateAll())}draw({uniforms:e}){const{radiusUnits:t,radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,stroked:l,filled:c,billboard:f,antialiasing:d,lineWidthUnits:p,lineWidthScale:_,lineWidthMinPixels:y,lineWidthMaxPixels:b}=this.props,T={stroked:l,filled:c,billboard:f,antialiasing:d,radiusUnits:Ma[t],radiusScale:r,radiusMinPixels:i,radiusMaxPixels:a,lineWidthUnits:Ma[p],lineWidthScale:_,lineWidthMinPixels:y,lineWidthMaxPixels:b},A=this.state.model;A.shaderInputs.setProps({scatterplot:T}),A.draw(this.context.renderPass)}_getModel(){const e=[-1,-1,0,1,-1,0,-1,1,0,1,1,0];return new El(this.context.device,{...this.getShaders(),id:this.props.id,bufferLayout:this.getAttributeManager().getBufferLayouts(),geometry:new $F({topology:"triangle-strip",attributes:{positions:{size:3,value:new Float32Array(e)}}}),isInstanced:!0})}}hm.defaultProps=F9;hm.layerName="ScatterplotLayer";const L9="pk.eyJ1Ijoia2FybmFtLXAiLCJhIjoiY205a2VnYW1pMGxlYTJrcG5vOHVwNnk0diJ9.aU3bMVTraO_3v3CyJ05eWg",z9="mapbox://styles/mapbox/light-v10",V9=[{name:"Maha Kumbh Mela",country:"India",longitude:81.8852,latitude:25.4328,attendance:120},{name:"Arba'een Pilgrimage",country:"Iraq",latitude:31.5085,longitude:44.714,attendance:20},{name:"Pope Francis' Catholic Mass (2015)",country:"Philippines",latitude:14.582,longitude:120.979,attendance:7},{name:"Hajj",country:"Saudi Arabia",latitude:21.4225,longitude:39.8262,attendance:3},{name:"Makara Jyothi (Sabarimala, 2007)",country:"India",latitude:9.4346,longitude:77.0814,attendance:5},{name:"Bishwa Ijtema",country:"Bangladesh",latitude:23.8915,longitude:90.3969,attendance:5},{name:"Attukal Temple",country:"India",latitude:8.4698,longitude:76.9555,attendance:3},{name:"Black Nazarene Procession",country:"Philippines",latitude:14.5995,longitude:120.9842,attendance:6},{name:"Nabakalebara Festival (2015)",country:"India",latitude:19.8028,longitude:85.8177,attendance:5},{name:"Beatification of Pope John Paul II (2005)",country:"Vatican City",latitude:41.9022,longitude:12.4539,attendance:1}];function H9({viewState:n,setViewState:e}){const[t,r]=K.useState(null),i=[new hm({id:"religious-events",data:V9,getPosition:a=>[a.longitude,a.latitude],getRadius:a=>a.attendance,getFillColor:[147,43,35],lineWidthMinPixels:1,opacity:.8,filled:!0,radiusScale:15e3,radiusMinPixels:2,radiusMaxPixels:100,pickable:!0,onHover:({object:a,x:l,y:c})=>r(a?{object:a,x:l,y:c}:null),transitions:{getPosition:200,getRadius:200}})];return ae.jsxs(c9,{viewState:n,onViewStateChange:({viewState:a})=>e(a),controller:!0,layers:i,style:{position:"relative",top:0,left:0,width:"100%",height:"100%"},children:[ae.jsx(R9,{mapboxAccessToken:L9,mapStyle:z9}),t&&ae.jsxs("div",{style:{position:"absolute",zIndex:10,pointerEvents:"none",left:t.x+10,top:t.y+10,background:"rgba(0,0,0,0.8)",padding:"6px 10px",color:"#fff",borderRadius:"4px",fontSize:"12px",maxWidth:"200px"},children:[ae.jsx("div",{children:ae.jsx("strong",{children:t.object.name})}),ae.jsx("div",{children:t.object.country}),ae.jsxs("div",{children:["Attendance: ",t.object.attendance," million"]})]})]})}const j9=({data:n,currentStep:e})=>{const t=K.useRef(),r=["13.01.2025","14.01.2025","29.01.2025","03.02.2025","12.02.2025"],i=["Fecal_Coliform","BOD","pH"],a=I_().domain(i).range(["#c00021","#e86e50","#e2a85d"]),l=2e3,c=700,f=700,d={top:100,right:150,bottom:100,left:100},p=U3("%d.%m.%Y"),_=r.map(p),y=n.map(C=>({date:p(C.Date),Fecal_Coliform:+C.Fecal_Coliform,BOD:+C.BOD,pH:+C.pH})).filter(C=>C.date&&_.some(N=>+N==+C.date)),b=R4().domain(y.map(C=>C.date)).range([0,l-d.top-d.bottom]).padding(.5),T=N_().domain(i).range([0,f-d.left-d.right]).padding(.1),A={};return i.forEach(C=>{const N=og(y,O=>O[C]);A[C]=C==="Fecal_Coliform"?C3().base(10).domain([1,N]).range([0,T.bandwidth()]):ju().domain([0,N]).range([0,T.bandwidth()])}),K.useEffect(()=>{const C=Zn(t.current);C.selectAll("*").remove(),C.attr("width",f).attr("height",c);const N=C.append("g").attr("class","moveable-group").attr("transform",`translate(${d.left}, ${d.top})`);for(let O=0;O<y.length-1;O++){const R=y[O],E=y[O+1];i.forEach(k=>{const V=T(k),ne=A[k],G=Math.max(R[k],1),se=Math.max(E[k],1),re=ne(G),q=ne(se),ce=V+(T.bandwidth()-re)/2,me=V+(T.bandwidth()-q)/2,de=b(R.date),_e=b(E.date),$=(de+_e)/2,ee=c3();ee.moveTo(ce,de),ee.bezierCurveTo(ce,$,me,$,me,_e),ee.lineTo(me+q,_e),ee.bezierCurveTo(me+q,$,ce+re,$,ce+re,de),ee.closePath(),N.append("path").attr("d",ee.toString()).attr("fill",a(k)).attr("stroke","white").attr("stroke-width",1)})}},[n]),K.useEffect(()=>{const N=Zn(t.current).select(".moveable-group"),O=(l-c-d.top-d.bottom)/4,R=-e*O;N.transition().duration(600).ease(a3).attr("transform",`translate(${d.left}, ${d.top+R})`)},[e]),ae.jsxs("div",{style:{height:`${c}px`,width:"100%",overflow:"hidden",position:"relative"},children:[ae.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",textAlign:"center",padding:"10px 0",fontWeight:"bold",fontSize:"18px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif",background:"rgba(255,255,255,0.8)",zIndex:2},children:"Water Quality Trends Across Major Kumbh Mela Rituals"}),ae.jsx("svg",{ref:t}),ae.jsxs("div",{style:{position:"absolute",top:`${c/2}px`,left:"0",width:"100%",display:"flex",alignItems:"center",pointerEvents:"none",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif"},children:[ae.jsx("div",{style:{paddingLeft:"5 px",fontSize:"20px",fontWeight:"bold",color:"#111",whiteSpace:"nowrap",marginRight:"10px"},children:r[e]}),ae.jsx("div",{style:{width:"500px",height:"2px",backgroundColor:"#000"}})]})]})},$9=({onStepChange:n,selectedInfoMap:e,currentStep:t})=>{const r=[ae.jsxs("div",{style:{textAlign:"left"},children:[ae.jsx("h1",{style:{color:"#932b23",fontSize:"2.6rem",fontWeight:700},children:"Faith Meets Ecology"}),ae.jsxs("p",{style:{color:"#222",fontSize:"1.2rem",lineHeight:1.6},children:["Understanding Public Sentiment on",ae.jsx("br",{}),"Kumbh Mela's Environmental Footprint ",ae.jsx("br",{})," ",ae.jsx("br",{})]}),ae.jsx("p",{style:{color:"#222",fontSize:"0.8rem",lineHeight:1.6},children:"By Priyanka Karnam"})]}),'<p>Kumbh Mela is the largest religious gathering in the world, with <span class="highlighted"> approximately 400 million people </span> attending over a span of 45 days.<br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/><br/></p>',`<span class="sectiontitle">Where does this take place?</span> 
    <p> <br/>At the confluence of River Ganga, River Yamuna, and
    mythical Saraswati, at Sangam, Prayagraj,
    which is located in India.<br/><br/><br/></p>`,`<span class="sectiontitle"> Holy Dip - Shahi Snan (Primary Ritual)</span> 
    <p> <br/>A sacred bath taken by saints and pilgrims in the confluence of rivers, believed to cleanse sins and purify the soul. It is the most auspicious act during Kumbh Mela.</p>`,`<span class="sectiontitle"> Religious Ceremonies & Prayers</span> 
    <p> <br/>Throughout the Mela, devotees perform traditional rituals, chant mantras, and offer prayers to seek blessings, enlightenment, and spiritual merit.</p>`,`<span class="sectiontitle"> Darshan of Naga Sadhus</span> 
    <p> <br/>Pilgrims gather to witness and receive blessings from Naga Sadhusascetic warriors who renounce all worldly possessions and symbolize ultimate spiritual discipline.</p>`,`<span class="sectiontitle">  Offerings to the River</span> 
    <p> <br/>Devotees make offerings of flowers, diyas (oil lamps), and sacred items to the river, symbolizing gratitude, purification, and reverence for nature.</p>`,`<span class="sectiontitle"> Merging the Ashes of the Deceased</span> 
    <p> <br/>Ashes of loved ones are immersed in the sacred waters, believed to free the soul from the cycle of rebirth and lead it toward liberation (moksha).</p>`,"This grand religious gathering, while spiritually significant, has a profound environmental footprint that extends far beyond the festival grounds. The rituals, offerings, and mass congregation at the Kumbh Mela often contribute to river pollution, directly affecting not only the health and well-being of millions of pilgrims but also the delicate ecosystems that depend on these waters.",`<p> Water pollution is severe in the Ganges and Yamuna, India's most polluted rivers  and it spikes further during Kumbh Mela. The National Green Tribunal (NGT) reports elevated levels of <span style= "color: #c00021;" >Fecal Coliform</span>,<span style="color: #e86e50;" > Biochemical Oxygen Demand (BOD)</span> and irregular <span style= "color: #e2a85d;" >pH values</span> which are key indicators of water quality and determine whether water is safe for outdoor bathing.</p>`,`<span class="sectiontitle">Paush Poornima</span> 
    <p> <br/>Marks the beginning of the Kumbh Mela bathing period. Devotees take a holy dip on this full moon day, symbolizing spiritual renewal and the start of auspicious rituals.</br></br></br></p>`,`<span class="sectiontitle">Makar Sankranti</span> 
    <p> <br/>A major bathing day when the Sun enters Capricorn. It signifies the end of winter solstice and is considered highly sacred for taking a dip in the holy rivers.</br></br></br></p>`,`<span class="sectiontitle">Mauni Amavasya (Amawasya)</span> 
    <p> <br/>The most significant bathing day of the Kumbh Mela. It is believed that bathing on this new moon day brings the greatest spiritual merit. Observers also practice silence (maun vrat).</br></br></br></p>`,`<span class="sectiontitle"> Basant Panchami (Panchami)</span> 
    <p> <br/>Celebrated in honor of Goddess Saraswati, the deity of wisdom. Pilgrims bathe to seek knowledge and purity while also celebrating the arrival of spring.</br></br></br></p>`,`<span class="sectiontitle">Maghi Poornima (Poornima)</span> 
    <p> <br/>The final full moon bathing day during the Mela. It holds spiritual importance as many devotees conclude their religious observances with one last purifying dip.</br></br></br></p>`,`Given the sheer scale of this event and its
    significant environmental impactranging from strained water
    resources and rising pollution levels to the
    generation of non-biodegradable
    wasteare people truly aware of these challenges?
    <span class="highlighted">
     How effectively is this situation being communicated through
     the media, and what do people actually
     believe or perceive about the
     environmental consequences of such gatherings?
   </span>`,"<p> </br>To explore public sentiment surrounding religious gatherings and environmental beliefs, data from Reddit and news outlets was collected and analyzed. </p>",`<span class="sectiontitle">Classification of sentiments</span>
   <p> </br>The content was classified based on 
   whether it aligned with environmental concerns or religious beliefs, and further assessed for its alignment with government policies.</p>
   <p style="font-size: 11px; color: #932b23;" ></br>Click or hover the bubbles for more infromation</p>`,`<span class="sectiontitle"> Classification of Sentiments in Reddit</span>
    <p><br/>The analysis of Reddit posts reveals that nearly half (48%) of the content is belief-aligned, followed by 40% aligning with environmental concerns, and 12% categorized as neutral. In terms of government alignment, a majority of the posts (52%) are critical of the government, while 27% remain neutral and 21% show pro-government sentiment. Overall, the Reddit discourse reflects a strong inclination toward personal or spiritual values and a critical stance on governmental actions.</p>
   <p style="font-size: 11px; color: #932b23;" ></br>Click or hover the bubbles for more infromation</p>`,`<span class="sectiontitle">Classification of Sentiments in News Outlets</span>
    <p><br/>The analysis of news articles reveals that both international and Indian media predominantly reflect a belief-aligned sentiment. Among international articles, 64.29% are critical of the government, and 57.14% are belief-aligned. Similarly, Indian articles show that 49.02% are critical of the government, while an even higher percentage72.55%align with belief-driven narratives. This suggests a consistent focus on spiritual or religious themes across both categories, accompanied by a largely critical perspective on governmental actions.</p>
    <p style="font-size: 11px; color: #932b23;" ></br>Click or hover the bubbles for more infromation</p>
    `,`As faith and environmental
    responsibility converge,
      perspectives divergesome
      believe that devotion and nature
      must coexist in harmony, while
      others argue that one must take
      precedence over the other. Yet,
      amidst this contemplation, a
      deeper question emerges: 
      <span class="highlighted">
      Can we reimagine sacred
      gatherings in a way that
      honors both spiritual
      traditions and the well-being
      of the planet?</span>`];return ae.jsx("div",{style:{width:"100%",margin:"0 auto",paddingTop:"50px"},children:ae.jsx(_N,{onStepEnter:({data:i})=>n(i),children:r.map((i,a)=>ae.jsx(SN,{data:a,children:ae.jsxs("div",{id:`scroll-step-${a}`,style:{margin:"0 0 400px",padding:"30px",opacity:t===a?1:.3,transition:"opacity 0.4s ease-in-out",height:"80vh"},children:[typeof i=="string"?ae.jsx("p",{dangerouslySetInnerHTML:{__html:i}}):i,a===0&&ae.jsxs("div",{className:"right-scroll-arrow",children:[ae.jsx("br",{}),ae.jsx("br",{}),ae.jsx("br",{}),ae.jsx("br",{})," Scroll"]}),a===10&&ae.jsx("img",{src:"/warli15.svg",alt:"Warlike visual",id:"imgstyle"}),a===11&&ae.jsx("img",{src:"/warli35.svg",alt:"Warlike visual",id:"imgstyle"}),a===12&&ae.jsx("img",{src:"/warli.svg",alt:"Warlike visual",id:"imgstyle"}),a===13&&ae.jsx("img",{src:"/warli23.svg",alt:"Warlike visual",id:"imgstyle"}),a===14&&ae.jsx("img",{src:"/warli20.svg",alt:"Warlike visual",id:"imgstyle"}),a===2&&ae.jsx("img",{src:"/map.jpg",id:"imgstyle"}),a===1&&ae.jsx("img",{src:"/map_legend.svg",id:"imgstyle"}),a>=17&&a<=19&&ae.jsx("img",{src:"/legend.svg",id:"imgstyle"}),t===a&&typeof e[a]=="string"&&e[a].length>0&&ae.jsx("div",{style:{marginTop:"20px",color:"#333",background:"#faf9f9",padding:"10px",borderRadius:"8px",fontSize:"14px",lineHeight:"1.6em"},dangerouslySetInnerHTML:{__html:`<strong style="font-size: 16px;">Selected Info:</strong><br/>${e[a]}`}})]})},a))})})},W9=({steps:n,currentStep:e,onDotClick:t,scrollStep:r})=>ae.jsx("div",{className:"scroll-dots-wrapper",children:ae.jsx("div",{className:"scroll-dots-container",children:Array.from({length:n}).map((i,a)=>ae.jsx("div",{className:`dot ${e===a?"active":""}`,onClick:()=>t(a),style:{cursor:"pointer"}},a))})});function X9(){const[n,e]=K.useState([]),[t,r]=K.useState([]),[i,a]=K.useState([]),l=K.useRef(null),[c,f]=K.useState(0),[d,p]=K.useState({}),_=K.useRef(0),y=n.length>0&&t.length>0;K.useRef(null);const[b,T]=K.useState({longitude:80,latitude:10,zoom:1.4,pitch:0,bearing:0});K.useEffect(()=>{yp("/data/Reddit.csv",mp).then(e).catch(E=>console.error("Error loading Reddit data:",E))},[]),K.useEffect(()=>{yp("/data/Articles.csv",mp).then(r).catch(E=>console.error("Error loading Articles data:",E))},[]),K.useEffect(()=>{yp("/data/Kumbhdata.csv",mp).then(a).catch(E=>console.error("Error loading kumbhmela data:",E))},[]),K.useEffect(()=>{var E;(E=l.current)==null||E.updateVisualization(c)},[c]);const A=K.useMemo(()=>[...n.map(E=>({...E,source:"Reddit",size:E.size||6,Predicted_Label:E.Predicted_Label,Predicted_Label_gov:E.Predicted_Label_gov,Pro_Gov_Score:E.Pro_Gov_Score,Crit_Gov_Score:E.Crit_Gov_Score,Environment_Score:E.Environment_Score,Belief_Score:E.Belief_Score})),...t.map(E=>({...E,source:"Articles",size:E.size||6,Predicted_Label:E.a_Predicted_Label,Predicted_Label_gov:E.a_Predicted_Label_gov,Pro_Gov_Score:E.a_Pro_Gov_Score,Crit_Gov_Score:E.a_Crit_Gov_Score,Environment_Score:E.a_Environment_Score,Belief_Score:E.a_Belief_Score}))],[n,t]),C=E=>{_.current=E,f(k=>k!==E?(p({}),E===2&&T({longitude:81.8852,latitude:25.4328,zoom:10,pitch:0,bearing:0,transitionDuration:1500,transitionInterpolator:new m2}),E===1&&T({longitude:80,latitude:10,zoom:1.4,pitch:0,bearing:0,transitionDuration:1500,transitionInterpolator:new m2}),E):k)},N=E=>{C(E);const k=document.querySelector(`#scroll-step-${E}`);k&&k.scrollIntoView({behavior:"smooth",block:"center"})},O=({data:E,step:k})=>{const ne=["13.01.2025","14.01.2025","29.01.2025","03.02.2025","12.02.2025"][k],G=E.find(se=>se.Date===ne);return G?ae.jsxs("div",{style:{position:"absolute",bottom:"60px",left:"20px",background:"rgba(255, 255, 255, 0.9)",padding:"14px 18px",borderRadius:"10px",fontSize:"13px",fontFamily:"'Helvetica Neue', Helvetica, Arial, sans-serif",lineHeight:"1.5em",maxWidth:"300px",zIndex:1e3,boxShadow:"0 6px 15px rgba(0, 0, 0, 0.15)"},children:[ae.jsx("div",{style:{color:"#000",fontWeight:600,fontSize:"16px"},children:G.Quality}),ae.jsx("hr",{style:{margin:"8px 0",borderColor:"#343a40"}}),ae.jsxs("div",{children:[ae.jsx("span",{style:{color:"#c00021",fontWeight:"bold",fontSize:"16px"},children:"Fecal Coliform:"})," ",ae.jsx("span",{style:{fontWeight:500},children:G.Fecal_Coliform})]}),ae.jsx("hr",{style:{margin:"8px 0",borderColor:"#343a40"}}),ae.jsxs("div",{children:[ae.jsx("span",{style:{color:"#e86e50",fontWeight:"bold",fontSize:"16px"},children:"BOD:"})," ",ae.jsx("span",{style:{fontWeight:500},children:G.BOD})]}),ae.jsx("hr",{style:{margin:"8px 0",borderColor:"#343a40"}}),ae.jsxs("div",{children:[ae.jsx("span",{style:{color:"#e2a85d",fontWeight:"bold",fontSize:"16px"},children:"pH:"})," ",ae.jsx("span",{style:{fontWeight:500},children:G.pH})]})]}):null},R=K.useCallback(E=>{var q,ce,me,de,_e,$;const k=_.current,V=E.source==="Reddit"&&((q=E.Source)!=null&&q.startsWith("http"))?E.Source:null,ne=E.source==="Articles"&&((ce=E.url)!=null&&ce.startsWith("http"))?E.url:null,G=V||ne,se=G?`<br/><a href="${G}" target="_blank" rel="noopener noreferrer" style="color:#0066cc; text-decoration:underline;">Read more</a>`:"",re=`
      <div style="line-height:1.6;">

        <strong>Type:</strong> ${E.source||E.Category}<br/>
        <strong>Author:</strong> ${E.author||E.Published_company||"-"}<br/>
        ${E.Category?`<strong>Category:</strong> ${E.Category}<br/>`:""}
        <strong>Title:</strong> ${E.title||E.content||"-"}<br/>
        <strong>Pro-Gov:</strong> ${(me=E.Pro_Gov_Score)==null?void 0:me.toFixed(2)} |
        <strong>Crit-Gov:</strong> ${(de=E.Crit_Gov_Score)==null?void 0:de.toFixed(2)}<br/>
        <strong>Environment:</strong> ${(_e=E.Environment_Score)==null?void 0:_e.toFixed(2)} |
        <strong>Belief:</strong> ${($=E.Belief_Score)==null?void 0:$.toFixed(2)}
        ${se}
      </div>
    `;p(ee=>ee[k]===re?ee:{...ee,[k]:re})},[]);return ae.jsxs(ae.Fragment,{children:[ae.jsx("div",{className:"app-container",children:ae.jsxs("div",{className:"scroll-content",children:[ae.jsx("div",{className:"left-visuals",children:y?ae.jsxs(ae.Fragment,{children:[c===0&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/mainimage.jpg",alt:"Narrative",className:"imagestyle"})}),(c===1||c===2)&&ae.jsx(H9,{viewState:b,setViewState:T}),c===3&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/Shah-Snan.jpg",alt:"Narrative",className:"imagestyle"})}),c===4&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/pooja.jpg",alt:"Narrative",className:"imagestyle"})}),c===5&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/aghori.jpg",alt:"Narrative",className:"imagestyle"})}),c===6&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/offering.jpg",alt:"Narrative",className:"imagestyle"})}),c===7&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/asthivisarjan.jpg",alt:"Narrative",className:"imagestyle"})}),c===8&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/water.jpg",alt:"Narrative",className:"imagestyle"})}),c===9&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/wateratri.svg",alt:"Narrative",className:"imagestyle"})}),c>=10&&c<=14&&ae.jsx(j9,{data:i,currentStep:c-10}),c>=10&&c<=14&&ae.jsx(O,{data:i,step:c-10}),c===15&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/newsdata.jpg",alt:"Narrative",className:"imagestyle"})}),c>=16&&c<=19&&ae.jsx(tN,{ref:l,data:A,onBubbleClick:R,currentStep:c}),c===20&&ae.jsx("div",{id:"imagedivstyle",children:ae.jsx("img",{src:"/Aghori_Water.jpg",alt:"Narrative",className:"imagestyle"})})]}):ae.jsx("div",{style:{padding:"2rem",fontSize:"1.2rem",color:"#666"},children:"Loading data..."})}),ae.jsx("div",{className:"right-scroll",children:ae.jsx($9,{onStepChange:C,selectedInfoMap:d,currentStep:c})})]})}),ae.jsx(W9,{steps:21,currentStep:c,onDotClick:N,scrollStep:c}),ae.jsx("div",{id:"global-tooltip",className:"tooltip"})]})}const O2=document.getElementById("root");O2?VE.createRoot(O2).render(ae.jsx(K.StrictMode,{children:ae.jsx(X9,{})})):console.error("Failed to find the root element. Make sure #root is present in index.html.");export{NE as g};
